(function () {
    'use strict';

    var app = angular.module('scaleApp', [
        'scaleConfigModule',
        'ngResource',
        'ngSanitize',
        'ngRoute',
        'emguo.poller',
        'ui.bootstrap',
        'ui.grid',
        'ui.grid.selection',
        'ui.grid.pagination',
        'ui.grid.resizeColumns',
        'cfp.hotkeys'
    ]);

    app.config(['$routeProvider', '$resourceProvider', 'pollerConfig', function($routeProvider, $resourceProvider, pollerConfig) {
        // stop pollers when route changes
        pollerConfig.stopOnRouteChange = true;
        pollerConfig.smart = true;

        // preserve trailing slashes
        $resourceProvider.defaults.stripTrailingSlashes = false;

        //routing
        $routeProvider
            .when('/', {
                controller: 'ovController',
                templateUrl: 'modules/overview/partials/ovTemplate.html'
            })
            .when('/admin/login',{
                controller: 'adminLoginController',
                templateUrl: 'modules/admin/partials/adminLoginTemplate.html'
            })
            .when('/admin/logout',{
                controller: 'logoutController',
                templateUrl: 'modules/admin/partials/adminLoginTemplate.html'
            })
            .when('/about', {
                controller: 'aboutController',
                templateUrl: 'modules/about/partials/aboutTemplate.html'
            })
            .when('/feed', {
                controller: 'feedDetailsController',
                templateUrl: 'modules/feed/partials/feedDetailsTemplate.html',
                reloadOnSearch: false
            })
            .when('/feed/ingests', {
                controller: 'ingestRecordsController',
                templateUrl: 'modules/feed/partials/ingestRecordsTemplate.html',
                reloadOnSearch: false
            })
            .when('/metrics', {
                controller: 'metricsController',
                templateUrl: 'modules/metrics/partials/metricsTemplate.html',
                reloadOnSearch: false
            })
            .when('/nodes', {
                controller: 'nodesController',
                templateUrl: 'modules/nodes/partials/nodesTemplate.html'
            })
            .when('/nodes/:id', {
                controller: 'nodeDetailsController',
                templateUrl: 'modules/nodes/partials/nodeDetailsTemplate.html'
            })
            .when('/load', {
                controller: 'loadController',
                templateUrl: 'modules/load/partials/loadTemplate.html'
            })
            .when('/load/running', {
                controller: 'queueRunningController',
                templateUrl: 'modules/load/partials/queueRunningTemplate.html'
            })
            .when('/load/depth', {
                controller: 'loadDepthController',
                templateUrl: 'modules/load/partials/loadDepthTemplate.html'
            })
            .when('/recipes', {
                controller: 'recipesController',
                templateUrl: 'modules/recipes/partials/recipesTemplate.html',
                reloadOnSearch: false
            })
            .when('/recipes/recipe/:id', {
                controller: 'recipeDetailsController',
                templateUrl: 'modules/recipes/partials/recipeDetailsTemplate.html'
            })
            .when('/recipes/types/:id?', {
                controller: 'recipeTypesController',
                templateUrl: 'modules/recipes/partials/recipeTypesTemplate.html'
            })
            .when('/recipes/builder', {
                controller: 'recipeEditorController',
                templateUrl: 'modules/recipes/partials/recipeEditorTemplate.html'
            })
            .when('/recipes/builder/:id', {
                controller: 'recipeEditorController',
                templateUrl: 'modules/recipes/partials/recipeEditorTemplate.html'
            })
            .when('/jobs', {
                controller: 'jobsController',
                templateUrl: 'modules/jobs/partials/jobsTemplate.html',
                reloadOnSearch: false
            })
            .when('/jobs/job/:id', {
                controller: 'jobDetailController',
                templateUrl: 'modules/jobs/partials/jobDetailTemplate.html'
            })
            .when('/jobs/types/:id?', {
                controller: 'jobTypesController',
                templateUrl: 'modules/jobs/partials/jobTypesTemplate.html'
            })
            .when('/jobs/failure-rates', {
                controller: 'jobTypesFailureRatesController',
                controllerAs: 'vm',
                templateUrl: 'modules/jobs/partials/jobTypesFailureRatesTemplate.html',
                reloadOnSearch: false
            })
            .when('/jobs/executions', {
                controller: 'jobExecutionsController',
                templateUrl: 'modules/jobs/partials/jobExecutionsTemplate.html'
            })
            .when('/jobs/executions/:id', {
                controller: 'jobExecutionDetailController',
                templateUrl: 'modules/jobs/partials/jobExecutionDetailTemplate.html'
            })
            .otherwise({
                redirectTo: '/'
            });
    }])
    .value('moment', window.moment)
    .value('localStorage', window.localStorage)
    .value('XMLHttpRequest', window.XMLHttpRequest)
    .value('toastr', window.toastr);
})();

(function () {
    'use strict';

    angular.module('scaleConfigModule', []).provider('scaleConfig', function () {
        var scaleConfig = {},
            scaleConfigLocal = {};

        this.$get = function () {
            var config = $.ajax({
                type: 'GET',
                url: 'config/scaleConfig.json',
                cache: false,
                async: false,
                contentType: 'application/json',
                dataType: 'json'
            });
            
            if (config.status === 200) {
                scaleConfig = config.responseJSON.scaleConfig;

                var configLocal = $.ajax({
                    type: 'GET',
                    url: 'config/scaleConfig.local.json',
                    cache: false,
                    async: false,
                    contentType: 'application/json',
                    dataType: 'json'
                });

                if (configLocal.status === 200) {
                    scaleConfigLocal = configLocal.responseJSON.scaleConfigLocal;
                }

                _.merge(scaleConfig, scaleConfigLocal);
            }

            return scaleConfig;
        }
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisHeaderController', ['$scope', '$element', 'subnavService', function($scope, $element, subnavService) {
        $scope.date = new Date();
        $scope.currentPath = subnavService.getCurrentPath();
    }])
    .directive('aisHeader', function () {
        /**
         * Usage: <ais-header name={name}></ais-header>
         */
        return {
            controller: 'aisHeaderController',
            restrict: 'E',
            templateUrl: 'modules/header/headerTemplate.html',
            scope: {
                name: '=',
                hideTitle: '=',
                loading: '=', // optional - will overlay a loading spinner on the page based on the passed-in value
                showSubnav: '=',
                subnavLinks: '='
            }
        };

    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').directive('scaleNavigation', function () {
        return {
            restrict: 'E',
            templateUrl: 'modules/navigation/partials/navTemplate.html',
            controller: 'navController'
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aboutController', ['$scope', '$location', '$window', 'navService', 'stateService', function($scope, $location, $window, navService, stateService) {
        $scope.stateService = stateService;
        $scope.version = '';

        var initialize = function() {
            navService.updateLocation('about');
        };

        initialize();

        $scope.$watch('stateService.getVersion()', function (newValue) {
            $scope.version = newValue;
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisDataFeedController', ['$scope', 'scaleConfig', 'loadService', 'scaleService', function ($scope, scaleConfig, loadService, scaleService) {
        $scope.days = [];
        $scope.hours = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];
        $scope.values = {};
        var processNewFeed = function(){
            var currentDay = moment.utc();
            $scope.days = [];
            var day = '';
            if($scope.feed){
                _.forEach($scope.feed.values, function(val){
                    var valday = moment.utc(val.time).format(scaleConfig.dateFormats.day);
                    var valhour = moment.utc(val.time).hour();
                    var id = valday + '_' + valhour;
                    $scope.values[id] = val;
                    if(valday !== day){
                        day = valday;
                        $scope.days.push(valday);
                    }
                });
                buildTable();
            }
        };

        var buildTable = function () {
            var currDay = moment().utc().format(scaleConfig.dateFormats.day);
            var currHour = moment().utc().hour();

            var table_html = '<div class="table-responsive"><table>';
            table_html += '<tr><th>Hour (UTC)</th>';
            for(day in $scope.days){
                table_html += '<td class="day-label" title="' + $scope.days[day] + '"><div class="day-of-week">' + scaleService.getDayString(moment($scope.days[day]).day()) + '</div>' + moment($scope.days[day]).format('MM/DD') + '</td>';
            }
            table_html += '</tr>';
            for(var hour in $scope.hours){
                hour = 23-hour;
                table_html += '<tr>';
                table_html += '<th title="' + $scope.hours[hour] + ':00">' + $scope.hours[hour] + '</th>';

                for(var day in $scope.days){
                    var key =  $scope.days[day] + '_' + $scope.hours[hour];
                    var files = $scope.values[key].files;
                    var size = $scope.values[key].size;
                    var cls = 'good';
                    if($scope.days[day] === currDay){
                        if($scope.hours[hour] === currHour){
                            cls = 'current';
                        }
                        else if($scope.hours[hour] > currHour) {
                            cls = 'future';
                        }
                    }
                    if(files === 0 && size === 0 && cls !== 'current' && cls !== 'future'){
                        cls = 'unknown';
                    }
                    //console.log(key);
                    table_html += '<td id="' + key + '" title="' + $scope.days[day] + ' ' + $scope.hours[hour] + ':00">';
                    if(cls === 'future'){
                        //table_html += '<span class="' + cls + '" id="span_' + $scope.days[day] + '_' + $scope.hours[hour] + '" style="display: block;"><div class="file-count">&nbsp;</div><div class="file-size">&nbsp;</div></span></td>';
                        table_html += '<span class="' + cls + '" id="span_' + $scope.days[day] + '_' + $scope.hours[hour] + '" style="display: block;">&nbsp;</span></td>';
                    }
                    else{
                        //table_html += '<span class="' + cls + '" id="span_' + $scope.days[day] + '_' + $scope.hours[hour] + '" style="display: block;"><div class="file-count">' + files + '</div><div class="file-size">' + scaleService.calculateFileSizeFromBytes(size,1) + '</div></span></td>';
                        //table_html += '<span class="' + cls + '" id="span_' + $scope.days[day] + '_' + $scope.hours[hour] + '" style="display: block;"><span class="file-count">' + files + '</span> / <span class="file-size">' + scaleService.calculateFileSizeFromBytes(size,1) + '</span></span></td>';
                        table_html += '<span class="' + cls + '" id="span_' + $scope.days[day] + '_' + $scope.hours[hour] + '" style="display: block;">' + scaleService.calculateFileSizeFromBytes(size,1) + ' / ' + files + '</span></td>';
                    }

                }
                table_html += '</tr>';
            }
            table_html += '</table></div>';
            $('#history').html(table_html);
        };

        var initialize = function(){

            $scope.$watch('feed', function (value) {
                if($scope.feed){
                    processNewFeed();
                }
            });
        };

        initialize();
    }]).directive('aisDataFeed', function () {
        return {
            controller: 'aisDataFeedController',
            templateUrl: 'modules/charts/dataFeed/dataFeedTemplate.html',
            restrict: 'E',
            scope: {
                feed: '=' // Feed data
            }
        };

    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisDonutController', ['$scope', '$element', 'scaleConfig', function($scope, $element, scaleConfig) {
        var chart = null;

        var genChart = function () {
            if (chart) {
                //chart.data()
                //$scope.colData
                var oldData = [],
                    removeIds = [];

                // reassemble currently displayed data to match $scope.colData
                _.forEach(chart.data(), function (d) {
                    oldData.push([d.values[0].id, d.values[0].value]);
                });

                // determine which elements to remove
                _.forEach(oldData, function (od) {
                    var keep = _.find($scope.colData, function (cd) {
                        return cd[0] === od[0];
                    });
                    if (!keep) {
                        removeIds.push(od[0]);
                    }
                });

                // update chart
                //console.log(JSON.stringify($scope.colData));
                //console.log(JSON.stringify(removeIds));
                chart.load({
                    columns: $scope.colData,
                    unload: removeIds
                });
            } else {
                chart = c3.generate({
                    bindto: $element[0],
                    data: {
                        columns: $scope.colData,
                        type: $scope.type,
                        colors: {
                            down: scaleConfig.colors.chart_red,
                            warning: scaleConfig.colors.chart_yellow,
                            up: scaleConfig.colors.chart_green,
                            Completed: scaleConfig.colors.chart_green,
                            Done: '#3681bf',
                            Queue: scaleConfig.colors.chart_yellow,
                            Failed: scaleConfig.colors.chart_red,
                            ALGORITHM: scaleConfig.colors.failure_algorithm,
                            DATA: scaleConfig.colors.failure_data,
                            SYSTEM: scaleConfig.colors.failure_system,
                            Offline: scaleConfig.colors.chart_red,
                            'High Failure Rate': scaleConfig.colors.chart_orange,
                            Paused: scaleConfig.colors.chart_yellow
                        }
                    },
                    transition: {
                        duration: 700
                    },
                    pie: {
                        label: {
                            format: d3.format(',')
                        }
                    },
                    donut: {
                        label: {
                            format: $scope.showLabel ? d3.format(',') : function () {
                                return '';
                            }
                        },
                        width: $scope.width,
                        title: $scope.name
                    },
                    tooltip: {
                        format: {
                            value: d3.format(',')
                        }
                    },
                    size: {
                        height: $scope.size || 320
                    }
                });
            }
            $element[0].style.position = 'static';
        };

        var initColumnData = function(){
            $scope.colData = [];
            $scope.data.forEach(function(obj){
                $scope.colData.push([obj.status,obj.count]);
            });
        };

        var initialize = function() {
            initColumnData();
            genChart();
        };

        $scope.$watch('data', function (data) {
            if (data) {
                if (data.length > 0) {
                    initialize();
                } else {
                    $($element[0]).empty();
                }
            }
        });

        window.onresize = function() {
          var width = $($element[0]).width();
          console.log(width);
          genChart();
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').directive('aisDonut', function () {
        return {
            controller: 'aisDonutController',
            restrict: 'E',
            scope: {
                data: '=',
                type: '=',
                size: '=',
                showLabel: '=',
                width: '=',
                name: '='
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisGridChartController', ['$rootScope', '$scope', '$location', '$uibModal', 'userService', 'scaleConfig', 'scaleService', function ($rootScope, $scope, $location, $uibModal, userService, scaleConfig, scaleService) {
        var svg = null,
            rect = null,
            scale = parseFloat($scope.scale),
            tip = d3.tip()
                .attr('class', 'd3-tip')
                .offset([-10, 0])
                .html(function(d) {
                    var failures = d.status.getFailures(),
                        failStr = failures.length > 0 ? '<br /><br />' : '',
                        running = getCellActivityTotal(d),
                        completed = getCellTotal(d),
                        statusStr = running > 0 || completed > 0 ? '<br />' : '';

                    if (running > 0) {
                        statusStr = statusStr + '<span class="label label-running">Running: ' + running + '</span>';
                    }
                    if (completed > 0) {
                        statusStr = statusStr + ' <span class="label label-completed">Completed: ' + completed + '</span>';
                    }

                    failures = _.sortByOrder(failures, ['order']);

                    _.forEach(failures, function (f) {
                        failStr = failStr + '<span class="label label-' + f.status.toLowerCase() + '">' + _.capitalize(f.status.toLowerCase()) + ': ' + f.count + '</span> ';
                    });
                    return d.title + ' ' + d.version + '<br />' + statusStr + failStr;
                });

        $scope.loading = true;
        $scope.dataValues = [];
        $scope.cellWidth = 50 * scale;
        $scope.cellHeight = 50 * scale;
        $scope.enableZoom = typeof $scope.mode !== 'undefined' ? $scope.mode === 'zoom' : true;
        $scope.enableTooltip = typeof $scope.mode !== 'undefined' ? $scope.mode === 'tooltip' : false;
        $scope.enableReveal = typeof $scope.reveal !== 'undefined' ? $scope.reveal : true;
        $scope.user = userService.getUserCreds();
        $scope.pauseReason = '';
        $scope.gridData = [];
        $scope.gridClass = function () {
            return $scope.icons === true ? 'icons' : '';
        };

        var width = $('.grid-chart').width(),
            height = $scope.rows ? ($scope.cellHeight * $scope.rows) + 10 : $scope.mode === 'zoom' ? scaleService.getViewportSize().height * 2 : ($scope.cellHeight * 6) + 10, // multiply cell height by 8 (highest zoom scale extent value) plus some breathing room
            cols = 0,
            rows = 0,
            cellFontLg = .4,
            cellFontSm = .3;

        var getDataValues = function (data) {
            $scope.gridData = [];
            $scope.dataValues = [];
            if (data.data) {
                var dataType = data.data.toString().split(',')[0];
                if (dataType === 'JobType') {
                    $scope.dataValues = _.sortByOrder(_.values(data.data), ['name'], ['asc']);
                    // associate JobType with JobTypeStatus
                    _.forEach($scope.dataValues, function (val) {
                        val.status = _.find(data.status, 'job_type.id', val.id);
                    });
                    $scope.dataValues = _.sortByOrder(_.values(data.data), ['status.has_running', 'status.description', 'name'], ['asc', 'asc', 'asc']);
                } else if (dataType === 'Node') {
                    $scope.dataValues = _.values(data.data);
                    //$scope.dataValues = _.sortByOrder(_.values(data.data), ['hostname'], ['asc']);
                    // associate Node with NodeStatus
                    _.forEach($scope.dataValues, function (val) {
                        val.status = _.find(data.status, 'node.id', val.id);
                    });
                    //$scope.dataValues = _.sortByOrder($scope.dataValues, ['hostname'], ['asc']); // sort by hostName asc
                } else {
                    $scope.dataValues = data.data;
                }

                cols = $scope.columns ? $scope.columns : Math.floor(width / $scope.cellWidth);
                rows = $scope.rows ? $scope.rows : Math.ceil($scope.dataValues.length / cols);

                d3.range(rows).map(function (row) {
                    d3.range(cols).map(function (col) {
                        if (col <= $scope.dataValues.length - 1) {
                            var dataObj = $scope.dataValues[(cols * row) + col];
                            if (dataObj) {
                                dataObj.coords = [col * $scope.cellHeight, row * $scope.cellWidth];
                                $scope.gridData.push(dataObj);
                            }
                        }
                    });
                });

                update();
            }
        };

        var revealData = function () {
            d3.selectAll('.cell-text')
                .style('display', 'none');
            d3.selectAll('.cell-text-detail')
                .style('display', 'block');
            d3.selectAll('.cell-pause-resume-icon')
                .style('display', 'block');
        };

        var hideData = function () {
            d3.selectAll('.cell-text')
                .style('display', 'block');
            d3.selectAll('.cell-text-detail')
                .style('display', 'none');
            d3.selectAll('.cell-pause-resume-icon')
                .style('display', 'none');
        };

        var initialize = function (data) {
            cols = $scope.columns ? $scope.columns : Math.floor(width / $scope.cellWidth);
            rows = $scope.rows ? $scope.rows : Math.ceil($scope.dataValues.length / cols);

            var tickValues = Array.apply(null, {length: rows}).map(Number.call, Number);

            var zoom = d3.behavior.zoom()
                .scaleExtent([1, 6])
                //.center([0, 0])
                .on('zoom', zoomed);

            if ($scope.enableZoom) {
                svg = d3.select('.grid-chart').append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .append('g')
                    .call(zoom)
                    .append('g');
            } else if ($scope.enableTooltip) {
                svg = d3.select('.grid-chart').append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .append('g')
                    .call(tip);
            } else {
                svg = d3.select('.grid-chart').append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .append('g');
            }

            svg.append('rect')
                .attr('class', 'overlay')
                .attr('width', width)
                .attr('height', height);

            if ($scope.showAxes) {
                var y = d3.scale.linear()
                    .domain([0, rows])
                    .range([0, height-10]);

                var yAxis = d3.svg.axis()
                    .scale(y)
                    .orient('left')
                    .tickValues(tickValues);

                svg.attr('transform', 'translate(' + 25 + ',' + 0 + ')')
                    .append('g')
                    .attr('class', 'y axis')
                    .attr('transform', 'translate(' + 0 + ',' + $scope.cellHeight / 2 + ')')
                    .call(yAxis);
            }

            getDataValues(data);

            function zoomed() {
                var s = d3.event.scale;

                if ($scope.enableReveal) {
                    if (s > 3) {
                        revealData();
                    } else {
                        hideData();
                    }
                }
                if (s === 1) {
                    if ($scope.showAxes) {
                        zoom.translate([25, 0]);
                    } else {
                        zoom.translate([0, 0]);
                    }
                }
                svg.attr('transform', 'translate(' + zoom.translate() + ')scale(' + d3.event.scale + ')');
            }

            $scope.loading = false;
        };

        var dragOffsetX = 0,
            dragOffsetY = 0,
            clickOffsetX = 0,
            clickOffsetY = 0;

        var drag = d3.behavior.drag()
            .on('dragstart', function () {
                // track offsetX and offsetY to distinguish between drag and click
                dragOffsetX = d3.event.sourceEvent.layerX;
                dragOffsetY = d3.event.sourceEvent.layerY;
            });

        var getCellFill = function (d) {
            if (d && d.status) {
                return d.status.getCellFill();
            }
            return 'none';
        };

        var getCellText = function (d) {
            if (d) {
                return d.getCellText();
            }
        };

        var getCellActivity = function (d) {
            if (d && d.status) {
                return d.status.getRunning();
            }
        };

        var getCellPauseResume = function (d) {
            if (d && d.status) {
                return d.status.getCellPauseResume();
            }
        };

        var getCellActivityTotal = function (d) {
            if (d && d.status) {
                return d.status.getCellActivityTotal();
            }
        };

        var getCellTitle = function (d) {
            if (d) {
                return d.getCellTitle();
            }
        };

        var getCellError = function (d) {
            if (d && d.status) {
                return d.status.getCellError();
            }
            return 'Failed: Unavailable';
        };

        var getCellTotal = function (d) {
            if (d && d.status) {
                return d.status.getCellTotal();
            }
            return 'Completed: Unavailable';
        };

        var getCellStatus = function (d) {
            if (d && d.status) {
                if (d.toString() === 'Node') {
                    return d.status.getCellStatus();
                }
            }
            return 'Status Unavailable';
        };

        var getCellJobs = function (d) {
            if (d && d.status) {
                if (d.toString() === 'Node') {
                    return d.status.getCellJobs();
                }
            }
        };

        var getCellFailures = function (d) {
            if (d && d.status) {
                if (d.toString() === 'JobType') {
                    return d.status.getCellFailures();
                }
            }
        };

        var cellClickHandler = function (target) {
            // track offsetX and offsetY to distinguish between drag and click
            clickOffsetX = d3.event.layerX;
            clickOffsetY = d3.event.layerY;
            if (dragOffsetX === clickOffsetX && dragOffsetY === clickOffsetY) {
                // offsets are the same; no dragging occurred; process as click event
                $scope.$apply(function () {
                    if (target.toString() === 'JobType') {
                        $location.path('/jobs').search('job_type_id', target.id).search('status', target.status.has_running.status);
                    } else if (target.toString() === 'Node') {
                        $location.path('/nodes/' + target.id);
                    }
                });
            }
        };

        var update = function () {
            // DATA JOIN
            // Join new data with old elements, if any.
            if ($scope.enableTooltip) {
                var containerGroup = svg.selectAll('.cell-group')
                    .data($scope.gridData, function (d) { return d.coords; })
                    .on('mouseover', tip.show)
                    .on('mouseout', tip.hide)
                    .on('click', tip.hide);
            } else {
                var containerGroup = svg.selectAll('.cell-group')
                    .data($scope.gridData, function (d) { return d.coords; });
            }

            // UPDATE
            // Update old elements as needed.
            containerGroup.selectAll('.stop1')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 0) {
                        if (failures.length === 1) {
                            return '100%';
                        }
                        return '0%';
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 0) {
                        return failures[0] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[0] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });

            containerGroup.selectAll('.stop2')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 0) {
                        if (failures.length === 3) {
                            return '50%';
                        } else if (failures.length === 2) {
                            return '100%';
                        }
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 1) {
                        return failures[1] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[1] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });

            containerGroup.selectAll('.stop3')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 2) {
                        if (failures.length === 3) {
                            return '100%';
                        }
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 2) {
                        return failures[2] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[2] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });

            containerGroup.selectAll('.cell')
                .data($scope.gridData, function (d) { return d.coords; })
                .transition()
                .duration(750)
                .attr('class', function (d) {
                    var active = getCellActivity(d);
                    if (active) {
                        return active.count > 0 ? 'cell cell-activity' : 'cell';
                    }
                    return 'cell';
                })
                .style('stroke', function (d) {
                    return d ? '#fff' : 'none';
                })
                .style('fill', function (d) {
                    if (d.toString() === 'Node') {
                        return getCellFill(d);
                    }
                });

            var cg = containerGroup.selectAll('.cell-gradient');

            containerGroup.selectAll('.cell-text')
                .data($scope.gridData, function (d) { return d.coords; })
                .html(function (d) {
                    return getCellText(d);
                })
                .attr('y', function (d) {
                    if (d.toString() === 'JobType' && getCellActivityTotal(d) > 0) {
                        return $scope.cellHeight / 2;
                    }
                    return ($scope.cellHeight / 2) + 10;
                });

            containerGroup.selectAll('.cell-total-active')
                .data($scope.gridData, function (d) { return d.coords; })
                .text(function (d) {
                    if (d.toString() === 'JobType') {
                        return getCellActivityTotal(d);
                    }
                });

            containerGroup.selectAll('.cell-pause-resume-icon')
                .data($scope.gridData, function (d) { return d.coords; })
                .html(function (d) {
                    return getCellPauseResume(d);
                });

            containerGroup.selectAll('.cell-title')
                .data($scope.gridData, function (d) { return d.coords; })
                .html(function (d) {
                    return getCellTitle(d);
                });

            containerGroup.selectAll('.cell-error')
                .data($scope.gridData, function (d) { return d.coords; })
                .text(function (d) {
                    return getCellError(d, true);
                });

            containerGroup.selectAll('.cell-total')
                .data($scope.gridData, function (d) { return d.coords; })
                .text(function (d) {
                    return getCellTotal(d);
                });

            containerGroup.selectAll('.cell-status')
                .data($scope.gridData, function (d) { return d.coords; })
                .text(function (d) {
                    return getCellStatus(d);
                });

            containerGroup.selectAll('.cell-jobs')
                .data($scope.gridData, function (d) { return d.coords; })
                .html(function (d) {
                    return getCellJobs(d);
                });

            containerGroup.selectAll('.cell-overlay')
                .data($scope.gridData, function (d) { return d.coords; })
                .on('click', function (target) {
                    cellClickHandler(target);
                });

            // ENTER
            // Create new elements as needed.
            var cellGroup = containerGroup.enter()
                .append('g')
                .attr('class', 'cell-group');

            var defs = cellGroup.append('defs');
            var gradient = defs.append('linearGradient')
                .attr('id', function (d) {
                    return d.name;
                })
                .attr('class', 'cell-gradient')
                .attr('x1', 0)
                .attr('y1', 0)
                .attr('x2', 0)
                .attr('y2', 1);
            gradient.append('stop')
                .attr('class', 'stop1')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 0) {
                        if (failures.length === 1) {
                            return '100%';
                        }
                        return '0%';
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 0) {
                        return failures[0] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[0] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });
            gradient.append('stop')
                .attr('class', 'stop2')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 1) {
                        if (failures.length === 3) {
                            return '50%';
                        } else if (failures.length === 2) {
                            return '100%';
                        }
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 1) {
                        return failures[1] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[1] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });
            gradient.append('stop')
                .attr('class', 'stop3')
                .attr('offset', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 2) {
                        if (failures.length === 3) {
                            return '100%';
                        }
                    }
                    return '0%';
                })
                .attr('stop-color', function (d) {
                    var failures = getCellFailures(d);
                    if (failures && failures.length > 2) {
                        return failures[2] === 'SYSTEM' ? scaleConfig.colors.failure_system : failures[2] === 'DATA' ? scaleConfig.colors.failure_data : scaleConfig.colors.failure_algorithm;
                    }
                    return getCellFill(d);
                });

            cellGroup.append('rect')
                .attr('class', function (d) {
                    var active = getCellActivity(d);
                    if (active) {
                        return active.count > 0 ? 'cell cell-activity' : 'cell';
                    }
                    return 'cell';
                })
                .attr('width', $scope.cellWidth)
                .attr('height', $scope.cellHeight)
                .style('fill', function (d) {
                    if (d.toString() === 'Node') {
                        return getCellFill(d);
                    }
                })
                .attr('fill', function (d) {
                    if (d.toString() === 'JobType') {
                        return 'url(#' + d.name + ')';
                    }
                })
                .style('stroke', function (d) {
                    return d ? '#fff' : 'none';
                })
                .transition()
                .duration(750);

            cellGroup.append('text')
                .attr('class', 'cell-text')
                .html(function (d) {
                    return getCellText(d);
                })
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', function (d) {
                    if (d.toString() === 'JobType') {
                        if (getCellActivityTotal(d) > 0) {
                            return $scope.cellHeight / 2;
                        }
                        return ($scope.cellHeight / 2) + 10;
                    }
                    return $scope.cellHeight / 2;
                })
                .style('font-size', function (d) {
                    if (d.toString() === 'Node') {
                        return $scope.scale * 8 + 'px';
                    }
                    return '';
                })
                .style('display', $scope.enableReveal ? 'block' : 'none');

            cellGroup.append('text')
                .attr('class', 'cell-total-active')
                .text(function (d) {
                    if (d.toString() === 'JobType') {
                        return getCellActivityTotal(d);
                    }
                })
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', $scope.cellHeight - 5)
                .style('display', $scope.enableReveal ? 'block' : 'none');

            var detail = cellGroup.append('text')
                .attr('class', 'cell-text-detail')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight *.15)) // 15% from top of cell
                .attr('dy', 0)
                .style('display', $scope.enableReveal ? 'none' : 'block');

            detail.append('tspan')
                .attr('class', 'cell-title')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight * .15)) // 15% from top of cell
                .attr('dy', 0)
                .style('font-size', cellFontSm * scale + 'em')
                .html(function (d) {
                    return getCellTitle(d);
                })
                .call(wrap);

            detail.append('tspan')
                .attr('class', 'cell-error')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight *.3)) // 30% from top of cell
                .attr('dy', 0)
                .style('font-size', cellFontSm * scale + 'em')
                .text(function (d) {
                    return getCellError(d);
                })
                .call(wrap);

            detail.append('tspan')
                .attr('class', 'cell-total')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight *.4)) // 40% from top of cell
                .attr('dy', 0)
                .style('font-size', cellFontSm * scale + 'em')
                .text(function (d) {
                    return getCellTotal(d);
                })
                .call(wrap);

            detail.append('tspan')
                .attr('class', 'cell-status')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight * .55)) // 55% from top of cell
                .attr('dy', 0)
                .style('font-size', cellFontLg * scale + 'em')
                .text(function (d) {
                    return getCellStatus(d);
                });

            detail.append('tspan')
                .attr('class', 'cell-jobs')
                .attr('text-anchor', 'middle')
                .attr('x', $scope.cellWidth / 2)
                .attr('y', Math.floor($scope.cellHeight * .75)) // 75% from top of cell
                .attr('dy', 0)
                .style('font-size', cellFontSm * scale + 'em')
                .html(function (d) {
                    return getCellJobs(d);
                })
                .call(wrap);

            cellGroup.append('rect')
                .attr('class', 'cell-overlay')
                .attr('width', $scope.cellWidth)
                .attr('height', $scope.cellHeight)
                .style('fill', '#fff')
                .on('mouseover', function () {
                    d3.select(this)
                        .style('fill-opacity', '0.25');
                })
                .on('mouseout', function () {
                    d3.select(this)
                        .style('fill-opacity', '0');
                })
                .on('click', function (d) {
                    cellClickHandler(d);
                })
                .call(drag);

            if ($scope.user && $scope.user.is_admin) {
                cellGroup.append('text')
                    .attr('class', 'cell-pause-resume-icon')
                    .html(function (d) {
                        return getCellPauseResume(d);
                    })
                    .attr('text-anchor', 'start')
                    .attr('x', $scope.enableReveal ? 2 : 5)
                    .attr('y', $scope.enableReveal ? $scope.scale * 8 : 20)
                    .style('display', $scope.enableReveal ? 'none' : 'block')
                    .style('font-size', $scope.enableReveal ? $scope.scale * 7 + 'px' : '1.3em')
                    .on('mouseover', function () {
                        d3.select(this)
                            .style('cursor', 'pointer')
                            .style('fill', scaleConfig.colors.chart_blue);
                    })
                    .on('mouseout', function () {
                        d3.select(this)
                            .style('fill', 'white');
                    })
                    .on('click', function (target) {
                        var pauseResume = function () {
                            var targetData = {};
                            if (target && target.status) {
                                targetData = target;
                                targetData.status.pauseResumeCell($scope.pauseReason).then(function (updatedData) {
                                    if (targetData.toString() === 'Node') {
                                        // update target data values
                                        targetData.is_paused = updatedData.is_paused;
                                        targetData.pause_reason = updatedData.pause_reason;
                                        targetData.status.node = updatedData;
                                        $rootScope.$broadcast('updateNodeHealth');
                                    }
                                    // update grid cell
                                    updateCellFill();
                                    updatePauseResume();
                                    updateCellStatus();
                                });
                            }
                        };

                        // only prompt for reason when pausing (not resuming)
                        if (!target.is_paused) {
                            var modalInstance = $uibModal.open({
                                animation: true,
                                templateUrl: 'pauseDialog.html',
                                scope: $scope
                            });

                            modalInstance.result.then(function () {
                                pauseResume();
                            });
                        } else {
                            pauseResume();
                        }
                    });
            }

            // ENTER + UPDATE
            // Appending to the enter selection expands the update selection to include
            // entering elements; so, operations on the update selection after appending to
            // the enter selection will apply to both entering and updating nodes.
            containerGroup.transition()
                .duration(750)
                .attr('transform', function (d) {
                    return 'translate(' + d.coords + ')';
                });

            var updateCellFill = function () {
                containerGroup.selectAll('.cell')
                    .transition()
                    .duration(250)
                    .style('stroke', function (d) {
                        return d ? '#fff' : 'none';
                    })
                    .style('fill', function (d) {
                        return getCellFill(d);
                    });
            };

            var updatePauseResume = function () {
                containerGroup.selectAll('.cell-pause-resume-icon')
                    .html(function (d) {
                        return getCellPauseResume(d);
                    });
            };

            var updateCellStatus = function () {
                containerGroup.selectAll('.cell-status')
                    .text(function (d) {
                        return getCellStatus(d);
                    });
            };

            // EXIT
            // Remove old elements as needed.
            containerGroup.exit()
                .attr('class', 'cell-exit')
                .transition()
                .duration(750)
                .attr('transform', 'translate(0,0)')
                .remove();

            function wrap (text, width) {
                text.each(function () {
                    var text = d3.select(this),
                        words = text.text().split(/\s+/).reverse(),
                        word,
                        line = [],
                        lineNumber = 0,
                        lineHeight = 1.1,
                        y = text.attr('y'),
                        dy = parseFloat(text.attr('dy')),
                        tspan = text.text(null).append('tspan').attr('x', $scope.cellWidth / 2).attr('y', y).attr('dy', dy + 'em');
                    while (word = words.pop()) {
                        if (word !== 'undefined') {
                            line.push(word);
                            tspan.text(line.join(' '));
                            if (tspan.node().getComputedTextLength() > ($scope.cellWidth - 10)) {
                                line.pop();
                                tspan.text(line.join(' '));
                                line = [word];
                                tspan = text.append('tspan').attr('x', $scope.cellWidth / 2).attr('y', y).attr('dy', ++lineNumber * lineHeight + dy + 'em').text(word);
                            }
                        }
                    }
                });
            }
        };

        $scope.$watch('data', function (data) {
            if (_.keys(data).length > 0) {
                $('.grid-chart').empty();
                initialize(data);
            }
        });

        $scope.$on('redrawGrid', function (event, data) {
            getDataValues(data);
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').directive('aisGridChart', function () {
        return {
            controller: 'aisGridChartController',
            templateUrl: 'modules/charts/grid/gridChartTemplate.html',
            restrict: 'E',
            scope: {
                data: '=',
                icons: '=', // indicates whether cell-text is entirely made up of icons
                scale: '=', // multiplier to increase cell size
                reveal: '=', // if true, less data will show when zoomed out
                mode: '@', // valid values are zoom or tooltip
                columns: '=',
                rows: '=',
                showAxes: '='
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisHealthController', ['$scope', 'gaugeFactory', function ($scope, gaugeFactory) {
        var gauge = null,
            initialized = false;

        var initialize = function () {
            initialized = true;
            var scale = $scope.scale || 1;
            //$scope.gaugeSize = 150 * scale;
            //$scope.gaugeWidth = 25 * scale;
            $scope.donutSize = 275 * scale;
            $scope.donutWidth = 25 * scale;
            //gauge = gaugeFactory.createGauge($scope.type, 'Failure Rate')
        };

        /*var redrawGauge = function () {
            if (gauge) {
                gauge.redraw($scope.data.gaugeData);
            }
        };*/

        $scope.$watch('data', function (data) {
            if (data) {
                if (_.keys(data).length > 0) {
                    if (!initialized) {
                        initialize();
                    }
                    //redrawGauge();
                }
            }
        });
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').directive('aisHealth', function () {
        return {
            controller: 'aisHealthController',
            templateUrl: 'modules/charts/health/healthTemplate.html',
            restrict: 'E',
            scope: {
                name: '=',
                data: '=',
                scale: '=',
                errorLabel: '=',
                type: '='
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisJobLoadController', ['$scope', 'scaleConfig', 'scaleService', 'loadService', function ($scope, scaleConfig, scaleService, loadService) {
        var chart = null,
            colArr = [],
            xArr = [],
            pendingArr = [],
            queuedArr = [],
            runningArr = [],
            removeIds = [],
            legendHide = [];

        $scope.filterValue = 1;
        $scope.filterDuration = 'w';
        $scope.filterDurations = ['M', 'w', 'd'];
        $scope.zoomEnabled = false;
        $scope.zoomClass = 'btn-default';
        $scope.zoomText = 'Enable Zoom';
        $scope.jobLoadData = {};
        $scope.loadingJobLoad = true;
        $scope.jobLoadError = null;
        $scope.jobLoadErrorStatus = null;
        $scope.total = 0;
        $scope.chartStyle = '';

        var jobLoadParams = {
            started: moment.utc().subtract($scope.filterValue, $scope.filterDuration).startOf('d').toDate(), ended: moment.utc().endOf('d').toDate(), job_type_id: null, job_type_name: null, job_type_category: null, url: null
        };

        $scope.toggleZoom = function () {
            $scope.zoomEnabled = !$scope.zoomEnabled;
            chart.zoom.enable($scope.zoomEnabled);
            if ($scope.zoomEnabled) {
                $scope.zoomClass = 'btn-primary';
                $scope.zoomText = 'Disable Zoom';
            } else {
                $scope.zoomClass = 'btn-default';
                $scope.zoomText = 'Enable Zoom';
            }
        };

        var initChart = function () {
            colArr = [];
            xArr = [];
            pendingArr = [];
            queuedArr = [];
            runningArr = [];

            /*
            // x axis values
            var numHours = moment.utc(jobLoadParams.ended).diff(moment.utc(jobLoadParams.started), 'h');
            for (var i = 0; i < numHours; i++) {
                xArr.push(moment.utc(jobLoadParams.started).add(i, 'h').startOf('h').toDate());
            }

            // data values
            _.forEach(xArr, function (xDate) {
                var dataObj = _.find($scope.jobLoadData.results, function (d) {
                    return moment.utc(d.time).startOf('h').isSame(xDate, 'hour');
                });
                // push 0 if data for xDate is not present in queryDates
                pendingArr.push(dataObj ? dataObj.pending_count : 0);
                queuedArr.push(dataObj ? dataObj.queued_count : 0);
                runningArr.push(dataObj ? dataObj.running_count : 0);
            });

            xArr.unshift('x');
            pendingArr.unshift('Pending');
            queuedArr.unshift('Queued');
            runningArr.unshift('Running');
            */

            xArr = _.pluck($scope.jobLoadData.results, 'time');
            _.forEach(xArr, function (d, i) {
                xArr[i] = moment.utc(d).toDate();
            });
            xArr.unshift('x');

            var pendingArr = _.pluck($scope.jobLoadData.results, 'pending_count'),
                queuedArr = _.pluck($scope.jobLoadData.results, 'queued_count'),
                runningArr = _.pluck($scope.jobLoadData.results, 'running_count');

            pendingArr.unshift('Pending');
            queuedArr.unshift('Queued');
            runningArr.unshift('Running');

            // add to colArr
            colArr = [xArr, pendingArr, queuedArr, runningArr];

            var types = {},
                type = {},
                groups = [];

            _.forEach(colArr, function(col){
                    type = {};
                    if (col[0] !== 'x') {
                        type[col[0]] = 'area';
                        groups.push(col[0]);
                    }
                angular.extend(types, type);
            });

            //if (chart) {
                /*
                chart.groups([groups]);
                chart.load({
                    columns: colArr,
                    types: types,
                });
                */
                /*
                chart.flow({
                    columns: colArr
                });
                */
            //} else {
            if (chart) {
                chart.flush();
            }
                // chart config
                chart = c3.generate({
                    bindto: '#job-load',
                    data: {
                        x: 'x',
                        columns: colArr,
                        types: types,
                        groups: [groups],
                        colors: {
                            Pending: scaleConfig.colors.chart_pink,
                            Queued: scaleConfig.colors.chart_purple,
                            Running: scaleConfig.colors.chart_blue
                        }
                    },
                    transition: {
                        duration: 700
                    },
                    tooltip: {
                        format: {
                            title: function (x) {
                                return moment.utc(x).startOf('h').format(scaleConfig.dateFormats.day_second);
                            }
                        }
                    },
                    axis: {
                        x: {
                            type: 'timeseries',
                            tick: {
                                format: function (d) {
                                    return moment.utc(d).format(scaleConfig.dateFormats.day);
                                }
                            }
                        }
                    }
                });
            //}
            $scope.loadingJobLoad = false;
        };

        var getJobLoad = function (showPageLoad) {
            if (showPageLoad) {
                $scope.$parent.loading = true;
            } else {
                $scope.loadingJobLoad = true;
            }
            jobLoadParams.started = moment.utc().subtract($scope.filterValue, $scope.filterDuration).startOf('d').toDate();
            jobLoadParams.ended = moment.utc(jobLoadParams.started).add(1, $scope.filterDuration).endOf('d').toDate();
            jobLoadParams.page_size = 1000;

            loadService.getJobLoad(jobLoadParams).then(null, null, function (result) {
                if (result.$resolved) {
                    $scope.jobLoadData = result;
                    initChart();
                } else {
                    if (result.statusText && result.statusText !== '') {
                        $scope.jobLoadErrorStatus = result.statusText;
                    }
                    $scope.jobLoadError = 'Unable to retrieve job load.';
                }
                if (showPageLoad) {
                    $scope.$parent.loading = false;
                } else {
                    $scope.loadingJobLoad = false;
                }
            });
        };

        $scope.updateJobLoadRange = function (action) {
            if (action === 'older') {
                $scope.filterValue++;
            } else if (action === 'newer') {
                if ($scope.filterValue > 1) {
                    $scope.filterValue--;
                }
            } else if (action === 'today') {
                $scope.filterValue = 1;
            }
            getJobLoad(true);
        };

        $scope.$watch('filterValue', function (value) {
            var $jobLoadNewer = $('.job-load-newer'),
                $jobLoadToday = $('.job-load-today');

            if (value > 1) {
                $jobLoadNewer.removeAttr('disabled');
                $jobLoadToday.removeAttr('disabled');
            } else {
                $jobLoadNewer.attr('disabled', 'disabled');
                $jobLoadToday.attr('disabled', 'disabled');
            }
        });


        if ($scope.autoHeight) {
            // set chart height
            angular.element(document).ready(function () {
                // set container heights equal to available page height
                var viewport = scaleService.getViewportSize(),
                    offset = scaleConfig.headerOffset,
                    headerOffset = $('.job-load-header').height(),
                    legendOffset = $('.job-load-legend-label').height(),
                    filterOffset = $('.job-load-filter').outerHeight(true),
                    chartMaxHeight = viewport.height - offset - headerOffset - legendOffset - filterOffset - 5;

                $scope.chartStyle = 'height: ' + chartMaxHeight + 'px; max-height: ' + chartMaxHeight + 'px;';
                getJobLoad();
            });
        } else {
            getJobLoad();
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').directive('aisJobLoad', function () {
        return {
            controller: 'aisJobLoadController',
            templateUrl: 'modules/charts/jobLoad/jobLoadTemplate.html',
            restrict: 'E',
            scope: {
                showFilter: '=', // show time range filter UI
                cullLegend: '=', // only show job types in legend whose value is > 0
                hideTitle: '=',
                autoHeight: '='
            }
        };
    });
})();

'use strict';

angular.module('scaleApp').controller('aisRadialPercentageController', ['$scope', '$element', 'scaleConfig', function($scope, $element, scaleConfig) {
    var isInitialized = false,
        foreground = '',
        text = '',
        arcTween = '',
        textTween = '';

    var getForeground = function () {
        var value = parseFloat($scope.percentage);
        if (value >= 75) {
            return scaleConfig.colors.chart_green;
        } else if (value < 75 && value >= 50) {
            return scaleConfig.colors.chart_yellow;
        } else {
            return scaleConfig.colors.chart_red;
        }
    };

    var initialize = function() {
        // handle input either .83 or 83
        var percentage = $scope.percentage || 0;
        if (percentage > 1) {
            percentage /= 100;
        }

        // size the chart to the parent container. It's square, so take the
        // smaller of width/height
        var size = $element[0].parentNode.clientWidth;
        if ($element[0].parentNode.clientHeight < size) {
            size = $element[0].parentNode.clientHeight;
        }


        var duration = 1000;
        var formatPercent = d3.format('.0%');

        var arc = d3.svg.arc()
            .startAngle(0)
            .outerRadius(size * 0.95 / 2)
            .innerRadius(size * 0.80 / 2);

        var svg = d3.select($element[0]).append('svg').attr({
            width: size,
            height: size
        }).append('g').attr({
            'transform': 'translate(' + size / 2 + ',' + size / 2 + ')',
            'class': 'aisRadial'
        });

        var meter = svg.append('g').attr({
            'transform': 'rotate(180)'
        });
        meter.append('path')
            .datum({
                endAngle: (2 * Math.PI),
            })
            .attr('class', 'background')
            .attr('d', arc);

        foreground = meter.append('path')
            .datum({
                endAngle: 0
            })
            .attr({
                'd': arc
            })
            .style('fill', function () {
                return getForeground();
            });

        text = svg.append('text')
            .datum({
                percentage: 0
            })
            .attr('text-anchor', 'middle')
            .attr('dy', '.35em');


        textTween = function(transition, newPercentage) {
            transition.attrTween('text', function(d) {
                if (typeof d === 'undefined') {
                    d = 0;
                }
                var i = d3.interpolate(d.percentage, newPercentage);
                return function(t) {
                    d.percentage = i(t);
                    text.text(formatPercent(i(t)));
                    return t;
                }
            });
        };
        arcTween = function(transition, newAngle) {
            transition.attrTween('d', function(d) {
                var i = d3.interpolate(d.endAngle, newAngle);
                return function(t) {
                    d.endAngle = i(t);
                    return arc(d);
                };
            });
        };

        isInitialized = true;

        redraw(percentage);

        // get progress...

        //foreground.attr('d', arc.endAngle((Math.PI * 2) * 0.83));
        //text.text(formatPercent(percentage));
    };

    var redraw = function (value) {
        if (isInitialized) {
            var percentage = value;
            if (percentage > 1) {
                percentage /= 100;
            }
            //console.log('Setting percentage to: ' + percentage);

            //foreground.transition().duration(5000).attr('d', arc);
            foreground.transition().duration(1000)
                .style('fill', function () {
                    return getForeground();
                })
                .call(arcTween, (Math.PI * 2) * percentage);
            //text.text(formatPercent(percentage));
            text.transition().duration(1000).call(textTween, percentage);
        }
    };

    $scope.$watch('percentage', function(value) {
        if (value && !isInitialized) {
            initialize();
        } else {
            redraw(value);
        }
    })
}]);

'use strict';

angular.module('scaleApp').directive('aisRadialPercentage', function () {
    return {
        controller: 'aisRadialPercentageController',
        restrict: 'E',
        scope: {
            percentage: '@'
        }
    };
});

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisTimelineDirectiveController', ['$scope', '$element', 'scaleConfig', function ($scope, $element, scaleConfig) {

        var gantt = null;

        $element[0].onresize = function(){
            console.log('element resize');
        };

        var initialize = function() {
            $scope.$watch('tasks', function (value) {
                drawTimeline();
            });
        };

        var drawTimeline = function(){
            if($scope.tasks && $scope.tasks.length > 0){
                $scope.tasks.sort(function(a, b) {
                    return a[$scope.ended] - b[$scope.ended];
                });

                $scope.taskNames = _($scope.tasks).pluck('taskName').uniq().value();
                var height = $scope.taskNames.length * 30 + 20;

                var width = $element[0].clientWidth;
                if (!width || width === 0) { width = 600; }


                $scope.tasks.sort(function(a, b) {
                    return a[$scope.started] - b[$scope.started];
                });
                var minDate = $scope.tasks[0][$scope.started];
                var maxDate = $scope.tasks[$scope.tasks.length - 1][$scope.ended];
                var daysDiff = moment.utc(maxDate).diff(moment.utc(minDate),'days');
                var format = '%H:%M:%S.%m';
                if(daysDiff > 0){
                    format = "%m/%d/%y %H:%M";
                }

                gantt = d3.gantt().renderTo("#ais-timeline").taskTypes($scope.taskNames).taskStatus(scaleConfig.taskStatusStyles).tickFormat(format).begin($scope.started).ended($scope.ended).height(height).width(width);

                gantt.timeDomainMode("fit");

                gantt($scope.tasks);

            }
        };

        function getend() {
            var lastend = Date.now();
            if ($scope.tasks.length > 0) {
                lastend = $scope.tasks[$scope.tasks.length - 1][$scope.ended];
            }

            return lastend;
        };

        $scope.formatDate = function(date){
            if(date){
                return moment.utc(date).toISOString();
            }
            else {
                return date;
            }
        };
        initialize();

    }]).directive('aisTimeline', function () {
        return {
            controller: 'aisTimelineDirectiveController',
            templateUrl: 'modules/charts/timeline/timelineDirectiveTemplate.html',
            restrict: 'E',
            scope: {
                tasks: '=',
                started: '=',
                ended: '='
            }
        };

    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('adminLoginController', ['$timeout', '$rootScope', '$location', 'userService', function ($timeout, $rootScope, $location, userService) {

        var initialize = function () {
            $rootScope.user = userService.getUserCreds();
            if(!$rootScope.user){
                $rootScope.user = userService.login('admin');
            }

            console.log($rootScope.user);

            $timeout(function(){
                // Any code in here will automatically have an $scope.apply() run afterwards
                $location.path("/");
            });
        };

        initialize();
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('logoutController', ['$timeout', '$rootScope', '$location', 'userService', function ($timeout, $rootScope, $location, userService) {

        var initialize = function () {
            userService.logout();
            $timeout(function(){
                // Any code in here will automatically have an $scope.apply() run afterwards
                $location.path("/");
            });
        };

        initialize();
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('feedDetailsController', ['$scope', '$location', 'scaleConfig', 'navService', 'subnavService', 'feedService', 'moment', function($scope, $location, scaleConfig, navService, subnavService, feedService, moment) {
        $scope.loading = true;
        $scope.feedData = {};
        $scope.subnavLinks = scaleConfig.subnavLinks.feed;
        $scope.useIngestTime = 'false';
        $scope.filterValue = 1;
        $scope.filterDuration = 'w';

        $scope.changeFeedSelection = function(){
            setFeedUrl();
            //getFeed();
        };

        $scope.changeIngestTimeSelection = function(){
            setFeedUrl();
            getFeed();
        };

        var getFeedParams = function(){
            var params = {};
            var strikeId = $scope.selectedFeed ? $scope.selectedFeed.strike.id : null;
            var useIngestTime = $scope.useIngestTime ? $scope.useIngestTime : null;

            params.started = moment.utc().subtract($scope.filterValue, $scope.filterDuration).startOf('d').toISOString();
            params.ended = moment.utc(params.started).add(1, $scope.filterDuration).endOf('d').toISOString();

            if (strikeId != $location.search().strike_id) {
                params.strike_id = strikeId;
            } else if ($location.search().strike_id) {
                params.strike_id = $location.search().strike_id;
            }

            if (useIngestTime != $location.search().use_ingest_time) {
               params.use_ingest_time = useIngestTime;
            } else if ($location.search().use_ingest_time) {
               console.log('getFeedParams use_ingest_time: ' + $location.search().use_ingest_time);
               params.use_ingest_time = $location.search().use_ingest_time;
            }

            return params;
        };

        var getFeed = function () {
            $scope.loading = true;
            if ($location.search().use_ingest_time) {
                $scope.useIngestTime = $location.search().use_ingest_time;
            }
            var feedParams = getFeedParams();
            $location.search(feedParams);
            feedService.getFeed(feedParams).then(function (data) {
                $scope.allFeeds = _.sortByOrder(data.results, ['strike.name'], ['asc']);
                var strikeId = $location.search().strike_id;
                if(strikeId){
                    // set selectedFeed = new feed
                    var feed = _.find($scope.allFeeds, function(feed){
                        return feed.strike.id == strikeId;
                    });
                    $scope.selectedFeed = feed ? feed : null;
                } else {
                    $scope.selectedFeed = $scope.allFeeds[0];
                    setFeedUrl();
                }
            }).finally(function(){
                $scope.loading = false;
            });
        };

        $scope.updateFeedRange = function (action) {
            if (action === 'older') {
                $scope.filterValue++;
            } else if (action === 'newer') {
                if ($scope.filterValue > 1) {
                    $scope.filterValue--;
                }
            } else if (action === 'today') {
                $scope.filterValue = 1;
            }
            getFeed();
        };

        var setFeedUrl = function(){
            // set param in URL
            var params = getFeedParams();
            $location.search(params);
        };

        var initialize = function () {
            navService.updateLocation('feed');
            subnavService.setCurrentPath('feed');
            getFeed();
        };

        initialize();

        $scope.$watch('filterValue', function (value) {
            var $feedNewer = $('.feed-newer'),
                $feedToday = $('.feed-today');

            if (value > 1) {
                $feedNewer.removeAttr('disabled');
                $feedToday.removeAttr('disabled');
            } else {
                $feedNewer.attr('disabled', 'disabled');
                $feedToday.attr('disabled', 'disabled');
            }
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('ingestRecordsController', ['$scope', '$rootScope', '$location', 'scaleConfig', 'scaleService', 'gridFactory', 'navService', 'subnavService', 'feedService', function($scope, $rootScope, $location, scaleConfig, scaleService, gridFactory, navService, subnavService, feedService) {
        $scope.subnavLinks = scaleConfig.subnavLinks.feed;

        var gridParams = {
            page: 1, page_size: 25, started: null, ended: null, order: '-transfer_started', status: null
        };

        // check for gridParams in query string, and update as necessary
        _.forEach(_.pairs(gridParams), function (param) {
            var value = _.at($location.search(), param[0]);
            if (value.length > 0) {
                gridParams[param[0]] = value.length > 1 ? value : value[0];
            }
        });

        var filteredByStatus = gridParams.status ? true : false;
        var filteredByOrder = gridParams.order ? true : false;
        $scope.lastModifiedStart = gridParams.started ? moment.utc(gridParams.started).toDate() : moment.utc().subtract(1, 'weeks').startOf('d').toDate();

        $scope.lastModifiedStartPopup = {
            opened: false
        };
        $scope.openLastModifiedStartPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStartPopup.opened = true;
        };
        $scope.lastModifiedStop = gridParams.ended ? moment.utc(gridParams.ended).toDate() : moment.utc().endOf('d').toDate();
        $scope.lastModifiedStopPopup = {
            opened: false
        };
        $scope.openLastModifiedStopPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStopPopup.opened = true;
        };
        $scope.dateModelOptions = {
            timezone: '+000'
        };

        $scope.statusValues = scaleConfig.ingestStatus;
        $scope.selectedStatus = gridParams.status || $scope.statusValues[0];
        $scope.$watch('selectedStatus', function (value) {
            if ($scope.loading) {
                if (filteredByStatus) {
                    updateStatus(value);
                }
            } else {
                filteredByStatus = value !== 'VIEW ALL';
                updateStatus(value);
            }
        });

        $scope.$watch('lastModifiedStart', function (value) {
            if (!$scope.loading) {
                gridParams.started = value.toISOString();
                $scope.filterResults();
            }
        });

        $scope.$watch('lastModifiedStop', function (value) {
            if (!$scope.loading) {
                console.log(value);
                gridParams.ended = value.toISOString();
                $scope.filterResults();
            }
        });


        var updateStatus = function (value) {
            if (value != gridParams.status) {
                gridParams.page = 1;
            }
            gridParams.status = value === 'VIEW ALL' ? null : value;
            gridParams.page_size = $scope.gridOptions.paginationPageSize;
            if (!$scope.loading) {
                $scope.filterResults();
            }
        };

        var defaultColumnDefs = [
            { field: 'file_name', displayName: 'File Name', enableFiltering: false },
            {
                field: 'file_size',
                displayName: 'File Size',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.file_size_formatted }}</div>'
            },
            {
                field: 'strike.id',
                displayName: 'Strike Process',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.strike.id }}</div>'
            },
            {
                field: 'status',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedStatus"><option ng-selected="{{ grid.appScope.statusValues[$index] == grid.appScope.selectedStatus }}" value="{{ grid.appScope.statusValues[$index] }}" ng-repeat="status in grid.appScope.statusValues track by $index">{{ status.toUpperCase() }}</option></select></div>'
            },
            {
                field: 'transfer_started',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.transfer_started_formatted }}</div>'
            },
            {
                field: 'transfer_ended',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.transfer_ended_formatted }}</div>'
            },
            {
                field: 'ingest_started',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.ingest_started_formatted }}</div>'
            },
            {
                field: 'ingest_ended',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.ingest_ended_formatted }}</div>'
            }
        ];

        $scope.gridOptions = gridFactory.defaultGridOptions();
        $scope.gridOptions.paginationCurrentPage = parseInt(gridParams.page || 1);
        $scope.gridOptions.paginationPageSize = parseInt(gridParams.page_size) || $scope.gridOptions.paginationPageSize;
        $scope.gridOptions.columnDefs = gridFactory.applySortConfig(defaultColumnDefs, gridParams);
        $scope.gridOptions.data = [];
        $scope.gridOptions.onRegisterApi = function (gridApi) {
                //set gridApi on scope
                $scope.gridApi = gridApi;
                // $scope.gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                //     if ($scope.actionClicked) {
                //         $scope.actionClicked = false;
                //     } else {
                //         $scope.$apply(function(){
                //             $location.path('/feed/ingests/' + row.entity.id);
                //         });
                //     }
                //
                // });
                $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                    gridParams.page = currentPage;
                    gridParams.page_size = pageSize;
                    console.log('gridApi.paginationChanged');
                    $scope.filterResults();
                });
                $scope.gridApi.core.on.sortChanged($scope, function (grid, sortColumns) {
                    $rootScope.colDefs = null;
                    _.forEach($scope.gridApi.grid.columns, function (col) {
                        col.colDef.sort = col.sort;
                    });
                    $rootScope.colDefs = $scope.gridApi.grid.options.columnDefs;
                    var sortArr = [];
                    _.forEach(sortColumns, function (col) {
                        sortArr.push(col.sort.direction === 'desc' ? '-' + col.field : col.field);
                    });
                    updateOrder(sortArr);
                });
            };

        $scope.filterResults = function () {
            _.forEach(_.pairs(gridParams), function (param) {
                $location.search(param[0], param[1]);
            });
            getIngests();
        };

        var updateOrder = function (sortArr) {
            gridParams.order = sortArr.length > 0 ? sortArr : null;
            filteredByOrder = sortArr.length > 0;
            $scope.filterResults();
        };

        var getIngests = function () {
            $scope.loading = true;
            feedService.getIngestsOnce(gridParams).then(function (data) {
                $scope.ingests = data.results;
                $scope.gridOptions.totalItems = data.count;
                $scope.gridOptions.data = $scope.ingests;
                $scope.loading = false;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };


        var initialize = function () {
            navService.updateLocation('feed');
            subnavService.setCurrentPath('feed/ingests');
            if (!gridParams.started) {
                console.log('lastModifiedStart: ' + $scope.lastModifiedStart);
                gridParams.started = moment.utc($scope.lastModifiedStart).toISOString();
                $location.search('started', gridParams.started).replace();
            }
            if (!gridParams.ended) {
                gridParams.ended = moment.utc($scope.lastModifiedStop).toISOString();
                $location.search('ended', gridParams.ended).replace();
            }
            getIngests();
        };

        initialize();

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset + scaleConfig.footerOffset + scaleConfig.dateFilterOffset,
                gridMaxHeight = viewport.height - offset;

            $scope.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px; overflow-y: auto;';
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('Feed', ['scaleConfig', function (scaleConfig) {
        var Feed = function (value, status) {
            this.value = value;
            this.status = status;
        };

        // public methods
        Feed.prototype = {
            toString: function () {
                return 'Feed';
            },
            getCellText: function () {
                return this.value;
            },
            getCellTitle: function () {
                return '';
            }
        };

        // static methods, assigned to class
        Feed.build = function (data) {
            if (data) {
                return new Feed(
                    data.value,
                    data.status
                );
            }
            return new Feed();
        };

        Feed.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Feed.build)
                    .filter(Boolean);
            }
            return Feed.build(data);
        };

        return Feed;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('FeedStatus', ['scaleConfig', function (scaleConfig) {
        var FeedStatus = function (status) {
            this.status = status;
        };

        // public methods
        FeedStatus.prototype = {
            toString: function () {
                return 'FeedStatus';
            },
            getCellFill: function () {
                return scaleConfig.colors.chart_green;
            },
            getCellActivity: function () {
                return '';
            },
            getCellActivityTotal: function () {
                return '';
            },
            getCellError: function () {
                return '';
            },
            getCellTotal: function () {
                return '';
            }
        };

        // static methods, assigned to class
        FeedStatus.build = function (data) {
            if (data) {
                return new FeedStatus(
                    data.status
                );
            }
            return new FeedStatus();
        };

        FeedStatus.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(FeedStatus.build)
                    .filter(Boolean);
            }
            return FeedStatus.build(data);
        };

        return FeedStatus;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('Ingest', ['scaleConfig', 'scaleService', function (scaleConfig, scaleService) {
        var Ingest = function (id, file_name, strike, status, bytes_transferred, transfer_started, transfer_ended, media_type, file_size, data_type, ingest_started, ingest_ended, source_file, created, last_modified) {
            this.id = id;
            this.file_name = file_name;
            this.strike = strike;
            this.status = status;
            this.bytes_transferred = bytes_transferred;
            this.transfer_started = transfer_started;
            this.transfer_started_formatted = moment.utc(transfer_started).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.transfer_ended = transfer_ended;
            this.transfer_ended_formatted = moment.utc(transfer_ended).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.media_type = media_type;
            this.file_size = file_size;
            this.file_size_formatted = scaleService.calculateFileSizeFromBytes(file_size);
            this.data_type = data_type;
            this.ingest_started = ingest_started;
            this.ingest_started_formatted = moment.utc(ingest_started).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.ingest_ended = ingest_ended;
            this.ingest_ended_formatted = moment.utc(ingest_ended).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.source_file = source_file;
            this.created = created;
            this.created_formatted = moment.utc(created).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.last_modified = last_modified;
            this.last_modified_formatted = moment.utc(last_modified).format(scaleConfig.dateFormats.day_second_utc_nolabel);
        };

        // public methods
        Ingest.prototype = {
            
        };

        // static methods, assigned to class
        Ingest.build = function (data) {
            if (data) {
                return new Ingest(
                    data.id,
                    data.file_name,
                    data.strike,
                    data.status,
                    data.bytes_transferred,
                    data.transfer_started,
                    data.transfer_ended,
                    data.media_type,
                    data.file_size,
                    data.data_type,
                    data.ingest_started,
                    data.ingest_ended,
                    data.source_file,
                    data.created,
                    data.last_modified
                );
            }
            return new Ingest();
        };

        Ingest.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Ingest.build);
            }
            return Ingest.build(data);
        };

        return Ingest;
    }]);
})();

(function () {
    'use strict';
    angular.module('scaleApp').service('feedService', ['$location', '$timeout', '$q', '$http', 'scaleConfig', 'Ingest', function ($location, $timeout, $q, $http, scaleConfig, Ingest) {

        var getFeedParams = function(params){
            if(!params){ params = {}; }
            var p = {};
            p.page_size = 1000;
            p.started = params.started ? params.started : moment.utc().add(-7,'days').startOf('d').toDate();
            p.ended = params.ended ? params.ended : moment.utc().toDate();
            p.use_ingest_time = params.use_ingest_time ? params.use_ingest_time : null;
            return p;
        };

        var getIngestsParams = function(params){
            return params;
        };

        return {
            getFeed: function(params){
                var d = $q.defer();
                var params = getFeedParams(params);
                $http({
                    url: scaleConfig.urls.apiPrefix + 'ingests/status/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getIngestsOnce: function(params) {
                var d = $q.defer();
                var params = getIngestsParams(params);
                $http({
                    url: scaleConfig.urls.apiPrefix + 'ingests/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = Ingest.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').directive('aisMultiselect', function () {
        return {
            restrict: 'A',
            require: '^ngModel',
            scope: {
                multiselectDataProvider: '=',
                enableFiltering: '=',
                maxHeight: '=',
                numberDisplayed: '=',
                includeSelectAllOption: '=',
                nonSelectedText: '=',
                ngModel: '='
            },
            link: function(scope, element, attributes) {
                element = $(element[0]);

                element.multiselect({
                    enableFiltering: scope.enableFiltering,
                    enableCaseInsensitiveFiltering: true,
                    maxHeight: scope.maxHeight || 300,
                    numberDisplayed: scope.numberDisplayed || 3,
                    includeSelectAllOption: scope.includeSelectAllOption,
                    nonSelectedText: scope.nonSelectedText || 'None Selected',
                    onChange: function (optionElement, checked) {
                        scope.$apply(function () {
                            scope.ngModel = element.val();
                        });
                    }
                });

                scope.$watchCollection('multiselectDataProvider', function (newValue, oldValue) {
                    if (angular.equals(newValue, oldValue)) {
                        return;
                    }
                    element.multiselect('dataprovider', newValue);
                });

                /*
                // Watch for any changes to the length of our select element
                scope.$watch(function () {
                    return element[0];
                }, function (newValue) {
                    debugger;
                    //element.multiselect('setOptions', element[0]);
                    //element.multiselect('rebuild');
                }, true);

                // Watch for any changes from outside the directive and refresh
                scope.$watch(attributes.ngModel, function () {
                    element.multiselect('refresh');
                });
                */
            }
        };
    })
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('gaugeFactory', ['scaleConfig', function (scaleConfig) {
        var Gauge = function (placeholderName, configuration)
        {
            this.placeholderName = placeholderName;

            var self = this; // for internal d3 functions

            this.configure = function(configuration)
            {
                this.config = configuration;

                this.config.size = this.config.size * 0.9;

                this.config.radius = this.config.size * 0.97 / 2;
                this.config.cx = this.config.size / 2;
                this.config.cy = this.config.size / 2;

                this.config.min = undefined != configuration.min ? configuration.min : 0;
                this.config.max = undefined != configuration.max ? configuration.max : 100;
                this.config.range = this.config.max - this.config.min;

                this.config.majorTicks = configuration.majorTicks || 5;
                this.config.minorTicks = configuration.minorTicks || 2;

                this.config.greenColor 	= configuration.greenColor || '#8fca0e';
                this.config.yellowColor = configuration.yellowColor || '#ffc317';
                this.config.redColor 	= configuration.redColor || '#f54d36';

                this.config.transitionDuration = configuration.transitionDuration || 500;
            };

            this.render = function()
            {
                this.body = d3.select('#' + this.placeholderName)
                    .append('svg:svg')
                    .attr('class', 'gauge')
                    .attr('width', this.config.size)
                    .attr('height', this.config.size);

                this.body.append('svg:circle')
                    .attr('class', 'outer-circle')
                    .attr('cx', this.config.cx)
                    .attr('cy', this.config.cy)
                    .attr('r', this.config.radius)
                    .style('fill', '#ccc');
                /*.style('stroke', '#000')
                 .style('stroke-width', '0.5px');*/

                this.body.append('svg:circle')
                    .attr('cx', this.config.cx)
                    .attr('cy', this.config.cy)
                    .attr('r', 0.9 * this.config.radius)
                    .style('fill', '#fff')
                    .style('stroke', '#e0e0e0')
                    .style('stroke-width', '2px');

                for (var greenIdx in this.config.greenZones)
                {
                    this.drawBand(this.config.greenZones[greenIdx].from, this.config.greenZones[greenIdx].to, self.config.greenColor);
                }

                for (var yellowIdx in this.config.yellowZones)
                {
                    this.drawBand(this.config.yellowZones[yellowIdx].from, this.config.yellowZones[yellowIdx].to, self.config.yellowColor);
                }

                for (var redIdx in this.config.redZones)
                {
                    this.drawBand(this.config.redZones[redIdx].from, this.config.redZones[redIdx].to, self.config.redColor);
                }

                var fontSize = 0;

                if (undefined != this.config.label)
                {
                    fontSize = Math.round(this.config.size / 9);
                    this.body.append('svg:text')
                        .attr('x', this.config.cx)
                        .attr('y', this.config.cy / 2 + fontSize / 2)
                        .attr('dy', fontSize / 2)
                        .attr('text-anchor', 'middle')
                        .text(this.config.label)
                        .style('font-size', fontSize + 'px')
                        .style('fill', '#333')
                        .style('stroke-width', '0px');
                }

                fontSize = Math.round(this.config.size / 16);
                var majorDelta = this.config.range / (this.config.majorTicks - 1);
                for (var major = this.config.min; major <= this.config.max; major += majorDelta)
                {
                    var minorDelta = majorDelta / this.config.minorTicks,
                        point1 = 0,
                        point2 = 0;
                    for (var minor = major + minorDelta; minor < Math.min(major + majorDelta, this.config.max); minor += minorDelta)
                    {
                        point1 = this.valueToPoint(minor, 0.75);
                        point2 = this.valueToPoint(minor, 0.85);

                        this.body.append('svg:line')
                            .attr('x1', point1.x)
                            .attr('y1', point1.y)
                            .attr('x2', point2.x)
                            .attr('y2', point2.y)
                            .style('stroke', '#666')
                            .style('stroke-width', '1px');
                    }

                    point1 = this.valueToPoint(major, 0.7);
                    point2 = this.valueToPoint(major, 0.85);

                    this.body.append('svg:line')
                        .attr('x1', point1.x)
                        .attr('y1', point1.y)
                        .attr('x2', point2.x)
                        .attr('y2', point2.y)
                        .style('stroke', '#333')
                        .style('stroke-width', '2px');

                    if (major == this.config.min || major == this.config.max)
                    {
                        var point = this.valueToPoint(major, 0.63);

                        this.body.append('svg:text')
                            .attr('x', point.x)
                            .attr('y', point.y)
                            .attr('dy', fontSize / 3)
                            .attr('text-anchor', major == this.config.min ? 'start' : 'end')
                            .text(major)
                            .style('font-size', fontSize + 'px')
                            .style('fill', '#333')
                            .style('stroke-width', '0px');
                    }
                }

                var pointerContainer = this.body.append('svg:g').attr('class', 'pointerContainer');

                var midValue = (this.config.min + this.config.max) / 2;

                var pointerPath = this.buildPointerPath(midValue);

                var pointerLine = d3.svg.line()
                    .x(function(d) { return d.x })
                    .y(function(d) { return d.y })
                    .interpolate('basis');

                pointerContainer.selectAll('path')
                    .data([pointerPath])
                    .enter()
                    .append('svg:path')
                    .attr('d', pointerLine)
                    .style('fill', '#888');

                pointerContainer.append('svg:circle')
                    .attr('cx', this.config.cx)
                    .attr('cy', this.config.cy)
                    .attr('r', 0.07 * this.config.radius)
                    .style('fill', '#888');

                fontSize = Math.round(this.config.size / 10);
                pointerContainer.selectAll('text')
                    .data([midValue])
                    .enter()
                    .append('svg:text')
                    .attr('x', this.config.cx)
                    .attr('y', this.config.size - this.config.cy / 4 - fontSize)
                    .attr('dy', fontSize / 2)
                    .attr('text-anchor', 'middle')
                    .style('font-size', fontSize + 'px')
                    .style('fill', '#000')
                    .style('stroke-width', '0px');

                this.redraw(this.config.min, 0);
            };

            this.buildPointerPath = function(value)
            {
                var delta = this.config.range / 13;

                var head = valueToPoint(value, 0.85);
                var head1 = valueToPoint(value - delta, 0.12);
                var head2 = valueToPoint(value + delta, 0.12);

                var tailValue = value - (this.config.range * (1/(270/360)) / 2);
                var tail = valueToPoint(tailValue, 0.28);
                var tail1 = valueToPoint(tailValue - delta, 0.12);
                var tail2 = valueToPoint(tailValue + delta, 0.12);

                return [head, head1, tail2, tail, tail1, head2, head];

                function valueToPoint(value, factor)
                {
                    var point = self.valueToPoint(value, factor);
                    point.x -= self.config.cx;
                    point.y -= self.config.cy;
                    return point;
                }
            };

            this.drawBand = function(start, end, color)
            {
                if (0 >= end - start) return;

                this.body.append('svg:path')
                    .style('fill', color)
                    .attr('d', d3.svg.arc()
                        .startAngle(this.valueToRadians(start))
                        .endAngle(this.valueToRadians(end))
                        .innerRadius(0.65 * this.config.radius)
                        .outerRadius(0.85 * this.config.radius))
                    .attr('transform', function() { return 'translate(' + self.config.cx + ', ' + self.config.cy + ') rotate(270)' });
            };

            this.redraw = function(value, transitionDuration)
            {
                var pointerContainer = this.body.select('.pointerContainer');

                pointerContainer.selectAll('text').text(parseFloat(value).toFixed(2) + '%');

                var pointer = pointerContainer.selectAll('path');
                pointer.transition()
                    .duration(undefined != transitionDuration ? transitionDuration : this.config.transitionDuration)
                    //.delay(0)
                    //.ease('linear')
                    //.attr('transform', function(d)
                    .attrTween('transform', function()
                    {
                        var pointerValue = value;
                        if (value > self.config.max) pointerValue = self.config.max + 0.02*self.config.range;
                        else if (value < self.config.min) pointerValue = self.config.min - 0.02*self.config.range;
                        var targetRotation = (self.valueToDegrees(pointerValue) - 90);
                        var currentRotation = self._currentRotation || targetRotation;
                        self._currentRotation = targetRotation;

                        return function(step)
                        {
                            var rotation = currentRotation + (targetRotation-currentRotation)*step;
                            return 'translate(' + self.config.cx + ', ' + self.config.cy + ') rotate(' + rotation + ')';
                        }
                    });

                var outerCircle = this.body.select('.outer-circle')
                    .transition()
                    .duration(750)
                    .style('fill', function () {
                        var i = parseInt(value);
                        if (i >= 0 && i < 75) {
                            return self.config.greenColor;
                        } else if (i >= 75 && i < 90) {
                            return self.config.yellowColor;
                        } else {
                            return self.config.redColor;
                        }
                    });
            };

            this.valueToDegrees = function(value)
            {
                // thanks @closealert
                //return value / this.config.range * 270 - 45;
                return value / this.config.range * 270 - (this.config.min / this.config.range * 270 + 45);
            };

            this.valueToRadians = function(value)
            {
                return this.valueToDegrees(value) * Math.PI / 180;
            };

            this.valueToPoint = function(value, factor)
            {
                return { 	x: this.config.cx - this.config.radius * factor * Math.cos(this.valueToRadians(value)),
                    y: this.config.cy - this.config.radius * factor * Math.sin(this.valueToRadians(value)) 		};
            };

            // initialization
            this.configure(configuration);
        };

        return {
            createGauge: function (name, label, min, max, size) {
                var config = {
                    size: size || scaleConfig.defaultGaugeWidth,
                    label: label,
                    min: min || 0,
                    max: max || 100,
                    minorTicks: 5
                };

                var range = config.max - config.min;
                config.yellowZones = [{ from: config.min + range*0.75, to: config.min + range*0.9 }];
                config.redZones = [{ from: config.min + range*0.9, to: config.max }];

                var gauge = new Gauge(name + 'GaugeContainer', config);
                gauge.render();
                return gauge;
            }
        }
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('gridFactory', ['uiGridConstants', function (uiGridConstants) {

        var getSortConfig = function(orderParam){
            if(orderParam){
                var sortField = orderParam
                var sortDirection = 'asc';
                if(_.startsWith(orderParam, '-')){
                    sortDirection = 'desc';
                    sortField = sortField[0].length === 1 ? sortField.substring(1) : sortField[0].substring(1);
                }
                return {
                    direction: sortDirection,
                    field: sortField
                };
            }
            return {};
        };

        return {
            defaultGridOptions: function () {
                return {
                    enableRowSelection: true,
                    enableRowHeaderSelection: false,
                    enableHorizontalScrollbar: uiGridConstants.scrollbars.NEVER,
                    multiSelect: false,
                    enableFiltering: true,
                    useExternalSorting: true,
                    useExternalFiltering: true,
                    enableSorting: true,
                    minRowsToShow: 17,
                    paginationPageSizes: [25, 50, 75, 100],
                    paginationPageSize: 25,
                    useExternalPagination: true
                }
            },
            applySortConfig: function(columnDefs, gridParams){
                var sortConfig = getSortConfig(gridParams.order);
                if(sortConfig.field){
                    var colDef = _.find(columnDefs, {field: sortConfig.field});
                    if(colDef){
                        colDef.sort = {
                            direction: sortConfig.direction,
                            priority: 1
                        }
                    }
                }
                return columnDefs;
            }
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('pollerFactory', ['poller', function (poller) {
        return {
            newPoller: function (resource, interval) {
                return poller.get(resource, {
                    delay: interval,
                    catchError: true
                });
            }
        }
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('Status', ['StatusMaster', 'StatusScheduler', 'StatusResources', function (StatusMaster, StatusScheduler, StatusResources) {
        var Status = function ($resolved, master, scheduler, queue_depth, resources) {
            this.$resolved = $resolved;
            this.master = StatusMaster.transformer(master);
            this.scheduler = StatusScheduler.transformer(scheduler);
            this.queue_depth = queue_depth;
            this.resources = StatusResources.transformer(resources);
        };

        // public methods
        Status.prototype = {
            getCpuUsage: function () {
                if (this.resources.scheduled.cpus && this.resources.total.cpus) {
                    if (this.resources.total.cpus > 0) {
                        return ((this.resources.scheduled.cpus / this.resources.total.cpus) * 100).toFixed(2);
                    }
                }
                return 0.00;
            },
            getMemUsage: function () {
                if (this.resources.scheduled.mem && this.resources.total.mem) {
                    if (this.resources.total.mem > 0) {
                        return ((this.resources.scheduled.mem / this.resources.total.mem) * 100).toFixed(2);
                    }
                }
                return 0.00;
            },
            getDiskUsage: function () {
                if (this.resources.scheduled.disk && this.resources.total.disk) {
                    if (this.resources.total.disk > 0) {
                        return ((this.resources.scheduled.disk / this.resources.total.disk) * 100).toFixed(2);
                    }
                }
                return 0.00;
            }
        };

        // static methods, assigned to class
        Status.build = function (data) {
            if (data) {
                return new Status(
                    data.$resolved,
                    data.master,
                    data.scheduler,
                    data.queue_depth,
                    data.resources
                );
            }
            return new Status();
        };

        Status.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Status.build)
                    .filter(Boolean);
            }
            return Status.build(data);
        };

        return Status;
    }]);
})();
(function () {
    'use strict';
    
    angular.module('scaleApp').factory('StatusMaster', function () {
        var StatusMaster = function (is_online, hostname, port) {
            this.is_online = is_online;
            this.hostname = hostname;
            this.port = port;
        };

        // public methods
        StatusMaster.prototype = {

        };

        // static methods, assigned to class
        StatusMaster.build = function (data) {
            if (data) {
                return new StatusMaster(
                    data.is_online,
                    data.hostname,
                    data.port
                );
            }
            return new StatusMaster();
        };

        StatusMaster.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(StatusMaster.build)
                    .filter(Boolean);
            }
            return StatusMaster.build(data);
        };

        return StatusMaster;
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('StatusResource', function () {
        var StatusResource = function (cpus, mem, disk) {
            this.cpus = cpus;
            this.mem = mem;
            this.disk = disk;
        };

        // public methods
        StatusResource.prototype = {

        };

        // static methods, assigned to class
        StatusResource.build = function (data) {
            if (data) {
                return new StatusResource(
                    data.cpus,
                    data.mem,
                    data.disk
                );
            }
            return new StatusResource();
        };

        StatusResource.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(StatusResource.build)
                    .filter(Boolean);
            }
            return StatusResource.build(data);
        };

        return StatusResource;
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('StatusResources', ['StatusResource', function (StatusResource) {
        var StatusResources = function (total, scheduled, used) {
            this.total = StatusResource.transformer(total);
            this.scheduled = StatusResource.transformer(scheduled);
            this.used = StatusResource.transformer(used);
        };

        // public methods
        StatusResources.prototype = {

        };

        // static methods, assigned to class
        StatusResources.build = function (data) {
            if (data) {
                return new StatusResources(
                    data.total,
                    data.scheduled,
                    data.used
                );
            }
            return new StatusResources();
        };

        StatusResources.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(StatusResources.build)
                    .filter(Boolean);
            }
            return StatusResources.build(data);
        };

        return StatusResources;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('StatusScheduler', function () {
        var StatusScheduler = function (is_online, is_paused, hostname) {
            this.is_online = is_online;
            this.is_paused = is_paused;
            this.hostname = hostname;
        };

        // public methods
        StatusScheduler.prototype = {

        };

        // static methods, assigned to class
        StatusScheduler.build = function (data) {
            if (data) {
                return new StatusScheduler(
                    data.is_online,
                    data.is_paused,
                    data.hostname
                );
            }
            return new StatusScheduler();
        };

        StatusScheduler.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(StatusScheduler.build)
                    .filter(Boolean);
            }
            return StatusScheduler.build(data);
        };

        return StatusScheduler;
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').service('scaleService', ['$q', '$http', 'scaleConfig', function ($q, $http, scaleConfig) {
        function padWithZero (input, length) {
            // Cast input to string
            input = '' + input;

            var paddingSize = Math.max(0, length - input.length);
            return new Array(paddingSize > 0 ? paddingSize + 1 : 0).join('0') + input;
        }

        return {
            calculateFileSizeFromMib: function(num){
                if (num > 0) {
                    if (num < 1024) {
                        return num.toFixed(2) + ' MB';
                    }
                    if (num >= 1024 && num < 1024*1024) {
                        return (num/1024).toFixed(2) + ' GB';
                    }
                    return (num/1024/1024).toFixed(2) + ' TB';
                }
                return num;
            },
            calculateFileSizeFromBytes: function(num,decimals){
                // if(precision){
                //     // round num to specified precision
                //     num = Math.round(num/precision);
                // }
                if (num > 0) {
                    if (num < 1024) {
                        return num.toFixed(decimals) + ' Bytes';
                    }
                    if (num >= 1024 && num < 1024*1024) {
                        return (num/1024).toFixed(decimals) + ' KB';
                    }
                    if (num >= 1024*1024 && num < 1024*1024*1024) {
                        return (num/1024/1024).toFixed(decimals) + ' MB';
                    }
                    if (num >= 1024*1024*1024 && num < 1024*1024*1024*1024) {
                        return (num/1024/1024/1024).toFixed(decimals) + ' GB';
                    }
                    return (num/1024/1024/1024/1024).toFixed(decimals) + ' TB';
                }
                return num;
            },
            getViewportSize: function () {
                var w = window,
                    d = document,
                    e = d.documentElement,
                    g = document.body,
                    x = w.innerWidth || e.clientWidth || g.clientWidth,
                    y = w.innerHeight || e.clientHeight || g.clientHeight;

                return {
                    width: x,
                    height: y
                };
            },
            calculateDuration: function (start, stop) {
                var to = moment.utc(stop),
                    from = moment.utc(start),
                    diff = moment.utc(to).diff(moment.utc(from)),
                    durationStr = '';

                var duration = moment.duration(diff);

                durationStr = duration.days() > 0 ? durationStr + padWithZero(duration.days(), 2) + 'd, ' : durationStr;
                durationStr = duration.hours() > 0 ? durationStr + padWithZero(duration.hours(), 2) + 'h, ' : durationStr;
                durationStr = duration.minutes() > 0 ? durationStr + padWithZero(duration.minutes(), 2) + 'm, ' : durationStr;
                durationStr = durationStr + padWithZero(duration.seconds(), 2) + 's';
                
                return durationStr;
            },
            getDayString: function(dayNumber){
                var dayArr = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
                return dayArr[dayNumber];
            },
            isIE: function () {
                var ua = window.navigator.userAgent,
                    oldIE = ua.indexOf('MSIE'),
                    newIE = ua.indexOf('Trident/');

                if ((oldIE > -1) || (newIE > -1)) {
                    return true;
                }
                return false;
            },
            getVersion: function () {
                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'v' + scaleConfig.majorVersion + '/version/',
                    method: 'GET'
                }).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            }
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('schedulerService', ['$http', '$q', 'scaleConfig', function ($http, $q, scaleConfig) {
        var getUpdateSchedulerData = function (is_paused) {
            return {
                is_paused: is_paused
            };
        };

        return {
            updateScheduler: function (data) {
                data = data || getUpdateSchedulerData();
                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'scheduler/',
                    method: 'PATCH',
                    data: data
                }).success(function (result) {
                    d.resolve(result);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            }
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('stateService', function () {
        var version = '';

        return {
            getVersion: function () {
                return version;
            },
            setVersion: function (v) {
                version = v;
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('statusService', ['$resource', 'scaleConfig', 'poller', 'pollerFactory', 'Status', function ($resource, scaleConfig, poller, pollerFactory, Status) {
        return {
            getStatus: function () {
                var statusResource = $resource(scaleConfig.urls.apiPrefix + 'status/'),
                    statusPoller = pollerFactory.newPoller(statusResource, scaleConfig.pollIntervals.status);

                return statusPoller.promise.then(null, null, function (result) {
                    if (result.$resolved) {
                        result = Status.transformer(result);
                        //result = angular.extend(result, returnResult);
                    } else {
                        statusPoller.stop();
                    }
                    return result;
                });
            }
        }
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').service('userService', ['$rootScope', function ($rootScope) {
        return {
            getUserCreds: function(){
                var creds = localStorage.getItem('userCreds');
                try {
                    return JSON.parse(creds);
                } catch (e) {
                    console.log('Error parsing user credentials');
                    return creds;
                }
            },
            setUserCreds: function(user){
                if (user !== null) {
                    localStorage.setItem('userCreds', JSON.stringify(user));
                } else {
                    $rootScope.user = null;
                    localStorage.removeItem('userCreds');
                }

            },
            login: function (username) {
                var user = {
                    username: username,
                    is_admin: true
                };
                this.setUserCreds(user);
                return user;
            },
            logout: function() {
                this.setUserCreds(null);
            }
        }
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('jobDetailController', ['$scope', '$rootScope', '$location', '$routeParams', '$uibModal', 'navService', 'jobService', 'jobExecutionService', 'nodeService', 'loadService', 'scaleConfig', 'subnavService', 'userService', 'scaleService', 'toastr', function ($scope, $rootScope, $location, $routeParams, $uibModal, navService, jobService, jobExecutionService, nodeService, loadService, scaleConfig, subnavService, userService, scaleService, toastr) {
        $scope.job = {};
        $scope.jobId = $routeParams.id;
        $scope.subnavLinks = scaleConfig.subnavLinks.jobs;
        subnavService.setCurrentPath('jobs');
        $scope.loadingJobDetail = false;
        $scope.latestExecution = null;
        $scope.executionLog = null;
        $scope.executionDetails = null;
        $scope.selectedExectuionDetailValues = null;
        $scope.timeline = [];
        $scope.readonly = true;
        $scope.jobErrorCreated = '';
        $scope.jobErrorLastModified = '';
        $scope.lastStatusChange = '';
        $scope.triggerOccurred = '';

        $scope.showLog = function (execution) {
            $scope.selectedExecutionLog = execution;
            var modalInstance = $uibModal.open({
                animation: true,
                templateUrl: 'showLog.html',
                scope: $scope,
                //size: 'lg',
                windowClass: 'log-modal-window'
            });
        };

        $scope.showExecutionDetails = function (executionId) {
            jobExecutionService.getJobExecutionDetails(executionId).then(function (data) {
                $scope.selectedExecutionDetails = data;
                $scope.selectedExecutionDetailValues = _.pairs(data);
                var modalInstance = $uibModal.open({
                    animation: true,
                    templateUrl: 'showExecutionDetails.html',
                    scope: $scope,
                    size: 'lg'
                });
            });
        };

        $scope.mediaTypeClass = function (mediaType) {
            var mediaTypeCfg = _.find(scaleConfig.mediaTypes, 'mimeType', mediaType);
            if (mediaTypeCfg) {
                return mediaTypeCfg.icon;
            } else {
                return null;
            }
        };

        $scope.requeueJob = function (jobId) {
            $scope.loading = true;
            loadService.requeueJobs({ job_ids: [jobId] }).then(function (data) {
                toastr['success']('Requeued Job');
                $scope.job.status = data.job_status;
                getJobDetail(jobId);
            }).catch(function (error) {
                toastr['error']('Requeue request failed');
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        $scope.cancelJob = function (job) {
            $scope.loading = true;
            $scope.actionClicked = true;
            $scope.loading = true;
            var originalStatus = job.status;
            job.status = 'CANCEL';
            jobService.updateJob(job.id, { status: 'CANCELED' }).then(function (data) {
                toastr['success']('Job Canceled');
                job.status = 'CANCELED';
            }).catch(function (error) {
                toastr['error'](error);
                console.log(error);
                job.status = originalStatus;
            }).finally(function () {
                $scope.loading = false;
            });
        };
        
        $scope.calculateFileSize = function (size) {
            return scaleService.calculateFileSizeFromBytes(size);
        };

        var getJobDetail = function (jobId) {
            $scope.loadingJobDetail = true;
            jobService.getJobDetail(jobId).then(function (data) {
                $scope.job = data;
                $scope.timeline = calculateTimeline(data);
                // $scope.publishedProducts = _.where(data.products, { 'is_published': true });
                // $scope.unpublishedProducts = _.where(data.products, { 'is_published': false });
                // $scope.publishedProductsGrouped = _.pairs(_.groupBy($scope.publishedProducts, 'job_exe.id'));
                $scope.latestExecution = data.getLatestExecution();
                $scope.jobErrorCreated = data.error ? moment.utc(data.error.created).toISOString() : '';
                $scope.lastStatusChange = data.last_status_change ? moment.duration(moment.utc(data.last_status_change).diff(moment.utc())).humanize(true) : '';
                $scope.triggerOccurred = data.event.occurred ? moment.duration(moment.utc(data.event.occurred).diff(moment.utc())).humanize(true) : '';
                $scope.inputs = data.inputs;
                $scope.outputs = data.outputs;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loadingJobDetail = false;
            });
        };

        var calculateTimeline = function (job) {
            var tl = [];
            tl.push({ taskName: 'Created', started: job.created ? moment.utc(job.created).toDate() : job.created, ended: job.queued ? moment.utc(job.queued).toDate() : job.queued });
            tl.push({ taskName: 'Queued', started: job.queued ? moment.utc(job.queued).toDate() : job.queued, ended: job.started ? moment.utc(job.started).toDate() : job.started });
            tl.push({ taskName: 'Executed', started: job.started ? moment.utc(job.started).toDate() : job.started, ended: job.ended ? moment.utc(job.ended).toDate() : job.ended });

            return tl;
        };

        var initialize = function () {
            navService.updateLocation('jobs');

            $rootScope.user = userService.getUserCreds();
            if($rootScope.user){
                $scope.readonly = false;
            }

            getJobDetail($scope.jobId);
        };

        initialize();
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('jobExecutionDetailController', ['$scope', '$location', '$routeParams', 'navService', 'jobExecutionService', 'nodeService', 'scaleConfig', 'subnavService', function ($scope, $location, $routeParams, navService, jobExecutionService, nodeService, scaleConfig, subnavService) {
        $scope.jobExecution = {};
        $scope.jobExecutionId = $routeParams.id;
        $scope.loading = true;
        $scope.subnavLinks = scaleConfig.subnavLinks.jobs;
        subnavService.setCurrentPath('jobs/runs');

        var getJobExecutionDetail = function (jobExecutionId) {
            jobExecutionService.getJobExecutionDetail(id).then(function (data) {
                $scope.jobExecution = data;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var initialize = function () {
            getJobExecutionDetail($routeParams.id);
            navService.updateLocation('jobs');
        };

        initialize();
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('jobExecutionsController', ['$scope', '$location', 'navService', 'statsService', 'jobExecutionService', 'jobTypeService', 'uiGridConstants', 'scaleConfig', 'subnavService', function($scope, $location, navService, statsService, jobExecutionService, jobTypeService, uiGridConstants, scaleConfig, subnavService) {

        $scope.jobExecutions = [];
        $scope.loading = true;
        $scope.jobTypeValues = [];
        $scope.selectedJobType = '';
        $scope.jobStatus = scaleConfig.jobStatus;
        $scope.selectedJobStatus = '';
        $scope.subnavLinks = scaleConfig.subnavLinks.jobs;
        subnavService.setCurrentPath('jobs/executions');

        var gridFilter = {},
            gridPageNumber = 1;

        $scope.gridOptions = {
            enableRowSelection: true,
            enableRowHeaderSelection: false,
            enableHorizontalScrollbar: uiGridConstants.scrollbars.NEVER,
            multiSelect: false,
            enableFiltering: true,
            useExternalFiltering: true,
            enableSorting: true,
            minRowsToShow: 17,
            paginationPageSizes: [25,50,75],
            paginationPageSize: 25,
            useExternalPagination: true,
            columnDefs: [
                {
                    field: 'jobTypeId',
                    displayName: 'Job Type',
                    cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.getIcon()"></span> {{ row.entity.job.jobType.title }}</div>',
                    filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedJobType"><option value="{{ grid.appScope.jobTypeValues[$index].id }}" ng-repeat="jobType in grid.appScope.jobTypeValues track by $index">{{ grid.appScope.jobTypeValues[$index].name }} {{ grid.appScope.jobTypeValues[$index].version }}</option></select>'
                },
                { field: 'created', enableFiltering: false, cellFilter: 'date:\'yyyy-MM-dd HH:mm:ss\'' },
                { field: 'lastModified', enableFiltering: false, cellFilter: 'date:\'yyyy-MM-dd HH:mm:ss\'' },
                {
                    field: 'status',
                    filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedJobStatus"><option ng-repeat="status in grid.appScope.jobStatus track by $index">{{ status.toUpperCase() }}</option></select>'
                },
                { field: 'id', displayName: 'ID', enableFiltering: false }
            ],
            data: [],
            onRegisterApi: function (gridApi) {
                //set gridApi on scope
                $scope.gridApi = gridApi;
                $scope.gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                    $scope.$apply(function () {
                        //$location.path('/jobexecutions/' + row.entity.id);
                        console.log(row);
                    });
                });
                $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                    $scope.getPage(currentPage, pageSize);
                });
            }
        };

        $scope.$watch('selectedJobType', function (value) {
            if (!$scope.loading) {
                gridFilter.jobTypeId = value;
                $scope.getPage(gridPageNumber, $scope.gridOptions.paginationPageSize, gridFilter);
            }
        });

        $scope.$watch('selectedJobStatus', function (value) {
            if (!$scope.loading) {
                gridFilter.jobStatus = value;
                $scope.getPage(gridPageNumber, $scope.gridOptions.paginationPageSize, gridFilter);
            }
        });

        $scope.getPage = function (pageNumber, pageSize) {
            $scope.loading = true;
            gridPageNumber = pageNumber;
            jobExecutionService.getJobExecutions(pageNumber, pageSize, gridFilter).then(function (data) {
                var newData = [];
                for (var i = 0; i < $scope.gridOptions.paginationPageSize; i++) {
                    if (data.executions[i]) {
                        newData.push(data.executions[i]);
                    }
                }
                $scope.gridOptions.data = newData;
                $scope.gridOptions.totalItems = data.count;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var getJobExecutions = function () {
            jobExecutionService.getJobExecutions(gridPageNumber, $scope.gridOptions.paginationPageSize, gridFilter).then(function (data) {
                window.localStorage['scale-jobexecutions-time'] = moment.utc().toISOString();
                window.localStorage['scale-jobexecutions'] = JSON.stringify(data);
                $scope.gridOptions.totalItems = data.count;
                $scope.gridOptions.data = data.executions;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                getJobTypes();
            });
        };

        var getJobTypes = function () {
            jobTypeService.getJobTypesOnce().then(function (data) {
                $scope.jobTypeValues = data.results;
                $scope.jobTypeValues.unshift({ name: '', version: '', id: null });
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var initialize = function() {
            getJobExecutions();
            navService.updateLocation('jobs');
        };
        initialize();
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('jobTypesController', ['$rootScope', '$scope', '$routeParams', '$location', 'hotkeys', 'scaleService', 'navService', 'jobTypeService', 'scaleConfig', 'subnavService', 'nodeService', 'localStorage', 'userService', function ($rootScope, $scope, $routeParams, $location, hotkeys, scaleService, navService, jobTypeService, scaleConfig, subnavService, nodeService, localStorage, userService) {
        $scope.containerStyle = '';
        $scope.requestedJobTypeId = parseInt($routeParams.id);
        $scope.jobTypes = [];
        $scope.jobTypeIds = [];
        $scope.jobTypeCount = 0;
        $scope.activeJobTypeDetails = {};
        $scope.activeJobTypeInterfaceValues = [];
        $scope.activeJobTypeErrors = [];
        $scope.activeJobTypeStats = {};
        $scope.showJobTypeErrors = false;
        $scope.loading = true;
        $scope.activeJobType = null;
        $scope.healthData6 = {};
        $scope.healthData12 = {};
        $scope.healthData24 = {};
        $scope.activityIcon = '<i class="fa fa-pulse">&#x' + scaleConfig.activityIconCode + '</i>';
        $scope.jobDetailsClass = 'hidden';
        $scope.pauseBtnClass = 'fa-pause';
        $scope.user = userService.getUserCreds();
        $scope.subnavLinks = scaleConfig.subnavLinks.jobs;
        subnavService.setCurrentPath('jobs/types');

        var jobTypeStats = {};

        $scope.viewDetails = function (id) {
            $scope.activeJobType = _.find($scope.jobTypes, 'id', id);
            $scope.activeJobType.created = formatDateTime($scope.activeJobType.created);
            $scope.activeJobType.lastModified = formatDateTime($scope.activeJobType.lastModified);

            $location.path('jobs/types/' + id);

            getJobTypeDetails($scope.activeJobType.id);

            //formatJobTypeStats();

            $scope.jobDetailsClass = 'visible';
        };

        $scope.togglePause = function () {
            $scope.activeJobType.is_paused = !$scope.activeJobType.is_paused;
            $scope.activeJobTypeDetails.is_paused = $scope.activeJobType.is_paused;
            $scope.loading = true;
            jobTypeService.updateJobType($scope.activeJobTypeDetails).then(function(data){
                $scope.activeJobTypeDetails = data;
                $scope.pauseBtnClass = $scope.getPauseButtonClass($scope.activeJobTypeDetails.is_paused);
                $scope.loading = false;
            }).catch(function (error) {
                console.log(error);
                toastr['error'](error);
                $scope.loading = false;
            });
        };

        $scope.getPauseButtonClass = function(is_paused){
            return is_paused ? 'fa-play' : 'fa-pause';
        }

        $scope.getJobTypeListItemClass = function(jobType){
            return jobType.is_paused ? 'paused' : '';
        }

        var formatDateTime = function (dt) {
            return moment.utc(dt).toISOString();
        };

        var getJobTypes = function () {
            jobTypeService.getJobTypesOnce().then(function (data) {
                $scope.jobTypes = data.results;
                $scope.jobTypeIds = _.pluck(data.results, 'id');
                $scope.jobTypeCount = data.count;
                if ($scope.requestedJobTypeId) {
                    $scope.viewDetails($scope.requestedJobTypeId);
                } else {
                    $scope.loading = false;
                }
                hotkeys.bindTo($scope)
                    .add({
                        combo: 'ctrl+up',
                        description: 'Previous Job Type',
                        callback: function () {
                            if ($scope.activeJobType) {
                                var idx = _.indexOf($scope.jobTypeIds, $scope.activeJobType.id);
                                if (idx > 0) {
                                    $scope.viewDetails($scope.jobTypeIds[idx - 1]);
                                }
                            }
                        }
                    }).add({
                        combo: 'ctrl+down',
                        description: 'Next Job Type',
                        callback: function () {
                            if ($scope.activeJobType) {
                                var idx = _.indexOf($scope.jobTypeIds, $scope.activeJobType.id);
                                if (idx < ($scope.jobTypeIds.length - 1)) {
                                    $scope.viewDetails($scope.jobTypeIds[idx + 1]);
                                }
                            }
                        }
                    });
            }).catch(function (error) {
                console.log(error);
                $scope.loading = false;
            });
        };

        var getJobTypeDetails = function (id) {
            $scope.loading = true;
            jobTypeService.getJobTypeDetails(id).then(function (data) {
                $scope.activeJobTypeDetails = data;
                $scope.activeJobTypeInterfaceValues = _.pairs(data.job_type_interface);
                $scope.pauseBtnClass = $scope.getPauseButtonClass($scope.activeJobTypeDetails.is_paused);
                // format error mapping
                $scope.activeJobTypeErrors = [];
                $scope.showJobTypeErrors = _.keys(data.error_mapping.exit_codes).length > 0;
                if ($scope.showJobTypeErrors) {
                    _.forEach(data.error_mapping.exit_codes, function (error_name) {
                        var error = _.find(data.errors, 'name', error_name),
                            exitCode = _.invert(data.error_mapping.exit_codes)[error_name];
                        $scope.activeJobTypeErrors.push({code: exitCode, data: error});
                    });
                }

                // format job type stats
                var performance = data.getPerformance(),
                    failures = data.getFailures();

                $scope.activeJobTypeStats = performance;

                $scope.healthData6 = {
                    gaugeData: performance.hour6.rate,
                    donutData: failures.hour6
                };
                $scope.healthData12 = {
                    gaugeData: performance.hour12.rate,
                    donutData: failures.hour12
                };
                $scope.healthData24 = {
                    gaugeData: performance.hour24.rate,
                    donutData: failures.hour24
                };
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var initialize = function () {
            getJobTypes();
            navService.updateLocation('jobs');
        };

        initialize();

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                containerMaxHeight = viewport.height - offset;

            $scope.containerStyle = 'height: ' + containerMaxHeight + 'px; max-height: ' + containerMaxHeight + 'px;';
        });
    }]);
})();

(function () {
    'use strict';
    
    angular.module('scaleApp').controller('jobTypesFailureRatesController', ['$scope', '$location', 'scaleConfig', 'scaleService', 'subnavService', 'jobTypeService', 'metricsService', 'gridFactory', 'JobType', 'toastr', 'moment', function ($scope, $location, scaleConfig, scaleService, subnavService, jobTypeService, metricsService, gridFactory, JobType, toastr, moment) {
        var vm = this;

        vm.jobTypeParams = {
            page: null,
            page_size: null,
            started: null,
            ended: null,
            name: null,
            category: null,
            order: null
        };

        // check for jobTypeParams in query string, and update as necessary
        _.forEach(_.pairs(vm.jobTypeParams), function (param) {
            var value = _.at($location.search(), param[0]);
            if (value.length > 0) {
                vm.jobTypeParams[param[0]] = value.length > 1 ? value : value[0];
            }
        });

        var started = moment.utc().subtract(30, 'd').toISOString(),
            ended = moment.utc().toISOString(),
            jobTypes = [],
            numDays = moment.utc(ended).diff(moment.utc(started), 'd'),
            filteredByJobType = vm.jobTypeParams.name ? true : false;

        vm.scaleService = scaleService;
        vm.loading = true;
        vm.dates = [];
        vm.performanceData = [];
        vm.jobTypeValues = [];
        vm.selectedJobType = vm.jobTypeParams.name || '';
        vm.gridStyle = '';
        vm.subnavLinks = scaleConfig.subnavLinks.jobs;
        subnavService.setCurrentPath('jobs/failure-rates');

        var defaultColumnDefs = [
            {
                field: 'job_type',
                displayName: 'Job Type',
                cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.job_type.getIcon()"></span> {{ row.entity.job_type.title }} {{ row.entity.job_type.version }}</div>',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.vm.selectedJobType"><option ng-if="grid.appScope.vm.jobTypeValues[$index]" ng-selected="{{ grid.appScope.vm.jobTypeValues[$index].name == grid.appScope.vm.selectedJobType }}" value="{{ grid.appScope.vm.jobTypeValues[$index].name }}" ng-repeat="jobType in grid.appScope.vm.jobTypeValues track by $index">{{ grid.appScope.vm.jobTypeValues[$index].title }} {{ grid.appScope.vm.jobTypeValues[$index].version }}</option></select></div>',
                enableSorting: false
            },
            {
                field: 'twentyfour_hours',
                displayName: '24 Hours',
                enableSorting: false,
                enableFiltering: false,
                headerCellTemplate: 'gridHeader.html',
                cellTemplate: 'gridRow.html'
            },
            {
                field: 'fortyeight_hours',
                displayName: '48 Hours',
                enableSorting: false,
                enableFiltering: false,
                headerCellTemplate: 'gridHeader.html',
                cellTemplate: 'gridRow.html'
            },
            {
                field: 'thirty_days',
                displayName: '30 Days',
                enableSorting: false,
                enableFiltering: false,
                headerCellTemplate: 'gridHeader.html',
                cellTemplate: 'gridRow.html'
            }
        ];

        vm.gridOptions = gridFactory.defaultGridOptions();
        vm.gridOptions.columnDefs = defaultColumnDefs;
        vm.gridOptions.data = [];
        vm.gridOptions.onRegisterApi = function (gridApi) {
            //set gridApi on scope
            $scope.gridApi = gridApi;
            $scope.gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                if ($scope.actionClicked) {
                    $scope.actionClicked = false;
                } else {
                    $scope.$apply(function () {
                        $location.path('/jobs/types/' + row.entity.job_type.id);
                    });
                }
            });
        };
        
        vm.setStyle = function (colField, errorType) {
            var errorValue = (colField[errorType] / colField.total).toFixed(2);
            var textColor = errorValue >= 0.5 ? '#fff' : '#000';
            var rgb = errorType === 'system' ? '103, 0, 13' : errorType === 'algorithm' ? '203, 24, 29' : '241, 105, 19';
            return 'background: rgba(' + rgb + ', ' + errorValue + '); color: ' + textColor;
        };
        
        vm.getPercentageOfTotal = function (errorTotal, total) {
            if (total === 0) {
                return '100%';
            }
            return ((errorTotal / total) * 100).toFixed(0) + '%';
        };

        vm.filterResults = function () {
            _.forEach(_.pairs(vm.jobTypeParams), function (param) {
                $location.search(param[0], param[1]);
            });
            vm.loading = true;
            initialize();
        };

        vm.updateJobType = function (value) {
            vm.jobTypeParams.name = value === 'VIEW ALL' ? null : value;
            if (!vm.loading) {
                vm.filterResults();
            }
        };

        var formatData = function (data, numDays) {
            var dataArr = [];
            _.forEach(data, function (result) {
                var filteredResult = _.filter(result, function (d) {
                    var date = moment.utc(d.date, 'YYYY-MM-DD');
                    if (moment.utc().diff(moment.utc(date), 'd') <= numDays) {
                        return d;
                    }
                });
                dataArr.push(filteredResult);
            });
            return dataArr;
        };

        var formatColumn = function (cData, id) {
            var systemErrors = cData[0],
                algorithmErrors = cData[1],
                dataErrors = cData[2],
                totalCount = cData[3];

            var obj = {
                system: _.sum(_.map(_.filter(systemErrors, { id: id }), 'value')),
                algorithm: _.sum(_.map(_.filter(algorithmErrors, { id: id }), 'value')),
                data: _.sum(_.map(_.filter(dataErrors, { id: id }), 'value')),
                total: _.sum(_.map(_.filter(totalCount, { id: id }), 'value'))
            };
            obj.errorTotal = obj.system + obj.algorithm + obj.data;

            return obj;
        };

        var initialize = function () {
            jobTypeService.getJobTypesOnce().then(function (jobTypesData) {
                jobTypes = _.cloneDeep(jobTypesData.results);
                vm.jobTypeValues = _.cloneDeep(jobTypesData.results);
                vm.jobTypeValues.unshift({ name: 'VIEW ALL', title: 'VIEW ALL', version: '', id: 0 });
                vm.gridOptions.totalItems = jobTypesData.count;

                var metricsParams = {
                    page: null,
                    page_size: null,
                    started: started,
                    ended: ended,
                    choice_id: _.map(jobTypes, 'id'),
                    column: ['system_error_count', 'algorithm_error_count', 'data_error_count', 'total_count'],
                    group: null,
                    dataType: 'job-types'
                };

                metricsService.getPlotData(metricsParams).then(function (data) {
                    if (data.results.length > 0) {
                        var data30Days = _.map(data.results, 'values'),
                            data48Hours = formatData(data30Days, 2),
                            data24Hours = formatData(data48Hours, 1);

                        _.forEach(jobTypes, function (jobType) {
                            vm.performanceData.push({
                                job_type: JobType.transformer(jobType),
                                twentyfour_hours: formatColumn(data24Hours, jobType.id),
                                fortyeight_hours: formatColumn(data48Hours, jobType.id),
                                thirty_days: formatColumn(data30Days, jobType.id)
                            });
                        });

                        vm.performanceData = _.sortByOrder(vm.performanceData, function (d) {
                            if (d.twentyfour_hours.total > 0) {
                                return d.twentyfour_hours.errorTotal / d.twentyfour_hours.total;
                            }
                            return 1;
                        }, ['desc']);

                        vm.gridOptions.data = vm.performanceData;
                    }

                    vm.loading = false;
                }).catch(function (error) {
                    vm.loading = false;
                    console.log(error);
                    toastr['error'](error);
                });
            });
        };
        
        initialize();

        $scope.$watch('vm.selectedJobType', function (newValue, oldValue) {
            if (angular.equals(newValue, oldValue)) {
                return;
            }
            if (vm.loading) {
                if (filteredByJobType) {
                    vm.updateJobType(newValue);
                }
            } else {
                filteredByJobType = newValue !== 'VIEW ALL';
                vm.updateJobType(newValue);
            }
        });

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                gridMaxHeight = viewport.height - offset;

            vm.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px; overflow-y: auto;';
        });
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('jobsController', ['$rootScope', '$scope', '$location', '$uibModal', 'navService', 'jobService', 'jobTypeService', 'jobExecutionService', 'uiGridConstants', 'scaleConfig', 'subnavService', 'gridFactory', 'loadService', 'scaleService', 'userService', 'moment', 'toastr', function($rootScope, $scope, $location, $uibModal, navService, jobService, jobTypeService, jobExecutionService, uiGridConstants, scaleConfig, subnavService, gridFactory, loadService, scaleService, userService, moment, toastr) {
        var self = this;

        self.jobsParams = {
            page: null, page_size: null, started: null, ended: null, order: $rootScope.jobsControllerOrder || '-last_modified', status: null, error_category: null, job_type_id: null, job_type_name: null, job_type_category: null, url: null
        };

        // check for jobsParams in query string, and update as necessary
        _.forEach(_.pairs(self.jobsParams), function (param) {
            var value = _.at($location.search(), param[0]);
            if (value.length > 0) {
                self.jobsParams[param[0]] = value.length > 1 ? value : value[0];
            }
        });

        var gridPageNumber = self.jobsParams.page || 1,
            filteredByJobType = self.jobsParams.job_type_id ? true : false,
            filteredByJobStatus = self.jobsParams.status ? true : false,
            filteredByErrorCategory = self.jobsParams.error_category ? true : false,
            filteredByOrder = self.jobsParams.order ? true : false;

        $scope.jobsData = {};
        $scope.loading = true;
        $scope.jobTypeValues = [];
        $scope.jobExecution = null;
        $scope.selectedJobType = self.jobsParams.job_type_id || 0;
        $scope.jobStatusValues = scaleConfig.jobStatus;
        $scope.selectedJobStatus = self.jobsParams.status || $scope.jobStatusValues[0];
        $scope.errorCategoryValues = _.map(scaleConfig.errorCategories, 'name');
        $scope.selectedErrorCategory = self.jobsParams.error_category || $scope.errorCategoryValues[0];
        $scope.subnavLinks = scaleConfig.subnavLinks.jobs;
        $scope.actionClicked = false;
        $scope.gridStyle = '';
        $scope.readonly = true;
        $scope.lastModifiedStart = self.jobsParams.started ? moment.utc(self.jobsParams.started).toDate() : moment.utc().subtract(1, 'weeks').startOf('d').toDate();
        $scope.lastModifiedStartPopup = {
            opened: false
        };
        $scope.openLastModifiedStartPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStartPopup.opened = true;
        };
        $scope.lastModifiedStop = self.jobsParams.ended ? moment.utc(self.jobsParams.ended).toDate() : moment.utc().endOf('d').toDate();
        $scope.lastModifiedStopPopup = {
            opened: false
        };
        $scope.openLastModifiedStopPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStopPopup.opened = true;
        };
        $scope.dateModelOptions = {
            timezone: '+000'
        };

        subnavService.setCurrentPath('jobs');

        var defaultColumnDefs = [
            {
                field: 'job_type',
                displayName: 'Job Type',
                cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.job_type.getIcon()"></span> {{ row.entity.job_type.title }} {{ row.entity.job_type.version }}</div>',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedJobType"><option ng-if="grid.appScope.jobTypeValues[$index]" ng-selected="{{ grid.appScope.jobTypeValues[$index].id == grid.appScope.selectedJobType }}" value="{{ grid.appScope.jobTypeValues[$index].id }}" ng-repeat="jobType in grid.appScope.jobTypeValues track by $index">{{ grid.appScope.jobTypeValues[$index].title }} {{ grid.appScope.jobTypeValues[$index].version }}</option></select></div>'
            },
            {
                field: 'created',
                displayName: 'Created (Z)',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.created_formatted }}</div>'
            },
            {
                field: 'last_modified',
                displayName: 'Last Modified (Z)',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.last_modified_formatted }}</div>'
            },
            {
                field: 'duration',
                enableFiltering: false,
                enableSorting: false,
                width: 120,
                cellTemplate: '<div class="ui-grid-cell-contents text-right">{{ row.entity.getDuration() }}</div>'
            },
            {
                field: 'status',
                width: 150,
                cellTemplate: '<div class="ui-grid-cell-contents"><div class="pull-right"><button ng-show="((!grid.appScope.readonly) && (row.entity.status === \'FAILED\' || row.entity.status === \'CANCELED\'))" ng-click="grid.appScope.requeueJobs({ job_ids: [row.entity.id] })" class="btn btn-xs btn-default" title="Requeue Job"><i class="fa fa-repeat"></i></button> <button ng-show="!grid.appScope.readonly && row.entity.status !== \'COMPLETED\' && row.entity.status !== \'CANCELED\'" ng-click="grid.appScope.cancelJob(row.entity)" class="btn btn-xs btn-default" title="Cancel Job"><i class="fa fa-ban"></i></button></div> {{ row.entity.status }}</div>',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedJobStatus"><option ng-selected="{{ grid.appScope.jobStatusValues[$index] == grid.appScope.selectedJobStatus }}" value="{{ grid.appScope.jobStatusValues[$index] }}" ng-repeat="status in grid.appScope.jobStatusValues track by $index">{{ status.toUpperCase() }}</option></select></div>'
            },
            {
                field: 'error.category',
                width: 150,
                displayName: 'Error Category',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedErrorCategory"><option ng-selected="{{ grid.appScope.errorCategoryValues[$index] == grid.appScope.selectedErrorCategory }}" value="{{ grid.appScope.errorCategoryValues[$index] }}" ng-repeat="error in grid.appScope.errorCategoryValues track by $index">{{ error.toUpperCase() }}</option></select></div>'
            },
            {
                field: 'error.title',
                displayName: 'Error',
                cellTemplate: '<div class="ui-grid-cell-contents"><div uib-tooltip="{{ row.entity.error.description }}" tooltip-append-to-body="true">{{ row.entity.error.title }}</div></div>',
                width: 200,
                enableFiltering: false
            },
            {
                field: 'id',
                displayName: 'Log',
                enableFiltering: false,
                sortable: false,
                width: 60,
                cellTemplate: '<div class="ui-grid-cell-contents text-center"><button ng-click="grid.appScope.showLog(row.entity.id)" class="btn btn-xs btn-default"><i class="fa fa-file-text"></i></button></div>'
            }
        ];

        $scope.gridOptions = gridFactory.defaultGridOptions();
        $scope.gridOptions.paginationCurrentPage = parseInt(self.jobsParams.page || 1);
        $scope.gridOptions.paginationPageSize = parseInt(self.jobsParams.page_size) || $scope.gridOptions.paginationPageSize;
        var colDefs = $rootScope.colDefs ? $rootScope.colDefs : defaultColumnDefs;
        $scope.gridOptions.columnDefs = gridFactory.applySortConfig(colDefs, self.jobsParams);
        $scope.gridOptions.data = [];
        $scope.gridOptions.onRegisterApi = function (gridApi) {
                //set gridApi on scope
                $scope.gridApi = gridApi;
                $scope.gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                    if ($scope.actionClicked) {
                        $scope.actionClicked = false;
                    } else {
                        $scope.$apply(function(){
                            $location.path('/jobs/job/' + row.entity.id);
                        });
                    }

                });
                $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                    self.jobsParams.page = currentPage;
                    self.jobsParams.page_size = pageSize;
                    console.log('gridApi');
                    $scope.filterResults();
                });
                $scope.gridApi.core.on.sortChanged($scope, function (grid, sortColumns) {
                    $rootScope.colDefs = null;
                    _.forEach($scope.gridApi.grid.columns, function (col) {
                        col.colDef.sort = col.sort;
                    });
                    $rootScope.colDefs = $scope.gridApi.grid.options.columnDefs;
                    var sortArr = [];
                    _.forEach(sortColumns, function (col) {
                        sortArr.push(col.sort.direction === 'desc' ? '-' + col.field : col.field);
                    });
                    self.updateJobOrder(sortArr);
                });
            };


        $scope.showStatus = function (status) {
            return _.includes($scope.jobStatusValues, status);
        };

        self.updateJobType = function (value) {
            value = parseInt(value);
            if (value !== self.jobsParams.job_type_id) {
                self.jobsParams.page = 1;
            }
            self.jobsParams.job_type_id = value == 0 ? null : value;
            self.jobsParams.page_size = $scope.gridOptions.paginationPageSize;
            console.log('selectedJobType');
            if (!$scope.loading) {
                $scope.filterResults();
            }
        };

        $scope.$watch('selectedJobType', function (value) {
            if ($scope.loading) {
                if (filteredByJobType) {
                    self.updateJobType(value);
                }
            } else {
                filteredByJobType = value != 0;
                self.updateJobType(value);
            }
        });

        self.updateJobStatus = function (value) {
            if (value != self.jobsParams.status) {
                self.jobsParams.page = 1;
            }
            self.jobsParams.status = value === 'VIEW ALL' ? null : value;
            self.jobsParams.page_size = $scope.gridOptions.paginationPageSize;
            console.log('selectedJobStatus');
            if (!$scope.loading) {
                $scope.filterResults();
            }
        };

        self.updateErrorCategory = function (value) {
            if (value != self.jobsParams.error_category) {
                self.jobsParams.page = 1;
            }
            self.jobsParams.error_category = value === 'VIEW ALL' ? null : value;
            self.jobsParams.page_size = $scope.gridOptions.paginationPageSize;
            console.log('selectedErrorCategory');
            if (!$scope.loading) {
                $scope.filterResults();
            }
        };

        $scope.$watch('selectedJobStatus', function (value) {
            if ($scope.loading) {
                if (filteredByJobStatus) {
                    self.updateJobStatus(value);
                }
            } else {
                filteredByJobStatus = value !== 'VIEW ALL';
                self.updateJobStatus(value);
            }
        });

        $scope.$watch('selectedErrorCategory', function (value) {
            if ($scope.loading) {
                if (filteredByErrorCategory) {
                    self.updateErrorCategory(value);
                }
            } else {
                filteredByErrorCategory = value !== 'VIEW ALL';
                self.updateErrorCategory(value);
            }
        });

        self.updateJobOrder = function (sortArr) {
            self.jobsParams.order = sortArr.length > 0 ? sortArr : null;
            filteredByOrder = sortArr.length > 0;
            $scope.filterResults();
        };

        $scope.$watch('lastModifiedStart', function (value) {
            if (!$scope.loading) {
                self.jobsParams.started = value.toISOString();
                $scope.filterResults();
            }
        });

        $scope.$watch('lastModifiedStop', function (value) {
            if (!$scope.loading) {
                self.jobsParams.ended = value.toISOString();
                $scope.filterResults();
            }
        });

        /*$scope.$watch('gridApi', function (gridApi) {
            if (filteredByOrder) {
                gridApi.core.raise.sortChanged();
            }
        });*/

        $scope.showLog = function (jobId) {
            // show log modal
            $scope.actionClicked = true;
            console.log('show log modal');
            jobService.getJobDetail(jobId).then(function (data) {
                $scope.selectedJob = data.job_type.title + ' ' + data.job_type.version;
                $scope.jobExecution = data.getLatestExecution();
                var modalInstance = $uibModal.open({
                    animation: true,
                    templateUrl: 'showLog.html',
                    scope: $scope,
                    size: 'lg',
                    windowClass: 'log-modal-window'
                });
            });
        };

        $scope.filterResults = function () {
            _.forEach(_.pairs(self.jobsParams), function (param) {
                $location.search(param[0], param[1]);
            });
            $scope.loading = true;
            self.getJobs();
        };

        $scope.requeueJobs = function (jobsParams) {
            if (!jobsParams) {
                jobsParams = self.jobsParams ? self.jobsParams : { started: $scope.lastModifiedStart.toISOString(), ended: $scope.lastModifiedStop.toISOString() };
            }
            $scope.actionClicked = true;
            $scope.loading = true;
            loadService.requeueJobs(jobsParams).then(function () {
                toastr['success']('Requeue Successful');
                self.getJobs();
            }).catch(function (error) {
                toastr['error']('Requeue request failed');
                console.log(error);
                $scope.loading = false;
            });
        };

        $scope.cancelJob = function (job) {
            $scope.actionClicked = true;
            $scope.loading = true;
            var originalStatus = job.status;
            job.status = 'CANCEL';
            jobService.updateJob(job.id, { status: 'CANCELED' }).then(function (data) {
                toastr['success']('Job Canceled');
                job.status = 'CANCELED';
            }).catch(function (error) {
                toastr['error'](error);
                console.log(error);
                job.status = originalStatus;
            }).finally(function () {
                $scope.loading = false;
            });
        };

        self.getJobs = function () {
            jobService.getJobsOnce(self.jobsParams).then(function (data) {
                $scope.jobsData = data.results;
                $scope.gridOptions.totalItems = data.count;
                $scope.gridOptions.data = data.results;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        self.getJobTypes = function () {
            jobTypeService.getJobTypesOnce().then(function (data) {
                $scope.jobTypeValues = data.results;
                $scope.jobTypeValues.unshift({ name: 'VIEW ALL', title: 'VIEW ALL', version: '', id: 0 });
                /*if (!filteredByJobType && !filteredByJobStatus && !filteredByOrder) {
                    self.getJobs();
                } else {
                    if (filteredByOrder) {
                        self.updateJobOrder(self.jobsParams.order);
                    }
                }*/
                self.getJobs(self.jobsParams);
            }).catch(function (error) {
                $scope.loading = false;
                console.log(error);
            });
        };

        self.initialize = function () {
            if (typeof $rootScope.colDefs === 'undefined') {
                // root column defs have not been altered by user, so set up defaults
                if (!self.jobsParams.order) {
                    self.jobsParams.order = '-last_modified';
                    $location.search('order', self.jobsParams.order).replace();
                }
                if (!self.jobsParams.page_size) {
                    self.jobsParams.page_size = $scope.gridOptions.paginationPageSize;
                    $location.search('page_size', self.jobsParams.page_size).replace();
                }
                if (!self.jobsParams.started) {
                    self.jobsParams.started = moment.utc($scope.lastModifiedStart).toISOString();
                    $location.search('started', self.jobsParams.started).replace();
                }
                if (!self.jobsParams.ended) {
                    self.jobsParams.ended = moment.utc($scope.lastModifiedStop).toISOString();
                    $location.search('ended', self.jobsParams.ended).replace();
                }
            }
            self.getJobTypes();
            $rootScope.user = userService.getUserCreds();

            if ($rootScope.user) {
                $scope.readonly = false;
            }
            navService.updateLocation('jobs');
        };

        self.initialize();

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset + scaleConfig.dateFilterOffset,
                gridMaxHeight = viewport.height - offset;

            $scope.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px; overflow-y: auto;';
        });
    }]);
})();

(function(){
    angular.module('scaleApp').controller('jobExecutionLogController', ['$scope', '$location', '$element', '$timeout', 'jobExecutionService', 'scaleConfig', function($scope, $location, $element, $timeout, jobExecutionService, scaleConfig) {
        'use strict';
        var initialize = function(){

            $scope.forceScroll = true;

            $scope.jobLogError = null;

            $scope.$watch('execution', function (newValue, oldValue) {
                if ($scope.execution) {
                    jobExecutionService.getLog($scope.execution.id).then(null, null, function(result){
                        // get difference of max scroll length and current scroll length.
                        var logResult = result.execution_log;
                        if(result.$resolved){
                            var div = $($element[0]).find('.bash');
                            $scope.scrollDiff = (div.scrollTop() + div.prop('offsetHeight')) - div.prop('scrollHeight');
                            if($scope.scrollDiff >= 0){ $scope.forceScroll = true; }
                            $scope.execLog = logResult;
                        } else {
                            if (result.statusText && result.statusText !== '') {
                                $scope.jobLogErrorStatus = result.statusText;
                            }
                            $scope.jobLogError = 'Unable to retrieve job logs.';
                        }
                    });
                }
            });
            $scope.$watch('execLog', function (newValue, oldValue) {
                if ($scope.execLog) {
                    if($scope.forceScroll || $scope.scrollDiff >= 0){
                        $timeout(function(){
                            $scope.forceScroll = false;
                            var scrlHeight = $($element[0]).find('.bash').prop("scrollHeight");
                            $($element[0]).find('.bash').scrollTop(scrlHeight);
                        }, 50);
                    }
                }
            });
        };

        $scope.scrollitem = function(item){
                console.log(item);
        };

        $scope.stdoutChanged = function(){
            console.log('stdout changed.');
        };

        initialize();

    }]).directive('jobExecutionLog', function () {
        return {
            controller: 'jobExecutionLogController',
            templateUrl: 'modules/jobs/directives/jobExecutionLogTemplate.html',
            restrict: 'E',
            scope: {
                execution: '='
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('aisJobHealthController', ['$rootScope', '$scope', 'jobTypeService', function ($rootScope, $scope, jobTypeService) {
        $scope.loadingJobHealth = true;
        $scope.jobHealthError = null;
        $scope.jobHealthErrorStatus = null;
        $scope.jobHealth = {};

        var getJobTypeStatus = function () {
            jobTypeService.getJobTypeStatus(null, null, $scope.duration, null).then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.jobHealthError = null;
                    $scope.jobTypeStatus = data.results;
                    $scope.total = 0;
                    $scope.failed = 0;

                    var performance = {},
                        failures = [];

                    _.forEach(data.results, function (status) {
                        performance = status.getPerformance();
                        $scope.total = $scope.total + performance.total;
                        $scope.failed = $scope.failed + performance.failed;
                        failures.push(status.getFailures());
                    });

                    var failureData = [],
                        systemFailures = 0,
                        dataFailures = 0,
                        algorithmFailures = 0;

                    _.forEach(failures, function (f) {
                        _.forEach(f, function (type) {
                            if (type.status === 'SYSTEM') {
                                systemFailures = systemFailures + type.count;
                            } else if (type.status === 'DATA') {
                                dataFailures = dataFailures + type.count;
                            } else if (type.status === 'ALGORITHM') {
                                algorithmFailures = algorithmFailures + type.count;
                            }
                        });
                    });

                    if (systemFailures > 0 || dataFailures > 0 || algorithmFailures > 0) {
                        if (systemFailures > 0) {
                            failureData.push({
                                status: 'SYSTEM',
                                count: systemFailures
                            });
                        }
                        if (algorithmFailures > 0) {
                            failureData.push({
                                status: 'ALGORITHM',
                                count: algorithmFailures
                            });
                        }
                        if (dataFailures > 0) {
                            failureData.push({
                                status: 'DATA',
                                count: dataFailures
                            });
                        }
                    }

                    $scope.jobHealth = {
                        gaugeData: $scope.total === 0 ? 0 : 100 - (($scope.failed / $scope.total) * 100).toFixed(2),
                        donutData: failureData
                    };

                    if ($scope.broadcastData) {
                        $rootScope.$broadcast('jobTypeStatus', $scope.jobTypeStatus);
                    }
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.jobHealthErrorStatus = data.statusText;
                    }
                    $scope.jobHealthError = 'Unable to retrieve job statistics.';
                }
                $scope.loadingJobHealth = false;
            });
        };

        getJobTypeStatus();
    }]).directive('aisJobHealth', function(){
        /**
         * Usage: <ais-job-health />
         **/
        return {
            controller: 'aisJobHealthController',
            templateUrl: 'modules/jobs/directives/jobHealthTemplate.html',
            restrict: 'E',
            scope: {
                duration: '=',
                broadcastData: '=', // set to true when using another widget in the same view that also calls getJobTypeStatus
                showDescription: '='
            }
        };
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('jobTypeInterfaceDirectiveController', ['$rootScope', '$scope', 'jobTypeService', function ($rootScope, $scope, jobTypeService) {

    }]).directive('aisJobTypeInterface', function(){
        /**
         * Usage: <ais-job-health />
         **/
        return {
            controller: 'jobTypeInterfaceDirectiveController',
            templateUrl: 'modules/jobs/directives/jobTypeInterfaceTemplate.html',
            restrict: 'E',
            scope: {
                jobTypeInterface: '='
            }
        };
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('Job', ['scaleConfig', 'JobType', 'scaleService', function (scaleConfig, JobType, scaleService) {
        var Job = function (id, job_type, job_type_rev, event, error, status, priority, num_exes, timeout, max_tries, cpus_required, mem_required, disk_in_required, disk_out_required, created, queued, started, ended, last_status_change, last_modified) {
            this.id = id;
            this.job_type = JobType.transformer(job_type);
            this.job_type_rev = job_type_rev;
            this.event = event;
            this.error = error;
            this.status = status;
            this.priority = priority;
            this.num_exes = num_exes;
            this.timeout = timeout;
            this.max_tries = max_tries;
            this.cpus_required = cpus_required;
            this.mem_required = mem_required;
            this.disk_in_required = disk_in_required;
            this.disk_out_required = disk_out_required;
            this.created = created;
            this.created_formatted = moment.utc(created).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.queued = queued;
            this.started = started;
            this.ended = ended;
            this.last_status_change = last_status_change;
            this.last_modified = last_modified;
            this.last_modified_formatted = moment.utc(last_modified).format(scaleConfig.dateFormats.day_second_utc_nolabel);
        };

        // public methods
        Job.prototype = {
            getDuration: function () {
                var start = this.started,
                    end = this.ended ? this.ended : moment.utc().toISOString();
                return scaleService.calculateDuration(start, end);
            }
        };

        // static methods, assigned to class
        Job.build = function (data) {
            if (data) {
                return new Job(
                    data.id,
                    data.job_type,
                    data.job_type_rev,
                    data.event,
                    data.error,
                    data.status,
                    data.priority,
                    data.num_exes,
                    data.timeout,
                    data.max_tries,
                    data.cpus_required,
                    data.mem_required,
                    data.disk_in_required,
                    data.disk_out_required,
                    data.created,
                    data.queued,
                    data.started,
                    data.ended,
                    data.last_status_change,
                    data.last_modified
                );
            }
            return new Job();
        };

        Job.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Job.build)
                    .filter(Boolean);
            }
            return Job.build(data);
        };

        return Job;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobDetailEvent', ['JobDetailEventRule', function (JobDetailEventRule) {
        var JobDetailEvent = function (id, type, rule, occurred) {
            this.id = id;
            this.type = type;
            this.rule = JobDetailEventRule.transformer(rule);
            this.occurred = occurred;
        };

        // public methods
        JobDetailEvent.prototype = {

        };

        // static methods, assigned to class
        JobDetailEvent.build = function (data) {
            if (data) {
                return new JobDetailEvent(
                    data.id,
                    data.type,
                    data.rule,
                    data.occurred
                );
            }
            return new JobDetailEvent();
        };

        JobDetailEvent.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobDetailEvent.build)
                    .filter(Boolean);
            }
            return JobDetailEvent.build(data);
        };

        return JobDetailEvent;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobDetailEventRule', function () {
        var JobDetailEventRule = function (id, type, is_active, created, archived, last_modified) {
            this.id = id;
            this.type = type;
            this.is_active = is_active;
            this.created = created;
            this.archived = archived;
            this.last_modified = last_modified;
        };

        // public methods
        JobDetailEventRule.prototype = {

        };

        // static methods, assigned to class
        JobDetailEventRule.build = function (data) {
            if (data) {
                return new JobDetailEventRule(
                    data.id,
                    data.type,
                    data.is_active,
                    data.created,
                    data.archived,
                    data.last_modified
                );
            }
            return new JobDetailEventRule();
        };

        JobDetailEventRule.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobDetailEventRule.build)
                    .filter(Boolean);
            }
            return JobDetailEventRule.build(data);
        };

        return JobDetailEventRule;
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobDetailInputData', function () {
        var JobDetailInputData = function (name, value, file_id, file_ids, files) {
            this.name = name;
            this.value = value;
            this.file_id = file_id;
            this.file_ids = file_ids;
            this.files = files;
        };

        // public methods
        JobDetailInputData.prototype = {
            getValue: function () {
                if (this.value)
                    return this.value;
                if (this.file_id)
                    return this.file_id;
                if (this.file_ids)
                    return this.file_ids;
            }
        };

        // static methods, assigned to class
        JobDetailInputData.build = function (data) {
            if (data) {
                return new JobDetailInputData(
                    data.name,
                    data.value,
                    data.file_id,
                    data.file_ids,
                    data.files
                );
            }
            return new JobDetailInputData();
        };

        JobDetailInputData.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobDetailInputData.build)
                    .filter(Boolean);
            }
            return JobDetailInputData.build(data);
        };

        return JobDetailInputData;
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobDetailOutputData', function () {
        var JobDetailOutputData = function (name, workspace_id, files) {
            this.name = name;
            this.workspace_id = workspace_id;
            this.files = files;
        };

        // public methods
        JobDetailOutputData.prototype = {

        };

        // static methods, assigned to class
        JobDetailOutputData.build = function (data) {
            if (data) {
                return new JobDetailOutputData(
                    data.name,
                    data.workspace_id,
                    data.files
                );
            }
            return new JobDetailOutputData();
        };

        JobDetailOutputData.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobDetailOutputData.build)
                    .filter(Boolean);
            }
            return JobDetailOutputData.build(data);
        };

        return JobDetailOutputData;
    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobDetails', ['scaleConfig', 'JobType', 'JobExecution', 'Product', 'JobDetailInputData', 'JobDetailOutputData', 'Recipe', 'JobDetailEvent', 'scaleService', function (scaleConfig, JobType, JobExecution, Product, JobDetailInputData, JobDetailOutputData, Recipe, JobDetailEvent, scaleService) {
        var JobDetails = function (id, job_type, job_type_rev, event, error, status, priority, num_exes, timeout, max_tries, cpus_required, mem_required, disk_in_required, disk_out_required, created, queued, started, ended, last_status_change, last_modified, data, results, recipes, job_exes, inputs, outputs) {
            this.id = id;
            this.job_type = JobType.transformer(job_type);
            this.job_type_rev = job_type_rev;
            this.event = JobDetailEvent.transformer(event);
            this.error = error;
            this.status = status;
            this.priority = priority;
            this.num_exes = num_exes;
            this.timeout = timeout;
            this.max_tries = max_tries;
            this.cpus_required = cpus_required;
            this.mem_required = mem_required;
            this.disk_in_required = disk_in_required;
            this.disk_out_required = disk_out_required;
            this.created = created;
            this.created_formatted = moment.utc(created).format(scaleConfig.dateFormats.day_second_utc);
            this.queued = queued;
            this.queued_formatted = moment.utc(queued).format(scaleConfig.dateFormats.day_second_utc);
            this.started = started;
            this.started_formatted = moment.utc(started).format(scaleConfig.dateFormats.day_second_utc);
            this.ended = ended;
            this.ended_formatted = moment.utc(ended).format(scaleConfig.dateFormats.day_second_utc);
            this.last_status_change = last_status_change;
            this.last_modified = last_modified;
            this.data = {
                input_data: JobDetailInputData.transformer(data.input_data),
                version: data.version,
                output_data: JobDetailOutputData.transformer(data.output_data)
            };
            this.results = {
                output_data: JobDetailOutputData.transformer(results.output_data),
                version: results.version
            };
            this.recipes = Recipe.transformer(recipes);
            this.job_exes = JobExecution.transformer(job_exes);
            this.inputs = inputs;
            this.outputs = outputs;
        };

        // public methods
        JobDetails.prototype = {
            getDuration: function () {
                return scaleService.calculateDuration(this.created, this.last_modified);
            },
            getLatestExecution: function(){
                if (this.num_exes > 0 ) {
                    return this.job_exes[0];
                }
                return null;
            },
            getStatusClass: function(){
                // if(this.status === 'COMPLETED'){
                //     return 'label-success';
                // }
                // else if( this.status === 'FAILED'){
                //     return 'label-default';//    return 'label-danger';
                // }
                // else{
                //     return 'label-default';
                // }
                return this.status.toLowerCase();
            }
        };

        // static methods, assigned to class
        JobDetails.build = function (data) {
            if (data) {
                return new JobDetails(
                    data.id,
                    data.job_type,
                    data.job_type_rev,
                    data.event,
                    data.error,
                    data.status,
                    data.priority,
                    data.num_exes,
                    data.timeout,
                    data.max_tries,
                    data.cpus_required,
                    data.mem_required,
                    data.disk_in_required,
                    data.disk_out_required,
                    data.created,
                    data.queued,
                    data.started,
                    data.ended,
                    data.last_status_change,
                    data.last_modified,
                    data.data,
                    data.results,
                    data.recipes,
                    data.job_exes,
                    data.inputs,
                    data.outputs
                );
            }
            return new JobDetails();
        };

        JobDetails.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobDetails.build)
                    .filter(Boolean);
            }
            return JobDetails.build(data);
        };

        return JobDetails;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobExecution', ['scaleConfig', 'Job', 'Node', 'moment', function (scaleConfig, Job, Node, moment) {
        var JobExecution = function (id, status, command_arguments, timeout, pre_started, pre_completed, pre_exit_code, job_started, job_completed, job_exit_code, post_started, post_completed, post_exit_code, created, queued, started, ended, last_modified, job, node, error, environment, cpus_scheduled, mem_scheduled, disk_in_scheduled, disk_out_scheduled, disk_total_scheduled, results, current_stdout_url, current_stderr_url, results_manifest) {
            this.id = id;
            this.status = status;
            this.command_arguments = command_arguments;
            this.timeout = timeout;
            this.pre_started = pre_started;
            this.pre_completed = pre_completed;
            this.pre_exit_code = pre_exit_code;
            this.job_started = job_started;
            this.job_completed = job_completed;
            this.job_exit_code = job_exit_code;
            this.post_started = post_started;
            this.post_completed = post_completed;
            this.post_exit_code = post_exit_code;
            this.created = created;
            this.created_formatted = created ? moment.utc(created).toISOString() : created;
            this.queued = queued;
            this.queued_formatted = queued ? moment.utc(queued).toISOString() : queued;
            this.started = started;
            this.started_formatted = started ? moment.utc(started).toISOString() : started;
            this.ended = ended;
            this.ended_formatted = ended ? moment.utc(ended).toISOString() : ended;
            this.last_modified = last_modified;
            this.last_modified_formatted = last_modified ? moment.utc(last_modified).toISOString() : last_modified;
            this.job = Job.transformer(job);
            this.node = Node.transformer(node);
            this.error = error;
            this.environment = environment;
            this.cpus_scheduled = cpus_scheduled;
            this.mem_scheduled = mem_scheduled;
            this.disk_in_scheduled = disk_in_scheduled;
            this.disk_out_scheduled = disk_out_scheduled;
            this.disk_total_scheduled = disk_total_scheduled;
            this.results = results;
            this.current_stdout_url = current_stdout_url;
            this.current_stderr_url = current_stderr_url;
            this.results_manifest = results_manifest;
        };

        // public methods
        JobExecution.prototype = {
            getDuration: function () {
                return moment.utc(this.job_completed).diff(moment.utc(this.job_started));
            },
            getIcon: function () {
                return this.job.jobType.iconCode ? '<i class="fa">&#x' + this.job.jobType.iconCode + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
            }
        };

        // static methods, assigned to class
        JobExecution.build = function (data) {
            if (data) {
                return new JobExecution(
                    data.id,
                    data.status,
                    data.command_arguments,
                    data.timeout,
                    data.pre_started,
                    data.pre_completed,
                    data.pre_exit_code,
                    data.job_started,
                    data.job_completed,
                    data.job_exit_code,
                    data.post_started,
                    data.post_completed,
                    data.post_exit_code,
                    data.created,
                    data.queued,
                    data.started,
                    data.ended,
                    data.last_modified,
                    data.job,
                    data.node,
                    data.error,
                    data.environment,
                    data.cpus_scheduled,
                    data.mem_scheduled,
                    data.disk_in_scheduled,
                    data.disk_out_scheduled,
                    data.disk_total_scheduled,
                    data.results,
                    data.current_stdout_url,
                    data.current_stderr_url,
                    data.results_manifest
                );
            }
            return new JobExecution();
        };

        JobExecution.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobExecution.build)
                    .filter(Boolean);
            }
            return JobExecution.build(data);
        };

        return JobExecution;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobExecutionLog', ['scaleConfig', 'Job', 'Node', function (scaleConfig, Job, Node) {
        var JobExecutionLog = function (id, status, command_arguments, timeout, exit_code, created, queued, scheduled, pre_started, pre_completed, job_started, job_completed, post_started, post_completed, ended, last_modified, job, node, error, is_finished, stdout, stderr) {
            this.id = id;
            this.status = status;
            this.command_arguments = command_arguments;
            this.timeout = timeout;
            this.exit_code = exit_code;
            this.created = created;
            this.queued = queued;
            this.scheduled = scheduled;
            this.pre_started = pre_started;
            this.pre_completed = pre_completed;
            this.job_started = job_started;
            this.job_completed = job_completed;
            this.post_started = post_started;
            this.post_completed = post_completed;
            this.ended = ended;
            this.last_modified = last_modified;
            this.job = Job.transformer(job);
            this.node = Node.transformer(node);
            this.error = error;
            this.is_finished = is_finished;
            this.stdout = stdout;
            this.stdoutHtml = stdout ? stdout.replace(new RegExp('\r?\n','g'), '<br />') : '';
            this.stderr = stderr;
        };

        // public methods
        JobExecutionLog.prototype = {
            toHtml: function(instr){
                return instr
            }

        };

        // static methods, assigned to class
        JobExecutionLog.build = function (data) {
            if (data) {
                return new JobExecutionLog(
                    data.id,
                    data.status,
                    data.command_arguments,
                    data.timeout,
                    data.exit_code,
                    data.created,
                    data.queued,
                    data.scheduled,
                    data.pre_started,
                    data.pre_completed,
                    data.job_started,
                    data.job_completed,
                    data.post_started,
                    data.post_completed,
                    data.ended,
                    data.last_modified,
                    data.job,
                    data.node,
                    data.error,
                    data.is_finished,
                    data.stdout,
                    data.stderr
                );
            }
            return new JobExecutionLog();
        };

        JobExecutionLog.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobExecutionLog.build)
                    .filter(Boolean);
            }
            return JobExecutionLog.build(data);
        };

        return JobExecutionLog;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobType', ['scaleConfig', 'JobTypeInterface', function (scaleConfig, JobTypeInterface) {
        var JobType = function (id, name, title, version, description, is_system, is_long_running, is_active, is_operational, is_paused, uses_docker, docker_privileged, docker_image, priority, timeout, max_tries, cpus_required, mem_required, disk_out_const_required, disk_out_mult_required, icon_code, created, archived, paused, last_modified, job_type_interface) {
            this.id = id;
            this.name = name;
            this.title = title;
            this.version = version;
            this.description = description;
            this.is_system = is_system;
            this.is_long_running = is_long_running;
            this.is_active = is_active;
            this.is_operational = is_operational;
            this.is_paused = is_paused;
            this.uses_docker = uses_docker;
            this.docker_privileged = docker_privileged;
            this.docker_image = docker_image;
            this.priority = priority;
            this.timeout = timeout;
            this.max_tries = max_tries;
            this.cpus_required = cpus_required;
            this.mem_required = mem_required;
            this.disk_out_const_required = disk_out_const_required;
            this.disk_out_mult_required = disk_out_mult_required;
            this.icon_code = icon_code;
            this.created = created;
            this.archived = archived;
            this.paused = paused;
            this.last_modified = last_modified;
            this.job_type_interface = JobTypeInterface.transformer(job_type_interface);
        };

        // public methods
        JobType.prototype = {
            toString: function () {
                return 'JobType';
            },
            getIcon: function () {
                return this.icon_code ? '<i class="fa">&#x' + this.icon_code + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
            },
            getCellText: function () {
                return this.icon_code ? '&#x' + this.icon_code + ';' : '&#x' + scaleConfig.defaultIconCode + ';';
            },
            getCellTitle: function () {
                return this.title;
            }
        };

        // static methods, assigned to class
        JobType.build = function (data) {
            if (data) {
                return new JobType(
                    data.id,
                    data.name,
                    data.title,
                    data.version,
                    data.description,
                    data.is_system,
                    data.is_long_running,
                    data.is_active,
                    data.is_operational,
                    data.is_paused,
                    data.uses_docker,
                    data.docker_privileged,
                    data.docker_image,
                    data.priority,
                    data.timeout,
                    data.max_tries,
                    data.cpus_required,
                    data.mem_required,
                    data.disk_out_const_required,
                    data.disk_out_mult_required,
                    data.icon_code,
                    data.created,
                    data.archived,
                    data.paused,
                    data.last_modified,
                    data.interface
                );
            }
            return new JobType();
        };

        JobType.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobType.build)
                    .filter(Boolean);
            }
            return JobType.build(data);
        };

        return JobType;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeDetails', ['scaleConfig', 'JobTypeInterface', 'JobTypeErrorMapping', 'JobTypeError', 'scaleService', function (scaleConfig, JobTypeInterface, JobTypeErrorMapping, JobTypeError, scaleService) {
        var JobTypeDetails = function (id, name, version, title, description, category, author_name, author_url, is_system, is_long_running, is_active, is_operational, is_paused, icon_code, uses_docker, docker_privileged, docker_image, revision_num, priority, timeout, max_scheduled, max_tries, cpus_required, mem_required, disk_out_const_required, disk_out_mult_required, created, archived, paused, last_modified, job_type_interface, error_mapping, trigger_rule, errors, job_counts_6h, job_counts_12h, job_counts_24h) {
            this.id = id;
            this.name = name;
            this.version = version;
            this.title = title;
            this.description = description;
            this.category = category;
            this.author_name = author_name;
            this.author_url = author_url;
            this.is_system = is_system;
            this.is_long_running = is_long_running;
            this.is_active = is_active;
            this.is_operational = is_operational;
            this.is_paused = is_paused;
            this.icon_code = icon_code;
            this.uses_docker = uses_docker;
            this.docker_privileged = docker_privileged;
            this.docker_image = docker_image;
            this.revision_num = revision_num;
            this.priority = priority;
            this.timeout = timeout;
            this.max_scheduled = max_scheduled;
            this.max_tries = max_tries;
            this.cpus_required = cpus_required;
            this.mem_required = mem_required;
            this.mem_required_formatted = scaleService.calculateFileSizeFromMib(mem_required);
            this.disk_out_const_required = disk_out_const_required;
            this.disk_out_const_required_formatted = scaleService.calculateFileSizeFromMib(disk_out_const_required);
            this.disk_out_mult_required = disk_out_mult_required;
            this.created = created;
            this.archived = archived;
            this.paused = paused;
            this.last_modified = last_modified;
            this.job_type_interface = job_type_interface;
            this.error_mapping = JobTypeErrorMapping.transformer(error_mapping);
            this.trigger_rule = trigger_rule;
            this.errors = JobTypeError.transformer(errors);
            this.job_counts_6h = job_counts_6h;
            this.job_counts_12h = job_counts_12h;
            this.job_counts_24h = job_counts_24h;
        };

        // public methods
        JobTypeDetails.prototype = {
            getIcon: function () {
                return this.icon_code ? '<i class="fa">&#x' + this.icon_code + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
            },
            getPerformance: function () {
                var failed6Arr = _.where(this.job_counts_6h, { 'status': 'FAILED' }),
                    failed12Arr = _.where(this.job_counts_12h, { 'status': 'FAILED' }),
                    failed24Arr = _.where(this.job_counts_24h, { 'status': 'FAILED' });

                var completed6 = _.find(this.job_counts_6h, 'status', 'COMPLETED') || { count: 0 },
                    failed6 = _.sum(failed6Arr, 'count'),
                    total6 = failed6Arr.length > 0 ? failed6 + completed6.count : completed6.count,
                    successRate6 = total6 === 0 ? 0 : 100 - ((failed6 / total6) * 100).toFixed(2),
                    completed12 = _.find(this.job_counts_12h, 'status', 'COMPLETED') || { count: 0 },
                    failed12 = _.sum(failed12Arr, 'count'),
                    total12 = failed12Arr.length > 0 ? failed12 + completed12.count : completed12.count,
                    successRate12 = total12 === 0 ? 0 : 100 - ((failed12 / total12) * 100).toFixed(2),
                    completed24 = _.find(this.job_counts_24h, 'status', 'COMPLETED') || { count: 0 },
                    failed24 = _.sum(failed24Arr, 'count'),
                    total24 = failed24Arr.length > 0 ? failed24 + completed24.count : completed24.count,
                    successRate24 = total24 === 0 ? 0 : 100 - ((failed24 / total24) * 100).toFixed(2);

                return {
                    hour6: {
                        rate: successRate6,
                        failed: failed6,
                        completed: completed6.count,
                        total: total6
                    },
                    hour12: {
                        rate: successRate12,
                        failed: failed12,
                        completed: completed12.count,
                        total: total12
                    },
                    hour24: {
                        rate: successRate24,
                        failed: failed24,
                        completed: completed24.count,
                        total: total24
                    }
                };
            },
            getFailures: function () {
                var failed6 = _.where(this.job_counts_6h, { 'status': 'FAILED' }),
                    failed6Values = _.values(_.groupBy(failed6, 'category')),
                    failed12 = _.where(this.job_counts_12h, { 'status': 'FAILED' }),
                    failed12Values = _.values(_.groupBy(failed12, 'category')),
                    failed24 = _.where(this.job_counts_24h, { 'status': 'FAILED' }),
                    failed24Values = _.values(_.groupBy(failed24, 'category'));

                var getFailureCounts = function (categories) {
                    var returnArr = [];
                    _.forEach(categories, function (category) {
                        _.forEach(category, function (val) {
                            returnArr.push({ status: val.category, count: val.count });
                        });
                    });
                    return returnArr;
                };

                return {
                    hour6: getFailureCounts(failed6Values),
                    hour12: getFailureCounts(failed12Values),
                    hour24: getFailureCounts(failed24Values)
                };
            }
        };

        // static methods, assigned to class
        JobTypeDetails.build = function (data) {
            if (data) {
                // TODO: change property returned by API from "interface" to "job_type_interface" because "interface" is a reserved word in JS
                var jobTypeInterface = data.interface ? data.interface : data.job_type_interface;
                return new JobTypeDetails(
                    data.id,
                    data.name,
                    data.version,
                    data.title,
                    data.description,
                    data.category,
                    data.author_name,
                    data.author_url,
                    data.is_system,
                    data.is_long_running,
                    data.is_active,
                    data.is_operational,
                    data.is_paused,
                    data.icon_code,
                    data.uses_docker,
                    data.docker_privileged,
                    data.docker_image,
                    data.revision_num,
                    data.priority,
                    data.timeout,
                    data.max_scheduled,
                    data.max_tries,
                    data.cpus_required,
                    data.mem_required,
                    data.disk_out_const_required,
                    data.disk_out_mult_required,
                    data.created,
                    data.archived,
                    data.paused,
                    data.last_modified,
                    jobTypeInterface,
                    data.error_mapping,
                    data.trigger_rule,
                    data.errors,
                    data.job_counts_6h,
                    data.job_counts_12h,
                    data.job_counts_24h
                );
            }
            return new JobTypeDetails();
        };

        JobTypeDetails.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeDetails.build);
            }
            return JobTypeDetails.build(data);
        };

        return JobTypeDetails;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeError', ['moment', 'scaleConfig', function (moment, scaleConfig) {
        var JobTypeError = function (id, name, title, description, category, created, last_modified) {
            this.id = id;
            this.name = name;
            this.title = title;
            this.description = description;
            this.category = category;
            this.created = created;
            this.created_formatted = created ? moment.utc(created).toISOString() : created;
            this.last_modified = last_modified;
            this.last_modified_formatted = last_modified ? moment.utc(last_modified).toISOString() : last_modified;
        };

        // public methods
        JobTypeError.prototype = {

        };

        // static methods, assigned to class
        JobTypeError.build = function (data) {
            if (data) {
                return new JobTypeError(
                    data.id,
                    data.name,
                    data.title,
                    data.description,
                    data.category,
                    data.created,
                    data.last_modified
                );
            }
            return new JobTypeError();
        };

        JobTypeError.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeError.build)
                    .filter(Boolean);
            }
            return JobTypeError.build(data);
        };

        return JobTypeError;
    }])
})();

(function () {
    'use strict';
    
    angular.module('scaleApp').factory('JobTypeErrorMapping', function () {
        var JobTypeErrorMapping = function (version, exit_codes) {
            this.version = version;
            this.exit_codes = exit_codes;
        };

        // public methods
        JobTypeErrorMapping.prototype = {

        };

        // static methods, assigned to class
        JobTypeErrorMapping.build = function (data) {
            if (data) {
                return new JobTypeErrorMapping(
                    data.version,
                    data.exit_codes
                );
            }
            return new JobTypeErrorMapping();
        };

        JobTypeErrorMapping.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeErrorMapping.build)
                    .filter(Boolean);
            }
            return JobTypeErrorMapping.build(data);
        };

        return JobTypeErrorMapping;
    })
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeInputData', ['scaleConfig', function (scaleConfig) {
        var JobTypeInputData = function (media_types, required, type, name) {
            this.media_types = media_types;
            this.required = required;
            this.type = type;
            this.name = name;
        };

        // public methods
        JobTypeInputData.prototype = {

        };

        // static methods, assigned to class
        JobTypeInputData.build = function (data) {
            if (data) {
                return new JobTypeInputData(
                    data.media_types,
                    data.required,
                    data.type,
                    data.name
                );
            }
            return new JobTypeInputData();
        };

        JobTypeInputData.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeInputData.build);
            }
            return JobTypeInputData.build(data);
        };

        return JobTypeInputData;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeInterface', ['scaleConfig', 'JobTypeInputData', 'JobTypeOutputData', function (scaleConfig, JobTypeInputData, JobTypeOutputData) {
        var JobTypeInterface = function (version, command, command_arguments, input_data, output_data) {
            this.version = version;
            this.command = command;
            this.command_arguments = command_arguments;
            this.input_data = JobTypeInputData.transformer(input_data);
            this.output_data = JobTypeOutputData.transformer(output_data);
        };

        // public methods
        JobTypeInterface.prototype = {
            getIcon: function () {
                return this.iconCode ? '<i class="fa">&#x' + this.iconCode + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
            }
        };

        // static methods, assigned to class
        JobTypeInterface.build = function (data) {
            if (data) {
                return new JobTypeInterface(
                    data.version,
                    data.command,
                    data.command_arguments,
                    data.input_data,
                    data.output_data
                );
            }
            return new JobTypeInterface();
        };

        JobTypeInterface.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeInterface.build)
                    .filter(Boolean);
            }
            return JobTypeInterface.build(data);
        };

        return JobTypeInterface;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeOutputData', function () {
        var JobTypeOutputData = function (name, type, required, media_type) {
            this.name = name;
            this.type = type;
            this.required = required;
            this.media_type = media_type;
        };

        // public methods
        JobTypeOutputData.prototype = {

        };

        // static methods, assigned to class
        JobTypeOutputData.build = function (data) {
            if (data) {
                return new JobTypeOutputData(
                    data.name,
                    data.type,
                    data.required,
                    data.media_type
                );
            }
            return new JobTypeOutputData();
        };

        JobTypeOutputData.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeOutputData.build)
                    .filter(Boolean);
            }
            return JobTypeOutputData.build(data);
        };

        return JobTypeOutputData;
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('JobTypeStatus', ['scaleConfig', 'JobType', 'JobExecution', function (scaleConfig, JobType, JobExecution) {
        var JobTypeStatus = function (job_type, job_counts) {
            this.job_type = JobType.transformer(job_type);
            this.job_counts = job_counts;
            this.has_running = _.find(job_counts, 'status', 'RUNNING');
            this.description = this.getPerformance().rateDescription;
        };

        // public methods
        JobTypeStatus.prototype = {
            toString: function () {
                return 'JobTypeStatus';
            },
            getPerformance: function () {
                var failedArr = _.sortByOrder(_.filter(this.job_counts, { status: 'FAILED' }), ['count'], ['desc']),
                    completed = _.find(this.job_counts, 'status', 'COMPLETED') || { count: 0 },
                    failed = _.sum(failedArr, 'count'),
                    failedCategory = failedArr.length > 0 ? failedArr[0].category : '',
                    total = failedArr.length > 0 ? failed + completed.count : completed.count,
                    successRate = total === 0 ? 0 : 100 - ((failed / total) * 100).toFixed(2),
                    successRateDescription = 'success';

                if (successRate <= 30 && total > 0) {
                    successRateDescription = 'error';
                } else if (successRate > 30 && successRate <= 60 && total > 0) {
                    successRateDescription = 'warning';
                } else if (total === 0 && !this.has_running) {
                    successRateDescription = 'z_inactive'; // prepend with 'z_' for ordering purposes
                }

                return {
                    rate: successRate,
                    rateDescription: successRateDescription,
                    failed: failed,
                    failedCategory: failedCategory,
                    completed: completed.count,
                    total: total
                };
            },
            getRunning: function () {
                return _.find(this.job_counts, 'status', 'RUNNING') || { count: 0 };
            },
            getFailures: function () {
                var failed = _.where(this.job_counts, { 'status': 'FAILED' });

                _.forEach(failed, function (f) {
                    var category = _.find(scaleConfig.errorCategories, { name: f.category });
                    f.order = category ? category.order : '';
                });

                var failedValues = _.values(_.groupBy(failed, 'order'));

                var getFailureCounts = function (categories) {
                    var returnArr = [];
                    _.forEach(categories, function (category) {
                        _.forEach(category, function (val) {
                            returnArr.push({ status: val.category, count: val.count, order: val.order });
                        });
                    });
                    return _.sortByOrder(returnArr, ['order'], ['desc']);
                };

                return getFailureCounts(failedValues);
            },
            getCellFill: function () {
                var status = this.getPerformance();
                if (status.rateDescription === 'z_inactive') {
                    return scaleConfig.colors.chart_gray_dark;
                }
                return scaleConfig.colors.chart_green;
            },
            getCellActivityTotal: function () {
                return this.getRunning().count > 0 ? this.getRunning().count : '';
            },
            getCellError: function () {
                var performance = this.getPerformance();
                return 'Failed: ' + (performance.failed);
            },
            getCellTotal: function () {
                var performance = this.getPerformance();
                return performance.completed;
            },
            getCellPauseResume: function () {
                return;
            },
            getCellFailures: function () {
                return _.map(this.getFailures(), 'status');
            }
        };

        // static methods, assigned to class
        JobTypeStatus.build = function (data) {
            if (data) {
                return new JobTypeStatus(
                    data.job_type,
                    data.job_counts
                );
            }
            return new JobTypeStatus();
        };

        JobTypeStatus.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(JobTypeStatus.build)
                    .filter(Boolean);
            }
            return JobTypeStatus.build(data);
        };

        return JobTypeStatus;
    }]);
})();

(function (){
    'use strict';

    angular.module('scaleApp').factory('Product', ['JobType', 'scaleService', 'scaleConfig', function (JobType, scaleService, scaleConfig) {
        var Product = function (id, workspace, file_name, media_type, file_size, data_type, is_deleted, uuid, url, created, deleted, data_started, data_ended, geometry, center_point, meta_data, countries, last_modified, is_operational, is_published, published, unpublished, job_type, job, job_exe, update, source_files) {
            this.id = id;
            this.workspace = workspace;
            this.file_name = file_name;
            this.media_type = media_type;
            this.file_size = file_size;
            this.file_size_readable = this.getReadableFileSize();
            this.data_type = data_type;
            this.is_deleted = is_deleted;
            this.uuid = uuid;
            this.url = url;
            this.created = created;
            this.created_formatted = created ? moment.utc(created).toISOString() : created;
            this.deleted = deleted;
            this.data_started = data_started;
            this.data_ended = data_ended;
            this.geometry = geometry;
            this.center_point = center_point;
            this.meta_data = meta_data;
            this.countries = countries;
            this.last_modified = last_modified;
            this.last_modified_formatted = last_modified ? moment.utc(last_modified).toISOString() : last_modified;
            this.is_operational = is_operational;
            this.is_operational_label = is_operational ? 'Operational' : 'R&amp;D';
            this.is_published = is_published;
            this.published = published;
            this.unpublished = unpublished;
            this.job_type = JobType.transformer(job_type);
            this.job = job;
            this.job_exe = job_exe;
            this.update = update;
            this.source_files = source_files;
        };

        // public methods
        Product.prototype = {
            getDuration: function () {
                return moment.utc(this.last_modified).diff(moment.utc(this.created));
            },
            getReadableFileSize: function () {
                return scaleService.calculateFileSizeFromBytes(this.file_size);
            }
        };

        // static methods, assigned to class
        Product.build = function (data) {
            if (data) {
                return new Product(
                    data.id,
                    data.workspace,
                    data.file_name,
                    data.media_type,
                    data.file_size,
                    data.data_type,
                    data.is_deleted,
                    data.uuid,
                    data.url,
                    data.created,
                    data.deleted,
                    data.data_started,
                    data.data_ended,
                    data.geometry,
                    data.center_point,
                    data.meta_data,
                    data.countries,
                    data.last_modified,
                    data.is_operational,
                    data.is_published,
                    data.published,
                    data.unpublished,
                    data.job_type,
                    data.job,
                    data.job_exe,
                    data.update,
                    data.source_files
                );
            }
            return new Product();
        };

        Product.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Product.build)
                    .filter(Boolean);
            }
            return Product.build(data);
        };

        return Product;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('RunningJob', ['scaleConfig', 'scaleService', 'JobType', function (scaleConfig, scaleService, JobType) {
        var RunningJob = function (count, longest_running, job_type) {
            this.count = count;
            this.longest_running = longest_running;
            this.job_type = JobType.transformer(job_type);
        };

        // public methods
        RunningJob.prototype = {
            getDuration: function () {
                return scaleService.calculateDuration(this.longest_running, moment.utc().toISOString());
            },
            getIcon: function () {
                var icon = this.job_type.icon_code ? '<i class="fa">&#x' + this.job_type.icon_code + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
                return icon;
            }
        };

        // static methods, assigned to class
        RunningJob.build = function (data) {
            if (data) {
                return new RunningJob(
                    data.count,
                    data.longest_running,
                    data.job_type
                );
            }
            return new RunningJob();
        };

        RunningJob.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RunningJob.build)
                    .filter(Boolean);
            }
            return RunningJob.build(data);
        };

        return RunningJob;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('SystemFailure', ['scaleConfig', 'scaleService', function (scaleConfig, scaleService) {
        var SystemFailure = function (count, job_type_name, job_type_version, error_name, first_error, last_error) {
            this.count = count;
            this.job_type_name = job_type_name;
            this.job_type_version = job_type_version;
            this.error_name = error_name;
            this.first_error = first_error;
            this.last_error = last_error;
        };

        // public methods
        SystemFailure.prototype = {
            getDuration: function () {
                return scaleService.calculateDuration(this.first_error, this.last_error);
            },
            getIcon: function () {
                var configJobType = _.find(scaleConfig.jobTypes, 'title', this.job_type_name);
                if (configJobType) {
                    return configJobType.icon;
                }
                return scaleConfig.defaultIcon;
            }
        };

        // static methods, assigned to class
        SystemFailure.build = function (data) {
            if (data) {
                return new SystemFailure(
                    data.count,
                    data.job_type_name,
                    data.job_type_version,
                    data.error_name,
                    data.first_error,
                    data.last_error
                );
            }
            return new SystemFailure();
        };

        SystemFailure.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(SystemFailure.build)
                    .filter(Boolean);
            }
            return SystemFailure.build(data);
        };

        return SystemFailure;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('loadController', ['$scope', '$location', 'scaleService', 'navService', 'loadService', 'uiGridConstants', 'scaleConfig', 'subnavService', 'QueueStatus', 'gridFactory', function($scope, $location, scaleService, navService, loadService, uiGridConstants, scaleConfig, subnavService, QueueStatus, gridFactory) {
        $scope.loading = true;
        $scope.queueStatusError = null;
        $scope.queueStatusErrorStatus = null;
        $scope.totalQueued = 0;
        $scope.gridStyle = '';
        $scope.subnavLinks = scaleConfig.subnavLinks.load;
        subnavService.setCurrentPath('load');

        $scope.getPage = function (pageNumber, pageSize) {
            $scope.loading = true;
            loadService.getQueueStatus(pageNumber - 1, pageSize).then(function (data) {
                var newData = [];
                for (var i = 0; i < $scope.gridOptions.paginationPageSize; i++) {
                    newData.push(data.jobs[i]);
                }
                $scope.gridOptions.data = newData;
            }).catch(function (error) {
                $scope.status = 'Unable to load queue status: ' + error.message;
                console.error($scope.status);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var initialize = function() {
            $scope.gridOptions = gridFactory.defaultGridOptions();
            $scope.gridOptions.enableSorting = false;
            $scope.gridOptions.columnDefs = [
                    {
                        field: 'job_type.title',
                        displayName: 'Job Type',
                        enableFiltering: false,
                        cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.getIcon()"></span> {{ row.entity.job_type.title }}</div>'
                    },
                    { field: 'job_type.version', displayName: 'Version', enableFiltering: false },
                    { field: 'highest_priority', enableFiltering: false },
                    {
                        field: 'longestQueued',
                        displayName: 'Duration of Longest Queued Job',
                        enableFiltering: false,
                        cellTemplate: '<div class="ui-grid-cell-contents text-right">{{ row.entity.getDuration() }}</div>'
                    },
                    { field: 'count', enableFiltering: false }
                ];
            $scope.gridOptions.data = [];
            $scope.gridOptions.onRegisterApi = function (gridApi) {
                    //set gridApi on scope
                    $scope.gridApi = gridApi;
                    gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                        $scope.$apply(function () {
                            $location.path('/jobs').search({job_type_id: row.entity.job_type.id, status: 'QUEUED'});
                        });
                    });
                    $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                        $scope.getPage(currentPage, pageSize);
                    });
                };


            loadService.getQueueStatus(0, $scope.gridOptions.paginationPageSize).then(null, null, function (result) {
                if (result.$resolved) {
                    $scope.gridOptions.data = result.results;
                    $scope.gridOptions.totalItems = result.results.length;
                    $scope.totalQueued = _.sum(result.results, 'count');
                    console.log('queue status updated');
                } else {
                    if (result.statusText && result.statusText !== '') {
                        $scope.queueStatusErrorStatus = result.statusText;
                    }
                    $scope.queueStatusError = 'Unable to retrieve queue status.';
                }
                $scope.loading = false
            });

            navService.updateLocation('load');
        };
        initialize();

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                gridMaxHeight = viewport.height - offset;

            $scope.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px; overflow-y: auto;';
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('loadDepthController', ['$scope', '$location', 'navService', 'scaleConfig', 'subnavService', function ($scope, $location, navService, scaleConfig, subnavService) {
        $scope.subnavLinks = scaleConfig.subnavLinks.load;
        subnavService.setCurrentPath('load/depth');

        $scope.loading = false;

        var initialize = function () {
            navService.updateLocation('load');
        };

        initialize();
    }]);
})();

(function(){
    'use strict';

    angular.module('scaleApp').controller('queueRunningController', ['$scope', '$location', 'scaleService', 'navService', 'jobService', 'gridFactory', 'uiGridConstants', 'scaleConfig', 'subnavService', function($scope, $location, scaleService, navService, jobService, gridFactory, uiGridConstants, scaleConfig, subnavService) {
        $scope.loading = true;
        $scope.runningJobsError = null;
        $scope.runningJobsErrorStatus = null;
        $scope.totalRunning = 0;
        $scope.gridStyle = '';
        $scope.subnavLinks = scaleConfig.subnavLinks.load;
        subnavService.setCurrentPath('load/running');

        $scope.getPage = function (pageNumber, pageSize){
            $scope.loading = true;
            jobService.getRunningJobsOnce(pageNumber - 1, pageSize).then(function (data) {
                var newData = [];
                for(var i = 0; i < $scope.gridOptions.paginationPageSize; i++){
                    newData.push(data.results[i]);
                }
                $scope.gridOptions.data = newData;
            }).catch(function(error){
                $scope.status = 'Unable to load queue running status: ' + error.message;
                console.error($scope.status);
            }).finally(function(){
                $scope.loading = false;
            });
        };

        var initialize = function() {
            $scope.gridOptions = gridFactory.defaultGridOptions();
            $scope.gridOptions.enableSorting = false;
            $scope.gridOptions.columnDefs = [
                {
                    field: 'title',
                    displayName: 'Job Type',
                    enableFiltering: false,
                    cellTemplate: '<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.getIcon()"></span> {{ row.entity.job_type.title }}</div>'
                },
                {field: 'job_type.version', displayName: 'Version', enableFiltering: false},
                {field: 'count', displayName: 'Number of Jobs', enableFiltering: false},
                {
                    field: 'longestRunning',
                    displayName: 'Duration of Longest Running Job',
                    enableFiltering: false,
                    cellTemplate: '<div class="ui-grid-cell-contents text-right">{{ row.entity.getDuration() }}</div>'
                }
            ];
            $scope.gridOptions.data = [];
            $scope.gridOptions.onRegisterApi = function (gridApi) {
                // set gridApi on scope
                $scope.gridApi = gridApi;
                gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                    $scope.$apply(function(){
                        $location.path('/jobs').search({job_type_id: row.entity.job_type.id, status: 'RUNNING'});
                    });
                });
                $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                    $scope.getPage(currentPage, pageSize);
                });
            };

            jobService.getRunningJobs(0, $scope.gridOptions.paginationPageSize).then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.gridOptions.data = data.results;
                    $scope.gridOptions.totalItems = data.results.length;
                    $scope.totalRunning = _.sum(data.results, 'count');
                    console.log('running jobs updated');
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.runningJobsErrorStatus = data.statusText;
                    }
                    $scope.runningJobsError = 'Unable to retrieve running jobs.';
                }
                $scope.loading = false;
            });
            navService.updateLocation('load');
        };
        initialize();

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                gridMaxHeight = viewport.height - offset;

            $scope.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px; overflow-y: auto;';
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('jobExecutionService', ['$http', '$q', '$resource', 'poller', 'scaleConfig', 'JobExecution', 'JobExecutionLog', function ($http, $q, $resource, poller, scaleConfig, JobExecution, JobExecutionLog) {

        var getJobExecutionsParams = function( pageNumber, pageSize, filter ){
            var params = {
                page: pageNumber,
                page_size: pageSize
            };
            var jobTypeId = filter.job_type_id ? filter.jobTypeId : '';
            var jobStatus = filter.status ? filter.jobStatus : '';

            if (jobStatus && jobStatus !== '') {
                params.job_status = jobStatus;
            }
            return params;
        };

        return {
            getJobExecutions: function (pageNumber, pageSize, filter) {
                var jobExecutions = [],
                    d = $q.defer();

                var params = getJobExecutionsParams(pageNumber, pageSize, filter);
                $http({
                    url: scaleConfig.urls.apiPrefix + 'job-executions/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    jobExecutions.executions = JobExecution.transformer(data.results);
                    jobExecutions.count = data.count;
                    d.resolve(jobExecutions);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getJobExecutionDetails: function (id) {
                var d = $q.defer();

                $http.get(scaleConfig.urls.apiPrefix + 'job-executions/' + id + '/').success(function (data) {
                    d.resolve(JobExecution.transformer(data));
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getLogOnce: function(execId){
                var d = $q.defer();

                $http.get(scaleConfig.urls.apiPrefix + 'job-executions/' + execId + '/logs/').success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getLog: function(execId){
                var url = url || scaleConfig.urls.apiPrefix + 'job-executions/' + execId + '/logs/';

                // Update view. Since a promise can only be resolved or rejected once but we want
                // to keep track of all requests, poller service uses the notifyCallback. By default
                // poller only gets notified of success responses.
                var jobExecutionLogResource = $resource(url);
                var jobExecutionLogPoller = poller.get(jobExecutionLogResource, {
                        delay: scaleConfig.pollIntervals.jobExecutionLog
                    });

                return jobExecutionLogPoller.promise.then(null, null, function (result) {
                    if(result.$resolved){
                        result.execution_log = JobExecutionLog.transformer(result);
                        if(result.execution_log.status === 'COMPLETED' || result.execution_log.status === 'FAILED'){
                            jobExecutionLogPoller.stop();
                        }
                        return result;
                    } else {
                        jobExecutionLogPoller.stop();
                        return result;
                    }

                });
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('jobService', ['$http', '$q', '$resource', 'scaleConfig', 'Job', 'JobDetails', 'RunningJob', 'poller', 'pollerFactory', function($http, $q, $resource, scaleConfig, Job, JobDetails, RunningJob, poller, pollerFactory) {

        var getJobsParams = function (page, page_size, started, ended, order, status, job_type_id, job_type_name, job_type_category, url) {
            return {
                page: page,
                page_size: page_size,
                started: started,
                ended: ended,
                order: order,
                status: status,
                job_type_id: job_type_id,
                job_type_name: job_type_name,
                job_type_category: job_type_category,
                url: url
            };
        };

        var getJobUpdateData = function (status) {
            return {
                status: status
            };
        };

        return {
            getJobs: function (params) {
                params = params || getJobsParams();
                params.url = params.url ? params.url : scaleConfig.urls.apiPrefix + 'jobs/';

                var jobsResource = $resource(params.url, params),
                    jobsPoller = pollerFactory.newPoller(jobsResource, scaleConfig.pollIntervals.jobs);

                return jobsPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        data.results = Job.transformer(data.results);
                    } else {
                        jobsPoller.stop();
                    }
                    return data;
                });
            },
            getJobsOnce: function (params) {
                params = params || getJobsParams();
                var d = $q.defer();

                $http({
                    url: params.url ? params.url : scaleConfig.urls.apiPrefix + 'jobs/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = Job.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            },
            getJobCountsByStatus: function (hour) {
                hour = hour || 3;
                var d = $q.defer();

                $http.get(scaleConfig.urls.getJobCountsByStatus(hour)).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getJobDetail: function (id) {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'jobs/' + id + '/').success(function (data) {
                    d.resolve(JobDetails.transformer(data));
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getRunningJobs: function (pageNumber, pageSize) {
                var params = {
                    pageNumber: pageNumber,
                    pageSize: pageSize
                };
                var runningJobsResource = $resource(scaleConfig.urls.apiPrefix + 'job-types/running/', params),
                    runningJobsPoller = pollerFactory.newPoller(runningJobsResource, scaleConfig.pollIntervals.runningJobs);

                return runningJobsPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        data.results = RunningJob.transformer(data.results);
                    } else {
                        runningJobsPoller.stop();
                    }
                    return data;
                });
            },
            getRunningJobsOnce: function (pageNumber, pageSize) {
                var params = {
                    pageNumber: pageNumber,
                    pageSize: pageSize
                };
                var d = $q.defer();

                $http.get(scaleConfig.urls.apiPrefix + 'job-types/running/', params).success(function (data) {
                    data.results = RunningJob.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            updateJob: function (id, data) {
                data = data || getJobUpdateData();
                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'jobs/' + id + '/',
                    method: 'PATCH',
                    data: data
                }).success(function (result) {
                    d.resolve(result);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('jobTypeService', ['$http', '$q', '$resource', 'poller', 'pollerFactory', 'scaleConfig', 'jobService', 'JobType', 'JobTypeDetails', 'JobTypeStatus', function ($http, $q, $resource, poller, pollerFactory, scaleConfig, jobService, JobType, JobTypeDetails, JobTypeStatus) {
        /*var totalJobTypes = 5;

        var getTotalJobTypes = function () {
            return totalJobTypes;
        };

        var setTotalJobTypes = function () {
            totalJobTypes = Math.floor(Math.random() * (20 - 1 + 1)) + 1;
        };

        setInterval(function () {
            setTotalJobTypes();
        }, 3100);*/

        var getJobTypeParams = function (page, page_size, started, ended, name, category, order) {
            return {
                page: page,
                page_size: page_size,
                started: started,
                ended: ended,
                name: name,
                category: category,
                order: order ? order : ['name', 'version']
            };
        };

        var getJobTypeStatusParams = function (page, page_size, started, ended) {
            var params = {};

            if (page) { params.page = page; }
            if (page_size) { params.page_size = page_size; }
            if (started) { params.started = started; }
            if (ended) { params.ended = ended; }

            return params;
        };

        return {
            getJobTypes: function (params) {
                params = params || getJobTypeParams();
                // var params = {
                //     order: order || ['name','version']
                // };

                var jobTypesResource = $resource(scaleConfig.urls.apiPrefix + 'job-types/', params),
                    jobTypesPoller = pollerFactory.newPoller(jobTypesResource, scaleConfig.pollIntervals.jobTypes);

                return jobTypesPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        /*var returnResult = {
                            $resolved: true,
                            job_types: []
                        };
                        for (var i = 1; i < getTotalJobTypes(); i++) {
                            returnResult.job_types.push(
                                {
                                    "is_system": true,
                                    "paused": null,
                                    "disk": 64.0,
                                    "id": i,
                                    "docker_image": null,
                                    "archived": null,
                                    "uses_docker": false,
                                    "priority": 10,
                                    "version": "1.0",
                                    "icon_code": scaleConfig.jobTypes[i - 1].code,
                                    "description": "Ingests a source file into a workspace",
                                    "mem": 64.0,
                                    "is_active": true,
                                    "cpus": 1.0,
                                    "last_modified": "2015-03-11T00:00:00Z",
                                    "max_tries": 3,
                                    "is_paused": false,
                                    "name": scaleConfig.jobTypes[i - 1].title,
                                    "created": "2015-03-11T00:00:00Z",
                                    "timeout": 1800,
                                    "is_long_running": false
                                }
                            )
                        }
                        result = returnResult;*/

                        data.results = JobType.transformer(data.results);
                        return data;
                    } else {
                        jobTypesPoller.stop();
                        return data;
                    }
                });
            },
            getJobTypesOnce: function (params) {
                params = params || getJobTypeParams();

                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'job-types/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = JobType.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getJobTypeStatus: function (page, page_size, started, ended) {
                var params = getJobTypeStatusParams(page, page_size, started, ended);

                var jobTypeStatusResource = $resource(scaleConfig.urls.apiPrefix + 'job-types/status/', params),
                    jobTypeStatusPoller = pollerFactory.newPoller(jobTypeStatusResource, scaleConfig.pollIntervals.jobTypeStatus);

                return jobTypeStatusPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        /*var returndata = {
                            $resolved: true,
                            job_type_stats: []
                        };
                        for (var i = 0; i < getTotalJobTypes(); i++) {
                            returndata.job_type_stats.push(
                                {
                                    "id": i,
                                    "icon_code": "",
                                    "name": "",
                                    "version": "",
                                    "num_completed": Math.floor(Math.random() * (20000 - 10000 + 1)) + 10000,
                                    "num_canceled": Math.floor(Math.random() * (100 - 20 + 1)) + 20,
                                    "num_error_DATA": Math.floor(Math.random() * (9000 - 20 + 1)) + 20,
                                    "num_error_SYSTEM": Math.floor(Math.random() * (9000 - 20 + 1)) + 20,
                                    "num_error_ALGORITHM": Math.floor(Math.random() * (9000 - 20 + 1)) + 20
                                }
                            )
                        }
                        data = returndata;*/

                        data.results = JobTypeStatus.transformer(data.results);
                    } else {
                        jobTypeStatusPoller.stop();
                    }
                    return data;
                });
            },
            getJobTypeStatusOnce: function (page, page_size, started, ended) {
                var d = $q.defer(),
                    params = getJobTypeStatusParams(page, page_size, started, ended);

                $http({
                    url: scaleConfig.urls.apiPrefix + 'job-types/status/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = JobTypeStatus.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getJobTypeDetails: function (id) {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'job-types/' + id + '/').success(function (data) {
                    d.resolve(JobTypeDetails.transformer(data));
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            updateJobType: function (data){
                var updatedJobType = function(data){
                    return {
                        error_mappings: data.error_mappings,
                        is_paused: data.is_paused
                    };
                };
                var updatedData = updatedJobType(data);
                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'job-types/' + data.id + '/',
                    method: 'PATCH',
                    data: updatedData
                }).success(function (result) {
                    d.resolve(JobTypeDetails.transformer(result));
                }).error(function (error) {
                    d.reject(error);
                });                
                return d.promise;
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('QueueStatus', ['scaleConfig', 'scaleService', 'JobType', function (scaleConfig, scaleService, JobType) {
        var QueueStatus = function (job_type, count, longest_queued, highest_priority) {
            this.job_type = JobType.transformer(job_type);
            this.count = count;
            this.longest_queued = longest_queued;
            this.highest_priority = highest_priority;
        };

        // public methods
        QueueStatus.prototype = {
            getIcon: function () {
                return this.job_type.icon_code ? '<i class="fa">&#x' + this.job_type.icon_code + '</i>' : '<i class="fa">&#x' + scaleConfig.defaultIconCode + '</i>';
            },
            getDuration: function () {
                return scaleService.calculateDuration(this.longest_queued, moment.utc().toISOString());
            }
        };

        // static methods, assigned to class
        QueueStatus.build = function (data) {
            if (data) {
                return new QueueStatus(
                    data.job_type,
                    data.count,
                    data.longest_queued,
                    data.highest_priority
                );
            }
            return new QueueStatus();
        };

        QueueStatus.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(QueueStatus.build);
            }
            return QueueStatus.build(data);
        };

        return QueueStatus;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('loadService', ['$http', '$q', '$resource', 'scaleConfig', 'poller', 'pollerFactory', 'QueueStatus', function($http, $q, $resource, scaleConfig, poller, pollerFactory, QueueStatus) {
        var getJobLoadParams = function (page, page_size, started, ended, order, status, job_type_id, job_type_name, job_type_category, url) {
            return {
                started: started,
                ended: ended,
                job_type_id: job_type_id,
                job_type_name: job_type_name,
                job_type_category: job_type_category,
                page_size: 1000,
                url: url
            };
        };

        var getRequeueJobsParams = function (started, ended, job_status, job_type_ids, job_type_names, job_type_categories, priority, url) {
            return {
                started: started,
                ended: ended,
                job_status: job_status,
                job_ids: job_ids,
                job_type_ids: job_type_ids,
                job_type_names: job_type_names,
                job_type_categories: job_type_categories,
                priority: priority,
                url: url
            };
        };

        return {
            getQueueStatus: function (pageNumber, pageSize) {
                var params = {
                    page_number: pageNumber,
                    page_size: pageSize
                };

                var queueStatusResource = $resource(scaleConfig.urls.apiPrefix + 'queue/status/', params),
                    queueStatusPoller = pollerFactory.newPoller(queueStatusResource, scaleConfig.pollIntervals.queueStatus);

                return queueStatusPoller.promise.then(null, null, function (result) {
                    if (result.$resolved) {
                        result.results = QueueStatus.transformer(result.results);
                    } else {
                        queueStatusPoller.stop();
                    }
                    return result;
                });
            },
            getQueueStatusOnce: function () {
                var d = $q.defer();

                $http.get(scaleConfig.urls.apiPrefix + 'queue/status/').success(function (data) {
                    data.results = QueueStatus.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            },
            requeueJobs: function (params) {
                params = params || getRequeueJobsParams();
                params.url = params.url ? params.url : scaleConfig.urls.apiPrefix + 'queue/requeue-jobs/';

                var d = $q.defer();

                $http.post(params.url, params).success(function (result) {
                    d.resolve(result);
                }).error(function(error){
                    d.reject(error);
                });

                return d.promise;
            },
            getJobLoad: function (params) {
                params = params || getJobLoadParams();
                params.url = params.url ? params.url : scaleConfig.urls.apiPrefix + 'load/';

                var jobLoadResource = $resource(params.url, params),
                    jobLoadPoller = pollerFactory.newPoller(jobLoadResource, scaleConfig.pollIntervals.jobLoad);

                return jobLoadPoller.promise.then(null, null, function (data) {
                    if (!data.$resolved) {
                        jobLoadPoller.stop();
                    }
                    return data;
                });
            },
            getJobLoadOnce: function (params) {
                params = params || getJobLoadParams();
                var d = $q.defer();

                $http({
                    url: params.url ? params.url : scaleConfig.urls.apiPrefix + 'load/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('metricsController', ['$scope', '$location', 'scaleConfig', 'scaleService', 'navService', 'metricsService', 'moment', function ($scope, $location, scaleConfig, scaleService, navService, metricsService, moment) {
        var chart = null,
            colArr = [],
            colNames = {},
            xArr = [],
            removeIds = [],
            yUnits = [],
            locationParams = {
                chart: null
            },
            self = this;

        $scope._ = _;
        $scope.moment = moment;
        $scope.loadingMetrics = false;
        $scope.chartArr = [];
        $scope.chartData = [];
        $scope.chartStyle = '';
        $scope.selectedDataType = {};
        $scope.inputStartDate = moment.utc().subtract(1, 'M').toDate();
        $scope.inputEndDate = moment.utc().toDate();
        $scope.openInputStart = function ($event) {
            $event.stopPropagation();
            $scope.inputStartOpened = true;
        };
        $scope.inputStartOpened = false;
        $scope.openInputEnd = function ($event) {
            $event.stopPropagation();
            $scope.inputEndOpened = true;
        };
        $scope.inputEndOpened = false;
        $scope.dateModelOptions = {
            timezone: '+000'
        };
        $scope.dataTypeFilterText = '';
        $scope.filtersApplied = [];
        $scope.filteredChoices = [];
        $scope.filteredChoicesOptions = [];
        $scope.selectedMetrics = [];
        $scope.columnGroupsOptions = [];
        $scope.columns = [];
        $scope.groups = [];
        $scope.chartTitle = '';
        $scope.chartDisplay = 'stacked';
        $scope.stackedClass = 'btn-primary';
        $scope.groupedClass = 'btn-default';
        $scope.subchartClass = 'btn-primary';
        $scope.subchartEnabled = false;
        $scope.chartType = 'bar';
        $scope.chartTypeDisplay = 'Bar';
        $scope.barClass = 'btn-primary';
        $scope.areaClass = 'btn-default';
        $scope.lineClass = 'btn-default';
        $scope.splineClass = 'btn-default';
        $scope.scatterClass = 'btn-default';

        /*
        // check for locationParams in query string, and update as necessary
        _.forEach(_.pairs(locationParams), function (param) {
            var value = _.at($location.search(), param[0]);
            if (value.length > 0) {
                locationParams[param[0]] = value.length > 1 ? value : value[0];
            }
        });

        if (locationParams.chart) {
            try {
                $scope.chartArr = JSON.parse(atob(locationParams.chart));
            } catch (e) {
                toastr['error']('Unable to parse JSON');
            }
        }
        */

        self.getPlotDataParams = function (obj) {
            return {
                page: null,
                page_size: null,
                started: obj.started,
                ended: obj.ended,
                choice_id: obj.choice_id,
                column: obj.column,
                group: obj.group,
                dataType: obj.dataType.name
            };
        };

        self.resetSelections = function () {
            $scope.inputStartDate = moment.utc().subtract(1, 'M').toDate();
            $scope.inputEndDate = moment.utc().toDate();
            $scope.selectedDataType = {};
            $scope.changeDataTypeSelection();
        };

        self.updateChart = function () {
            $scope.chartData = [];
            if ($scope.chartArr.length === 0) {
                // nothing to show on chart
                chart.destroy();
                chart = null;
            } else {
                var callInit = _.after($scope.chartArr.length, function () {
                    // only initChart after this function has been called for all datasets in chartArr
                    $scope.loadingMetrics = false;
                    self.initChart();
                });

                _.forEach($scope.chartArr, function (obj) {
                    var params = self.getPlotDataParams(obj);
                    metricsService.getPlotData(params).then(function (data) {
                    //metricsService.getGeneratedPlotData({query: obj, params: params}).then(function (data) {
                        $scope.chartData.push({
                            query: obj,
                            results: data.results
                        });
                        callInit();
                    }).catch(function (error) {
                        $scope.loadingMetrics = false;
                        console.log(error);
                        toastr['error'](error);
                    });
                });
                /*
                locationParams.chart = btoa(JSON.stringify($scope.chartArr));
                $location.search('chart', locationParams.chart).replace();
                */
            }
        };

        $scope.addToChart = function () {
            $scope.chartArr = []; // comment this out if allowing multiple adds
            $scope.loadingMetrics = true;
            var filteredChoices = [],
                selectedColumns = [];
            // find the filter object associated with the chosen filter IDs
            _.forEach($scope.filtersApplied, function (id) {
                filteredChoices.push(_.find($scope.filteredChoices, { id: parseInt(id) }));
            });
            if (angular.isArray($scope.selectedMetrics)) {
                _.forEach($scope.selectedMetrics, function (metric) {
                    selectedColumns.push(_.find($scope.columns, { name: metric }));
                });
            } else {
                selectedColumns.push(_.find($scope.columns, { name: $scope.selectedMetrics }));
            }
            $scope.chartArr.push({
                started: $scope.inputStartDate.toISOString(),
                ended: $scope.inputEndDate.toISOString(),
                choice_id: $scope.filtersApplied,
                column: _.pluck(selectedColumns, 'name'),
                group: null,
                dataType: $scope.selectedDataType,
                filtersApplied: filteredChoices,
                selectedMetrics: selectedColumns
            });
            self.updateChart();
            //self.resetSelections();
        };

        $scope.deleteFromChart = function (objToDelete) {
            _.remove($scope.chartArr, function (obj) {
                return JSON.stringify(obj) === JSON.stringify(objToDelete);
            });
            self.updateChart();
        };

        $scope.getFilterOptions = function (param) {
            return _.uniq(_.pluck($scope.filteredChoices, param));
        };

        $scope.changeDataTypeSelection = function () {
            // reset options
            $scope.filtersApplied = [];
            //$scope.filteredChoices = [];
            $scope.selectedDataTypeOptions = [];
            $scope.dataTypeFilterText = '';
            $scope.selectedMetrics = [];
            //$scope.columnGroups = [];
            $scope.columns = [];

            if (!$scope.selectedDataType.name || $scope.selectedDataType.name === '') {
                $scope.selectedDataType = {};
                self.getDataTypes();
            } else {
                self.getDataTypeOptions($scope.selectedDataType);
            }
        };

        /*$scope.changeFilterSelection = function (name) {
            console.log(name + ': ' + $scope.filtersApplied[name]);
            // remove filter if value is null or empty
            if (!$scope.filtersApplied[name] || $scope.filtersApplied[name] === '') {
                delete $scope.filtersApplied[name];
            }
            // update filtered choices
            applyFiltersToChoices();
        };*/

        $scope.areFiltersApplied = function () {
            return $scope.filtersApplied.length > 0;
        };

        /*$scope.removeFilter = function (name) {
            // set value = null
            $scope.filtersApplied[name] = '';
            // trigger filter selection change
            $scope.changeFilterSelection(name);
        };*/

        $scope.updateChartDisplay = function (display) {
            $scope.chartDisplay = display;
            $scope.stackedClass = display === 'stacked' ? 'btn-primary' : 'btn-default';
            $scope.groupedClass = display === 'grouped' ? 'btn-primary' : 'btn-default';
            self.initChart();
        };

        $scope.updateChartType = function (type) {
            $scope.chartType = type;
            $scope.chartTypeDisplay = _.capitalize(type);
            $scope.barClass = type === 'bar' ? 'btn-primary' : 'btn-default';
            $scope.areaClass = type === 'area' ? 'btn-primary' : 'btn-default';
            $scope.lineClass = type === 'line' ? 'btn-primary' : 'btn-default';
            $scope.splineClass = type === 'spline' ? 'btn-primary' : 'btn-default';
            $scope.scatterClass = type === 'scatter' ? 'btn-primary' : 'btn-default';
            self.initChart();
        };

        $scope.toggleSubchart = function () {
            $scope.subchartEnabled = !$scope.subchartEnabled;
            if ($scope.subchartEnabled) {
                $scope.subchartClass = 'btn-primary';
            } else {
                $scope.subchartClass = 'btn-default';
            }
        };

        self.initialize = function () {
            navService.updateLocation('metrics');
            self.getDataTypes();
            /*
            if ($scope.chartArr.length > 0) {
                self.updateChart();
            }
            */
        };

        /*var applyFiltersToChoices = function () {
            var choices = $scope.selectedDataTypeOptions ? $scope.selectedDataTypeOptions.choices : [];
            var filteredChoices = _.where(choices,$scope.filtersApplied);
            $scope.filteredChoices = filteredChoices;
        };*/

        self.getDataTypes = function () {
            metricsService.getDataTypes().then(function (result) {
                $scope.availableDataTypes = result.results;
            }).catch(function (error) {
                console.log(error);
                toastr['error'](error);
            });
        };

        self.getDataType = function (id) {
            metricsService.getDataTypeMetrics(id).then(function (result) {
                $scope.selectedDataTypeAvailableMetrics = result.metrics;
            }).catch(function (error) {
                console.log(error);
            });
        };

        self.getDataTypeOptions = function (dataType) {
            metricsService.getDataTypeOptions(dataType.name).then(function (result) {
                $scope.selectedDataTypeOptions = result;
                _.forEach(result.filters, function (filter) {
                    $scope.dataTypeFilterText = $scope.dataTypeFilterText.length === 0 ? _.capitalize(filter.param) : $scope.dataTypeFilterText + ', ' + _.capitalize(filter.param);
                });
                $scope.filteredChoices = _.sortByOrder(result.choices, ['title','version'], ['asc','asc']);
                // format filteredChoices for use with multiselect directive
                var filteredChoicesOptions = [];
                _.forEach($scope.filteredChoices, function (choice) {
                    filteredChoicesOptions.push({
                        label: choice.version ? choice.title + ' ' + choice.version : choice.title,
                        title: choice.version ? choice.title + ' ' + choice.version : choice.title,
                        value: choice.id
                    });
                });
                $scope.filteredChoicesOptions = filteredChoicesOptions;
                $scope.columns = _.sortByOrder(result.columns, ['title'], ['asc']);
                $scope.groups = result.groups;

                // create an array of objects containing grouped columns
                var columnGroupsOptions = [],
                    columnGroups = _.pairs(_.groupBy(result.columns, 'group'));
                _.forEach(columnGroups, function (group) {
                    var option = {
                        label: _.find($scope.groups, { name: group[0] }).title,
                        children: []
                    };
                    _.forEach(group[1], function (column) {
                        var child = {
                            label: column.title,
                            title: column.title,
                            value: column.name
                        };
                        option.children.push(child);
                    });
                    columnGroupsOptions.push(option);
                });
                columnGroupsOptions.unshift({
                    label: 'None Selected',
                    title: 'None Selected',
                    value: ''
                });
                $scope.columnGroupsOptions = columnGroupsOptions;
            }).catch(function (error){
                console.log(error);
                toastr['error'](error);
            });
        };

        self.initialize();

        $scope.$watch('inputEndDate', function (value) {
            console.log(value)
        });

        // set up chart
        self.initChart = function () {
            // mark any existing data for removal
            // compare currCols (columns currently in the chart) with displayCols (columns to display)
            removeIds = [];
            var currCols = [],
                displayCols = [];
            _.forEach(colArr, function (col, idx) {
                if (idx > 0) {
                    currCols.push(col[0]);
                }
            });
            _.forEach($scope.chartData, function (d) {
                displayCols = displayCols.concat(_.pluck(d.query.filtersApplied, 'name'));
            });
            // determine the exact differences between currCols and displayCols
            // if none are found, then removeIds stays empty
            _.forEach(currCols, function (currCol) {
                var displayCol = _.find(displayCols, function (dCol) {
                    return dCol === currCol;
                });
                if (!displayCol) {
                    removeIds.push(currCol);
                }
            });

            // init with new data
            colArr = [];
            xArr = [];
            colNames = {};

            // create xArr
            var numDays = moment.utc($scope.inputEndDate).endOf('d').diff(moment.utc($scope.inputStartDate.toISOString()).startOf('d'), 'd') + 1; // add 1 to include starting day in count
            for (var i = 0; i < numDays; i++) {
                xArr.push(moment.utc($scope.inputStartDate.toISOString()).startOf('d').add(i, 'd').toDate());
            }

            // iterate over datatypes and add values to colArr
            _.forEach($scope.chartData, function (data) {
                var valueArr = [],
                    query = data.query,
                    queryFilter = {},
                    queryDates = [];

                yUnits = _.pluck(query.selectedMetrics, 'units');

                if (query.filtersApplied.length > 0) {
                    // filters were applied, so build data source accordingly
                    _.forEach(data.results, function (result) {
                        if (result.values.length > 0) {
                            // values for all filters are returned in one array of arrays,
                            // so group results by id to isolate filter values
                            var groupedResult = _.groupBy(result.values, 'id'),
                                resultObj = {},
                                filterIds = _.pluck(query.filtersApplied, 'id');
                            // try to get each filter id from groupedResult.
                            // if it's undefined, an empty array will be returned
                            // this allows a zeroed array to appear in the chart,
                            // since we want to include all filters selected by the user
                            // regardless of value
                            if (filterIds.length > 1) {
                                // when more than one filter is requested, then an id
                                // value is present within data.results
                                _.forEach(filterIds, function (id) {
                                    resultObj[id] = _.get(groupedResult, id, []);
                                });
                            } else {
                                // when one filter is requested, no id value is included
                                // in data.results, so build resultObj with the other
                                // info we have
                                resultObj[query.choice_id[0]] = _.pairs(groupedResult)[0][1];
                            }
                            _.forEach(_.pairs(resultObj), function (d) {
                                valueArr = [];
                                // d[0] will be choice id, d[1] will be values
                                // if only one filter was selected, d[0] will return as string 'undefined' since no id is included in this case
                                queryFilter = d[0] === 'undefined' ? query.filtersApplied[0] : _.find(query.filtersApplied, {id: parseInt(d[0])});
                                queryDates = d[1];

                                // add result values to valueArr
                                _.forEach(xArr, function (xDate) {
                                    var valueObj = _.find(queryDates, function (qDate) {
                                        return moment.utc(qDate.date).isSame(xDate, 'day');
                                    });
                                    // push 0 if data for xDate is not present in queryDates
                                    valueArr.push(valueObj ? valueObj.value : 0);
                                });

                                // prepend valueArr with filter title, and push onto colArr
                                valueArr.unshift(queryFilter.name + queryFilter.id);
                                colNames[queryFilter.name + queryFilter.id] = queryFilter.version ? queryFilter.title + ' ' + queryFilter.version : queryFilter.title;
                                colArr.push(valueArr);
                            });
                        }
                    });
                } else {
                    // no filters were applied, so show aggregate statistics
                    _.forEach(data.results, function (result) {
                        // add result values to valueArr
                        _.forEach(xArr, function (xDate) {
                            var valueObj = _.find(result.values, function (qDate) {
                                return moment.utc(qDate.date).isSame(xDate, 'day');
                            });
                            // push 0 if data for xDate is not present in result.values
                            valueArr.push(valueObj ? valueObj.value : 0);
                        });

                        // prepend valueArr with filter title, and push onto colArr
                        var columnLabel = result.column.title + ' for all ' + query.dataType.title;
                        valueArr.unshift(columnLabel);
                        colNames['aggregate'] = columnLabel;
                        colArr.push(valueArr);
                    });
                }
            });

            // inform the user if the metrics they selected are empty
            if (_.sum(_.flatten(colArr)) === 0) {
                toastr['info']('There is no data to display.');
            }

            // prepend xArr with an 'x' label and add to colArr
            xArr.unshift('x');
            colArr.unshift(xArr);

            var types = {},
                type = {},
                groups = [];

            _.forEach(colArr, function (col) {
                type = {};
                if (col[0] !== 'x') {
                    type[col[0]] = $scope.chartType;
                    if ($scope.chartDisplay === 'stacked') {
                        groups.push(col[0]);
                    }
                }
                angular.extend(types, type);
            });

            if (chart) {
                // chart already exists, so update values
                chart.groups([groups]);
                chart.data.names(colNames);
                chart.axis.labels({
                    y: _.capitalize(yUnits[0])
                });
                chart.load({
                    columns: colArr,
                    types: types,
                    unload: removeIds
                });
            } else {
                // no chart yet, so set it up
                chart = c3.generate({
                    bindto: '#metrics',
                    data: {
                        x: 'x',
                        columns: colArr,
                        types: types,
                        groups: [groups],
                        names: colNames
                    },
                    subchart: {
                        show: $scope.subchartEnabled
                    },
                    transition: {
                        duration: 700
                    },
                    color: {
                        pattern: scaleConfig.colors.patternD320
                    },
                    axis: {
                        type: 'timeseries',
                        x: {
                            tick: {
                                format: function (d) {
                                    return moment.utc(d).toISOString();
                                }
                            },
                            label: {
                                text: 'Dates',
                                position: 'outer-center'
                            }
                        },
                        y: {
                            label: {
                                text: _.capitalize(yUnits[0]),
                                position: 'outer-middle'
                            }
                        }
                    }
                });
            }
        };

        // set chart height
        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                chartMaxHeight = viewport.height - offset;

            $scope.chartStyle = 'height: ' + chartMaxHeight + 'px; max-height: ' + chartMaxHeight + 'px;';
        });
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('metricsService', ['$http', '$q', '$resource', 'scaleConfig', function ($http, $q, $resource, scaleConfig) {
        var getPlotDataParams = function (page, page_size, started, ended, choice_id, column, group, dataType) {
            console.log(choice_id);
            return {
                page: page,
                page_size: page_size,
                started: started,
                ended: ended,
                choice_id: choice_id,
                column: column,
                group: group,
                dataType: dataType
            };
        };

        return {
            getDataTypes: function () {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'metrics/').success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getDataTypeMetrics: function (id) {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'metrics/' + id + '/').success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getDataTypeOptions: function (name) {
                var d = $q.defer();
                var url = scaleConfig.urls.apiPrefix + 'metrics/' + name + '/';
                $http.get(url).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getPlotData: function (params) {
                var params = params || getPlotDataParams(),
                    d = $q.defer();

                $http({
                    method: 'GET',
                    url: scaleConfig.urls.apiPrefix + 'metrics/' + params.dataType + '/plot-data/',
                    params: params
                }).success(function (data) {
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            },
            getGeneratedPlotData: function (obj) {
                var d = $q.defer();

                var returnObj = {
                    count: 28,
                    next: null,
                    previous: null,
                    results: []
                };

                var numDays = moment.utc(obj.params.ended).diff(moment.utc(obj.params.started), 'd') + 1;

                _.forEach(obj.query.selectedMetrics, function (metric) {
                    var returnResult = {
                        column: metric,
                        min_x: moment.utc(obj.params.started).format('YYYY-MM-DD'),
                        max_x: moment.utc(obj.params.ended).format('YYYY-MM-DD'),
                        min_y: 1,
                        max_y: 100,
                        values: []
                    };

                    for (var i = 0; i < numDays; i++) {
                        if (obj.query.filtersApplied.length > 1) {
                            _.forEach(obj.query.filtersApplied, function (filter) {
                                returnResult.values.push({
                                    date: moment.utc(obj.params.started).add(i, 'd').format('YYYY-MM-DD'),
                                    value: Math.floor(Math.random() * (1000 - 1 + 1)) + 1,
                                    id: filter.id
                                });
                            });
                        } else {
                            returnResult.values.push({
                                date: moment.utc(obj.params.started).add(i, 'd').format('YYYY-MM-DD'),
                                value: Math.floor(Math.random() * (1000 - 1 + 1)) + 1
                            });
                        }
                    }
                    returnObj.results.push(returnResult);
                });

                d.resolve(returnObj);

                return d.promise;
            }
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('navController', ['$scope', '$location', '$window', 'scaleConfig', 'scaleService', 'stateService', 'navService', function($scope, $location, $window, scaleConfig, scaleService, stateService, navService) {
        document.getElementsByTagName('body')[0].style.backgroundColor = scaleConfig.colors.nav_bg;

        $scope.version = '';
        $scope.activePage = 'overview';
        $scope.docsUrl = scaleConfig.urls.documentation;

        $scope.goto = function(loc) {
            $location.search('');
            $location.path(loc);
        };

        var locationUpdated = function() {
            $scope.activePage = navService.location;
        };

        var initialize = function() {
            navService.registerObserver(locationUpdated);

            scaleService.getVersion().then(function (data) {
                $scope.version = data.version;
                stateService.setVersion(data.version);
            });
        };
        initialize();
    }]);
})();

(function () {
    'use strict';
    /**
     * See: http://stackoverflow.com/questions/12576798/angularjs-how-to-watch-service-variables/17558885#17558885
     * Doing things this way so that ssNavbarController can get notified
     * when the location changes. Then, our controllers just need to call into
     * this service to updateLocation.
     *
     * The only thing I don't like about this is that the individual
     * controllers have to call in and tell the ssNavigationService what
     * page they are showing.
     */
    angular.module('scaleApp').service('navService', ['$location', function ($location) {

        this.location = 'overview'; // where the app starts

        var observers = [];

        this.registerObserver = function(callback) {
            observers.push(callback);
        };

        this.notifyObservers = function() {
            angular.forEach(observers, function(observer) {
                observer();
            });
        };

        this.updateLocation = function(locationIn) {
            this.location = locationIn;
            this.notifyObservers();
        };

    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('subnavService', ['$http', 'scaleConfig', function ($http, scaleConfig) {
        var currentPath = '';

        this.setCurrentPath = function (path) {
            currentPath = path;
        };

        this.getCurrentPath = function () {
            return currentPath;
        };
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('nodeDetailsController', ['$scope', '$location', '$routeParams', '$timeout', 'navService', 'nodeService', 'scaleService', function($scope, $location, $routeParams, $timeout, navService, nodeService, scaleService) {
        $scope.nodeId = $routeParams.id;
        $scope.scaleService = scaleService;

        var getNodeDetails = function (nodeId) {
            nodeService.getNode(nodeId).then( function (data) {
                $scope.node = data;
            });
        };

        var initialize = function() {
            navService.updateLocation('nodes');

            getNodeDetails($scope.nodeId);
            _.defer(function () {
                $scope.loading = false;
            });
        };

        initialize();

        /*$scope.$watch('nodeData', function (val) {
            $scope.redrawGrid();
        }, true);*/
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('nodesController', ['$scope', '$location', '$timeout', 'navService', 'nodeService', function($scope, $location, $timeout, navService, nodeService) {
        $scope.nodeCounts = [];
        $scope.loading = true;
        $scope.hourValue = 3;
        $scope.nodesError = null;
        $scope.nodesErrorStatus = null;
        $scope.nodeStatusError = null;
        $scope.nodeStatusErrorStatus = null;
        $scope.nodeData = {
            data: null,
            status: null
        };

        var debounceTimer = {};

        var debounceBroadcast = function (message, args) {
            if (debounceTimer[message]) {
                $timeout.cancel(debounceTimer[message]);
            }
            debounceTimer[message] = $timeout(function () {
                $scope.$broadcast(message, args);
            }, 500);
        };

        $scope.redrawGrid = function () {
            debounceBroadcast('redrawGrid', $scope.nodeData);
        };

        var getNodes = function () {
            nodeService.getNodes().then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.nodesError = null;
                    $scope.nodeData.data = data.results;
                    $scope.redrawGrid();
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.nodesErrorStatus = data.statusText;
                    }
                    $scope.nodesError = 'Unable to retrieve nodes.';
                }
            });
        };

        var getNodeStatus = function () {
            nodeService.getNodeStatus(null, null, 'PT' + $scope.hourValue + 'H', null).then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.nodeStatusError = null;
                    $scope.nodeData.status = data.results;
                    $scope.redrawGrid();
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.nodeStatusErrorStatus = data.statusText;
                    }
                    $scope.nodeStatusError = 'Unable to retrieve node status.';
                }
            });
        };

        var initialize = function() {
            getNodes();
            getNodeStatus();
            _.defer(function () {
                $scope.loading = false;
            });
            navService.updateLocation('nodes');
        };

        initialize();
    }]);
})();
(function (){
    'use strict';

    angular.module('scaleApp').controller('aisNodeHealthController', ['$rootScope', '$scope', 'nodeService', function ($rootScope, $scope, nodeService) {
        $scope.loadingNodeHealth = true;
        $scope.nodeHealthError = null;
        $scope.nodeHealthErrorStatus = null;
        $scope.nodeHealth = {};
        $scope.nodesOffline = 0;
        $scope.nodesPausedErrors = 0;
        $scope.nodesPaused = 0;
        $scope.nodesOfflineAndPaused = 0;
        $scope.nodesOfflineAndPausedErrors = 0;
        $scope.healthyNodes = 0;
        $scope.totalNodes = 0;

        var getNodeStatus = function () {
            $scope.loadingNodeHealth = true;
            nodeService.getNodeStatus(null, null, $scope.duration, null).then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.totalNodes = data.results.length;

                    var nodesOffline = [],
                        nodesPausedErrors = [],
                        nodesPaused = [],
                        nodesOfflineAndPausedErrors = [],
                        nodesOfflineAndPaused = [];

                    _.forEach(data.results, function (n) {
                        if (!n.is_online) {
                            // node is offline
                            if (n.node.is_paused_errors) {
                                nodesOfflineAndPausedErrors.push(n);
                            } else if (n.node.is_paused) {
                                nodesOfflineAndPaused.push(n);
                            } else {
                                nodesOffline.push(n);
                            }
                        } else {
                            // node is online
                            if (n.node.is_paused_errors) {
                                nodesPausedErrors.push(n);
                            } else if (n.node.is_paused) {
                                nodesPaused.push(n);
                            }
                        }
                    });

                    $scope.nodesOffline = nodesOffline.length;
                    $scope.nodesPausedErrors = nodesPausedErrors.length;
                    $scope.nodesPaused = nodesPaused.length;
                    $scope.nodesOfflineAndPausedErrors = nodesOfflineAndPausedErrors.length;
                    $scope.nodesOfflineAndPaused = nodesOfflineAndPaused.length;

                    // add the length of nodes both offline and paused to produce an accurate healthy count
                    $scope.healthyNodes = $scope.totalNodes - $scope.nodesOffline - $scope.nodesPausedErrors - $scope.nodesPaused - $scope.nodesOfflineAndPaused - $scope.nodesOfflineAndPausedErrors;

                    var donutData = [];

                    // determine percentage of healthy nodes, and breakdown of why nodes are unhealthy
                    var gaugeData = $scope.totalNodes > 0 ? (($scope.healthyNodes / $scope.totalNodes) * 100).toFixed(2) : 0.00;

                    if ($scope.nodesOffline > 0) {
                        donutData.push({
                            status: 'Offline',
                            count: $scope.nodesOffline
                        });
                    }

                    if ($scope.nodesPausedErrors > 0) {
                        donutData.push({
                            status: 'High Failure Rate',
                            count: $scope.nodesPausedErrors
                        });
                    }

                    if ($scope.nodesPaused > 0) {
                        donutData.push({
                            status: 'Paused',
                            count: $scope.nodesPaused
                        });
                    }
                    
                    if ($scope.nodesOfflineAndPaused) {
                        donutData.push({
                            status: 'Offline and Paused',
                            count: $scope.nodesOfflineAndPaused
                        });
                    }

                    if ($scope.nodesOfflineAndPausedErrors) {
                        donutData.push({
                            status: 'Offline and Paused due to Errors',
                            count: $scope.nodesOfflineAndPausedErrors
                        });
                    }

                    $scope.nodeHealth = {
                        gaugeData: gaugeData,
                        donutData: donutData
                    };
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.nodeHealthErrorStatus = data.statusText;
                    }
                    $scope.nodeHealthError = 'Unable to retrieve node health.';
                }
                $scope.loadingNodeHealth = false;
            });
        };

        getNodeStatus();

        $rootScope.$on('updateNodeHealth', function () {
            getNodeStatus();
        });
    }]).directive('aisNodeHealth', function(){
        /**
         * Usage: <ais-node-health />
         **/
         return {
             controller: 'aisNodeHealthController',
             templateUrl: 'modules/nodes/directives/nodeHealthTemplate.html',
             restrict: 'E',
             scope: {
                 duration: '=',
                 showDescription: '='
             }
         };
    });
})();

(function(){
    'use strict';

    angular.module('scaleApp').factory('Node', ['NodeResources', 'scaleService', function (NodeResources, scaleService) {
        var Node = function (id, hostname, port, slave_id, is_paused, is_paused_errors, is_active, archived, created, last_offer, last_modified, job_exes_running, resources) {
            this.id = id;
            this.hostname = hostname;
            this.port = port;
            this.slave_id = slave_id;
            this.is_paused = is_paused;
            this.is_paused_errors = is_paused_errors;
            this.is_active = is_active;
            this.archived = archived;
            this.created = created;
            this.last_offer = last_offer;
            this.last_modified = last_modified;
            this.job_exes_running = job_exes_running;
            this.resources = NodeResources.transformer(resources);
        };

        //public methods
        Node.prototype = {
            toString: function () {
                return 'Node';
            },
            getDuration: function () {
                return scaleService.calculateDuration(this.created, this.last_modified);
            },
            getCellText: function () {
                // this is only used reveal = true on gridChart directive
                return this.hostname;
            },
            getCellTitle: function () {
                return this.hostname;
            }
        };

        // static methods, assigned to class
        Node.build = function (data) {
            if (data) {
                return new Node(
                    data.id,
                    data.hostname,
                    data.port,
                    data.slave_id,
                    data.is_paused,
                    data.is_paused_errors,
                    data.is_active,
                    data.archived,
                    data.created,
                    data.last_offer,
                    data.last_modified,
                    data.job_exes_running,
                    data.resources
                );
            }
            return new Node();
        };

        Node.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Node.build);
            }
            return Node.build(data);
        };

        return Node;
    }]);
})();

(function(){
    'use strict';

    angular.module('scaleApp').factory('NodeResources', function(){
        var NodeResources = function (total, scheduled, used) {
            this.total = total;
            this.scheduled = scheduled;
            this.used = used;
        };

        //public methods
        NodeResources.prototype = {
            // getDuration: function() {
                //return scaleService.calculateDuration(this.created, this.last_modified);
            // }
        };

        // static methods, assigned to class
        NodeResources.build = function (data) {
            if (data) {
                return new NodeResources(
                    data.total,
                    data.scheduled,
                    data.used
                );
            }
            return new NodeResources();
        };

        NodeResources.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(NodeResources.build)
                    .filter(Boolean);
            }
            return NodeResources.build(data);
        };

        return NodeResources;
    });
})();

(function() {
    'use strict';

    angular.module('scaleApp').factory('NodeStatus', ['scaleConfig', 'nodeUpdateService', 'Node', 'JobExecution', function (scaleConfig, nodeUpdateService, Node, JobExecution) {
        var NodeStatus = function (node, is_online, job_exe_counts, job_exes_running) {
            this.node = Node.transformer(node);
            this.is_online = is_online;
            this.job_exe_counts = job_exe_counts;
            this.job_exes_running = JobExecution.transformer(job_exes_running);
        };

        //public methods
        NodeStatus.prototype = {
            toString: function () {
                return 'NodeStatus';
            },
            getCompleted: function () {
                var completed = _.find(this.job_exe_counts, 'status', 'COMPLETED');
                return completed ? completed.count : 0;
            },
            getFailed: function () {
                var failed = _.find(this.job_exe_counts, 'status', 'FAILED');
                return failed ? failed.count : 0;
            },
            getCellFill: function () {
                var color = '';
                if (this.is_online) {
                    if (this.node.is_paused_errors) {
                        color = scaleConfig.colors.chart_orange;
                    } else if (this.node.is_paused) {
                        color = scaleConfig.colors.chart_yellow;
                    } else {
                        color = scaleConfig.colors.chart_green;
                    }
                } else {
                    color = scaleConfig.colors.chart_red;
                }
                return color;
            },
            getRunning: function () {
                return { count: 0 };
            },
            getCellError: function () {
                return 'Failed: ' + this.getFailed();
            },
            getCellTotal: function () {
                return 'Completed: ' + this.getCompleted();
            },
            getCellStatus: function () {
                if (this.is_online) {
                    if (this.node.is_paused_errors) {
                        return 'High Failure Rate';
                    } else if (this.node.is_paused) {
                        return 'Paused';
                    } else {
                        return 'Online';
                    }
                } else {
                    return 'Offline';
                }
            },
            getCellJobs: function () {
                var text = '';
                _.forEach(this.job_exes_running, function (jobExecution) {
                    text = jobExecution.job.job_type.icon_code ?
                    text + ' ' + '&#x' + jobExecution.job.job_type.icon_code + ';' :
                    text + ' ' + '&#x' + scaleConfig.defaultIconCode + ';';
                });
                return text;
            },
            getCellPauseResume: function () {
                return this.node.is_paused ? '&#xf04b;' : '&#xf04c;';
            },
            pauseResumeCell: function (pause_reason) {
                var updateData = {
                    hostname: this.node.hostname,
                    port: this.node.port,
                    pause_reason: pause_reason || '',
                    is_paused: !this.node.is_paused
                };
                return nodeUpdateService.updateNode(this.node.id, updateData).then(function (result) {
                    return Node.transformer(result);
                }).catch(function (error) {
                    console.log(error);
                });
            }
        };

        // static methods, assigned to class
        NodeStatus.build = function (data) {
            if (data) {
                return new NodeStatus(
                    data.node,
                    data.is_online,
                    data.job_exe_counts,
                    data.job_exes_running
                );
            }
            return new NodeStatus();
        };

        NodeStatus.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(NodeStatus.build);
            }
            return NodeStatus.build(data);
        };

        return NodeStatus;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('nodeService', ['$http', '$q', '$resource', 'scaleConfig', 'Node', 'NodeStatus', 'poller', 'pollerFactory', function ($http, $q, $resource, scaleConfig, Node, NodeStatus, poller, pollerFactory) {
        /*var totalNodes = 5;

        var getTotalNodes = function () {
            return totalNodes;
        };

        var setTotalNodes = function () {
            totalNodes = Math.floor(Math.random() * (20 - 1 + 1)) + 1;
        };

        setInterval(function () {
            setTotalNodes();
        }, 3100);*/

        var getNodeStatusParams = function (page, page_size, started, ended) {
            var params = {};

            if(page) { params.page = page; }
            if(page_size) { params.page_size = page_size; }
            if(started) { params.started = started; }
            if(ended) { params.ended = ended; }

            return params;
        };

        return {
            getNodes: function () {
                var nodesResource = $resource(scaleConfig.urls.apiPrefix + 'nodes/'),
                    nodesPoller = pollerFactory.newPoller(nodesResource, scaleConfig.pollIntervals.nodes);

                return nodesPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        /*var returnResult = {
                            $resolved: true,
                            nodes: []
                        };
                        var newData = {};
                        for (var i = 0; i < getTotalNodes(); i++) {
                            newData = {
                                "id": i,
                                "hostname": "node" + i + ".local",
                                "port": 5051,
                                "slave_id": "20150616-103050-1800454536-5050-6193-S2",
                                "total_cpus": 2.0,
                                "total_mem": 6793.0,
                                "total_disk": 94639.0,
                                "is_paused": false,
                                "created": "2015-06-15T17:18:52.414Z",
                                "last_modified": "2015-06-15T17:18:52.414Z"
                            };
                            returnResult.nodes.push(newData);
                        }
                        result = returnResult;*/

                        data.results = Node.transformer(data.results);
                    } else {
                        nodesPoller.stop();
                    }
                    return data;
                });
            },
            getNodesOnce: function () {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'nodes/').success(function (data) {
                    var returnData = Node.transformer(data.nodes);
                    d.resolve(returnData);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getNode: function (slaveId) {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'nodes/' + slaveId + '/').success(function (data) {
                    var returnData = Node.transformer(data);
                    d.resolve(returnData);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getNodeStatus: function (page, page_size, started, ended) {
                var params = getNodeStatusParams(page, page_size, started, ended);

                var nodeStatusResource = $resource(scaleConfig.urls.apiPrefix + 'nodes/status/', params),
                    nodeStatusPoller = pollerFactory.newPoller(nodeStatusResource, scaleConfig.pollIntervals.nodeStatus);

                return nodeStatusPoller.promise.then(null, null, function (data) {
                    if (data.$resolved) {
                        /*var returnResult = {
                            $resolved: true,
                            node_stats: []
                        };
                        var newData = {};
                        for (var i = 0; i < getTotalNodes(); i++) {
                            newData = {
                                "hostname": "node" + i + ".local",
                                "jobs_completed": Math.floor(Math.random() * (100 - 20 + 1)) + 20,
                                "system_failures": Math.floor(Math.random() * (20 - 0 + 1)) + 0,
                                "id": i
                            };
                            returnResult.node_stats.push(newData);
                        }
                        result = returnResult;*/

                        data.results = NodeStatus.transformer(data.results);
                    } else {
                        nodeStatusPoller.stop();
                    }
                    return data;
                });
            },
            getNodeStatusOnce: function (page, page_size, started, ended) {
                var d = $q.defer();
                var params = getNodeStatusParams(page, page_size, started, ended);
                $http({
                    url: scaleConfig.urls.apiPrefix + 'nodes/status/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = NodeStatus.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },
            getNodeData: function (slaveId, since) {
                var data = {},
                    self = this;

                since = since || 'PT3H';

                return self.getNodes().then(function (nodes) {
                    data.nodes = nodes;
                    return self.getNodeStatus(since).then(function (stats) {
                        data.stats = stats;
                        return data;
                    });
                });
            }
        };

    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('nodeUpdateService', ['$http', '$q', 'scaleConfig', 'Node', function ($http, $q, scaleConfig, Node) {
        var getNodeUpdateData = function (hostname, port, pause_reason, is_paused) {
            return {
                hostname: hostname,
                port: port,
                pause_reason: pause_reason,
                is_paused: is_paused
            };
        };

        return {
            updateNode: function (id, data) {
                data = data || getNodeUpdateData();
                var d = $q.defer();

                $http({
                    url: scaleConfig.urls.apiPrefix + 'nodes/' + id + '/',
                    method: 'PATCH',
                    data: data
                }).success(function (result) {
                    d.resolve(Node.transformer(result));
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            }
        };
    }])
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('ovController', ['$rootScope', '$scope', 'navService', 'nodeService', 'jobService', 'jobTypeService', 'statusService', 'gaugeFactory', 'scaleConfig', 'scaleService', 'schedulerService', 'userService', function($rootScope, $scope, navService, nodeService, jobService, jobTypeService, statusService, gaugeFactory, scaleConfig, scaleService, schedulerService, userService) {
        $scope.date = new Date();
        $scope.jobError = null;
        $scope.jobErrorStatus = null;
        $scope.loadingJobs = true;
        $scope.jobTypes = [];
        $scope.hourValue = 3;
        $scope.jobData = {
            data: null,
            status: null
        };
        $scope.jobErrorBreakdown = [];
        $scope.status = null;
        $scope.loadingStatus = true;
        $scope.statusError = null;
        $scope.statusErrorStatus = null;
        $scope.masterStatus = '';
        $scope.masterStatusClass = 'alert-success';
        $scope.schedulerStatus = '';
        $scope.schedulerStatusClass = 'alert-success';
        $scope.memCalc = '';
        $scope.diskCalc = '';
        $scope.schedulerIsPaused = false;
        $scope.user = userService.getUserCreds();
        $scope.schedulerContainerClass = $scope.user ? $scope.user.is_admin ? 'col-xs-8 col-lg-10' : 'col-xs-12' : 'col-xs-12';
        $scope.schedulerBtnClass = 'fa-pause';

        $scope.toggleScheduler = function () {
            $scope.schedulerIsPaused = !$scope.schedulerIsPaused;
            var schedulerData = {
                is_paused: $scope.schedulerIsPaused
            };
            schedulerService.updateScheduler(schedulerData).then(function (data) {
                $scope.schedulerStatus = data.is_paused ? 'Paused' : 'Running';
                $scope.schedulerStatusClass = data.is_paused ? 'alert-warning' : 'alert-success';
                $scope.schedulerBtnClass = data.is_paused ? 'fa-play' : 'fa-pause';
            }).catch(function (error) {
                console.log(error);
            });
        };

        var redrawGrid = function () {
            $scope.$broadcast('redrawGrid', $scope.jobData);
        };

        var getJobTypes = function () {
            jobTypeService.getJobTypes().then(null, null, function (data) {
                if (data.$resolved) {
                    $scope.jobError = null;
                    $scope.jobData.data = data.results;
                    redrawGrid();
                } else {
                    if (data.statusText && data.statusText !== '') {
                        $scope.jobErrorStatus = data.statusText;
                    }
                    $scope.jobError = 'Unable to retrieve job types.'
                }
                $scope.loadingJobs = false
            });
        };

        var getStatus = function () {
            var cpuGauge = gaugeFactory.createGauge('cpu', 'CPU', 0, 100, 180),
                memGauge = gaugeFactory.createGauge('memory', 'Memory', 0, 100, 180),
                diskGauge = gaugeFactory.createGauge('disk', 'Disk', 0, 100, 180);

            statusService.getStatus().then(null, null, function (result) {
                if (result.$resolved) {
                    $scope.statusError = null;
                    $scope.status = result;
                    cpuGauge.redraw(result.getCpuUsage());
                    memGauge.redraw(result.getMemUsage());
                    diskGauge.redraw(result.getDiskUsage());
                    $scope.masterStatus = result.master.is_online ? 'Online' : 'Offline';
                    $scope.masterStatusClass = result.master.is_online ? 'alert-success' : 'alert-danger';
                    if (result.scheduler.is_online) {
                        $scope.schedulerStatus = result.scheduler.is_paused ? 'Paused' : 'Running';
                        $scope.schedulerStatusClass = result.scheduler.is_paused ? 'alert-warning' : 'alert-success';
                        $scope.schedulerIsPaused = result.scheduler.is_paused;
                        $scope.schedulerBtnClass = result.scheduler.is_paused ? 'fa-play' : 'fa-pause';
                    } else {
                        $scope.schedulerStatus = result.scheduler.is_paused ? 'Offline; Paused' : 'Offline';
                        $scope.schedulerStatusClass = 'alert-danger';
                        $scope.schedulerIsPaused = result.scheduler.is_paused;
                        $scope.schedulerBtnClass = result.scheduler.is_paused ? 'fa-play' : 'fa-pause';
                    }
                    if (result.resources.scheduled.mem && result.resources.total.mem) {
                        $scope.memCalc = scaleService.calculateFileSizeFromMib(result.resources.scheduled.mem) + ' / ' + scaleService.calculateFileSizeFromMib(result.resources.total.mem);
                    }
                    if (result.resources.scheduled.disk && result.resources.total.disk) {
                        $scope.diskCalc = scaleService.calculateFileSizeFromMib(result.resources.scheduled.disk) + ' / ' + scaleService.calculateFileSizeFromMib(result.resources.total.disk);
                    }
                } else {
                    if (result.statusText && result.statusText !== '') {
                        $scope.statusErrorStatus = result.statusText;
                    }
                    $scope.statusError = 'Unable to retrieve cluster status.';
                }
                $scope.loadingStatus = false;
            });
        };

        $rootScope.$on('jobTypeStatus', function (event, data) {
            $scope.jobData.status = data;
            redrawGrid();
        });

        var initialize = function () {
            getJobTypes();
            getStatus();
            navService.updateLocation('overview');
        };

        initialize();
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').service('workspacesService', ['$http', '$q', '$resource', 'scaleConfig', function($http, $q, $resource, scaleConfig) {

        return {
            getWorkspaces: function () {
                var d = $q.defer();
                var url = scaleConfig.urls.apiPrefix + 'workspaces/';

                $http({
                    url: url,
                    method: 'GET'
                }).success(function (data) {
                    d.resolve(data.results);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            }//,
            //getWorkspaceDetails: function(id) {
            //
            //}
        };
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('recipeDetailsController', ['$rootScope', '$scope', '$location', '$routeParams', 'navService', 'recipeService', 'scaleConfig', 'subnavService', 'userService', function ($rootScope, $scope, $location, $routeParams, navService, recipeService, scaleConfig, subnavService, userService) {

        var self = this;

        $scope.recipe = {};
        $scope.recipeId = $routeParams.id;
        $scope.subnavLinks = scaleConfig.subnavLinks.recipes;
        subnavService.setCurrentPath('recipes');
        $scope.loadingRecipeDetail = true;
        $scope.activeTab = 'status';
        $scope.lastStatusChange = '';

        self.getRecipeDetail = function (recipeId) {
            $scope.loadingRecipeDetail = true;
            recipeService.getRecipeDetails(recipeId).then(function (data) {
                $scope.recipe = data;
                recipeService.getRecipeTypeDetail(data.recipe_type.id).then(function(recipeType){
                    $scope.recipeType = recipeType;
                }).catch(function(error){
                   console.log(error);
                });
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loadingRecipeDetail = false;
            });
        };

        self.initialize = function () {
            navService.updateLocation('recipes');
            $rootScope.user = userService.getUserCreds();

            self.getRecipeDetail($scope.recipeId);
        };



        $scope.switchTab = function (tab) {
            $('#' + $scope.activeTab).hide();
            $scope.activeTab = tab;
            $('#' + $scope.activeTab).show();
        };

        self.initialize();
    }]);
})();

(function(){
    'use strict';

    angular.module('scaleApp').controller('recipeEditorController', ['$scope', '$log', '$location', '$routeParams', '$uibModal', 'navService', 'recipeService', 'RecipeType', 'subnavService', 'jobTypeService', 'scaleConfig', function($scope, $log, $location, $routeParams, $uibModal, navService, recipeService, RecipeType, subnavService, jobTypeService, scaleConfig) {

        $scope.date = new Date();
        $scope.recipes = null;
        $scope.recipeTypeId = parseInt($routeParams.id);

        $scope.jobTypeValues = [];

        $scope.subnavLinks = scaleConfig.subnavLinks.recipes;
        subnavService.setCurrentPath('recipes/builder');

        $scope.items = ['item1', 'item2', 'item3'];
        $scope.animationsEnabled = true;
        $scope.selected = null;

        var getJobTypes = function () {
            jobTypeService.getJobTypesOnce().then(function (data) {
                $scope.jobTypeValues = data;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        $scope.openAddJob = function (size) {
           var modalInstance = $uibModal.open({
             animation: $scope.animationsEnabled,
             templateUrl: 'addJobContent.html',
             scope: $scope,
             size: 'sm'
           });

           modalInstance.result.then(function () {
             $scope.addJobType($scope.selectedItem);
           }, function () {

           });
         };

         $scope.addJobType = function(selectedJobType){
             $scope.recipeType.definition.addJobType(selectedJobType);
             $scope.redrawGraph();
         };

         $scope.selectItem = function(item){
             $scope.selectedItem = item;
         };

        $scope.initialize = function() {
            getJobTypes();
            navService.updateLocation('recipes');
            if($scope.recipeTypeId){
                $scope.getRecipeTypeDetail($scope.recipeTypeId);
            }
            else{
                $scope.recipeType = RecipeType.new();
            }

        };

        $scope.getRecipeTypeDetail = function (id) {
            recipeService.getRecipeTypeDetail(id).then(function (data) {
                $scope.recipeType = data;
                if ($scope.redrawGraph) {
                    $scope.redrawGraph();
                }
            });
        };

        $scope.saveRecipeType = function(){
                console.log($scope.recipeType.name);
        };

        $scope.initialize();
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').controller('recipeTypesController', ['$rootScope', '$scope', '$routeParams', '$location', '$uibModal', 'hotkeys', 'scaleService', 'navService', 'recipeService', 'subnavService', 'jobTypeService', 'scaleConfig', 'RecipeType', 'userService', 'localStorage', function ($rootScope, $scope, $routeParams, $location, $uibModal, hotkeys, scaleService, navService, recipeService, subnavService, jobTypeService, scaleConfig, RecipeType, userService, localStorage) {
        $scope.loading = true;
        $scope.containerStyle = '';
        $scope.recipeTypes = [];
        $scope.recipeTypeIds = [];
        $scope.requestedRecipeTypeId = parseInt($routeParams.id);
        $scope.activeRecipeType = null;
        $scope.percentage = 73;
        $scope.date = new Date();
        $scope.recipes = null;
        $scope.mode = 'view'; // valid values are add, view, and edit
        $scope.addBtnText = 'New Recipe';
        $scope.addBtnClass = 'btn-primary';
        $scope.addBtnIcon = 'fa-plus-circle';
        $scope.editBtnText = 'Edit';
        $scope.editBtnClass = 'btn-success';
        $scope.editBtnIcon = 'fa-edit';
        $scope.jobTypeValues = [];
        $scope.isRecipeModified = false;
        $scope.saveBtnClass = 'btn-default';
        $scope.masterClass = 'col-xs-3';
        $scope.detailClass = 'col-xs-9';
        $scope.minimizeMaster = false;
        $scope.minimizeBtnClass = 'fa fa-chevron-left';
        $scope.user = userService.getUserCreds();
        $scope.scaleConfig = scaleConfig;
        $scope.localRecipeTypes = [];

        $scope.subnavLinks = scaleConfig.subnavLinks.recipes;
        subnavService.setCurrentPath('recipes/types');

        var initialize = function () {
            navService.updateLocation('recipes');
            $rootScope.user = userService.getUserCreds();
            getRecipeTypes();
            //getJobTypes();
        };
        
        var getRecipeTypes = function () {
            recipeService.getRecipeTypes().then(function (data) {
                $scope.recipeTypes = data;
                if (scaleConfig.static) {
                    var i = 0,
                        oJson = {},
                        sKey;
                    for (; sKey = localStorage.key(i); i++) {
                        oJson[sKey] = localStorage.getItem(sKey);
                    }
                    _.filter(_.pairs(oJson), function (o) {
                        if (_.contains(o[0], 'recipeType')) {
                            var type = JSON.parse(o[1]);
                            $scope.localRecipeTypes.push(type);
                            $scope.recipeTypes.push(type);
                        }
                    });
                }
                $scope.recipeTypeIds = _.pluck(data, 'id');
                $scope.viewRecipeTypeDetail($scope.requestedRecipeTypeId);
                hotkeys.bindTo($scope)
                    .add({
                        combo: 'ctrl+up',
                        description: 'Previous Recipe Type',
                        callback: function () {
                            if ($scope.activeRecipeType) {
                                var idx = _.indexOf($scope.recipeTypeIds, $scope.activeRecipeType.id);
                                if (idx > 0) {
                                    $scope.loadRecipeType($scope.recipeTypeIds[idx - 1]);
                                }
                            }
                        }
                    }).add({
                        combo: 'ctrl+down',
                        description: 'Next Recipe Type',
                        callback: function () {
                            if ($scope.activeRecipeType) {
                                var idx = _.indexOf($scope.recipeTypeIds, $scope.activeRecipeType.id);
                                if (idx < ($scope.recipeTypeIds.length - 1)) {
                                    $scope.loadRecipeType($scope.recipeTypeIds[idx + 1]);
                                }
                            }
                        }
                    });
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                if ($scope.loading) {
                    $scope.loading = false;
                }
            })
        };

        $scope.clearLocalRecipeTypes = function () {
            _.forEach($scope.localRecipeTypes, function (type) {
                localStorage.removeItem('recipeType' + type.id);
            });
            $location.path('/recipes/types');
        };

        $scope.newRecipeType = function(){
            $location.path('/recipes/types/0');
        };

        $scope.viewRecipeTypeDetail = function (recipeTypeId) {
            if (recipeTypeId > 0) {
                recipeService.getRecipeTypeDetail(recipeTypeId).then(function (data) {
                    $scope.activeRecipeType = data;
                });
            } else if( recipeTypeId === 0) {
                $scope.activeRecipeType = new RecipeType();
            }
        };

        $scope.loadRecipeType = function (id) {
            if ($scope.activeRecipeType && $scope.activeRecipeType.modified) {
                confirmChangeRecipe().then(function () {
                    // OK
                    $location.path('/recipes/types/' + id);
                }, function () {
                    // Cancel

                });
            } else {
                $location.path('/recipes/types/' + id);
            }
        };

        var confirmChangeRecipe = function () {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'confirmDialog.html',
                scope: $scope,
                size: 'sm'
            });

            return modalInstance.result;
        };

        $scope.toggleMaster = function (minimizeMaster) {
            if (typeof minimizeMaster !== 'undefined') {
                $scope.minimizeMaster = minimizeMaster;
            } else {
                $scope.minimizeMaster = !$scope.minimizeMaster;
            }
            $scope.masterClass = $scope.minimizeMaster ? 'col-xs-1 minimized' : 'col-xs-3';
            $scope.detailClass = $scope.minimizeMaster ? 'col-xs-11' : 'col-xs-9';
            $scope.minimizeBtnClass = $scope.minimizeMaster ? 'fa fa-chevron-right' : 'fa fa-chevron-left';
        };

        $rootScope.$on('toggleEdit', function (event, data) {
            $scope.toggleMaster(data === 'edit');
        });

        initialize();

        $rootScope.$on('recipeModified', function () {
            $scope.isRecipeModified = true;
            $scope.saveBtnClass = 'btn-success';
        });

        angular.element(document).ready(function () {
            // set container heights equal to available page height
            var viewport = scaleService.getViewportSize(),
                offset = scaleConfig.headerOffset,
                containerMaxHeight = viewport.height - offset;

            $scope.containerStyle = 'height: ' + containerMaxHeight + 'px; max-height: ' + containerMaxHeight + 'px;';
        });
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').controller('recipesController', ['$rootScope', '$scope', '$location', 'scaleService', 'navService', 'gridFactory', 'uiGridConstants', 'scaleConfig', 'subnavService', 'recipeService', function ($rootScope, $scope, $location, scaleService, navService, gridFactory, uiGridConstants, scaleConfig, subnavService, recipeService) {

        var recipesParams = {
            page: null, page_size: null, started: null, ended: null, order: $rootScope.recipesControllerOrder || null, type_id: null, type_name: null, url: null
        };

        // check for recipesParams in query string, and update as necessary
        _.forEach(_.pairs(recipesParams), function (param) {
            var value = _.at($location.search(), param[0]);
            if (value.length > 0) {
                recipesParams[param[0]] = value.length > 1 ? value : value[0];
            }
        });

        var gridPageNumber = recipesParams.page || 1,
            filteredByRecipeType = recipesParams.type_id ? true : false,
            filteredByOrder = recipesParams.order ? true : false;

        // this file will be similar to jobsController
        $scope.recipesData = {};
        $scope.loading = true;
        $scope.recipeTypeValues = [];
        $scope.selectedRecipeType = recipesParams.type_id || 0;
        $scope.subnavLinks = scaleConfig.subnavLinks.recipes;
        $scope.gridStyle = '';
        $scope.lastModifiedStart = recipesParams.started ? moment.utc(recipesParams.started).toDate() : moment.utc().subtract(1, 'weeks').startOf('d').toDate();
        $scope.lastModifiedStartPopup = {
            opened: false
        };
        $scope.openLastModifiedStartPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStartPopup.opened = true;
        };
        $scope.lastModifiedStop = recipesParams.ended ? moment.utc(recipesParams.ended).toDate() : moment.utc().endOf('d').toDate();
        $scope.lastModifiedStopPopup = {
            opened: false
        };
        $scope.openLastModifiedStopPopup = function ($event) {
            $event.stopPropagation();
            $scope.lastModifiedStopPopup.opened = true;
        };
        $scope.dateModelOptions = {
            timezone: '+000'
        };

        subnavService.setCurrentPath('recipes');

        var defaultColumnDefs = [
            {
                field: 'recipe_type',
                displayName: 'Recipe Type',
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.recipe_type.title }} {{ row.entity.recipe_type.version }}</div>',
                filterHeaderTemplate: '<div class="ui-grid-filter-container"><select class="form-control input-sm" ng-model="grid.appScope.selectedRecipeType"><option ng-selected="{{ grid.appScope.recipeTypeValues[$index].id == grid.appScope.selectedRecipeType }}" value="{{ grid.appScope.recipeTypeValues[$index].id }}" ng-repeat="recipeType in grid.appScope.recipeTypeValues track by $index">{{ grid.appScope.recipeTypeValues[$index].title }} {{ grid.appScope.recipeTypeValues[$index].version }}</option></select>'
            },
            //{ field: 'created', enableFiltering: false, cellFilter: 'date:\'yyyy-MM-dd HH:mm:ss\''},
            {
                field: 'created',
                displayName: 'Created (Z)',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.created_formatted }}</div>'
            },
            {
                field: 'last_modified',
                displayName: 'Last Modified (Z)',
                enableFiltering: false,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.last_modified_formatted }}</div>'
                //cellFilter: 'date:\'yyyy-MM-dd HH:mm:ss\'',                
            },
            {
                field: 'duration',
                enableFiltering: false,
                enableSorting: false,
                width: 120,
                cellTemplate: '<div class="ui-grid-cell-contents text-right">{{ row.entity.getDuration() }}</div>'
            },
            {
                field: 'completed',
                enableFiltering: false,
                enableSorting: true,
                cellTemplate: '<div class="ui-grid-cell-contents">{{ row.entity.completed_formatted }}</div>'
            }
        ];

        $scope.gridOptions = gridFactory.defaultGridOptions();
        $scope.gridOptions.paginationCurrentPage = parseInt(recipesParams.page || 1);
        $scope.gridOptions.paginationPageSize = parseInt(recipesParams.page_size) || $scope.gridOptions.paginationPageSize;
        var colDefs = $rootScope.recipeColDefs ? $rootScope.recipeColDefs : defaultColumnDefs;
        $scope.gridOptions.columnDefs = gridFactory.applySortConfig(colDefs, recipesParams);
        $scope.gridOptions.data = [];
        $scope.gridOptions.onRegisterApi = function (gridApi) {
            //set gridApi on scope
            $scope.gridApi = gridApi;
            $scope.gridApi.selection.on.rowSelectionChanged($scope, function (row) {
                $scope.$apply(function(){
                    $location.path('/recipes/recipe/' + row.entity.id);
                });

            });
            $scope.gridApi.pagination.on.paginationChanged($scope, function (currentPage, pageSize) {
                recipesParams.page = currentPage;
                recipesParams.page_size = pageSize;
                console.log('gridApi');
                $scope.filterResults();
            });
            $scope.gridApi.core.on.sortChanged($scope, function (grid, sortColumns) {
                $rootScope.recipeColDefs = null;
                _.forEach($scope.gridApi.grid.columns, function (col) {
                    col.colDef.sort = col.sort;
                });
                $rootScope.recipeColDefs = $scope.gridApi.grid.options.columnDefs;
                var sortArr = [];
                _.forEach(sortColumns, function (col) {
                    sortArr.push(col.sort.direction === 'desc' ? '-' + col.field : col.field);
                });
                updateRecipeOrder(sortArr);
            });
        };

        $scope.getPage = function (filter, pageNumber, pageSize, url) {
            $scope.loading = true;
            recipeService.getRecipes(filter, pageNumber, pageSize, url).then(function (data) {
                var newData = [];
                for (var i = 0; i < $scope.gridOptions.paginationPageSize; i++) {
                    if (data.results[i]) {
                        newData.push(data.results[i]);
                    }
                }
                $scope.gridOptions.data = newData;
                $scope.gridOptions.totalItems = data.count;
                $scope.jobsData = data;
                gridPageNumber = pageNumber;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        $scope.filterResults = function () {
            _.forEach(_.pairs(recipesParams), function (param) {
                $location.search(param[0], param[1]);
            });
            $scope.loading = true;
            getRecipes();
        };

        var getRecipes = function () {
            recipeService.getRecipes(recipesParams).then(function (data) {
                $scope.recipesData = data;
                $scope.gridOptions.totalItems = data.count;
                $scope.gridOptions.data = data.results;
            }).catch(function (error) {
                console.log(error);
            }).finally(function () {
                $scope.loading = false;
            });
        };

        var getRecipeTypes = function () {
            recipeService.getRecipeTypes().then(function (data) {
                $scope.recipeTypeValues = data;
                $scope.recipeTypeValues.unshift({ name: 'VIEW ALL', title: 'VIEW ALL', version: '', id: 0 });
                getRecipes();
            }).catch(function (error) {
                $scope.loading = false;
                console.log(error);
            });
        };

        var updateRecipeOrder = function (sortArr) {
            recipesParams.order = sortArr.length > 0 ? sortArr : null;
            filteredByOrder = sortArr.length > 0;
            $scope.filterResults();
        };

        var updateRecipeType = function (value) {
            if (value != recipesParams.type_id) {
                recipesParams.page = 1;
            }
            recipesParams.type_id = value == 0 ? null : value;
            recipesParams.page_size = $scope.gridOptions.paginationPageSize;
            console.log('selectedRecipeType');
            if (!$scope.loading) {
                $scope.filterResults();
            }
        };

        $scope.$watch('lastModifiedStart', function (value) {
            if (!$scope.loading) {
                recipesParams.started = value.toISOString();
                $scope.filterResults();
            }
        });

        $scope.$watch('lastModifiedStop', function (value) {
            if (!$scope.loading) {
                recipesParams.ended = value.toISOString();
                $scope.filterResults();
            }
        });

        $scope.$watch('selectedRecipeType', function (value) {
            if ($scope.loading) {
                if (filteredByRecipeType) {
                    updateRecipeType(value);
                }
            } else {
                filteredByRecipeType = value != 0;
                updateRecipeType(value);
            }
        });

        var initialize = function () {
            if (typeof $rootScope.recipeColDefs === 'undefined') {
                // root column defs have not been altered by user, so set up defaults
                if (!recipesParams.order) {
                    recipesParams.order = '-last_modified';
                    $location.search('order', recipesParams.order).replace();
                }
                if (!recipesParams.page_size) {
                    recipesParams.page_size = $scope.gridOptions.paginationPageSize;
                    $location.search('page_size', recipesParams.page_size).replace();
                }
                if (!recipesParams.started) {
                    recipesParams.started = moment.utc($scope.lastModifiedStart).toISOString();
                    $location.search('started', recipesParams.started).replace();
                }
                if (!recipesParams.ended) {
                    recipesParams.ended = moment.utc($scope.lastModifiedStop).toISOString();
                    $location.search('ended', recipesParams.ended).replace();
                }
            }
            getRecipeTypes();
            navService.updateLocation('recipes');
        };

        initialize();

        angular.element(document).ready(function(){
           // set container height equal to available page height
            var viewport = scaleService.getViewportSize();
            var offset = scaleConfig.headerOffset + scaleConfig.dateFilterOffset;
            var gridMaxHeight = viewport.height - offset;
            $scope.gridStyle = 'height: ' + gridMaxHeight + 'px; max-height: ' + gridMaxHeight + 'px;';
        });
    }]);
})();

/**
 * <ais-scale-recipe-viewer />
 */
(function () {
    angular.module('scaleApp').controller('aisScaleRecipeGraphViewerController', ['$rootScope', '$scope', '$location', '$uibModal', 'scaleConfig', 'scaleService', 'jobTypeService', 'recipeService', 'workspacesService', 'RecipeType', 'RecipeTypeDetail', 'JobType', 'localStorage', function ($rootScope, $scope, $location, $uibModal, scaleConfig, scaleService, jobTypeService, recipeService, workspacesService, RecipeType, RecipeTypeDetail, JobType, localStorage) {
        $scope.vertices = [];
        $scope.edges = [];
        $scope.selectedJob = null;
        $scope.selectedInputProvider = null;
        $scope.mode = null;
        $scope.editMode = null;
        $scope.dependencyBtnClass = 'fa-plus';
        $scope.addBtnText = 'New Recipe';
        $scope.addBtnClass = 'btn-primary';
        $scope.addBtnIcon = 'fa-plus-circle';
        $scope.editBtnText = 'Edit';
        $scope.editBtnClass = 'btn-success';
        $scope.editBtnIcon = 'fa-edit';
        $scope.jobTypeValues = [];
        $scope.saveBtnClass = 'btn-default';
        $scope.savingRecipe = false;
        $scope.warnings = [];
        $scope.readonly = true;
        $scope.detailMaxHeight = 0;
        $scope.recipeTypeTrigger = { dataTypes: '' };
        $scope.detailContainerStyle = '';
        $scope.containerClass = $scope.hasContainer ? '' : 'detail-container no-tabs';
        $scope.lastStatusChange = '';
        $scope.availableWorkspaces = [];
        $scope.recipeInputTypes = [
            {
                name: 'property',
                title: 'Property',
                fields: []
            },
            {
                name: 'file',
                title: 'File',
                fields: [
                    {
                        name: 'media_types',
                        title: 'Media Types',
                        value: []
                    }
                ]
            },
            {
                name: 'files',
                title: 'Files',
                fields: [
                    {
                        name: 'media_types',
                        title: 'Media Types',
                        value: []
                    }
                ]
            }
        ];
        $scope.availableTriggerTypes = scaleConfig.triggerTypes;
        $scope.selectedRecipeInputType = {};
        $scope.recipeInput = {
            name: '',
            required: true,
            type: ''
        };
        $scope.isIE = scaleService.isIE();

        var startJob = null;
        var zoomScale = 0;

        // Dagre variables
        var svg = null;
        var inner = null;
        var graph = null;
        var zoom = null;
        var render = null;

        var getClosestNode = function (name) {
            return d3.selectAll('.nodeRect').filter(function (d) {
                return d === name;
            });
        };

        var getOtherNodes = function (name) {
            return d3.selectAll('.nodeRect').filter(function (d) {
                return d !== name;
            });
        };

        var resetEditBtn = function () {
            $scope.editBtnText = $scope.mode === 'edit' ? 'Cancel Edit' : 'Edit';
            $scope.editBtnClass = $scope.mode === 'edit' ? 'btn-warning' : 'btn-success';
            $scope.editBtnIcon = $scope.mode === 'edit' ? 'fa-close' : 'fa-edit';
        };

        var resetAddBtn = function () {
            $scope.addBtnText = $scope.mode === 'add' ? 'Cancel' : 'New Recipe';
            $scope.addBtnClass = $scope.mode === 'add' ? 'btn-warning' : 'btn-primary';
            $scope.addBtnIcon = $scope.mode === 'add' ? 'fa-close' : 'fa-plus-circle';
        };

        var toggleAddRecipe = function () {
            $scope.mode = $scope.mode === 'add' ? 'view' : 'add';
            resetAddBtn();
        };

        var toggleEditRecipe = function () {
            if ($scope.mode === 'edit') {
                $scope.mode = 'view';
                $scope.reloadRecipeTypeDetail($scope.recipeType.id);
            } else {
                $scope.mode = 'edit';
            }
            $scope.editMode = '';
            resetEditBtn();
        };

        var enableSaveRecipe = function () {
            $scope.recipeType.modified = true;
            //$scope.saveBtnClass = 'btn-primary';
        };

        var disableSaveRecipe = function () {
            $scope.recipeType.modified = false;
            $scope.saveBtnClass = 'btn-default;'
        };

        var confirmChangeRecipe = function () {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'confirmDialog.html',
                scope: $scope,
                size: 'sm'
            });

            return modalInstance.result;
        };

        var getRecipeTypeJobClassName = function (job) {
            // default to 'nostatus'
            var className = 'nostatus';
            // find the associated job in the recipe.jobs
            if ($scope.recipe) {
                var recipejob = _.find($scope.recipe.jobs,{job_name: job.name});
                if (recipejob) {
                    className = recipejob.job.status.toLowerCase();
                }
            }
            return className;
        };

        $scope.reloadRecipeTypeDetail = function (id) {
            var getRecipeDetail = function () {
                recipeService.getRecipeTypeDetail(id).then(function (data) {
                    $scope.recipeType = data;

                });
            };

            if ($scope.recipeType.modified) {
                confirmChangeRecipe().then(function () {
                    // OK
                    disableSaveRecipe();
                    resetAddBtn();
                    if ($scope.mode === 'edit') {
                        toggleEditRecipe();
                    }
                    getRecipeDetail();
                }, function () {
                    // Cancel

                });
            } else {
                if ($scope.mode === 'edit') {
                    toggleEditRecipe();
                }
                resetAddBtn();
                getRecipeDetail();
            }
        };

        $scope.redraw = function () {
            initialize();
            //$rootScope.$broadcast('recipeModified');
        };

        $scope.nodeClick = function (name) {
            // Remove selection class
            //$('div').removeClass('selected-node');
            d3.selectAll('.nodeRect').classed('selected-node', false);

            // find the job in the recipe definition
            var job = _.find($scope.recipeType.definition.jobs, { name: name });

            if (name === 'start') {
                job = startJob;
            }
            var $name = $('#' + name);
            var pos = $name.position();

            // click node different from selectedJob
            if (!$scope.selectedJob || job.name !== $scope.selectedJob.name) {
                if ($scope.editMode === 'addDependency') {
                    addDependency(name);
                    enableSaveRecipe();
                    $scope.redraw();

                } else if ($scope.editMode === 'addInput') {
                    var contentStr = '';
                    if (job.name === 'start') {
                        contentStr = '<ul class="list-group">';
                        _.forEach($scope.recipeType.definition.input_data, function (recipeInput) {
                            contentStr = contentStr + '<li class="list-group-item">';
                            contentStr = contentStr + '<a onclick="mapInputRecipeInput(\'' + recipeInput.name + '\')">' + recipeInput.name + '</a>';
                            if (recipeInput.media_types) {
                                contentStr = contentStr + '<div class="input-media-types">' + recipeInput.media_types.join(',') + '</div>';
                            }
                            contentStr = contentStr + '</li>';
                        });
                        contentStr = contentStr + '</ul>';
                        $name.popover({
                            container: 'body',
                            content: contentStr,
                            html: true,
                            title: 'Select provider/output'
                        });
                        $name.popover('show');
                    } else {
                        if (job.job_type.job_type_interface.output_data.length > 0) {
                            contentStr = '<ul class="list-group">';
                            _.forEach(job.job_type.job_type_interface.output_data, function (jobOutput) {
                                contentStr = contentStr + '<li class="list-group-item">';
                                contentStr = contentStr + '<a onclick="mapInput(\'' + job.name + '\', \'' + jobOutput.name + '\')">' + jobOutput.name + '</a>';
                                if (jobOutput.media_type) {
                                    contentStr = contentStr + '<div class="input-media-types">' + jobOutput.media_type + '</div>';
                                }
                                contentStr = contentStr + '</li>';
                            });
                            contentStr = contentStr + '</ul>';
                            $name.popover({
                                container: 'body',
                                content: contentStr,
                                html: true,
                                title: 'Select provider/output'
                            });
                            $name.popover('show');
                        }
                    }
                } else if ($scope.editMode === 'addOutput') {
                    $scope.selectedOutputReceiver = job;
                    if (job.job_type.job_type_interface.input_data.length > 0) {
                        contentStr = '<ul class="list-group">';
                        _.forEach(job.job_type.job_type_interface.input_data, function (jobInput) {
                            contentStr = contentStr + '<li class="list-group-item">';
                            contentStr = contentStr + '<a onclick="mapOutput(\'' + job.name + '\', \'' + jobInput.name + '\')">' + jobInput.name + '</a>';
                            if (jobInput.media_types) {
                                contentStr = contentStr + '<div class="input-media-types">' + jobInput.media_types.join(',') + '</div>';
                            }
                            contentStr = contentStr + '</li>';
                        });
                        contentStr = contentStr + '</ul>';
                        $name.popover({
                            container: 'body',
                            content: contentStr,
                            html: true,
                            title: 'Select receiver/input'
                        });
                        $name.popover('show');
                    }
                } else {
                    // update the selected job
                    $scope.selectedJob = job;
                    if ($scope.recipe) {
                        $scope.selectedRecipeJob = _.find($scope.recipe.jobs, { job_name: job.name });
                    }
                    // apply the selected-node class
                    //$name.addClass('selected-node');
                    getClosestNode(name).classed('selected-node', true);
                }
            }
            else { // click selected node
                //$('div').removeClass('selected-node');
                d3.selectAll('.nodeRect').classed('selected-node', false);
                $scope.selectedJob = null;
                $scope.selectedRecipeJob = null;
                $scope.selectedOutputReceiver = null;
                $scope.selectedInputProvider = null;
                $scope.editMode = '';
                $scope.dependencyBtnClass = 'fa-plus';

                //$('.recipeNode:not(".selected-node")').removeClass('selected-node-selectable');
                getOtherNodes(name).classed('selected-node-selectable', false);
            }
            if ($scope.selectedJob) {
                //$('#' + $scope.selectedJob.name).addClass('selected-node');
                getClosestNode($scope.selectedJob.name).classed('selected-node', true);
            }
        };
        $scope.toggleEditMode = function () {
            if ($scope.mode === 'edit') {
                $scope.reloadRecipeTypeDetail($scope.recipeType.id);
            } else {
                toggleEditRecipe();
                resetAddBtn();
            }
            $rootScope.$broadcast('toggleEdit', $scope.mode);
        };

        $scope.openAddJob = function () {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'addJobContent.html',
                scope: $scope,
                size: 'sm'
            });

            modalInstance.result.then(function () {
                if ($scope.selectedJobType) {
                    jobTypeService.getJobTypeDetails($scope.selectedJobType.id).then(function (data) {
                        $scope.addJobType(data);
                        enableSaveRecipe();
                    });
                }
            }, function () {

            });
        };

        $scope.openEditTrigger = function () {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'editTrigger.html',
                scope: $scope,
                size: 'md'
            });

            modalInstance.result.then(function () {
                if ($scope.mode === 'edit' || $scope.mode === 'add') {
                    $scope.recipeType.trigger_rule.configuration.condition.data_types = $scope.recipeTypeTrigger.dataTypes ? $scope.recipeTypeTrigger.dataTypes.split(',') : [];
                    enableSaveRecipe();
                }
            }, function () {

            });


        };

        $scope.deleteRecipeInput = function (inputName) {
            var removedRecipeInput = _.remove($scope.recipeType.definition.input_data, function (recipeInput) {
                return recipeInput.name === inputName;
            });
            console.log('removed ' + removedRecipeInput.length + ' recipe inputs.');
            enableSaveRecipe();
            $scope.redraw();

        };

        $scope.openAddInput = function () {
            var modalInstance = $uibModal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'addInput.html',
                scope: $scope
            });

            modalInstance.result.then(function () {
                // check for fields and add as necessary
                if ( $scope.selectedRecipeInputType.fields.length > 0) {
                    var fieldArr = [];
                    _.forEach($scope.selectedRecipeInputType.fields, function (field) {
                        _.forEach(field.value.split(','), function (value) {
                            fieldArr.push(value);
                        });
                        $scope.recipeInput[field.name] = fieldArr;
                    });
                }

                // add input to recipe type definition
                $scope.recipeType.definition.input_data.push($scope.recipeInput);
                _.forEach($scope.recipeType.definition.jobs, function (job) {
                    if (job.recipe_inputs.length === 0) {
                        job.recipe_inputs.push({
                            job_input: $scope.recipeInput.name,
                            recipe_input: $scope.recipeInput.name
                        });
                    }
                });
                getIoMappings();

                // reset form fields
                $scope.recipeInput = {
                    name: '',
                    required: true,
                    type: ''
                };
                $scope.selectedRecipeInputType = {};
            });
        };

        $scope.changeInputType = function () {
            $scope.selectedRecipeInputType = _.find($scope.recipeInputTypes, {'name': $scope.recipeInput.type});
        };

        var getWarningsHtml = function (warnings) {
            var warningsHtml = '';
            _.forEach(warnings, function (warning) {
                warningsHtml += '<b>' + warning.id + ':</b> ' + warning.details + '<br /><br />';
            });
            warningsHtml += '<button type="button" class="btn btn-default btn-xs clear">Hide</button>';
            return warningsHtml;
        };

        $scope.validateRecipeType = function () {
            recipeService.validateRecipeType($scope.recipeType).then(function (validationResult) {
                if (validationResult.warnings && validationResult.warnings.length > 0) {
                    // display the warnings
                    var warningsHtml = getWarningsHtml(validationResult.warnings);
                    toastr["error"](warningsHtml);
                } else {
                    toastr["success"]('Recipe is valid.');
                }
            }).catch(function (error) {
                if (error.detail) {
                    toastr["error"](error.detail);
                } else {
                    toastr["error"](error);
                }
            });

        };


        $scope.saveRecipeType = function () {
            $scope.savingRecipe = true;
            recipeService.validateRecipeType($scope.recipeType).then(function (validationResult) {
                if (validationResult.warnings && validationResult.warnings.length > 0) {
                    // display the warnings
                    var warningsHtml = getWarningsHtml(validationResult.warnings);
                    toastr["error"](warningsHtml);
                    $scope.savingRecipe = false;
                } else {
                    recipeService.saveRecipeType($scope.recipeType).then(function (saveResult) {
                        $scope.savingRecipe = false;
                        $scope.recipeType = RecipeTypeDetail.transformer(saveResult);
                        if (scaleConfig.static) {
                            console.log(JSON.stringify($scope.recipeType));
                            localStorage.setItem('recipeType' + $scope.recipeType.id, JSON.stringify($scope.recipeType));
                        }
                        $scope.redraw();
                        $location.path('/recipes/types/' + $scope.recipeType.id);
                    });
                }
            }).catch(function (error) {
                if (error && error.detail) {
                    toastr['error'](error.detail);
                } else {
                    toastr['error'](error);
                }
                $scope.savingRecipe = false;
            });

            disableSaveRecipe();
        };

        $scope.addJobType = function (selectedJobType) {
            console.log(selectedJobType.name);
            $scope.recipeType.definition.addJob(selectedJobType);
            //$scope.$broadcast('redrawRecipes');
            $scope.redraw();
        };

        $scope.mapInput = function (providerName, providerOutput) {
            console.log('map selected job input to ' + providerName + '.' + providerOutput);
            var dependency = _.find($scope.selectedJob.dependencies, {name: providerName});

            if (dependency && dependency.connections && dependency.connections.length > 0) {
                var conn = _.find(dependency.connections, { output: providerOutput, input: $scope.selectedJobInput.name });
                if (!conn) {
                    dependency.connections.push({ output: providerOutput, input: $scope.selectedJobInput.name });
                }
            }
            else if (!dependency) {
                dependency = {name: providerName, connections: [{ output: providerOutput, input: $scope.selectedJobInput.name }]};
                $scope.selectedJob.dependencies.push(dependency);
            }
            else {
                dependency.connections = [{ output: providerOutput, input: $scope.selectedJobInput.name }];
            }
            $scope.selectedJob.depStart = false;
            $scope.editMode = '';
            $scope.selectedJobInput = null;
            $scope.selectedInputProvider = null;
            enableSaveRecipe();
            $scope.redraw();
        };

        $scope.mapInputRecipeInput = function (recipeInput) {
            console.log('map selected job to recipe input ' + recipeInput);
            var existingInput = _.find($scope.selectedJob.recipe_inputs, { job_input: $scope.selectedJobInput.name });
            if ( existingInput && existingInput.recipe_name !== recipeInput) {
                // update it
                existingInput.recipe_input = recipeInput;
                enableSaveRecipe();
                $scope.redraw();
            } else if ( !existingInput ) {
                // create it
                $scope.selectedJob.recipe_inputs.push({
                    job_input: $scope.selectedJobInput.name,
                    recipe_input: recipeInput
                });
                enableSaveRecipe();
                $scope.redraw();
            }
            $scope.editMode = '';
            $scope.selectedJobInput = null;
            $scope.selectedInputProvider = null;
        };

        $scope.mapOutput = function (receiverName, receiverInput) {
            var dependency = _.find($scope.selectedOutputReceiver.dependencies, {name: $scope.selectedJob.name});

            if (dependency && dependency.connections && dependency.connections.length > 0) {
                var conn = _.find(dependency.connections, { output: $scope.selectedJobOutput.name, input: receiverInput });
                if (!conn) {
                    dependency.connections.push({output: $scope.selectedJobOutput.name, input: receiverInput});
                }
            }
            else if (!dependency) {
                dependency = {name: $scope.selectedJob.name, connections: [{output: $scope.selectedJobOutput.name, input: receiverInput}]};
                $scope.selectedOutputReceiver.dependencies.push(dependency);
            }
            else {
                dependency.connections = [{output: $scope.selectedJobOutput.name, input: receiverInput}];
            }
            $scope.selectedOutputReceiver.depStart = false;
            $scope.editMode = '';
            $scope.selectedJobOutput = null;
            $scope.selectedOutputReceiver = null;
            enableSaveRecipe();
            $scope.redraw();
        };

        $scope.toggleAddDependency = function () {
            if ($scope.editMode === 'addDependency') {
                $scope.editMode = '';
                $scope.dependencyBtnClass = 'fa-plus';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', false);
                //$('.recipeNode:not(".selected-node")').removeClass('selected-node-selectable');
            } else {
                console.log('toggle addDependency mode');
                $scope.editMode = 'addDependency';
                $scope.dependencyBtnClass = 'fa-remove';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', true);
                //$('.recipeNode:not(".selected-node")').addClass('selected-node-selectable');
            }
        };

        $scope.toggleAddInput = function (jobinput) {
            if ($scope.editMode === 'addInput') {
                $scope.editMode = '';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', false);
                //$('.recipeNode:not(".selected-node")').removeClass('selected-node-selectable');
            } else {
                $scope.selectedJobInput = jobinput;
                console.log('toggle addInput mode');
                $scope.editMode = 'addInput';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', true);
                //$('.recipeNode:not(".selected-node")').addClass('selected-node-selectable');
            }
        };

        $scope.toggleAddOutput = function (joboutput) {
            if ($scope.editMode === 'addOutput') {
                $scope.editMode = '';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', false);
                //$('.recipeNode:not(".selected-node")').removeClass('selected-node-selectable');
            } else {
                $scope.selectedJobOutput = joboutput;
                console.log('toggle addOutput mode');
                $scope.editMode = 'addOutput';
                getOtherNodes($scope.selectedJob.name).classed('selected-node-selectable', true);
                //$('.recipeNode:not(".selected-node")').addClass('selected-node-selectable');
            }
        };

        $scope.removeDependency = function (depName) {
            var removedDeps = _.remove($scope.selectedJob.dependencies, function (dep) {
                return dep.name === depName;
            });
            console.log('removed ' + removedDeps.length + ' dependencies.');
            enableSaveRecipe();
            $scope.redraw();
        };

        $scope.removeInputMapping = function (depName, depOutput) {
            if ( depName === 'recipe' ) {
                // remove it from selectedJob.recipe_inputs
                var dep = _.remove($scope.selectedJob.recipe_inputs, { recipe_input: depOutput });
                enableSaveRecipe();
                $scope.redraw();
            } else {
                var dep = _.find($scope.selectedJob.dependencies, {name: depName});
                if (dep && dep.connections) {
                    // it's an input from another job
                    var removedCon = _.remove(dep.connections, function (conn) {
                        return conn.output === depOutput;
                    });
                    console.log('removed ' + removedCon.length + ' input connections.');
                    enableSaveRecipe();
                    $scope.redraw();
                }
            }

        };

        $scope.deleteRecipeJob = function (jobName) {
            // remove dependent connections
            _.forEach($scope.recipeType.definition.jobs, function (job) {
                _.remove(job.dependencies, {name: jobName});
            });
            // remove job from definition.jobs
            _.remove($scope.recipeType.definition.jobs, { name: jobName });
            // enable save and redraw
            $scope.selectedJob = null;
            enableSaveRecipe();
            $scope.redraw();
        };

        $scope.removeOutputMapping = function (jobName, depOutput) {
            // we have to remove output mapping from the job where the dependency is defined
            var receiver = _.find($scope.recipeType.definition.jobs,{name: jobName});
            // remove it from receiver.dependencies
            var dep = _.find(receiver.dependencies, {name: $scope.selectedJob.name});
            if (dep && dep.connections) {
                var removedCon = _.remove(dep.connections, function (conn) {
                    return conn.output === depOutput;
                });
                console.log('removed ' + removedCon.length + ' output connections.');
                enableSaveRecipe();
                $scope.redraw();
            }
        };

        $scope.selectJobTypeToAdd = function (item) {
            $scope.selectedJobType = item;
        };

        $scope.$on('redrawRecipes', function () {
            $scope.redraw();
        });

        var addDependency = function (jobName) {
            console.log($scope.selectedJob.name + '->' + jobName);
            if (!$scope.selectedJob.dependencies) {
                $scope.selectedJob.dependencies = [];
            }
            var existingDependency = _.find($scope.selectedJob.dependencies, {name: jobName});

            if (!existingDependency) { $scope.selectedJob.dependencies.push({name: jobName}); }
            $scope.selectedJob.depStart = false;
            $scope.editMode = '';
            $scope.dependencyBtnClass = 'fa-plus';

        };

        var getIoMappings = function () {
            if ($scope.recipeType.definition) {
                _.forEach($scope.recipeType.definition.jobs, function (job) {
                    // populate the current jobType
                    /*var thisJobType = _.find($scope.recipeType.job_types,{id: job.job_type_id});
                    job.job_type = thisJobType;*/

                    // find dependents
                    if (job.job_type && job.job_type.job_type_interface) {
                        _.forEach(job.job_type.job_type_interface.output_data, function (jobOutput, key) {
                            if (jobOutput) {
                                var deps = getDependents(job.name,jobOutput.name);
                                jobOutput.dependents = deps;
                            }
                        });
                        // add dependency mappings
                        _.forEach(job.job_type.job_type_interface.input_data, function (jobInput, key) {
                            if (jobInput) {
                                var inputMappings = [];
                                _.forEach(job.dependencies, function (dependency,key) {
                                    _.forEach(dependency.connections, function (conn,key) {
                                        if (conn.input === jobInput.name) {
                                            inputMappings.push({
                                                name: dependency.name,
                                                output: conn.output,
                                                input: conn.input
                                            });
                                        }
                                    });
                                });
                                _.forEach(job.recipe_inputs, function (recipeInput, key) {
                                    if (recipeInput.job_input === jobInput.name) {
                                        inputMappings.push({
                                            name: 'recipe',
                                            output: recipeInput.recipe_input,
                                            input: recipeInput.job_input
                                        });
                                    }
                                });
                                jobInput.dependencies = inputMappings;
                            }
                        });

                    }
                });
            }

        };

        var initialize = function () {

            jobTypeService.getJobTypesOnce().then(function (data) {
                $scope.jobTypeValues = data.results;
            });

            workspacesService.getWorkspaces().then(function (data) {
                $scope.availableWorkspaces = data
            });

            $scope.$watch('recipeType', function (newValue, oldValue) {
                $scope.mode = null;
                if (!$scope.recipeType) {
                    $scope.recipeType = new RecipeType();
                }

                if (typeof $scope.recipeType.id === 'undefined' || $scope.recipeType.id === null || $scope.recipeType.id === 0) {
                    $scope.mode = 'add';
                } else {
                    $scope.mode = $scope.mode || 'view';
                }
                _.forEach($scope.recipeType.definition.jobs, function (job, idx) {
                    if (!job.job_type.job_type_interface && $scope.recipeType.job_types) {
                        var jobTypeData = _.find($scope.recipeType.job_types, {name: job.job_type.name, version: job.job_type.version});
                        $scope.recipeType.definition.jobs[idx].job_type = jobTypeData;
                    }

                });

                // setup string to bind comma delimited list of trigger rule configuration condition data types
                if ($scope.recipeType.trigger_rule) {
                    if ($scope.recipeType.trigger_rule.configuration) {
                        if ($scope.recipeType.trigger_rule.configuration.condition) {
                            if ($scope.recipeType.trigger_rule.configuration.condition.data_types) {
                                $scope.recipeTypeTrigger.dataTypes = $scope.recipeType.trigger_rule.configuration.condition.data_types.join(',');
                            }
                        }
                    }
                }

                initGraph();
                getIoMappings();
                drawGraph();
            });
            if ($rootScope.user) {
                $scope.readonly = false;
            }
        };

        var initGraph = function () {
            // ******
            // setup D3 container and Graph
            // ******
            //$scope.selectedJob = null;
            function clicked() {
                var d = d3.event;
                var x = d3.event.x;
                var y = d3.event.y;
                var width = parseInt(svg.style("width").replace(/px/, ""));
                var height = parseInt(svg.style("height").replace(/px/, ""));

                inner.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(2)translate(" + -x + "," + -y + ")");

                //inner.attr("transform", "translate(50px, 50px)scale(2,3)");

                console.log(d);
            }

            svg = d3.select("svg");
            inner = svg.select("g"); //.on("click", clicked);
            // Set up zoom support
            zoom = d3.behavior.zoom().on("zoom", function () {
                zoomScale = d3.event.scale;
                inner.attr("transform", "translate(" + d3.event.translate + ")" +
                    "scale(" + zoomScale + ")");
            });
            svg.call(zoom);

            render = new dagreD3.render();

            // Left-to-right layout
            graph = new dagreD3.graphlib.Graph();
            graph.setGraph({
                nodesep: 70,
                ranksep: 50,
                rankdir: "TB",
                marginx: 20,
                marginy: 20
            });
        };

        drawGraph = function () {
            // globals because dagre needs a reference to angular scope
            window.nodeClick = function (name) {
                var scope = angular.element(document.getElementById('recipeviewer')).scope();
                scope.$apply(function () {
                    scope.nodeClick(name);
                });
            };

            window.mapInput = function (jobName, jobOutput) {
                $('#' + jobName).popover('destroy');
                var scope = angular.element(document.getElementById('recipeviewer')).scope();
                scope.$apply(function () {
                    scope.mapInput(jobName, jobOutput);
                });
            };

            window.mapInputRecipeInput = function (recipeInputName) {
                $('#start').popover('destroy');
                var scope = angular.element(document.getElementById('recipeviewer')).scope();
                scope.$apply(function () {
                    scope.mapInputRecipeInput(recipeInputName);
                });
            };

            window.mapOutput = function (jobName, jobInput) {
                $('#' + jobName).popover('destroy');
                var scope = angular.element(document.getElementById('recipeviewer')).scope();
                scope.$apply(function () {
                    scope.mapOutput(jobName, jobInput);
                });
            };

            if ($scope.recipe) {
                $scope.lastStatusChange = $scope.recipe.last_modified ? moment.duration(moment.utc($scope.recipe.last_modified).diff(moment.utc())).humanize(true) : '';
            }

            var jobs = [];
            if ($scope.recipeType.definition) {
                jobs = $scope.recipeType.definition.jobs;
            }
            var childCounts = [];
            // create graph objects
            for (var idx in jobs) {
                var job = jobs[idx];

                if (job.dependencies === undefined || job.dependencies.length < 1) {
                    job.depStart = true;
                }
                var className = getRecipeTypeJobClassName(job);

                var html = '<div class="recipeNode">';
                //var html = "<div onclick=\"console.log('" + job.job_type.name + "')\">";
                if (className !== 'nostatus') {
                    html += '<span class="status"></span>';
                }
                //   html += "<span class=consumers>"+worker.consumers+"</span>";
                html += '<span class="name">';
                if (job.job_type) {
                    //console.log(job.jobType);
                    html += '<div id="' + job.name + '" class="" onclick="nodeClick(\'' + job.name + '\')"><span class="name">' + job.job_type.getIcon() + ' ' + job.name + '</span></div>';
                    //if (jobType.name) {
                    //    html += '<div id="' + job.name + '" class="recipeNode" onclick="nodeClick(\'' + job.name + '\')"><span class="name">' + jobType.getIcon() + ' ' + jobType.title + '</span></div>';
                    //} else {
                    //    html += '<div id="' + job.name + '" class="recipeNode" onclick="nodeClick(\'' + job.name + '\')"><span class="name">' + jobType.getIcon() + ' ' + job.name + '</span></div>';
                    //}

                }
                html += '</span>';
                //   html += "<span class=queue><span class=counter>"+worker.count+"</span></span>";
                html += '</div>';
                graph.setNode(job.name, {
                    labelType: 'html',
                    label: html,
                    rx: 5,
                    ry: 5,
                    padding: 0,
                    class: className
                });
                // setup edges
                for (var d in job.dependencies) {
                    var dep = job.dependencies[d];

                    if (dep.name) {
                        graph.setEdge(dep.name, job.name, {
                            //labelType: 'html',
                            //label: dep.name + '-->' + job.name,
                            width: 20

                        });
                        if (childCounts[dep.name]) {
                            childCounts[dep.name] += 1;
                        } else {
                            childCounts[dep.name] = 1;
                        }
                    }
                }
            }

            // set start node and edges
            graph.setNode('start', {
                labelType: 'html',
                label: '<div id="start" class="recipeNode" onclick="nodeClick(\'start\')"><span class=name>Start</span></div>',
                rx: 5,
                ry: 5,
                padding: 0
            });
            startJob = {
                name: 'start',
                job_type: {
                    title: 'Start'
                },
                input_data: $scope.recipeType.input_data
            };
            var noDeps = _.filter(jobs, 'depStart', true);
            for (var n in noDeps) {
                graph.setEdge('start', noDeps[n].name, {
                    width: 20
                });
            }

            // set end node and edges
            graph.setNode('end', {
                labelType: 'html',
                label: '<div class="recipeNode"><span class="name">End</span></div>',
                rx: 5,
                ry: 5,
                padding: 0
            });
            var noChildren =_.filter(jobs, function (job) {
                return !childCounts[job.name];
            });
            for (var o in noChildren) {
                graph.setEdge(noChildren[o].name, 'end', {
                    width: 20
                });
            }

            // wait for current call stack to clear
            _.defer(function () {
                inner.call(render, graph);
                zoom.event(d3.select("svg"));

                $('.node rect').attr('class', 'nodeRect');

                // add selected class to appropriate node
                if ($scope.selectedJob) {
                    //$('#' + $scope.selectedJob.name).addClass('selected-node');
                    getClosestNode($scope.selectedJob.name).classed('selected-node', true);
                }
            });
        };

        var getDependents = function (name,outputName) {
            var results = [];

            _.forEach($scope.recipeType.definition.jobs, function (job, key) {
                if (job.name !== name) {
                    _.forEach(job.dependencies, function (dependency, key) {
                        if (dependency.name === name) {
                            _.forEach(dependency.connections, function (conn, key) {
                                if (conn.output === outputName) {
                                    results.push({
                                        name: job.name,
                                        output: conn.output,
                                        input: conn.input
                                    });
                                }
                            });
                        }
                    });
                }
            });
            return results;
        };

        initialize();

    }]).directive('aisScaleRecipeGraphViewer', function () {
        'use strict';
        /**
         * Usage: <ais-scale-recipe-viewer recipe="recipe" />
         */
        return {
            controller: 'aisScaleRecipeGraphViewerController',
            templateUrl: 'modules/recipes/partials/recipeGraphViewerTemplate.html',
            restrict: 'E',
            scope: {
                recipeType: '=',
                recipe: '=',
                isModified: '=modified',
                allowEdit: '=',
                hasContainer: '='
            },
            link: function (scope) {
                // angular.element(document).ready(function () {
                //     var elHeight = document.getElementsByClassName('recipe-viewer-title')[0].scrollHeight;
                //     scope.detailMaxHeight = scope.$parent.detailMaxHeight ? scope.$parent.detailMaxHeight - elHeight : 700;
                //     scope.detailContainerStyle = 'height: 62vh; max-height: 62vh; overflow-y: auto;';
                // });
            }
        };

    });
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('Recipe', ['scaleConfig', 'RecipeType', 'scaleService', function (scaleConfig, RecipeType, scaleService) {
        var Recipe = function (id, created, completed, last_modified, recipe_type) {
            this.id = id;
            this.created = created;
            this.created_formatted = moment.utc(created).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.completed = completed;
            this.completed_formatted = completed ? moment.utc(completed).format(scaleConfig.dateFormats.day_second_utc_nolabel) : '';
            this.last_modified = last_modified;
            this.last_modified_formatted = moment.utc(last_modified).format(scaleConfig.dateFormats.day_second_utc_nolabel);
            this.last_status_change = last_modified ? moment.duration(moment.utc(last_modified).diff(moment.utc())).humanize(true) : '';
            this.recipe_type = RecipeType.transformer(recipe_type);
        };

        // public methods
        Recipe.prototype = {
            getDuration: function () {
                return scaleService.calculateDuration(this.created, this.last_modified);
            }
        };

        // static methods, assigned to class
        Recipe.build = function (data) {
            if (data) {
                return new Recipe(
                    data.id,
                    data.created,
                    data.completed,
                    data.last_modified,
                    data.recipe_type
                );
            }
            return new Recipe();
        };

        Recipe.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(Recipe.build)
                    .filter(Boolean);
            }
            return Recipe.build(data);
        };

        return Recipe;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeData', function () {
        var RecipeData = function (input_data, version, workspace_id) {
            this.input_data = input_data;
            this.version = version;
            this.workspace_id = workspace_id;
        };

        // static methods, assigned to class
        RecipeData.build = function (data) {
            if (data) {
                return new RecipeData(
                    data.input_data,
                    data.version,
                    data.workspace_id
                );
            }
            return new RecipeData();
        };

        RecipeData.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeData.build)
                    .filter(Boolean);
            }
            return RecipeData.build(data);
        };

        return RecipeData;
    });
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeDetails', ['RecipeData', 'RecipeTypeDefinition', 'RecipeType', 'RecipeTypeDetail', 'RecipeJobContainer', 'scaleConfig', function (RecipeData, RecipeTypeDefinition, RecipeType, RecipeTypeDetail, RecipeJobContainer, scaleConfig) {
        var RecipeDetails = function (id, created, completed, last_modified, data, recipe_type, recipe_type_rev, jobs) {
            this.id = id;
            this.created = created;
            this.completed = completed;
            this.completed_formatted = this.completed ? moment.utc(this.completed).format(scaleConfig.dateFormats.day_second_utc) : this.completed;
            this.last_modified = last_modified;
            this.data = RecipeData.transformer(data);
            this.recipe_type = RecipeType.transformer(recipe_type);
            this.recipe_type_rev = RecipeTypeDetail.transformer(recipe_type_rev);
            this.jobs = RecipeJobContainer.transformer(jobs);
        };

        // static methods, assigned to class
        RecipeDetails.build = function (data) {
            if (data) {
                return new RecipeDetails(
                    data.id,
                    data.created,
                    data.completed,
                    data.last_modified,
                    data.data,
                    data.recipe_type,
                    data.recipe_type_rev,
                    data.jobs
                );
            }
            return new RecipeDetails();
        };

        RecipeDetails.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeDetails.build)
                    .filter(Boolean);
            }
            return RecipeDetails.build(data);
        };

        return RecipeDetails;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeJob', ['JobType', function (JobType) {
        var RecipeJob = function (id, status, job_type) {
            this.id = id;
            this.status = status;
            this.job_type = JobType.transformer(job_type);
        };

        // static methods, assigned to class
        RecipeJob.build = function (data) {
            if (data) {
                return new RecipeJob(
                    data.id,
                    data.status,
                    data.job_type
                );
            }
            return new RecipeJob();
        };

        RecipeJob.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeJob.build)
                    .filter(Boolean);
            }
            return RecipeJob.build(data);
        };

        return RecipeJob;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeJobContainer', ['RecipeJob', function (RecipeJob) {
        var RecipeJobContainer = function (job_name, job) {
            this.job_name = job_name;
            this.job = RecipeJob.transformer(job);
        };

        // static methods, assigned to class
        RecipeJobContainer.build = function (data) {
            if (data) {
                return new RecipeJobContainer(
                    data.job_name,
                    data.job
                );
            }
            return new RecipeJobContainer();
        };

        RecipeJobContainer.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeJobContainer.build)
                    .filter(Boolean);
            }
            return RecipeJobContainer.build(data);
        };

        return RecipeJobContainer;
    }]);
})();
(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeType', ['scaleConfig', 'RecipeTypeDefinition', function (scaleConfig, RecipeTypeDefinition) {
        var RecipeType = function (id, name, version, title, description, is_active, definition, revision_num, created,  last_modified, archived, trigger_rule) {
            this.id = id;
            this.name = name;
            this.version = version;
            this.title = title;
            this.description = description;
            this.is_active = is_active;
            this.definition = definition ? RecipeTypeDefinition.transformer(definition) : new RecipeTypeDefinition();
            this.revision_num = revision_num;
            this.created = created;
            this.last_modified = last_modified;
            this.archived = archived;
            if (trigger_rule) {
                this.trigger_rule = trigger_rule;
            } else {
                this.trigger_rule = {
                    type: '',
                    name: '',
                    is_active: false,
                    configuration: {
                        condition: {
                            media_type: '',
                            data_types: []
                        },
                        data: {
                            workspace_name: '',
                            input_data_name: ''
                        }
                    }
                };
            }
            this.modified = false;
        };

        // static methods, assigned to class
        RecipeType.build = function (data) {
            if (data) {
                return new RecipeType(
                    data.id,
                    data.name,
                    data.version,
                    data.title,
                    data.description,
                    data.is_active,
                    data.definition,
                    data.revision_num,
                    data.created,
                    data.last_modified,
                    data.archived,
                    data.trigger_rule
                );
            }
            return new RecipeType();
        };

        RecipeType.transformer = function (data) {
            if (angular.isArray(data)) {
                return data.map(RecipeType.build);
            }
            return RecipeType.build(data);
        };

        return RecipeType;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeTypeDefinition', ['scaleConfig', 'RecipeTypeDefinitionJob', 'JobTypeInputData', function (scaleConfig, RecipeTypeDefinitionJob, JobTypeInputData) {

        var self = this;
        // private methods
        var RecipeTypeDefinition = function (input_data, version, jobs) {
            this.input_data = input_data ? JobTypeInputData.transformer(input_data) : [];
            this.version = version || '1.0';
            this.jobs = jobs ? RecipeTypeDefinitionJob.transformer(jobs) : [];
        };

        var getJobName = function(jobs, jobName){
            var theName = jobName;
            var existing = _.find(jobs, { 'name': jobName });
            var idx = 2;
            while(existing){
                theName = jobName + '-' + idx;
                existing = _.find(jobs, { 'name': theName });
                idx++;
            }
            return theName;
        };

        // public methods
        RecipeTypeDefinition.prototype = {
            addJob: function (jobType) {
                var jname = getJobName(this.jobs, jobType.name);
                console.log(jname);
                var job = {
                    dependencies: [],
                    recipe_inputs: [],
                    name: jname,
                    job_type_id: jobType.id,
                    job_type: jobType
                };
                this.jobs.push(job);
            }
        };

        // static methods, assigned to class
        RecipeTypeDefinition.build = function (data) {
            if(data){
                return new RecipeTypeDefinition(
                    data.input_data,
                    data.version,
                    data.jobs
                );
            }
            return new RecipeTypeDefinition();
        };

        RecipeTypeDefinition.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeTypeDefinition.build);
            }
            return RecipeTypeDefinition.build(data);
        };

        return RecipeTypeDefinition;
    }]);
})();

(function(){
    'use strict';

    angular.module('scaleApp').factory('RecipeTypeDefinitionJob', ['scaleConfig', 'JobTypeDetails', function (scaleConfig, JobTypeDetails) {
        // private methods
        var RecipeTypeDefinitionJob = function (recipe_inputs, name, job_type, dependencies) {
            this.recipe_inputs = recipe_inputs;
            this.name = name;
            this.job_type = job_type;
            //this.job_type = {
            //    name: job_type.name,
            //    version: job_type.version
            //};
            this.dependencies = dependencies || [];
        };

        // static methods, assigned to class
        RecipeTypeDefinitionJob.build = function (data) {
            if (data) {
                return new RecipeTypeDefinitionJob(
                    data.recipe_inputs,
                    data.name,
                    data.job_type,
                    data.dependencies
                );
            }
            return new RecipeTypeDefinitionJob();
        };

        RecipeTypeDefinitionJob.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeTypeDefinitionJob.build);
            }
            return RecipeTypeDefinitionJob.build(data);
        };


        return RecipeTypeDefinitionJob;

    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeTypeDetail', ['scaleConfig', 'RecipeTypeDefinition', 'JobTypeDetails', function (scaleConfig, RecipeTypeDefinition, JobTypeDetails) {
        var RecipeTypeDetail = function (id, name, version, title, description, is_active, definition, created, last_modified, archived, trigger_rule, job_types) {
            this.id = id;
            this.name = name;
            this.version = version;
            this.title = title;
            this.description = description;
            this.is_active = is_active;
            this.definition = RecipeTypeDefinition.transformer(definition);
            this.created = created;
            this.last_modified = last_modified;
            this.archived = archived;
            this.trigger_rule = trigger_rule;
            this.job_types = JobTypeDetails.transformer(job_types);
            this.modified = false;
        };

        // static methods, assigned to class
        RecipeTypeDetail.build = function (data) {
            if (data) {
                return new RecipeTypeDetail(
                    data.id,
                    data.name,
                    data.version,
                    data.title,
                    data.description,
                    data.is_active,
                    data.definition,
                    data.created,
                    data.last_modified,
                    data.archived,
                    data.trigger_rule,
                    data.job_types
                );
            }
            return new RecipeTypeDetail();
        };

        RecipeTypeDetail.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeTypeDetail.build);
            }
            return RecipeTypeDetail.build(data);
        };

        return RecipeTypeDetail;
    }]);
})();

(function () {
    'use strict';

    angular.module('scaleApp').factory('RecipeTypeValidation', ['RecipeTypeDefinition', function (RecipeTypeDefinition) {

        var getRecipeTypeValidationJobs = function (jobs) {
            var jobsOut = [];
            _.forEach(jobs, function(job){
               jobsOut.push({
                   recipe_inputs: job.recipe_inputs,
                   name: job.name,
                   job_type: {
                       name: job.job_type.name,
                       version: job.job_type.version
                   },
                   dependencies: job.dependencies
               })
            });
            return jobsOut;
        };
        
        var RecipeTypeValidation = function (id, name, version, title, description, definition, trigger_rule) {
            if (id) {
                this.id = id;
            }
            this.name = name;
            this.version = version;
            this.title = title;
            this.description = description;
            this.definition = {
                input_data: definition.input_data,
                jobs: getRecipeTypeValidationJobs(definition.jobs)
            };
            this.trigger_rule = trigger_rule;
        };

        // static methods, assigned to class
        RecipeTypeValidation.build = function (data) {
            if (data) {
                return new RecipeTypeValidation(
                    data.id,
                    data.name,
                    data.version,
                    data.title,
                    data.description,
                    data.definition,
                    data.trigger_rule
                );
            }
            return new RecipeTypeValidation();
        };

        RecipeTypeValidation.transformer = function (data) {
            if (angular.isArray(data)) {
                return data
                    .map(RecipeTypeValidation.build);
            }
            return RecipeTypeValidation.build(data);
        };

        return RecipeTypeValidation;
    }]);
})();
(function () {
    'use strict';
    /**
     *
     */
    angular.module('scaleApp').service('recipeService', ['$http', '$q', '$timeout', 'scaleConfig', 'RecipeType', 'RecipeTypeDetail', 'Recipe', 'RecipeDetails', 'RecipeTypeValidation', function ($http, $q, $timeout, scaleConfig, RecipeType, RecipeTypeDetail, Recipe, RecipeDetails, RecipeTypeValidation) {
        var getRecipesParams = function (page, page_size, started, ended, order, completed, recipe_type_id, recipe_type_name, url) {
            return {
                page: page,
                page_size: page_size,
                started: started,
                ended: ended,
                order: order,
                completed: completed,
                recipe_type_id: recipe_type_id,
                recipe_type_name: recipe_type_name,
                url: url
            };
        };

        return {
            getRecipeTypes: function () {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'recipe-types/').success(function (data) {
                    d.resolve(RecipeType.transformer(data.results));
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },

            getRecipeTypeDetail: function (id) {
              var d = $q.defer();

              $http.get(scaleConfig.urls.apiPrefix + 'recipe-types/' + id + '/').success(function (data) {
                  var returnData = RecipeTypeDetail.transformer(data);
                  d.resolve(returnData);
              });
              return d.promise;
            },

            getRecipes: function (params) {
                params = params || getRecipesParams();
                var d = $q.defer();

                $http({
                    url: params.url ? params.url : scaleConfig.urls.apiPrefix + 'recipes/',
                    method: 'GET',
                    params: params
                }).success(function (data) {
                    data.results = Recipe.transformer(data.results);
                    d.resolve(data);
                }).error(function (error) {
                    d.reject(error);
                });

                return d.promise;
            },

            getRecipeDetails: function (id) {
                var d = $q.defer();
                $http.get(scaleConfig.urls.apiPrefix + 'recipes/' + id + '/').success(function (data) {
                    var result = RecipeDetails.transformer(data);
                    d.resolve(result);
                }).error(function (error) {
                    d.reject(error);
                });
                return d.promise;
            },

            saveRecipeType: function (recipeType) {
                var d = $q.defer();
                var cleanRecipeType = RecipeTypeValidation.transformer(recipeType);

                if (!cleanRecipeType.id) {
                    $http.post(scaleConfig.urls.apiPrefix + 'recipe-types/', cleanRecipeType).success(function (result) {
                        d.resolve(result);
                    }).error(function(error){
                        d.reject(error);
                    });
                } else {
                    $http.patch(scaleConfig.urls.apiPrefix + 'recipe-types/' + cleanRecipeType.id + '/', cleanRecipeType).success(function (result) {
                        recipeType = result;
                        d.resolve(recipeType);
                    }).error(function(error){
                        d.reject(error);
                    });
                }

                return d.promise;
            },

            validateRecipeType: function (recipeType) {
                var d = $q.defer();
                var cleanRecipeType = RecipeTypeValidation.transformer(recipeType);

                $http.post(scaleConfig.urls.apiPrefix + 'recipe-types/validation/', cleanRecipeType).success(function (result) {
                    d.resolve(result);
                }).error(function(error){
                    d.reject(error);
                });

                return d.promise;
            }
        };
    }]);
})();

/**
 * @author Dimitry Kudrayvtsev
 * @version 2.1
 */

 var updateWindow = function(){
    //  x = w.innerWidth || e.clientWidth || g.clientWidth;
    //  y = w.innerHeight|| e.clientHeight|| g.clientHeight;
     //
    //  svg.attr("width", x).attr("height", y);
    console.log('resize');
 };

 window.onresize = updateWindow;

d3.gantt = function() {
    var FIT_TIME_DOMAIN_MODE = "fit";
    var FIXED_TIME_DOMAIN_MODE = "fixed";

    var margin = {
		top : 20,
		right : 20,
		bottom : 20,
		left : 60
    };
    var timeDomainStart = d3.time.day.offset(new Date(),-3);
    var timeDomainEnd = d3.time.hour.offset(new Date(),+3);
    var timeDomainMode = FIT_TIME_DOMAIN_MODE;// fixed or fit
    var taskTypes = [];
    var taskStatus = [];
    var height = document.body.clientHeight - margin.top - margin.bottom-5;
    var width = document.body.clientWidth - margin.right - margin.left-5;
	var renderTo = "body";
	var begin = '';
	var ended = '';

    var tickFormat = "%H:%M:%S";

    var keyFunction = function(d) {
		return d[begin] + d.taskName + d[ended];
    };

    var rectTransform = function(d) {
		return "translate(" + x(d[begin]) + "," + y(d.taskName) + ")";
    };

    var x = d3.time.scale().domain([ timeDomainStart, timeDomainEnd ]).range([ 0, width ]).clamp(true);

    var y = d3.scale.ordinal().domain(taskTypes).rangeRoundBands([ 0, height - margin.top - margin.bottom ], .1);

    var xAxis = d3.svg.axis().scale(x).orient("bottom").tickFormat(d3.time.format(tickFormat)).tickSubdivide(true)
	    .tickSize(8).tickPadding(8);

    var yAxis = d3.svg.axis().scale(y).orient("left").tickSize(0);

    var initTimeDomain = function(tasks) {
	if (timeDomainMode === FIT_TIME_DOMAIN_MODE) {
	    if (tasks === undefined || tasks.length < 1) {
		timeDomainStart = d3.time.day.offset(new Date(), -3);
		timeDomainEnd = d3.time.hour.offset(new Date(), +3);
		return;
	    }
	    tasks.sort(function(a, b) {
		return a[ended] - b[ended];
	    });
	    timeDomainEnd = tasks[tasks.length - 1][ended];
	    tasks.sort(function(a, b) {
		return a[begin] - b[begin];
	    });
	    timeDomainStart = tasks[0][begin];
	}
    };

    var initAxis = function() {
	x = d3.time.scale().domain([ timeDomainStart, timeDomainEnd ]).range([ 0, width ]).clamp(true);
	y = d3.scale.ordinal().domain(taskTypes).rangeRoundBands([ 0, height - margin.top - margin.bottom ], .1);
	xAxis = d3.svg.axis().scale(x).orient("bottom").ticks(Math.ceil(width/150)).tickFormat(d3.time.format(tickFormat)).tickSubdivide(true)
		.tickSize(8).tickPadding(8);

	yAxis = d3.svg.axis().scale(y).orient("left").tickSize(0);
    };

    function gantt(tasks) {

	initTimeDomain(tasks);
	initAxis();

	var svg = d3.select(renderTo)
	.append("svg")
	.attr("class", "chart")
	.attr("width", width + margin.left + margin.right)
	.attr("height", height + margin.top + margin.bottom)
	.append("g")
        .attr("class", "gantt-chart")
	.attr("width", width + margin.left + margin.right)
	.attr("height", height + margin.top + margin.bottom)
	.attr("transform", "translate(" + margin.left + ", " + margin.top + ")");

      svg.selectAll(".chart")
	 .data(tasks, keyFunction).enter()
	 .append("rect")
	 .attr("rx", 5)
         .attr("ry", 5)
	 .attr("class", function(d){
	     if(taskStatus[d.status] == null){ return "bar";}
	     return taskStatus[d.status];
	     })
	 .attr("y", 0)
	 .attr("transform", rectTransform)
	 .attr("height", function(d) { return y.rangeBand(); })
	 .attr("width", function(d) {
	     return (x(d[ended]) - x(d[begin]));
	     });


	 svg.append("g")
	 .attr("class", "x axis")
	 .attr("transform", "translate(0, " + (height - margin.top - margin.bottom) + ")")
	 .transition()
	 .call(xAxis);

	 svg.append("g").attr("class", "y axis").transition().call(yAxis);

	 return gantt;

    };

    gantt.redraw = function(tasks) {
        console.log('redraw');
	initTimeDomain(tasks);
	initAxis();

        var svg = d3.select("svg");

        var ganttChartGroup = svg.select(".gantt-chart");
        var rect = ganttChartGroup.selectAll("rect").data(tasks, keyFunction);

        rect.enter()
         .insert("rect",":first-child")
         .attr("rx", 5)
         .attr("ry", 5)
	 .attr("class", function(d){
	     if(taskStatus[d.status] == null){ return "bar";}
	     return taskStatus[d.status];
	     })
	 .transition()
	 .attr("y", 0)
	 .attr("transform", rectTransform)
	 .attr("height", function(d) { return y.rangeBand(); })
	  .attr("width", function(d) {
	     return (x(d[ended]) - x(d[begin]));
	     });

        rect.transition()
          .attr("transform", rectTransform)
	 .attr("height", function(d) { return y.rangeBand(); })
	 .attr("width", function(d) {
	     return (x(d[ended]) - x(d[begin]));
	     });

	rect.exit().remove();

	svg.select(".x").transition().call(xAxis);
	svg.select(".y").transition().call(yAxis);

	return gantt;
    };

    gantt.margin = function(value) {
	if (!arguments.length)
	    return margin;
	margin = value;
	return gantt;
    };

    gantt.timeDomain = function(value) {
	if (!arguments.length)
	    return [ timeDomainStart, timeDomainEnd ];
	timeDomainStart = +value[0], timeDomainEnd = +value[1];
	return gantt;
    };

    /**
     * @param {string}
     *                vale The value can be "fit" - the domain fits the data or
     *                "fixed" - fixed domain.
     */
    gantt.timeDomainMode = function(value) {
	if (!arguments.length)
	    return timeDomainMode;
        timeDomainMode = value;
        return gantt;

    };

    gantt.taskTypes = function(value) {
	if (!arguments.length)
	    return taskTypes;
	taskTypes = value;
	return gantt;
    };

    gantt.taskStatus = function(value) {
	if (!arguments.length)
	    return taskStatus;
	taskStatus = value;
	return gantt;
    };

	gantt.begin = function(value){
		if(!arguments.length){
			return begin;
		}
		begin = value;
		return gantt;
	};

	gantt.ended = function(value){
		if(!arguments.length){
			return ended;
		}
		ended = value;
		return gantt;
	};

    gantt.width = function(value) {
	if (!arguments.length)
	    return width;
	width = +value;
	return gantt;
    };

    gantt.height = function(value) {
	if (!arguments.length)
	    return height;
	height = +value;
	return gantt;
    };

    gantt.tickFormat = function(value) {
	if (!arguments.length)
	    return tickFormat;
	tickFormat = value;
	return gantt;
    };

	gantt.renderTo = function(value) {
		if(!arguments.length){
			return renderTo;
		}
		renderTo = value;
		return gantt;
	};



    return gantt;
};

function Gauge(placeholderName, configuration)
{
    this.placeholderName = placeholderName;

    var self = this; // for internal d3 functions

    this.configure = function(configuration)
    {
        this.config = configuration;

        this.config.size = this.config.size * 0.9;

        this.config.raduis = this.config.size * 0.97 / 2;
        this.config.cx = this.config.size / 2;
        this.config.cy = this.config.size / 2;

        this.config.min = undefined != configuration.min ? configuration.min : 0;
        this.config.max = undefined != configuration.max ? configuration.max : 100;
        this.config.range = this.config.max - this.config.min;

        this.config.majorTicks = configuration.majorTicks || 5;
        this.config.minorTicks = configuration.minorTicks || 2;

        this.config.greenColor 	= configuration.greenColor || "#8fca0e";
        this.config.yellowColor = configuration.yellowColor || "#ffc317";
        this.config.redColor 	= configuration.redColor || "#f54d36";

        this.config.transitionDuration = configuration.transitionDuration || 500;
    };

    this.render = function()
    {
        this.body = d3.select("#" + this.placeholderName)
            .append("svg:svg")
            .attr("class", "gauge")
            .attr("width", this.config.size)
            .attr("height", this.config.size);

        this.body.append("svg:circle")
            .attr("class", "outer-circle")
            .attr("cx", this.config.cx)
            .attr("cy", this.config.cy)
            .attr("r", this.config.raduis * 0.95)
            .style("fill", "#ccc");
            /*.style("stroke", "#000")
            .style("stroke-width", "0.5px");*/

        this.body.append("svg:circle")
            .attr("cx", this.config.cx)
            .attr("cy", this.config.cy)
            .attr("r", 0.9 * this.config.raduis)
            .style("fill", "#fff")
            .style("stroke", "#e0e0e0")
            .style("stroke-width", "2px");

        for (var greenIdx in this.config.greenZones)
        {
            this.drawBand(this.config.greenZones[greenIdx].from, this.config.greenZones[greenIdx].to, self.config.greenColor);
        }

        for (var yellowIdx in this.config.yellowZones)
        {
            this.drawBand(this.config.yellowZones[yellowIdx].from, this.config.yellowZones[yellowIdx].to, self.config.yellowColor);
        }

        for (var redIdx in this.config.redZones)
        {
            this.drawBand(this.config.redZones[redIdx].from, this.config.redZones[redIdx].to, self.config.redColor);
        }

        var fontSize = 0;

        if (undefined != this.config.label)
        {
            fontSize = Math.round(this.config.size / 9);
            this.body.append("svg:text")
                .attr("x", this.config.cx)
                .attr("y", this.config.cy / 2 + fontSize / 2)
                .attr("dy", fontSize / 2)
                .attr("text-anchor", "middle")
                .text(this.config.label)
                .style("font-size", fontSize + "px")
                .style("fill", "#333")
                .style("stroke-width", "0px");
        }

        fontSize = Math.round(this.config.size / 16);
        var majorDelta = this.config.range / (this.config.majorTicks - 1);
        for (var major = this.config.min; major <= this.config.max; major += majorDelta)
        {
            var minorDelta = majorDelta / this.config.minorTicks,
                point1 = 0,
                point2 = 0;
            for (var minor = major + minorDelta; minor < Math.min(major + majorDelta, this.config.max); minor += minorDelta)
            {
                point1 = this.valueToPoint(minor, 0.75);
                point2 = this.valueToPoint(minor, 0.85);

                this.body.append("svg:line")
                    .attr("x1", point1.x)
                    .attr("y1", point1.y)
                    .attr("x2", point2.x)
                    .attr("y2", point2.y)
                    .style("stroke", "#666")
                    .style("stroke-width", "1px");
            }

            point1 = this.valueToPoint(major, 0.7);
            point2 = this.valueToPoint(major, 0.85);

            this.body.append("svg:line")
                .attr("x1", point1.x)
                .attr("y1", point1.y)
                .attr("x2", point2.x)
                .attr("y2", point2.y)
                .style("stroke", "#333")
                .style("stroke-width", "2px");

            if (major == this.config.min || major == this.config.max)
            {
                var point = this.valueToPoint(major, 0.63);

                this.body.append("svg:text")
                    .attr("x", point.x)
                    .attr("y", point.y)
                    .attr("dy", fontSize / 3)
                    .attr("text-anchor", major == this.config.min ? "start" : "end")
                    .text(major)
                    .style("font-size", fontSize + "px")
                    .style("fill", "#333")
                    .style("stroke-width", "0px");
            }
        }

        var pointerContainer = this.body.append("svg:g").attr("class", "pointerContainer");

        var midValue = (this.config.min + this.config.max) / 2;

        var pointerPath = this.buildPointerPath(midValue);

        var pointerLine = d3.svg.line()
            .x(function(d) { return d.x })
            .y(function(d) { return d.y })
            .interpolate("basis");

        pointerContainer.selectAll("path")
            .data([pointerPath])
            .enter()
            .append("svg:path")
            .attr("d", pointerLine)
            .style("fill", "#888");

        pointerContainer.append("svg:circle")
            .attr("cx", this.config.cx)
            .attr("cy", this.config.cy)
            .attr("r", 0.12 * this.config.raduis)
            .style("fill", "#888");

        fontSize = Math.round(this.config.size / 10);
        pointerContainer.selectAll("text")
            .data([midValue])
            .enter()
            .append("svg:text")
            .attr("x", this.config.cx)
            .attr("y", this.config.size - this.config.cy / 4 - fontSize)
            .attr("dy", fontSize / 2)
            .attr("text-anchor", "middle")
            .style("font-size", fontSize + "px")
            .style("fill", "#000")
            .style("stroke-width", "0px");

        this.redraw(this.config.min, 0);
    };

    this.buildPointerPath = function(value)
    {
        var delta = this.config.range / 13;

        var head = valueToPoint(value, 0.85);
        var head1 = valueToPoint(value - delta, 0.12);
        var head2 = valueToPoint(value + delta, 0.12);

        var tailValue = value - (this.config.range * (1/(270/360)) / 2);
        var tail = valueToPoint(tailValue, 0.28);
        var tail1 = valueToPoint(tailValue - delta, 0.12);
        var tail2 = valueToPoint(tailValue + delta, 0.12);

        return [head, head1, tail2, tail, tail1, head2, head];

        function valueToPoint(value, factor)
        {
            var point = self.valueToPoint(value, factor);
            point.x -= self.config.cx;
            point.y -= self.config.cy;
            return point;
        }
    };

    this.drawBand = function(start, end, color)
    {
        if (0 >= end - start) return;

        this.body.append("svg:path")
            .style("fill", color)
            .attr("d", d3.svg.arc()
                .startAngle(this.valueToRadians(start))
                .endAngle(this.valueToRadians(end))
                .innerRadius(0.65 * this.config.raduis)
                .outerRadius(0.85 * this.config.raduis))
            .attr("transform", function() { return "translate(" + self.config.cx + ", " + self.config.cy + ") rotate(270)" });
    };

    this.redraw = function(value, transitionDuration)
    {
        var pointerContainer = this.body.select(".pointerContainer");

        pointerContainer.selectAll("text").text(Math.round(value));

        var pointer = pointerContainer.selectAll("path");
        pointer.transition()
            .duration(undefined != transitionDuration ? transitionDuration : this.config.transitionDuration)
            //.delay(0)
            //.ease("linear")
            //.attr("transform", function(d)
            .attrTween("transform", function()
            {
                var pointerValue = value;
                if (value > self.config.max) pointerValue = self.config.max + 0.02*self.config.range;
                else if (value < self.config.min) pointerValue = self.config.min - 0.02*self.config.range;
                var targetRotation = (self.valueToDegrees(pointerValue) - 90);
                var currentRotation = self._currentRotation || targetRotation;
                self._currentRotation = targetRotation;

                return function(step)
                {
                    var rotation = currentRotation + (targetRotation-currentRotation)*step;
                    return "translate(" + self.config.cx + ", " + self.config.cy + ") rotate(" + rotation + ")";
                }
            });

        var outerCircle = this.body.select(".outer-circle")
            .transition()
            .duration(750)
            .style("fill", function () {
                var i = parseInt(value);
                if (i > 0 && i < 75) {
                    return self.config.greenColor;
                } else if (i >= 75 && i < 90) {
                    return self.config.yellowColor;
                } else {
                    return self.config.redColor;
                }
            });
    };

    this.valueToDegrees = function(value)
    {
        // thanks @closealert
        //return value / this.config.range * 270 - 45;
        return value / this.config.range * 270 - (this.config.min / this.config.range * 270 + 45);
    };

    this.valueToRadians = function(value)
    {
        return this.valueToDegrees(value) * Math.PI / 180;
    };

    this.valueToPoint = function(value, factor)
    {
        return { 	x: this.config.cx - this.config.raduis * factor * Math.cos(this.valueToRadians(value)),
            y: this.config.cy - this.config.raduis * factor * Math.sin(this.valueToRadians(value)) 		};
    };

    // initialization
    this.configure(configuration);
}
/*! 
 * angular-hotkeys v1.5.0
 * https://chieffancypants.github.io/angular-hotkeys
 * Copyright (c) 2015 Wes Cruver
 * License: MIT
 */
!function(){"use strict";angular.module("cfp.hotkeys",[]).provider("hotkeys",["$injector",function(a){this.includeCheatSheet=!0,this.useNgRoute=a.has("ngViewDirective"),this.templateTitle="Keyboard Shortcuts:",this.templateHeader=null,this.templateFooter=null,this.template='<div class="cfp-hotkeys-container fade" ng-class="{in: helpVisible}" style="display: none;"><div class="cfp-hotkeys"><h4 class="cfp-hotkeys-title" ng-if="!header">{{ title }}</h4><div ng-bind-html="header" ng-if="header"></div><table><tbody><tr ng-repeat="hotkey in hotkeys | filter:{ description: \'!$$undefined$$\' }"><td class="cfp-hotkeys-keys"><span ng-repeat="key in hotkey.format() track by $index" class="cfp-hotkeys-key">{{ key }}</span></td><td class="cfp-hotkeys-text">{{ hotkey.description }}</td></tr></tbody></table><div ng-bind-html="footer" ng-if="footer"></div><div class="cfp-hotkeys-close" ng-click="toggleCheatSheet()">×</div></div></div>',this.cheatSheetHotkey="?",this.cheatSheetDescription="Show / hide this help menu",this.$get=["$rootElement","$rootScope","$compile","$window","$document",function(a,b,c,d,e){function f(a){var b={command:"⌘",shift:"⇧",left:"←",right:"→",up:"↑",down:"↓","return":"↩",backspace:"⌫"};a=a.split("+");for(var c=0;c<a.length;c++)"mod"===a[c]&&(d.navigator&&d.navigator.platform.indexOf("Mac")>=0?a[c]="command":a[c]="ctrl"),a[c]=b[a[c]]||a[c];return a.join(" + ")}function g(a,b,c,d,e,f){this.combo=a instanceof Array?a:[a],this.description=b,this.callback=c,this.action=d,this.allowIn=e,this.persistent=f,this._formated=null}function h(){for(var a=o.hotkeys.length;a--;){var b=o.hotkeys[a];b&&!b.persistent&&k(b)}}function i(){o.helpVisible=!o.helpVisible,o.helpVisible?(t=l("esc"),k("esc"),j("esc",t.description,i,null,["INPUT","SELECT","TEXTAREA"])):(k("esc"),t!==!1&&j(t))}function j(a,b,c,d,e,f){var h,i=["INPUT","SELECT","TEXTAREA"],j=Object.prototype.toString.call(a);if("[object Object]"===j&&(b=a.description,c=a.callback,d=a.action,f=a.persistent,e=a.allowIn,a=a.combo),b instanceof Function?(d=c,c=b,b="$$undefined$$"):angular.isUndefined(b)&&(b="$$undefined$$"),void 0===f&&(f=!0),"function"==typeof c){h=c,e instanceof Array||(e=[]);for(var k,l=0;l<e.length;l++)e[l]=e[l].toUpperCase(),k=i.indexOf(e[l]),-1!==k&&i.splice(k,1);c=function(a){var b=!0,c=a.target||a.srcElement,d=c.nodeName.toUpperCase();if((" "+c.className+" ").indexOf(" mousetrap ")>-1)b=!0;else for(var e=0;e<i.length;e++)if(i[e]===d){b=!1;break}b&&n(h.apply(this,arguments))}}"string"==typeof d?Mousetrap.bind(a,n(c),d):Mousetrap.bind(a,n(c));var m=new g(a,b,c,d,e,f);return o.hotkeys.push(m),m}function k(a){var b=a instanceof g?a.combo:a;if(Mousetrap.unbind(b),angular.isArray(b)){for(var c=!0,d=b.length;d--;)c=k(b[d])&&c;return c}var e=o.hotkeys.indexOf(l(b));return e>-1?(o.hotkeys[e].combo.length>1?o.hotkeys[e].combo.splice(o.hotkeys[e].combo.indexOf(b),1):o.hotkeys.splice(e,1),!0):!1}function l(a){if(!a)return o.hotkeys;for(var b,c=0;c<o.hotkeys.length;c++)if(b=o.hotkeys[c],b.combo.indexOf(a)>-1)return b;return!1}function m(a){return a.$id in p||(p[a.$id]=[],a.$on("$destroy",function(){for(var b=p[a.$id].length;b--;)k(p[a.$id].pop())})),{add:function(b){var c;return c=arguments.length>1?j.apply(this,arguments):j(b),p[a.$id].push(c),this}}}function n(a){return function(c,d){if(a instanceof Array){var e=a[0],f=a[1];a=function(a){f.scope.$eval(e)}}b.$apply(function(){a(c,l(d))})}}Mousetrap.prototype.stopCallback=function(a,b){return(" "+b.className+" ").indexOf(" mousetrap ")>-1?!1:b.contentEditable&&"true"==b.contentEditable},g.prototype.format=function(){if(null===this._formated){for(var a=this.combo[0],b=a.split(/[\s]/),c=0;c<b.length;c++)b[c]=f(b[c]);this._formated=b}return this._formated};var o=b.$new();o.hotkeys=[],o.helpVisible=!1,o.title=this.templateTitle,o.header=this.templateHeader,o.footer=this.templateFooter,o.toggleCheatSheet=i;var p=[];if(this.useNgRoute&&b.$on("$routeChangeSuccess",function(a,b){h(),b&&b.hotkeys&&angular.forEach(b.hotkeys,function(a){var c=a[2];("string"==typeof c||c instanceof String)&&(a[2]=[c,b]),a[5]=!1,j.apply(this,a)})}),this.includeCheatSheet){var q=e[0],r=a[0],s=angular.element(this.template);j(this.cheatSheetHotkey,this.cheatSheetDescription,i),(r===q||r===q.documentElement)&&(r=q.body),angular.element(r).append(c(s)(o))}var t=!1,u={add:j,del:k,get:l,bindTo:m,template:this.template,toggleCheatSheet:i,includeCheatSheet:this.includeCheatSheet,cheatSheetHotkey:this.cheatSheetHotkey,cheatSheetDescription:this.cheatSheetDescription,useNgRoute:this.useNgRoute,purgeHotkeys:h,templateTitle:this.templateTitle};return u}]}]).directive("hotkey",["hotkeys",function(a){return{restrict:"A",link:function(b,c,d){var e,f;angular.forEach(b.$eval(d.hotkey),function(b,c){f="string"==typeof d.hotkeyAllowIn?d.hotkeyAllowIn.split(/[\s,]+/):[],e=c,a.add({combo:c,description:d.hotkeyDescription,callback:b,action:d.hotkeyAction,allowIn:f})}),c.bind("$destroy",function(){a.del(e)})}}}]).run(["hotkeys",function(a){}])}(),function(a,b,c){function d(a,b,c){return a.addEventListener?void a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return r[a.which]?r[a.which]:s[a.which]?s[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a,b){return a.sort().join(",")===b.sort().join(",")}function g(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function h(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function i(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function j(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function k(){if(!q){q={};for(var a in r)a>95&&112>a||r.hasOwnProperty(a)&&(q[r[a]]=a)}return q}function l(a,b,c){return c||(c=k()[a]?"keydown":"keypress"),"keypress"==c&&b.length&&(c="keydown"),c}function m(a){return"+"===a?["+"]:(a=a.replace(/\+{2}/g,"+plus"),a.split("+"))}function n(a,b){var c,d,e,f=[];for(c=m(a),e=0;e<c.length;++e)d=c[e],u[d]&&(d=u[d]),b&&"keypress"!=b&&t[d]&&(d=t[d],f.push("shift")),j(d)&&f.push(d);return b=l(d,f,b),{key:d,modifiers:f,action:b}}function o(a,c){return a===b?!1:a===c?!0:o(a.parentNode,c)}function p(a){function c(a){a=a||{};var b,c=!1;for(b in u)a[b]?c=!0:u[b]=0;c||(x=!1)}function k(a,b,c,d,e,g){var h,i,k=[],l=c.type;if(!s._callbacks[a])return[];for("keyup"==l&&j(a)&&(b=[a]),h=0;h<s._callbacks[a].length;++h)if(i=s._callbacks[a][h],(d||!i.seq||u[i.seq]==i.level)&&l==i.action&&("keypress"==l&&!c.metaKey&&!c.ctrlKey||f(b,i.modifiers))){var m=!d&&i.combo==e,n=d&&i.seq==d&&i.level==g;(m||n)&&s._callbacks[a].splice(h,1),k.push(i)}return k}function l(a,b,c,d){s.stopCallback(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(h(b),i(b))}function m(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);if(b)return"keyup"==a.type&&v===b?void(v=!1):void s.handleKey(b,g(a),a)}function o(){clearTimeout(t),t=setTimeout(c,1e3)}function q(a,b,d,f){function g(b){return function(){x=b,++u[a],o()}}function h(b){l(d,b,a),"keyup"!==f&&(v=e(b)),setTimeout(c,10)}u[a]=0;for(var i=0;i<b.length;++i){var j=i+1===b.length,k=j?h:g(f||n(b[i+1]).action);r(b[i],k,f,a,i)}}function r(a,b,c,d,e){s._directMap[a+":"+c]=b,a=a.replace(/\s+/g," ");var f,g=a.split(" ");return g.length>1?void q(a,g,b,c):(f=n(a,c),s._callbacks[f.key]=s._callbacks[f.key]||[],k(f.key,f.modifiers,{type:f.action},d,a,e),void s._callbacks[f.key][d?"unshift":"push"]({callback:b,modifiers:f.modifiers,action:f.action,seq:d,level:e,combo:a}))}var s=this;if(a=a||b,!(s instanceof p))return new p(a);s.target=a,s._callbacks={},s._directMap={};var t,u={},v=!1,w=!1,x=!1;s._handleKey=function(a,b,d){var e,f=k(a,b,d),g={},h=0,i=!1;for(e=0;e<f.length;++e)f[e].seq&&(h=Math.max(h,f[e].level));for(e=0;e<f.length;++e)if(f[e].seq){if(f[e].level!=h)continue;i=!0,g[f[e].seq]=1,l(f[e].callback,d,f[e].combo,f[e].seq)}else i||l(f[e].callback,d,f[e].combo);var m="keypress"==d.type&&w;d.type!=x||j(a)||m||c(g),w=i&&"keydown"==d.type},s._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)r(a[d],b,c)},d(a,"keypress",m),d(a,"keydown",m),d(a,"keyup",m)}for(var q,r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},s={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},t={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},v=1;20>v;++v)r[111+v]="f"+v;for(v=0;9>=v;++v)r[v+96]=v;p.prototype.bind=function(a,b,c){var d=this;return a=a instanceof Array?a:[a],d._bindMultiple.call(d,a,b,c),d},p.prototype.unbind=function(a,b){var c=this;return c.bind.call(c,a,function(){},b)},p.prototype.trigger=function(a,b){var c=this;return c._directMap[a+":"+b]&&c._directMap[a+":"+b]({},a),c},p.prototype.reset=function(){var a=this;return a._callbacks={},a._directMap={},a},p.prototype.stopCallback=function(a,b){var c=this;return(" "+b.className+" ").indexOf(" mousetrap ")>-1?!1:o(b,c.target)?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},p.prototype.handleKey=function(){var a=this;return a._handleKey.apply(a,arguments)},p.init=function(){var a=p(b);for(var c in a)"_"!==c.charAt(0)&&(p[c]=function(b){return function(){return a[b].apply(a,arguments)}}(c))},p.init(),a.Mousetrap=p,"undefined"!=typeof module&&module.exports&&(module.exports=p),"function"==typeof define&&define.amd&&define(function(){return p})}(window,document);
(function () {
    'use strict';

    angular.module('scaleApp').config(['$provide', function ($provide) {
        $provide.decorator('$httpBackend', angular.mock.e2e.$httpBackendDecorator);
    }]).run(['$httpBackend', 'scaleConfig', 'XMLHttpRequest', function ($httpBackend, scaleConfig, XMLHttpRequest) {

        var getSync = function (url) {
            var request = new XMLHttpRequest();
            request.open('GET', url, false);
            request.send(null);
            return [request.status, request.response, {}];
        };

        // Ingests Status
        var ingestsStatusRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'ingests/status/', 'i');
        $httpBackend.whenGET(ingestsStatusRegex).respond(function () {
            var strikes = JSON.parse(getSync('test/data/ingestStrikes.json')[1]),
                startDate = moment.utc().subtract(1, 'w').startOf('d').toISOString(),
                endDate = moment.utc().add(1, 'd').startOf('d').toISOString(),
                numHours = moment.utc(endDate).diff(moment.utc(startDate), 'h'),
                thisTime = '',
                values = [],
                results = [];

            _.forEach(strikes.results, function (strike) {
                values = [];

                for (var i = 0; i < numHours; i++) {
                    thisTime = moment.utc(startDate).add(i, 'h').toISOString();
                    values.push({
                        time: thisTime,
                        files: Math.floor(Math.random() * (500 - 5 + 1)) + 5,
                        size: Math.floor(Math.random() * (500000000 - 5000000 + 1)) + 5000000
                    });
                }

                results.push({
                    strike: strike,
                    most_recent: moment.utc().startOf('h').toISOString(),
                    files: 2,
                    size: 123456789,
                    values: values
                });
            });

            var data = {
                count: 2,
                next: null,
                previous: null,
                results: results
            };

            return [200, data, {}];
        });

        // Ingests
        var ingestsOverrideUrl = 'test/data/ingests.json';
        var ingestsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'ingests/', 'i');
        $httpBackend.whenGET(ingestsRegex).respond(function () {
            return getSync(ingestsOverrideUrl);
        });

        // Job load
        var jobLoadRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'load/', 'i');
        $httpBackend.whenGET(jobLoadRegex).respond(function () {
            var numHours = moment.utc().endOf('d').diff(moment.utc().subtract(7, 'd').startOf('d'), 'h');
            var startTime = moment.utc().subtract(7, 'd').startOf('d');
            var data = {
                count: numHours,
                next: null,
                previous: null,
                results: []
            };

            for (var i = 0; i < data.count; i++) {
                data.results.push({
                    time: moment.utc(startTime).add(i, 'h').toISOString(),
                    pending_count: Math.floor(Math.random() * (100 - 20 + 1)) + 20,
                    queued_count: Math.floor(Math.random() * (100 - 20 + 1)) + 20,
                    running_count: Math.floor(Math.random() * (100 - 20 + 1)) + 20
                });
            }

            return [200, data, {}];
        });

        // Job details
        var jobDetailsOverrideUrl = 'test/data/jobDetails.json';
        var jobDetailsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'jobs/.*/', 'i');
        $httpBackend.whenGET(jobDetailsRegex).respond(function (method, url) {
            //return getSync(jobDetailsOverrideUrl);
            // get the jobType.id from the url
            url = url.toString();
            var id = url.substring(url.substring(0,url.lastIndexOf('/')).lastIndexOf('/')+1,url.length-1);
            jobDetailsOverrideUrl = 'test/data/job-details/jobDetails' + id + '.json';
            return getSync(jobDetailsOverrideUrl);
        });

        // Jobs
        var jobsOverrideUrl = 'test/data/jobs.json';
        var jobsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'jobs/', 'i');
        $httpBackend.whenGET(jobsRegex).respond(function () {
            return getSync(jobsOverrideUrl);
        });

        // Job type status
        var jobTypeStatusOverrideUrl = 'test/data/jobTypeStatus.json';
        var jobTypeStatusRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'job-types/status/', 'i');
        $httpBackend.whenGET(jobTypeStatusRegex).respond(function () {
            return getSync(jobTypeStatusOverrideUrl);
        });

        // Running job types
        var runningJobsOverrideUrl = 'test/data/runningJobs.json';
        var runningJobsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'job-types/running/', 'i');
        $httpBackend.whenGET(runningJobsRegex).respond(function () {
            return getSync(runningJobsOverrideUrl);
        });

        // Job Type Details
        var jobTypeDetailsOverrideUrl = 'test/data/job-types/jobType1.json';
        var jobTypeDetailsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'job-types/.*/', 'i');
        $httpBackend.whenGET(jobTypeDetailsRegex).respond(function (method, url) {
            // get the jobType.id from the url
            url = url.toString();
            var id = url.substring(url.substring(0,url.lastIndexOf('/')).lastIndexOf('/')+1,url.length-1);
            jobTypeDetailsOverrideUrl = 'test/data/job-types/jobType' + id + '.json';
            return getSync(jobTypeDetailsOverrideUrl);
        });

        // Job types
        var jobTypesOverrideUrl = 'test/data/jobTypes.json';
        var jobTypesRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'job-types/', 'i');
        $httpBackend.whenGET(jobTypesRegex).respond(function () {
            return getSync(jobTypesOverrideUrl);
        });
        
        // Job execution logs
        var jobExecutionLogsOverrideUrl = 'test/data/jobExecutionLog.json';
        var jobExecutionLogRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'job-executions/.*/logs/', 'i');
        $httpBackend.whenGET(jobExecutionLogRegex).respond(function () {
            return getSync(jobExecutionLogsOverrideUrl);
        });


        // Metrics Plot Data Detail
        //var metricsPlotDataOverrideUrl = 'test/data/metricsJobTypesPlotData.json';
        var metricsPlotDataRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'metrics/.*/.*/','i');
        $httpBackend.whenGET(metricsPlotDataRegex).respond(function (method, url) {
            var obj = {},
                random = 0;

            url.split('?')[1].split('&').forEach(function(item) {
                var s = item.split('='),
                    k = s[0],
                    v = s[1] && decodeURIComponent(s[1]);
                (k in obj) ? obj[k].push(v) : obj[k] = [v]
            });

            var returnObj = {
                count: 28,
                next: null,
                previous: null,
                results: []
            };

            var numDays = moment.utc(obj.ended[0]).diff(moment.utc(obj.started[0]), 'd') + 1;

            _.forEach(obj.column, function (metric) {
                var maxRandom = metric === 'total_count' ? 1000 : 200;
                var minRandom = metric === 'total_count' ? 800 : 10;
                var returnResult = {
                    column: { title: _.startCase(metric) },
                    min_x: moment.utc(obj.started[0]).format('YYYY-MM-DD'),
                    max_x: moment.utc(obj.ended[0]).format('YYYY-MM-DD'),
                    min_y: 1,
                    max_y: 1000,
                    values: []
                };

                for (var i = 0; i < numDays; i++) {
                    if (obj.choice_id && obj.choice_id.length > 1) {
                        _.forEach(obj.choice_id, function (id) {
                            random = Math.floor(Math.random() * (5 - 1 + 1)) + 1;
                            if (random <= 4) {
                                var value = Math.floor(Math.random() * (maxRandom - minRandom + 1)) + minRandom;
                                returnResult.values.push({
                                    date: moment.utc(obj.started[0]).add(i, 'd').format('YYYY-MM-DD'),
                                    value: value,
                                    id: parseInt(id)
                                });
                            }
                        });
                    } else {
                        random = Math.floor(Math.random() * (5 - 1 + 1)) + 1;
                        if (random <= 4) {
                            returnResult.values.push({
                                date: moment.utc(obj.started[0]).add(i, 'd').format('YYYY-MM-DD'),
                                value: Math.floor(Math.random() * (maxRandom - minRandom + 1)) + minRandom
                            });
                        }
                    }
                }
                returnObj.results.push(returnResult);
            });

            return [200, returnObj, {}];
        });

        // Metrics Detail
        var metricsDetailRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'metrics/.*/','i');
        $httpBackend.whenGET(metricsDetailRegex).respond(function (method, url) {
            var urlArr = url.split('/'),
                detailType = urlArr[urlArr.length - 2];

            if (detailType === 'job-types') {
                return getSync('test/data/metricsJobTypes.json');
            } else if (detailType === 'error-types') {
                return getSync('test/data/metricsErrorTypes.json');
            }
            return getSync('test/data/metricsIngest.json');
        });

        // Metrics
        var metricsOverrideUrl = 'test/data/metrics.json';
        var metricsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'metrics/','i');
        $httpBackend.whenGET(metricsRegex).respond(function () {
            return getSync(metricsOverrideUrl);
        });

        // Node status
        var nodeStatusOverrideUrl = 'test/data/nodeStatus.json';
        var nodeStatusRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'nodes/status/', 'i');
        $httpBackend.whenGET(nodeStatusRegex).respond(function () {
            return getSync(nodeStatusOverrideUrl);
        });

        // Node details
        var nodeOverrideUrl = 'test/data/node.json';
        var nodeRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'nodes/.*/', 'i');
        $httpBackend.whenGET(nodeRegex).respond(function () {
            return getSync(nodeOverrideUrl);
        });

        // Nodes
        var nodesOverrideUrl = 'test/data/nodes.json';
        var nodesRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'nodes/', 'i');
        $httpBackend.whenGET(nodesRegex).respond(function () {
            return getSync(nodesOverrideUrl);
        });

        // Queue Status service
        var queueStatusOverrideUrl = 'test/data/queueStatus.json';
        var queueStatusRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'queue/status/', 'i');
        $httpBackend.whenGET(queueStatusRegex).respond(function () {
            return getSync(queueStatusOverrideUrl);
        });
        
        // Recipe Details
        var recipeDetailsOverrideUrl = 'test/data/recipeDetails.json';
        var recipeDetailsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipes/.*/', 'i');
        $httpBackend.whenGET(recipeDetailsRegex).respond(function (method, url) {
            // get the recipeDetail.id from the url
            url = url.toString();
            var id = url.substring(url.substring(0,url.lastIndexOf('/')).lastIndexOf('/')+1,url.length-1);
            recipeDetailsOverrideUrl = 'test/data/recipe-details/recipeDetail' + id + '.json';
            return getSync(recipeDetailsOverrideUrl);
        });

        // Recipes service
        var recipesOverrideUrl = 'test/data/recipes.json';
        var recipesRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipes/', 'i');
        $httpBackend.whenGET(recipesRegex).respond(function () {
            return getSync(recipesOverrideUrl);
        });

        // Recipe type validation service
        var recipeTypeValidationOverrideUrl = 'test/data/recipeTypeValidationSuccess.json';
        var recipeTypeValidationRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipe-types/validation/', 'i');
        $httpBackend.whenPOST(recipeTypeValidationRegex).respond(function () {
            return getSync(recipeTypeValidationOverrideUrl);
        });

        // Recipe Type Details
        var recipeTypeDetailsOverrideUrl = 'test/data/recipe-types/recipeType1.json';
        var recipeTypeDetailsRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipe-types/.*/', 'i');
        $httpBackend.whenGET(recipeTypeDetailsRegex).respond(function (method, url) {
            // get the recipeType.id from the url
            url = url.toString();
            var id = url.substring(url.substring(0,url.lastIndexOf('/')).lastIndexOf('/')+1,url.length-1);
            recipeTypeDetailsOverrideUrl = 'test/data/recipe-types/recipeType' + id + '.json';
            var returnValue = getSync(recipeTypeDetailsOverrideUrl);
            if (returnValue[0] !== 200) {
                returnValue = localStorage.getItem('recipeType' + id);
                return [200, JSON.parse(returnValue), {}];
            } else {
                return returnValue;
            }
        });

        // Recipe Types service
        var recipeTypesOverrideUrl = 'test/data/recipeTypes.json';
        var recipeTypesRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipe-types/', 'i');
        $httpBackend.whenGET(recipeTypesRegex).respond(function () {
            return getSync(recipeTypesOverrideUrl);
        });

        // Save Recipe Type
        var recipeTypeSaveRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'recipe-types/', 'i');
        $httpBackend.whenPOST(recipeTypeSaveRegex).respond(function (method, url, data) {
            var recipeJobTypes = [],
                recipeJobTypesDetails = [],
                jobTypeData = getSync('test/data/jobTypes.json'),
                jobTypes = JSON.parse(jobTypeData[1]).results,
                recipeType = JSON.parse(data),
                uniqueRecipeTypeJobs = _.uniq(recipeType.definition.jobs, 'job_type');
            _.forEach(uniqueRecipeTypeJobs, function (job) {
                recipeJobTypes.push(_.find(jobTypes, function (jobType) {
                    return jobType.name === job.job_type.name && jobType.version === job.job_type.version;
                }));
            });
            _.forEach(recipeJobTypes, function (jobType) {
                var jt = getSync('test/data/job-types/jobType' + jobType.id + '.json');
                recipeJobTypesDetails.push(JSON.parse(jt[1]));
            });
            var returnRecipe = {
                id: Math.floor(Math.random() * (10000 - 5 + 1)) + 5,
                name: recipeType.name,
                version: recipeType.version,
                title: recipeType.title,
                description: recipeType.description,
                is_active: true,
                definition: recipeType.definition,
                revision_num: 1,
                created: new Date().toISOString(),
                last_modified: new Date().toISOString(),
                archived: null,
                trigger_rule: recipeType.trigger_rule,
                job_types: recipeJobTypesDetails
            };
            return [200, JSON.stringify(returnRecipe), {}];
        });

        // Status service
        var statusOverrideUrl = 'test/data/status.json';
        var statusRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'status/', 'i');
        $httpBackend.whenGET(statusRegex).respond(function () {
            return getSync(statusOverrideUrl);
        });

        // Version
        var versionOverrideUrl = 'test/data/version.json';
        var versionRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'v3/version/', 'i');
        $httpBackend.whenGET(versionRegex).respond(function () {
            return getSync(versionOverrideUrl);
        });

        // Workspaces
        var workspacesOverrideUrl = 'test/data/workspaces.json';
        var workspacesRegex = new RegExp('^' + scaleConfig.urls.apiPrefix + 'workspaces/', 'i');
        $httpBackend.whenGET(workspacesRegex).respond(function () {
            return getSync(workspacesOverrideUrl);
        });





        // For everything else, don't mock
        $httpBackend.whenGET(/^\w+.*/).passThrough();
        $httpBackend.whenPOST(/^\w+.*/).passThrough();
    }]);
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNjYWxlQ29uZmlnLmpzIiwiaGVhZGVyL2hlYWRlckRpcmVjdGl2ZS5qcyIsIm5hdmlnYXRpb24vbmF2RGlyZWN0aXZlLmpzIiwiYWJvdXQvY29udHJvbGxlcnMvYWJvdXRDb250cm9sbGVyLmpzIiwiY2hhcnRzL2RhdGFGZWVkL2RhdGFGZWVkRGlyZWN0aXZlLmpzIiwiY2hhcnRzL2RvbnV0L2RvbnV0Q29udHJvbGxlci5qcyIsImNoYXJ0cy9kb251dC9kb251dERpcmVjdGl2ZS5qcyIsImNoYXJ0cy9ncmlkL2dyaWRDaGFydENvbnRyb2xsZXIuanMiLCJjaGFydHMvZ3JpZC9ncmlkQ2hhcnREaXJlY3RpdmUuanMiLCJjaGFydHMvaGVhbHRoL2hlYWx0aENvbnRyb2xsZXIuanMiLCJjaGFydHMvaGVhbHRoL2hlYWx0aERpcmVjdGl2ZS5qcyIsImNoYXJ0cy9qb2JMb2FkL2pvYkxvYWRDb250cm9sbGVyLmpzIiwiY2hhcnRzL2pvYkxvYWQvam9iTG9hZERpcmVjdGl2ZS5qcyIsImNoYXJ0cy9yYWRpYWxQZXJjZW50YWdlL3JhZGlhbFBlcmNlbnRhZ2VDb250cm9sbGVyLmpzIiwiY2hhcnRzL3JhZGlhbFBlcmNlbnRhZ2UvcmFkaWFsUGVyY2VudGFnZURpcmVjdGl2ZS5qcyIsImNoYXJ0cy90aW1lbGluZS90aW1lbGluZURpcmVjdGl2ZS5qcyIsImFkbWluL2NvbnRyb2xsZXJzL2FkbWluTG9naW5Db250cm9sbGVyLmpzIiwiYWRtaW4vY29udHJvbGxlcnMvbG9nb3V0Q29udHJvbGxlci5qcyIsImZlZWQvY29udHJvbGxlcnMvZmVlZERldGFpbHNDb250cm9sbGVyLmpzIiwiZmVlZC9jb250cm9sbGVycy9pbmdlc3RSZWNvcmRzQ29udHJvbGxlci5qcyIsImZlZWQvbW9kZWxzL0ZlZWQuanMiLCJmZWVkL21vZGVscy9GZWVkU3RhdHVzLmpzIiwiZmVlZC9tb2RlbHMvSW5nZXN0LmpzIiwiZmVlZC9zZXJ2aWNlcy9mZWVkU2VydmljZS5qcyIsImNvbW1vbi9kaXJlY3RpdmVzL2Fpc011bHRpc2VsZWN0LmpzIiwiY29tbW9uL2ZhY3Rvcmllcy9nYXVnZUZhY3RvcnkuanMiLCJjb21tb24vZmFjdG9yaWVzL2dyaWRGYWN0b3J5LmpzIiwiY29tbW9uL2ZhY3Rvcmllcy9wb2xsZXJGYWN0b3J5LmpzIiwiY29tbW9uL21vZGVscy9TdGF0dXMuanMiLCJjb21tb24vbW9kZWxzL1N0YXR1c01hc3Rlci5qcyIsImNvbW1vbi9tb2RlbHMvU3RhdHVzUmVzb3VyY2UuanMiLCJjb21tb24vbW9kZWxzL1N0YXR1c1Jlc291cmNlcy5qcyIsImNvbW1vbi9tb2RlbHMvU3RhdHVzU2NoZWR1bGVyLmpzIiwiY29tbW9uL3NlcnZpY2VzL3NjYWxlU2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9zY2hlZHVsZXJTZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3N0YXRlU2VydmljZS5qcyIsImNvbW1vbi9zZXJ2aWNlcy9zdGF0dXNTZXJ2aWNlLmpzIiwiY29tbW9uL3NlcnZpY2VzL3VzZXJTZXJ2aWNlLmpzIiwiam9icy9jb250cm9sbGVycy9qb2JEZXRhaWxDb250cm9sbGVyLmpzIiwiam9icy9jb250cm9sbGVycy9qb2JFeGVjdXRpb25EZXRhaWxDb250cm9sbGVyLmpzIiwiam9icy9jb250cm9sbGVycy9qb2JFeGVjdXRpb25zQ29udHJvbGxlci5qcyIsImpvYnMvY29udHJvbGxlcnMvam9iVHlwZXNDb250cm9sbGVyLmpzIiwiam9icy9jb250cm9sbGVycy9qb2JUeXBlc0ZhaWx1cmVSYXRlc0NvbnRyb2xsZXIuanMiLCJqb2JzL2NvbnRyb2xsZXJzL2pvYnNDb250cm9sbGVyLmpzIiwiam9icy9kaXJlY3RpdmVzL2pvYkV4ZWN1dGlvbkxvZ0RpcmVjdGl2ZS5qcyIsImpvYnMvZGlyZWN0aXZlcy9qb2JIZWFsdGhEaXJlY3RpdmUuanMiLCJqb2JzL2RpcmVjdGl2ZXMvam9iVHlwZUludGVyZmFjZURpcmVjdGl2ZS5qcyIsImpvYnMvbW9kZWxzL0pvYi5qcyIsImpvYnMvbW9kZWxzL0pvYkRldGFpbEV2ZW50LmpzIiwiam9icy9tb2RlbHMvSm9iRGV0YWlsRXZlbnRSdWxlLmpzIiwiam9icy9tb2RlbHMvSm9iRGV0YWlsSW5wdXREYXRhLmpzIiwiam9icy9tb2RlbHMvSm9iRGV0YWlsT3V0cHV0RGF0YS5qcyIsImpvYnMvbW9kZWxzL0pvYkRldGFpbHMuanMiLCJqb2JzL21vZGVscy9Kb2JFeGVjdXRpb24uanMiLCJqb2JzL21vZGVscy9Kb2JFeGVjdXRpb25Mb2cuanMiLCJqb2JzL21vZGVscy9Kb2JUeXBlLmpzIiwiam9icy9tb2RlbHMvSm9iVHlwZURldGFpbHMuanMiLCJqb2JzL21vZGVscy9Kb2JUeXBlRXJyb3IuanMiLCJqb2JzL21vZGVscy9Kb2JUeXBlRXJyb3JNYXBwaW5nLmpzIiwiam9icy9tb2RlbHMvSm9iVHlwZUlucHV0RGF0YS5qcyIsImpvYnMvbW9kZWxzL0pvYlR5cGVJbnRlcmZhY2UuanMiLCJqb2JzL21vZGVscy9Kb2JUeXBlT3V0cHV0RGF0YS5qcyIsImpvYnMvbW9kZWxzL0pvYlR5cGVTdGF0dXMuanMiLCJqb2JzL21vZGVscy9Qcm9kdWN0LmpzIiwiam9icy9tb2RlbHMvUnVubmluZ0pvYi5qcyIsImpvYnMvbW9kZWxzL1N5c3RlbUZhaWx1cmUuanMiLCJsb2FkL2NvbnRyb2xsZXJzL2xvYWRDb250cm9sbGVyLmpzIiwibG9hZC9jb250cm9sbGVycy9sb2FkRGVwdGhDb250cm9sbGVyLmpzIiwibG9hZC9jb250cm9sbGVycy9xdWV1ZVJ1bm5pbmdDb250cm9sbGVyLmpzIiwiam9icy9zZXJ2aWNlcy9qb2JFeGVjdXRpb25TZXJ2aWNlLmpzIiwiam9icy9zZXJ2aWNlcy9qb2JTZXJ2aWNlLmpzIiwiam9icy9zZXJ2aWNlcy9qb2JUeXBlU2VydmljZS5qcyIsImxvYWQvbW9kZWxzL1F1ZXVlU3RhdHVzLmpzIiwibG9hZC9zZXJ2aWNlcy9sb2FkU2VydmljZS5qcyIsIm1ldHJpY3MvY29udHJvbGxlcnMvbWV0cmljc0NvbnRyb2xsZXIuanMiLCJtZXRyaWNzL3NlcnZpY2VzL21ldHJpY3NTZXJ2aWNlLmpzIiwibmF2aWdhdGlvbi9jb250cm9sbGVycy9uYXZDb250cm9sbGVyLmpzIiwibmF2aWdhdGlvbi9zZXJ2aWNlcy9uYXZTZXJ2aWNlLmpzIiwibmF2aWdhdGlvbi9zZXJ2aWNlcy9zdWJuYXZTZXJ2aWNlLmpzIiwibm9kZXMvY29udHJvbGxlcnMvbm9kZURldGFpbHNDb250cm9sbGVyLmpzIiwibm9kZXMvY29udHJvbGxlcnMvbm9kZXNDb250cm9sbGVyLmpzIiwibm9kZXMvZGlyZWN0aXZlcy9ub2RlSGVhbHRoRGlyZWN0aXZlLmpzIiwibm9kZXMvbW9kZWxzL05vZGUuanMiLCJub2Rlcy9tb2RlbHMvTm9kZVJlc291cmNlcy5qcyIsIm5vZGVzL21vZGVscy9Ob2RlU3RhdHVzLmpzIiwibm9kZXMvc2VydmljZXMvbm9kZVNlcnZpY2UuanMiLCJub2Rlcy9zZXJ2aWNlcy9ub2RlVXBkYXRlU2VydmljZS5qcyIsIm92ZXJ2aWV3L2NvbnRyb2xsZXJzL292Q29udHJvbGxlci5qcyIsIndvcmtzcGFjZXMvc2VydmljZXMvd29ya3NwYWNlc1NlcnZpY2UuanMiLCJyZWNpcGVzL2NvbnRyb2xsZXJzL3JlY2lwZURldGFpbHNDb250cm9sbGVyLmpzIiwicmVjaXBlcy9jb250cm9sbGVycy9yZWNpcGVFZGl0b3JDb250cm9sbGVyLmpzIiwicmVjaXBlcy9jb250cm9sbGVycy9yZWNpcGVUeXBlc0NvbnRyb2xsZXIuanMiLCJyZWNpcGVzL2NvbnRyb2xsZXJzL3JlY2lwZXNDb250cm9sbGVyLmpzIiwicmVjaXBlcy9kaXJlY3RpdmVzL3JlY2lwZUdyYXBoVmlld2VyRGlyZWN0aXZlLmpzIiwicmVjaXBlcy9tb2RlbHMvUmVjaXBlLmpzIiwicmVjaXBlcy9tb2RlbHMvUmVjaXBlRGF0YS5qcyIsInJlY2lwZXMvbW9kZWxzL1JlY2lwZURldGFpbHMuanMiLCJyZWNpcGVzL21vZGVscy9SZWNpcGVKb2IuanMiLCJyZWNpcGVzL21vZGVscy9SZWNpcGVKb2JDb250YWluZXIuanMiLCJyZWNpcGVzL21vZGVscy9SZWNpcGVUeXBlLmpzIiwicmVjaXBlcy9tb2RlbHMvUmVjaXBlVHlwZURlZmluaXRpb24uanMiLCJyZWNpcGVzL21vZGVscy9SZWNpcGVUeXBlRGVmaW5pdGlvbkpvYi5qcyIsInJlY2lwZXMvbW9kZWxzL1JlY2lwZVR5cGVEZXRhaWwuanMiLCJyZWNpcGVzL21vZGVscy9SZWNpcGVUeXBlVmFsaWRhdGlvbi5qcyIsInJlY2lwZXMvc2VydmljZXMvcmVjaXBlU2VydmljZS5qcyIsImdhbnR0LWNoYXJ0LWQzLmpzIiwiZ2F1Z2UuanMiLCJob3RrZXlzLm1pbi5qcyIsImJhY2tlbmRTdHVicy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxJQUFBLE1BQUEsUUFBQSxPQUFBLFlBQUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBOzs7SUFHQSxJQUFBLCtEQUFBLFNBQUEsZ0JBQUEsbUJBQUEsY0FBQTs7UUFFQSxhQUFBLG9CQUFBO1FBQ0EsYUFBQSxRQUFBOzs7UUFHQSxrQkFBQSxTQUFBLHVCQUFBOzs7UUFHQTthQUNBLEtBQUEsS0FBQTtnQkFDQSxZQUFBO2dCQUNBLGFBQUE7O2FBRUEsS0FBQSxlQUFBO2dCQUNBLFlBQUE7Z0JBQ0EsYUFBQTs7YUFFQSxLQUFBLGdCQUFBO2dCQUNBLFlBQUE7Z0JBQ0EsYUFBQTs7YUFFQSxLQUFBLFVBQUE7Z0JBQ0EsWUFBQTtnQkFDQSxhQUFBOzthQUVBLEtBQUEsU0FBQTtnQkFDQSxZQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsZ0JBQUE7O2FBRUEsS0FBQSxpQkFBQTtnQkFDQSxZQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsZ0JBQUE7O2FBRUEsS0FBQSxZQUFBO2dCQUNBLFlBQUE7Z0JBQ0EsYUFBQTtnQkFDQSxnQkFBQTs7YUFFQSxLQUFBLFVBQUE7Z0JBQ0EsWUFBQTtnQkFDQSxhQUFBOzthQUVBLEtB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LFVBQUE7b0JBQ0EsWUFBQTs7O2dCQUdBLEVBQUEsUUFBQSxNQUFBLFFBQUEsVUFBQSxHQUFBO29CQUNBLFFBQUEsS0FBQSxDQUFBLEVBQUEsT0FBQSxHQUFBLElBQUEsRUFBQSxPQUFBLEdBQUE7Ozs7Z0JBSUEsRUFBQSxRQUFBLFNBQUEsVUFBQSxJQUFBO29CQUNBLElBQUEsT0FBQSxFQUFBLEtBQUEsT0FBQSxTQUFBLFVBQUEsSUFBQTt3QkFDQSxPQUFBLEdBQUEsT0FBQSxHQUFBOztvQkFFQSxJQUFBLENBQUEsTUFBQTt3QkFDQSxVQUFBLEtBQUEsR0FBQTs7Ozs7OztnQkFPQSxNQUFBLEtBQUE7b0JBQ0EsU0FBQSxPQUFBO29CQUNBLFFBQUE7O21CQUVBO2dCQUNBLFFBQUEsR0FBQSxTQUFBO29CQUNBLFFBQUEsU0FBQTtvQkFDQSxNQUFBO3dCQUNBLFNBQUEsT0FBQTt3QkFDQSxNQUFBLE9BQUE7d0JBQ0EsUUFBQTs0QkFDQSxNQUFBLFlBQUEsT0FBQTs0QkFDQSxTQUFBLFlBQUEsT0FBQTs0QkFDQSxJQUFBLFlBQUEsT0FBQTs0QkFDQSxXQUFBLFlBQUEsT0FBQTs0QkFDQSxNQUFBOzRCQUNBLE9BQUEsWUFBQSxPQUFBOzRCQUNBLFFBQUEsWUFBQSxPQUFBOzRCQUNBLFdBQUEsWUFBQSxPQUFBOzRCQUNBLE1BQUEsWUFBQSxPQUFBOzRCQUNBLFFBQUEsWUFBQSxPQUFBOzRCQUNBLFNBQUEsWUFBQSxPQUFBOzRCQUNBLHFCQUFBLFlBQUEsT0FBQTs0QkFDQSxRQUFBLFlBQUEsT0FBQTs7O29CQUdBLFlBQUE7d0JBQ0EsVUFBQTs7b0JBRUEsS0FBQTt3QkFDQSxPQUFBOzRCQUNBLFFBQUEsR0FBQSxPQUFBOzs7b0JBR0EsT0FBQTt3QkFDQSxPQUFBOzRCQUNBLFFBQUEsT0FBQSxZQUFBLEdBQUEsT0FBQSxPQUFBLFlBQUE7Z0NBQ0EsT0FBQTs7O3dCQUdBLE9BQUEsT0FBQTt3QkFDQSxPQUFBLE9BQUE7O29CQUVBLFNBQUE7d0JBQ0EsUUFBQTs0QkFDQSxPQUFBLEdBQUEsT0FBQTs7O29CQUdB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QTs7OztRQUlBLElBQUEsZUFBQSxVQUFBLEdBQUE7WUFDQSxJQUFBLEdBQUE7Z0JBQ0EsT0FBQSxFQUFBOzs7O1FBSUEsSUFBQSxlQUFBLFVBQUEsR0FBQTtZQUNBLElBQUEsS0FBQSxFQUFBLFFBQUE7Z0JBQ0EsT0FBQSxFQUFBLE9BQUE7O1lBRUEsT0FBQTs7O1FBR0EsSUFBQSxlQUFBLFVBQUEsR0FBQTtZQUNBLElBQUEsS0FBQSxFQUFBLFFBQUE7Z0JBQ0EsT0FBQSxFQUFBLE9BQUE7O1lBRUEsT0FBQTs7O1FBR0EsSUFBQSxnQkFBQSxVQUFBLEdBQUE7WUFDQSxJQUFBLEtBQUEsRUFBQSxRQUFBO2dCQUNBLElBQUEsRUFBQSxlQUFBLFFBQUE7b0JBQ0EsT0FBQSxFQUFBLE9BQUE7OztZQUdBLE9BQUE7OztRQUdBLElBQUEsY0FBQSxVQUFBLEdBQUE7WUFDQSxJQUFBLEtBQUEsRUFBQSxRQUFBO2dCQUNBLElBQUEsRUFBQSxlQUFBLFFBQUE7b0JBQ0EsT0FBQSxFQUFBLE9BQUE7Ozs7O1FBS0EsSUFBQSxrQkFBQSxVQUFBLEdBQUE7WUFDQSxJQUFBLEtBQUEsRUFBQSxRQUFBO2dCQUNBLElBQUEsRUFBQSxlQUFBLFdBQUE7b0JBQ0EsT0FBQSxFQUFBLE9BQUE7Ozs7O1FBS0EsSUFBQSxtQkFBQSxVQUFBLFFBQUE7O1lBRUEsZUFBQSxHQUFBLE1BQUE7WUFDQSxlQUFBLEdBQUEsTUFBQTtZQUNBLElBQUEsZ0JBQUEsZ0JBQUEsZ0JBQUEsY0FBQTs7Z0JBRUEsT0FBQSxPQUFBLFlBQUE7b0JBQ0EsSUFBQSxPQUFBLGVBQUEsV0FBQTt3QkFDQSxVQUFBLEtBQUEsU0FBQSxPQUFBLGVBQUEsT0FBQSxJQUFBLE9BQUEsVUFBQSxPQUFBLE9BQUEsWUFBQTsyQkFDQSxJQUFBLE9BQUEsZUFBQSxRQUFBO3dCQUNBLFVBQUEsS0FBQSxZQUFBLE9BQUE7Ozs7OztRQU1BLElBQUEsU0FBQSxZQUFBOzs7WUFHQSxJQUFBLE9BQUEsZUFBQTtnQkFDQSxJQUFBLGlCQUFBLElBQUEsVUFBQTtxQkFDQSxLQUFBLE9B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QkFDQSxJQUFBLFdBQUEsZ0JBQUE7b0JBQ0EsSUFBQSxZQUFBLFNBQUEsU0FBQSxHQUFBO3dCQUNBLElBQUEsU0FBQSxXQUFBLEdBQUE7NEJBQ0EsT0FBQTs7O29CQUdBLE9BQUE7O2lCQUVBLEtBQUEsY0FBQSxVQUFBLEdBQUE7b0JBQ0EsSUFBQSxXQUFBLGdCQUFBO29CQUNBLElBQUEsWUFBQSxTQUFBLFNBQUEsR0FBQTt3QkFDQSxPQUFBLFNBQUEsT0FBQSxXQUFBLFlBQUEsT0FBQSxpQkFBQSxTQUFBLE9BQUEsU0FBQSxZQUFBLE9BQUEsZUFBQSxZQUFBLE9BQUE7O29CQUVBLE9BQUEsWUFBQTs7O1lBR0EsVUFBQSxPQUFBO2lCQUNBLEtBQUEsU0FBQSxVQUFBLEdBQUE7b0JBQ0EsSUFBQSxTQUFBLGdCQUFBO29CQUNBLElBQUEsUUFBQTt3QkFDQSxPQUFBLE9BQUEsUUFBQSxJQUFBLHVCQUFBOztvQkFFQSxPQUFBOztpQkFFQSxLQUFBLFNBQUEsT0FBQTtpQkFDQSxLQUFBLFVBQUEsT0FBQTtpQkFDQSxNQUFBLFFBQUEsVUFBQSxHQUFBO29CQUNBLElBQUEsRUFBQSxlQUFBLFFBQUE7d0JBQ0EsT0FBQSxZQUFBOzs7aUJBR0EsS0FBQSxRQUFBLFVBQUEsR0FBQTtvQkFDQSxJQUFBLEVBQUEsZUFBQSxXQUFBO3dCQUNBLE9BQUEsVUFBQSxFQUFBLE9BQUE7OztpQkFHQSxNQUFBLFVBQUEsVUFBQSxHQUFBO29CQUNBLE9BQUEsSUFBQSxTQUFBOztpQkFFQTtpQkFDQSxTQUFBOztZQUVBLFVBQUEsT0FBQTtpQkFDQSxLQUFBLFNBQUE7aUJBQ0EsS0FBQSxVQUFBLEdBQUE7b0JBQ0EsT0FBQSxZQUFBOztpQkFFQSxLQUFBLGVBQUE7aUJBQ0EsS0FBQSxLQUFBLE9BQUEsWUFBQTtpQkFDQSxLQUFBLEtBQUEsVUFBQSxHQUFBO29CQUNBLElBQUEsRUFBQSxlQUFBLFdBQUE7d0JBQ0EsSUFBQSxxQkFBQSxLQUFBLEdBQUE7NEJBQ0EsT0FBQSxPQUFBLGFBQUE7O3dCQUVBLE9BQUEsQ0FBQSxPQUFBLGFB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QUNBOzs7OztBQ3JPQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxVQUFBLGNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQSxZQUFBO1lBQ0EsYUFBQTtZQUNBLFVBQUE7WUFDQSxPQUFBO2dCQUNBLFlBQUE7Z0JBQ0EsWUFBQTtnQkFDQSxXQUFBO2dCQUNBLFlBQUE7Ozs7OztBQ1pBOztBQUVBLFFBQUEsT0FBQSxZQUFBLFdBQUEsdUVBQUEsU0FBQSxRQUFBLFVBQUEsYUFBQTtJQUNBLElBQUEsZ0JBQUE7UUFDQSxhQUFBO1FBQ0EsT0FBQTtRQUNBLFdBQUE7UUFDQSxZQUFBOztJQUVBLElBQUEsZ0JBQUEsWUFBQTtRQUNBLElBQUEsUUFBQSxXQUFBLE9BQUE7UUFDQSxJQUFBLFNBQUEsSUFBQTtZQUNBLE9BQUEsWUFBQSxPQUFBO2VBQ0EsSUFBQSxRQUFBLE1BQUEsU0FBQSxJQUFBO1lBQ0EsT0FBQSxZQUFBLE9BQUE7ZUFDQTtZQUNBLE9BQUEsWUFBQSxPQUFBOzs7O0lBSUEsSUFBQSxhQUFBLFdBQUE7O1FBRUEsSUFBQSxhQUFBLE9BQUEsY0FBQTtRQUNBLElBQUEsYUFBQSxHQUFBO1lBQ0EsY0FBQTs7Ozs7UUFLQSxJQUFBLE9BQUEsU0FBQSxHQUFBLFdBQUE7UUFDQSxJQUFBLFNBQUEsR0FBQSxXQUFBLGVBQUEsTUFBQTtZQUNBLE9BQUEsU0FBQSxHQUFBLFdBQUE7Ozs7UUFJQSxJQUFBLFdBQUE7UUFDQSxJQUFBLGdCQUFBLEdBQUEsT0FBQTs7UUFFQSxJQUFBLE1BQUEsR0FBQSxJQUFBO2FBQ0EsV0FBQTthQUNBLFlBQUEsT0FBQSxPQUFBO2FBQ0EsWUFBQSxPQUFBLE9BQUE7O1FBRUEsSUFBQSxNQUFBLEdBQUEsT0FBQSxTQUFBLElBQUEsT0FBQSxPQUFBLEtBQUE7WUFDQSxPQUFBO1lBQ0EsUUFBQTtXQUNBLE9BQUEsS0FBQSxLQUFBO1lBQ0EsYUFBQSxlQUFBLE9BQUEsSUFBQSxNQUFBLE9BQUEsSUFBQTtZQUNBLFNBQUE7OztRQUdBLElBQUEsUUFBQSxJQUFBLE9BQUEsS0FBQSxLQUFBO1lBQ0EsYUFBQTs7UUFFQSxNQUFBLE9BQUE7YUFDQSxNQUFBO2dCQUNBLFdBQUEsSUFBQSxLQUFBOzthQUVBLEtBQUEsU0FBQTthQUNBLEtBQUEsS0FBQTs7UUFFQSxhQUFBLE1BQUEsT0FBQTthQUNBLE1BQUE7Z0JBQ0EsVUFBQTs7YUFFQSxLQUFBO2dCQUNBLEtBQUE7O2FBRUEsTUFBQSxRQUFBLFlBQUE7Z0JBQ0EsT0FBQTs7O1FBR0EsT0FBQSxJQUFBLE9BQUE7YUFDQSxNQUFBO2dCQUNBLFlBQUE7O2FBRUEsS0FBQSxlQUFBO2FBQ0EsS0FBQSxNQUFBOzs7UUFHQSxZQUFBLFNBQUEsWUFBQSxlQUFBO1lBQ0EsV0FBQSxVQUFBLFFBQUEsU0FBQSxHQUFBO2dCQUNBLElBQUEsT0FBQSxNQUFBLGFBQUE7b0JBQ0EsSUFBQTs7Z0JBRUEsSUFBQSxJQUFBLEdBQUEsWUFBQSxFQUFBLFlBQUE7Z0JBQ0EsT0FBQSxTQUFBLEdBQUE7b0JBQ0EsRUFBQSxhQUFBLEVBQUE7b0JBQ0EsS0FBQSxLQUFBLGNBQUEsRUFBQTtvQkFDQSxPQUFBOzs7O1FBSUEsV0FBQSxTQUFBLFlBQUEsVUFBQTtZQUNBLFdBQUEsVUFBQSxLQUFBLFNBQUEsR0FBQTtnQkFDQSxJQUFBLElBQUEsR0FBQSxZQUFBLEVBQUEsVUFBQTtnQkFDQSxPQUFBLFNBQUEsR0FBQTtvQkFDQSxFQUFBLFdBQUEsRUFBQTtvQkFDQSxPQUFBLElBQUE7Ozs7O1FBS0EsZ0JBQUE7O1FBRUEsT0FBQTs7Ozs7Ozs7SUFRQSxJQUFBLFNBQUEsVUFBQSxPQUFBO1FBQ0EsSUFBQSxlQUFBO1lBQ0EsSUFBQSxhQUFBO1lBQ0EsSUFBQSxhQUFBLEdBQUE7Z0JBQ0EsY0FBQTs7Ozs7WUFLQSxXQUFBLGFBQUEsU0FBQTtpQkFDQSxNQUFBLFFBQUEsWUFBQTtvQkFDQSxPQUFBOztpQkFFQSxLQUFBLFVBQUEsQ0FBQSxLQUFBLEtBQUEsS0FBQTs7WUFFQSxLQUFBLGFBQUEsU0FBQSxNQUFBLEtBQUEsV0FBQTs7OztJQUlBLE9BQUEsT0FBQSxjQUFBLFNBQUEsT0FBQTtRQUNBLElBQUEsU0FBQSxDQUFBLGVBQUE7WUFDQTtlQUNBO1lBQ0EsT0FBQTs7Ozs7QUN4SUE7O0FBRUEsUUFBQSxPQUFBLFlBQUEsVUFBQSx1QkFBQSxZQUFBO0lBQ0EsT0FBQTtRQUNBLFlBQUE7UUFDQSxVQUFBO1FBQ0EsT0FBQTtZQUNBLFlBQUE7Ozs7O0FDUEEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsV0FBQSx3RUFBQSxVQUFBLFFBQUEsVUFBQSxhQUFBOztRQUVBLElBQUEsUUFBQTs7UUFFQSxTQUFBLEdBQUEsV0FBQSxVQUFBO1lBQ0EsUUFBQSxJQUFBOzs7UUFHQSxJQUFBLGFBQUEsV0FBQTtZQUNBLE9BQUEsT0FBQSxTQUFBLFVBQUEsT0FBQTtnQkFDQTs7OztRQUlBLElBQUEsZUFBQSxVQUFBO1lBQ0EsR0FBQSxPQUFBLFNBQUEsT0FBQSxNQUFBLFNBQUEsRUFBQTtnQkFDQSxPQUFBLE1BQUEsS0FBQSxTQUFBLEdBQUEsR0FBQTtvQkFDQSxPQUFBLEVBQUEsT0FBQSxTQUFBLEVBQUEsT0FBQTs7O2dCQUdBLE9BQUEsWUFBQSxFQUFBLE9BQUEsT0FBQSxNQUFBLFlBQUEsT0FBQTtnQkFDQSxJQUFBLFNBQUEsT0FBQSxVQUFBLFNBQUEsS0FBQTs7Z0JBRUEsSUFBQSxRQUFBLFNBQUEsR0FBQTtnQkFDQSxJQUFBLENBQUEsU0FBQSxVQUFBLEdBQUEsRUFBQSxRQUFBOzs7Z0JBR0EsT0FBQSxNQUFBLEtBQUEsU0FBQSxHQUFBLEdBQUE7b0JBQ0EsT0FBQSxFQUFBLE9BQUEsV0FBQSxFQUFBLE9BQUE7O2dCQUVBLElBQUEsVUFBQSxPQUFBLE1BQUEsR0FBQSxPQUFBO2dCQUNBLElBQUEsVUFBQSxPQUFBLE1BQUEsT0FBQSxNQUFBLFNBQUEsR0FBQSxPQUFBO2dCQUNBLElBQUEsV0FBQSxPQUFBLElBQUEsU0FBQSxLQUFBLE9BQUEsSUFBQSxTQUFBO2dCQUNBLElBQUEsU0FBQTtnQkFDQSxHQUFBLFdBQUEsRUFBQTtvQkFDQSxTQUFBOzs7Z0JBR0Es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WUFBQSxRQUFBLFVBQUEsTUFBQSxhQUFBO29CQUNBLFdBQUEsVUFBQTtvQkFDQSxFQUFBLFFBQUEsT0FBQSxRQUFBLEtBQUEsU0FBQSxVQUFBLEtBQUE7d0JBQ0EsSUFBQSxPQUFBLE9BQUEsSUFBQTs7b0JBRUEsV0FBQSxVQUFBLE9BQUEsUUFBQSxLQUFBLFFBQUE7b0JBQ0EsSUFBQSxVQUFBO29CQUNBLEVBQUEsUUFBQSxhQUFBLFVBQUEsS0FBQTt3QkFDQSxRQUFBLEtBQUEsSUFBQSxLQUFBLGNBQUEsU0FBQSxNQUFBLElBQUEsUUFBQSxJQUFBOztvQkFFQSxZQUFBOzs7O1FBSUEsT0FBQSxnQkFBQSxZQUFBO1lBQ0EsRUFBQSxRQUFBLEVBQUEsTUFBQSxhQUFBLFVBQUEsT0FBQTtnQkFDQSxVQUFBLE9BQUEsTUFBQSxJQUFBLE1BQUE7O1lBRUE7OztRQUdBLElBQUEsY0FBQSxVQUFBLFNBQUE7WUFDQSxXQUFBLFFBQUEsUUFBQSxTQUFBLElBQUEsVUFBQTtZQUNBLGtCQUFBLFFBQUEsU0FBQTtZQUNBLE9BQUE7OztRQUdBLElBQUEsYUFBQSxZQUFBO1lBQ0EsT0FBQSxVQUFBO1lBQ0EsWUFBQSxlQUFBLFlBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxVQUFBLEtBQUE7Z0JBQ0EsT0FBQSxZQUFBLGFBQUEsS0FBQTtnQkFDQSxPQUFBLFlBQUEsT0FBQSxPQUFBO2dCQUNBLE9BQUEsVUFBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLFFBQUEsSUFBQTtlQUNBLFFBQUEsWUFBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7O1FBS0EsSUFBQSxhQUFBLFlBQUE7WUFDQSxXQUFBLGVBQUE7WUFDQSxjQUFBLGVBQUE7WUFDQSxJQUFBLENBQUEsV0FBQSxTQUFBO2dCQUNBLFFBQUEsSUFBQSx3QkFBQSxPQUFBO2dCQUNBLFdBQUEsVUFBQSxPQUFBLElBQUEsT0FBQSxtQkFBQTtnQkFDQSxVQUFBLE9BQUEsV0FBQSxXQUFBLFNBQUE7O1lBRUEsSUFBQSxDQUFBLFdBQUEsT0FBQTtnQkFDQSxXQUFBLFFB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QSxTQUFBLGNBQUE7Z0JBQ0EsTUFBQTtvQkFDQSxLQUFBLFlBQUEsS0FBQSxZQUFBO29CQUNBLFFBQUE7b0JBQ0EsUUFBQTttQkFDQSxRQUFBLFVBQUEsTUFBQTtvQkFDQSxFQUFBLFFBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOztnQkFFQSxPQUFBLEVBQUE7O1lBRUEsZ0JBQUEsU0FBQSxRQUFBO2dCQUNBLElBQUEsSUFBQSxHQUFBO2dCQUNBLElBQUEsU0FBQSxpQkFBQTtnQkFDQSxNQUFBO29CQUNBLEtBQUEsWUFBQSxLQUFBLFlBQUE7b0JBQ0EsUUFBQTtvQkFDQSxRQUFBO21CQUNBLFFBQUEsVUFBQSxNQUFBO29CQUNBLEtBQUEsVUFBQSxPQUFBLFlBQUEsS0FBQTtvQkFDQSxFQUFBLFFBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOztnQkFFQSxPQUFBLEVBQUE7Ozs7OztBQzlDQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxVQUFBLGtCQUFBLFlBQUE7UUFDQSxPQUFBO1lBQ0EsVUFBQTtZQUNBLFNBQUE7WUFDQSxPQUFBO2dCQUNBLHlCQUFBO2dCQUNBLGlCQUFBO2dCQUNBLFdBQUE7Z0JBQ0EsaUJBQUE7Z0JBQ0Esd0JBQUE7Z0JBQ0EsaUJBQUE7Z0JBQ0EsU0FBQTs7WUFFQSxNQUFBLFNBQUEsT0FBQSxTQUFBLFlBQUE7Z0JBQ0EsVUFBQSxFQUFBLFFBQUE7O2dCQUVBLFFBQUEsWUFBQTtvQkFDQSxpQkFBQSxNQUFBO29CQUNBLGdDQUFBO29CQUNBLFdBQUEsTUFBQSxhQUFBO29CQUNBLGlCQUFBLE1BQUEsbUJBQUE7b0JBQ0Esd0JBQUEsTUFBQTtvQkFDQSxpQkFBQSxNQUFBLG1CQUFBO29CQUNBLFVBQUEsVUFBQSxlQUFBLFNBQUE7d0JBQ0EsTUFBQSxPQUFBLFlBQUE7NEJBQ0EsTUFBQSxVQUFBLFFBQUE7Ozs7O2dCQUtBLE1BQUEsaUJBQUEsMkJBQUEsVUFBQSxVQUFBLFVBQUE7b0JBQ0EsSUFBQSxRQUFB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T0FBQSxPQUFBO2dCQUNBLElBQUEsYUFBQSxLQUFBLE9BQUEsU0FBQSxLQUFBLE9BQUEsYUFBQTtnQkFDQSxLQUFBLElBQUEsUUFBQSxLQUFBLE9BQUEsS0FBQSxTQUFBLEtBQUEsT0FBQSxLQUFBLFNBQUE7Z0JBQ0E7b0JBQ0EsSUFBQSxhQUFBLGFBQUEsS0FBQSxPQUFBO3dCQUNBLFNBQUE7d0JBQ0EsU0FBQTtvQkFDQSxLQUFBLElBQUEsUUFBQSxRQUFBLFlBQUEsUUFBQSxLQUFBLElBQUEsUUFBQSxZQUFBLEtBQUEsT0FBQSxNQUFBLFNBQUE7b0JBQ0E7d0JBQ0EsU0FBQSxLQUFBLGFBQUEsT0FBQTt3QkFDQSxTQUFBLEtBQUEsYUFBQSxPQUFBOzt3QkFFQSxLQUFBLEtBQUEsT0FBQTs2QkFDQSxLQUFBLE1BQUEsT0FBQTs2QkFDQSxLQUFBLE1BQUEsT0FBQTs2QkFDQSxLQUFBLE1BQUEsT0FBQTs2QkFDQSxLQUFBLE1BQUEsT0FBQTs2QkFDQSxNQUFBLFVBQUE7NkJBQ0EsTUFBQSxnQkFBQTs7O29CQUdBLFNBQUEsS0FBQSxhQUFBLE9BQUE7b0JBQ0EsU0FBQSxLQUFBLGFBQUEsT0FBQTs7b0JBRUEsS0FBQSxLQUFBLE9BQUE7eUJBQ0EsS0FBQSxNQUFBLE9BQUE7eUJBQ0EsS0FBQSxNQUFBLE9BQUE7eUJBQ0EsS0FBQSxNQUFBLE9BQUE7eUJBQ0EsS0FBQSxNQUFBLE9BQUE7eUJBQ0EsTUFBQSxVQUFBO3lCQUNBLE1BQUEsZ0JBQUE7O29CQUVBLElBQUEsU0FBQSxLQUFBLE9BQUEsT0FBQSxTQUFBLEtBQUEsT0FBQTtvQkFDQTt3QkFDQSxJQUFBLFFBQUEsS0FBQSxhQUFBLE9BQUE7O3dCQUVBLEtBQUEsS0FBQSxPQUFBOzZCQUNBLEtBQUEsS0FBQSxNQUFBOzZCQUNBLEtBQUEsS0FBQSxNQUFBOzZCQUNBLEtBQUEsTUFBQSxXQUFBOzZCQUNBLEtBQUEsZUFBQSxTQUFBLEtBQUEsT0FBQSxNQUFBLFVBQUE7NkJBQ0EsS0FBQTs2QkFDQSxNQUFBLGFBQUEsV0FBQTs2QkFDQSxNQUFBLFFBQUE7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QUEsQ0FBQSxJQUFBLEtBQUEsTUFBQSxRQUFBLFlBQUE7O29CQUVBLElBQUEsT0FBQSxLQUFBLEtBQUEsUUFBQSxNQUFBLEtBQUEsS0FBQSxLQUFBLE1BQUE7d0JBQ0EsT0FBQSxDQUFBLElBQUEsS0FBQSxLQUFBLE1BQUEsUUFBQSxZQUFBOztvQkFFQSxPQUFBLENBQUEsSUFBQSxLQUFBLEtBQUEsS0FBQSxNQUFBLFFBQUEsWUFBQTs7Z0JBRUEsT0FBQTs7WUFFQSxpQkFBQSxZQUFBO2dCQUNBLElBQUEsSUFBQTtvQkFDQSxJQUFBO29CQUNBLElBQUEsRUFBQTtvQkFDQSxJQUFBLFNBQUE7b0JBQ0EsSUFBQSxFQUFBLGNBQUEsRUFBQSxlQUFBLEVBQUE7b0JBQ0EsSUFBQSxFQUFBLGVBQUEsRUFBQSxnQkFBQSxFQUFBOztnQkFFQSxPQUFBO29CQUNBLE9BQUE7b0JBQ0EsUUFBQTs7O1lBR0EsbUJBQUEsVUFBQSxPQUFBLE1BQUE7Z0JBQ0EsSUFBQSxLQUFBLE9BQUEsSUFBQTtvQkFDQSxPQUFBLE9BQUEsSUFBQTtvQkFDQSxPQUFBLE9BQUEsSUFBQSxJQUFBLEtBQUEsT0FBQSxJQUFBO29CQUNBLGNBQUE7O2dCQUVBLElBQUEsV0FBQSxPQUFBLFNBQUE7O2dCQUVBLGNBQUEsU0FBQSxTQUFBLElBQUEsY0FBQSxZQUFBLFNBQUEsUUFBQSxLQUFBLFFBQUE7Z0JBQ0EsY0FBQSxTQUFBLFVBQUEsSUFBQSxjQUFBLFlBQUEsU0FBQSxTQUFBLEtBQUEsUUFBQTtnQkFDQSxjQUFBLFNBQUEsWUFBQSxJQUFBLGNBQUEsWUFBQSxTQUFBLFdBQUEsS0FBQSxRQUFBO2dCQUNBLGNBQUEsY0FBQSxZQUFBLFNBQUEsV0FBQSxLQUFBOztnQkFFQSxPQUFBOztZQUVBLGNBQUEsU0FBQSxVQUFBO2dCQUNBLElBQUEsU0FBQSxDQUFBLFNBQUEsU0FBQSxVQUFBLFlBQUEsV0FBQSxTQUFBO2dCQUNBLE9BQUEsT0FBQTs7WUFFQSxNQUFBLFlBQUE7Z0JBQ0EsSUFBQSxLQUFBLE9BQUEsVUFBQTtvQkFDQSxRQUFBLEdBQUEs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QUFBLE1BQUE7Z0JBQ0EsT0FBQSxXQUFBO2dCQUNBLElBQUEsU0FBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLE9BQUEsU0FBQTtnQkFDQSxRQUFBLElBQUE7Z0JBQ0EsSUFBQSxTQUFBO2VBQ0EsUUFBQSxZQUFBO2dCQUNBLE9BQUEsVUFBQTs7OztRQUlBLE9BQUEsb0JBQUEsVUFBQSxNQUFBO1lBQ0EsT0FBQSxhQUFBLDJCQUFBOzs7UUFHQSxJQUFBLGVBQUEsVUFBQSxPQUFBO1lBQ0EsT0FBQSxtQkFBQTtZQUNBLFdBQUEsYUFBQSxPQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLE9BQUEsTUFBQTtnQkFDQSxPQUFBLFdBQUEsa0JBQUE7Ozs7Z0JBSUEsT0FBQSxrQkFBQSxLQUFBO2dCQUNBLE9BQUEsa0JBQUEsS0FBQSxRQUFBLE9BQUEsSUFBQSxLQUFBLE1BQUEsU0FBQSxnQkFBQTtnQkFDQSxPQUFBLG1CQUFBLEtBQUEscUJBQUEsT0FBQSxTQUFBLE9BQUEsSUFBQSxLQUFBLG9CQUFBLEtBQUEsT0FBQSxRQUFBLFNBQUEsUUFBQTtnQkFDQSxPQUFBLGtCQUFBLEtBQUEsTUFBQSxXQUFBLE9BQUEsU0FBQSxPQUFBLElBQUEsS0FBQSxNQUFBLFVBQUEsS0FBQSxPQUFBLFFBQUEsU0FBQSxRQUFBO2dCQUNBLE9BQUEsU0FBQSxLQUFBO2dCQUNBLE9BQUEsVUFBQSxLQUFBO2VBQ0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsUUFBQSxJQUFBO2VBQ0EsUUFBQSxZQUFBO2dCQUNBLE9BQUEsbUJBQUE7Ozs7UUFJQSxJQUFBLG9CQUFBLFVBQUEsS0FBQTtZQUNBLElBQUEsS0FBQTtZQUNBLEdBQUEsS0FBQSxFQUFBLFVBQUEsV0FBQSxTQUFBLElBQUEsVUFBQSxPQUFBLElBQUEsSUFBQSxTQUFBLFdBQUEsSUFBQSxTQUFBLE9BQUEsSUFBQSxTQUFBLE9BQUEsSUFBQSxJQUFBLFFBQUEsV0FBQSxJQUFBO1lBQ0EsR0FBQSxLQUFBLEVBQUEsVUFBQSxVQUFBLFNBQUEsSUFBQSxTQUFBLE9BQUEsSUFBQSxJ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O2dCQUNBLE9BQUEsU0FBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7UUFJQSxPQUFBLHNCQUFBLFNBQUEsVUFBQTtZQUNBLE9BQUEsWUFBQSxZQUFBOzs7UUFHQSxPQUFBLDBCQUFBLFNBQUEsUUFBQTtZQUNBLE9BQUEsUUFBQSxZQUFBLFdBQUE7OztRQUdBLElBQUEsaUJBQUEsVUFBQSxJQUFBO1lBQ0EsT0FBQSxPQUFBLElBQUEsSUFBQTs7O1FBR0EsSUFBQSxjQUFBLFlBQUE7WUFDQSxlQUFBLGtCQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLE9BQUEsV0FBQSxLQUFBO2dCQUNBLE9BQUEsYUFBQSxFQUFBLE1BQUEsS0FBQSxTQUFBO2dCQUNBLE9BQUEsZUFBQSxLQUFBO2dCQUNBLElBQUEsT0FBQSxvQkFBQTtvQkFDQSxPQUFBLFlBQUEsT0FBQTt1QkFDQTtvQkFDQSxPQUFBLFVBQUE7O2dCQUVBLFFBQUEsT0FBQTtxQkFDQSxJQUFBO3dCQUNBLE9BQUE7d0JBQ0EsYUFBQTt3QkFDQSxVQUFBLFlBQUE7NEJBQ0EsSUFBQSxPQUFBLGVBQUE7Z0NBQ0EsSUFBQSxNQUFBLEVBQUEsUUFBQSxPQUFBLFlBQUEsT0FBQSxjQUFBO2dDQUNBLElBQUEsTUFBQSxHQUFBO29DQUNBLE9BQUEsWUFBQSxPQUFBLFdBQUEsTUFBQTs7Ozt1QkFJQSxJQUFBO3dCQUNBLE9BQUE7d0JBQ0EsYUFBQTt3QkFDQSxVQUFBLFlBQUE7NEJBQ0EsSUFBQSxPQUFBLGVBQUE7Z0NBQ0EsSUFBQSxNQUFBLEVBQUEsUUFBQSxPQUFBLFlBQUEsT0FBQSxjQUFBO2dDQUNBLElBQUEsT0FBQSxPQUFBLFdBQUEsU0FBQSxJQUFBO29DQUNBLE9BQUEsWUFBQSxPQUFBLFdBQUEsTUFBQTs7Ozs7ZUFLQSxNQUFBLFVBQUEsT0FBQTtnQkFDQSxRQUFBLElBQUE7Z0JBQ0EsT0FBQSxVQUFBOzs7O1FBSUEsSUFBQSxvQkFBQSxVQUFBLElBQUE7WUFDQSxPQUFBLFVBQUE7WUFDQSxlQUFBLGtCQUFBLElBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FB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QUFBLFVBQUEsT0FBQSxJQUFBLEtBQUEsV0FBQSxTQUFBLFdBQUEsT0FBQSxNQUFBLFNBQUEsR0FBQSxTQUFBLFFBQUEsS0FBQTtRQUNBLE9BQUEseUJBQUE7WUFDQSxRQUFBOztRQUVBLE9BQUEsNkJBQUEsVUFBQSxRQUFBO1lBQ0EsT0FBQTtZQUNBLE9BQUEsdUJBQUEsU0FBQTs7UUFFQSxPQUFBLG1CQUFBLEtBQUEsV0FBQSxRQUFBLE9BQUEsSUFBQSxLQUFBLFdBQUEsT0FBQSxXQUFBLE9BQUEsTUFBQSxNQUFBLEtBQUE7UUFDQSxPQUFBLHdCQUFBO1lBQ0EsUUFBQTs7UUFFQSxPQUFBLDRCQUFBLFVBQUEsUUFBQTtZQUNBLE9BQUE7WUFDQSxPQUFBLHNCQUFBLFNBQUE7O1FBRUEsT0FBQSxtQkFBQTtZQUNBLFVBQUE7OztRQUdBLGNBQUEsZUFBQTs7UUFFQSxJQUFBLG9CQUFBO1lBQ0E7Z0JBQ0EsT0FBQTtnQkFDQSxhQUFBO2dCQUNBLGNBQUE7Z0JBQ0Esc0JBQUE7O1lBRUE7Z0JBQ0EsT0FBQTtnQkFDQSxhQUFBO2dCQUNBLGlCQUFBO2dCQUNBLGNBQUE7O1lBRUE7Z0JBQ0EsT0FBQTtnQkFDQSxhQUFBO2dCQUNBLGlCQUFBO2dCQUNBLGNBQUE7O1lBRUE7Z0JBQ0EsT0FBQTtnQkFDQSxpQkFBQTtnQkFDQSxlQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsY0FBQTs7WUFFQTtnQkFDQSxPQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsY0FBQTtnQkFDQSxzQkFBQTs7WUFFQTtnQkFDQSxPQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsYUFBQTtnQkFDQSxzQkFBQTs7WUFFQTtnQkFDQSxPQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsY0FBQTtnQkFDQSxPQUFBO2dCQUNBLGlCQUFBOztZQUVBO2dCQUNBLE9BQUE7Z0JBQ0EsYUFBQTtnQkFDQSxpQkFBQTtnQkFDQSxVQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsY0FBQTs7OztRQUlBLE9BQUEsY0FBQSxZQUFBO1FBQ0EsT0FBQSxZQUFBLHdCQUFBLFNBQUEsS0FBQSxXQUFBLFFBQUE7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QUFBLE9BQUE7Z0JBQ0EsT0FBQSxTQUFBO2dCQUNBLFFBQUEsSUFBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7UUFJQSxPQUFBLFlBQUEsVUFBQSxLQUFBO1lBQ0EsT0FBQSxnQkFBQTtZQUNBLE9BQUEsVUFBQTtZQUNBLElBQUEsaUJBQUEsSUFBQTtZQUNBLElBQUEsU0FBQTtZQUNBLFdBQUEsVUFBQSxJQUFBLElBQUEsRUFBQSxRQUFBLGNBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxXQUFBO2dCQUNBLElBQUEsU0FBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLE9BQUEsU0FBQTtnQkFDQSxRQUFBLElBQUE7Z0JBQ0EsSUFBQSxTQUFBO2VBQ0EsUUFBQSxZQUFBO2dCQUNBLE9BQUEsVUFBQTs7OztRQUlBLEtBQUEsVUFBQSxZQUFBO1lBQ0EsV0FBQSxZQUFBLEtBQUEsWUFBQSxLQUFBLFVBQUEsTUFBQTtnQkFDQSxPQUFBLFdBQUEsS0FBQTtnQkFDQSxPQUFBLFlBQUEsYUFBQSxLQUFBO2dCQUNBLE9BQUEsWUFBQSxPQUFBLEtBQUE7ZUFDQSxNQUFBLFVBQUEsT0FBQTtnQkFDQSxRQUFBLElBQUE7ZUFDQSxRQUFBLFlBQUE7Z0JBQ0EsT0FBQSxVQUFBOzs7O1FBSUEsS0FBQSxjQUFBLFlBQUE7WUFDQSxlQUFBLGtCQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLE9BQUEsZ0JBQUEsS0FBQTtnQkFDQSxPQUFBLGNBQUEsUUFBQSxFQUFBLE1BQUEsWUFBQSxPQUFBLFlBQUEsU0FBQSxJQUFBLElBQUE7Ozs7Ozs7O2dCQVFBLEtBQUEsUUFBQSxLQUFBO2VBQ0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsT0FBQSxVQUFBO2dCQUNBLFFBQUEsSUFBQTs7OztRQUlBLEtBQUEsYUFBQSxZQUFBO1lBQ0EsSUFBQSxPQUFBLFdBQUEsWUFBQSxhQUFBOztnQkFFQSxJQUFBLENBQUEsS0FBQSxXQUFBLE9BQUE7b0JBQ0EsS0FBQSxXQUFBLFFBQUE7b0JBQ0EsVUFBQSxPQUFBLFNBQUEsS0FBQSxXQUFBLE9BQUE7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QUEsUUFBQSxPQUFBO2dCQUNBLE9BQUE7cUJBQ0EsSUFBQSxlQUFBO3FCQUNBLE9BQUE7O1lBRUEsT0FBQSxlQUFBLE1BQUE7OztRQUdBLE9BQUE7Ozs7QUN0Q0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsUUFBQSxzQkFBQSxZQUFBO1FBQ0EsSUFBQSxxQkFBQSxVQUFBLElBQUEsTUFBQSxXQUFBLFNBQUEsVUFBQSxlQUFBO1lBQ0EsS0FBQSxLQUFBO1lBQ0EsS0FBQSxPQUFBO1lBQ0EsS0FBQSxZQUFBO1lBQ0EsS0FBQSxVQUFBO1lBQ0EsS0FBQSxXQUFBO1lBQ0EsS0FBQSxnQkFBQTs7OztRQUlBLG1CQUFBLFlBQUE7Ozs7O1FBS0EsbUJBQUEsUUFBQSxVQUFBLE1BQUE7WUFDQSxJQUFBLE1BQUE7Z0JBQ0EsT0FBQSxJQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBOzs7WUFHQSxPQUFBLElBQUE7OztRQUdBLG1CQUFBLGNBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxPQUFBO3FCQUNBLElBQUEsbUJBQUE7cUJBQ0EsT0FBQTs7WUFFQSxPQUFBLG1CQUFBLE1BQUE7OztRQUdBLE9BQUE7Ozs7QUMxQ0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsUUFBQSxzQkFBQSxZQUFBO1FBQ0EsSUFBQSxxQkFBQSxVQUFBLE1BQUEsT0FBQSxTQUFBLFVBQUEsT0FBQTtZQUNBLEtBQUEsT0FBQTtZQUNBLEtBQUEsUUFBQTtZQUNBLEtBQUEsVUFBQTtZQUNBLEtBQUEsV0FBQTtZQUNBLEtBQUEsUUFBQTs7OztRQUlBLG1CQUFBLFlBQUE7WUFDQSxVQUFBLFlBQUE7Z0JBQ0EsSUFBQSxLQUFBO29CQUNBLE9BQUEsS0FBQTtnQkFDQSxJQUFBLEtBQUE7b0JBQ0EsT0FBQSxLQUFBO2dCQUNBLElBQUEsS0FBQTtvQkFDQSxPQUFBLEtBQUE7Ozs7O1FBS0EsbUJBQUEsUUFBQSxVQUFBLE1BQUE7WUFDQSxJQUFBLE1BQUE7Z0JBQ0EsT0FBQSxJQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTs7O1lBR0EsT0FBQSxJQUFBOzs7UUFHQSxtQkFBQSxjQUFBLFVBQUEsTUFBQTtZQUNBLElBQUEsUUFBQSxRQUFBLE9BQUE7Z0JBQ0EsT0FBQTtxQkFDQSxJQUFBLG1CQUFBO3FCQUNBLE9BQUE7O1lBRUEsT0FBQSxtQkFBQSxNQUFBOzs7UUFHQSxPQUFBOzs7O0FDL0NBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFFBQUEsdUJBQUEsWUFBQTtRQUNBLElBQUEsc0JBQUEsVUFBQSxNQUFBLGNBQUEsT0FBQTtZQUNBLEtBQUEsT0FBQTtZQUNBLEtBQUEsZUFBQTtZQUNBLEtBQUEsUUFBQTs7OztRQUlBLG9CQUFBLFlBQUE7Ozs7O1FBS0Esb0JBQUEsUUFBQSxVQUFBLE1BQUE7WUFDQSxJQUFBLE1BQUE7Z0JBQ0EsT0FBQSxJQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBOzs7WUFHQSxPQUFBLElBQUE7OztRQUdBLG9CQUFBLGNBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxPQUFBO3FCQUNBLElBQUEsb0JBQUE7cUJBQ0EsT0FBQTs7WUFFQSxPQUFBLG9CQUFBLE1BQUE7OztRQUdBLE9BQUE7Ozs7QUNwQ0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsUUFBQSw2SkFBQSxVQUFBLGFBQUEsU0FBQSxjQUFBLFNBQUEsb0JBQUEscUJBQUEsUUFBQSxnQkFBQSxjQUFBO1FBQ0EsSUFBQSxhQUFBLFVBQUEsSUFBQSxVQUFBLGNBQUEsT0FBQSxPQUFBLFFBQUEsVUFBQSxVQUFBLFNBQUEsV0FBQSxlQUFBLGNBQUEsa0JBQUEsbUJBQUEsU0FBQSxRQUFBLFNBQUEsT0FBQSxvQkFBQSxlQUFBLE1BQUEsU0FBQSxTQUFBLFVBQUEsUUFBQSxTQUFBO1lBQ0EsS0FBQSxLQUFBO1lBQ0EsS0FBQSxXQUFBLFFBQUEsWUFBQTtZQUNBLEtBQUEsZUFBQTtZQUNBLEtBQUEsUUFBQSxlQUFBLFlBQUE7WUFDQSxLQUFBLFFBQUE7WUFDQSxLQUFBLFNBQUE7WUFDQSxLQUFBLFdBQUE7WUFDQSxLQUFBLFdBQUE7WUFDQSxLQUFBLFVBQUE7WUFDQSxLQUFBLFlBQUE7WUFDQSxLQUFBLGdCQUFBO1lBQ0EsS0FBQSxlQUFBO1lBQ0EsS0FBQSxtQkFBQTtZQUNBLEtBQUEsb0JBQUE7WUFDQSxLQUFBLFVBQUE7WUFDQSxLQUFBLG9CQUFBLE9BQUEsSUFBQSxTQUFBLE9BQUEsWUFBQSxZQUFBO1lBQ0EsS0FBQSxTQUFBO1lBQ0EsS0FBQSxtQkFBQSxPQUFBLElBQUEsUUFBQSxPQUFBLFlBQUEsWUFBQTtZQUNBLEtBQUEsVUFBQTtZQUNBLEtBQUEsb0JBQUEsT0FBQSxJQUFBLFNBQUEsT0FBQSxZQUFBLFlBQUE7WUFDQSxLQUFBLFFBQUE7WUFDQSxLQUFBLGtCQUFBLE9BQUEsSUFBQSxPQUFBLE9BQUEsWUFBQSxZQUFBO1lBQ0EsS0FBQSxxQkFBQTtZQUNBLEtBQUEsZ0JBQUE7WUFDQSxLQUFBLE9BQUE7Z0JBQ0EsWUFBQSxtQkFBQSxZQUFBLEtBQUE7Z0JBQ0EsU0FBQSxLQUFBO2dCQUNBLGFBQUEsb0JBQUEsWUFBQSxLQUFBOztZQUVBLEtBQUEsVUFBQTtnQkFDQSxhQUFBLG9CQUFBLFlBQUEsUUFBQTtnQkFDQSxTQUFBLFFBQUE7O1lBRUEsS0FBQSxVQUFBLE9BQUEsWUFBQTtZQUNBLEtBQUEsV0FBQSxhQUFBLFlBQUE7WUFDQSxLQUFBLFNBQUE7WUFDQSxLQUFBLFVBQUE7Ozs7UUFJQSxXQUFBLFlBQUE7WUFDQSxhQUFBLFlBQUE7Z0JBQ0EsT0FBQSxhQUFBLGtCQUFBLEtBQUEsU0FBQSxLQUFBOztZQUVBLG9CQUFBLFVBQUE7Z0JBQ0EsSUFBQSxLQUFBLFdBQUEsSUFBQTtvQkFDQSxPQUFBLEtBQUEsU0FBQTs7Z0JBRUEsT0FBQTs7WUFFQSxnQkFBQSxV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LFdBQUEsRUFBQSxJQUFBLGFBQUE7b0JBQ0EsVUFBQSxZQUFBLFNBQUEsSUFBQSxXQUFBLFlBQUEsUUFBQSxZQUFBO29CQUNBLGdCQUFBLFlBQUEsSUFBQSxJQUFBLE1BQUEsQ0FBQSxDQUFBLFdBQUEsV0FBQSxLQUFBLFFBQUE7O2dCQUVBLE9BQUE7b0JBQ0EsT0FBQTt3QkFDQSxNQUFBO3dCQUNBLFFBQUE7d0JBQ0EsV0FBQSxXQUFBO3dCQUNBLE9BQUE7O29CQUVBLFFBQUE7d0JBQ0EsTUFBQTt3QkFDQSxRQUFBO3dCQUNBLFdBQUEsWUFBQTt3QkFDQSxPQUFBOztvQkFFQSxRQUFBO3dCQUNBLE1BQUE7d0JBQ0EsUUFBQTt3QkFDQSxXQUFBLFlBQUE7d0JBQ0EsT0FBQTs7OztZQUlBLGFBQUEsWUFBQTtnQkFDQSxJQUFBLFVBQUEsRUFBQSxNQUFBLEtBQUEsZUFBQSxFQUFBLFVBQUE7b0JBQ0EsZ0JBQUEsRUFBQSxPQUFBLEVBQUEsUUFBQSxTQUFBO29CQUNBLFdBQUEsRUFBQSxNQUFBLEtBQUEsZ0JBQUEsRUFBQSxVQUFBO29CQUNBLGlCQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUEsVUFBQTtvQkFDQSxXQUFBLEVBQUEsTUFBQSxLQUFBLGdCQUFBLEVBQUEsVUFBQTtvQkFDQSxpQkFBQSxFQUFBLE9BQUEsRUFBQSxRQUFBLFVBQUE7O2dCQUVBLElBQUEsbUJBQUEsVUFBQSxZQUFBO29CQUNBLElBQUEsWUFBQTtvQkFDQSxFQUFBLFFBQUEsWUFBQSxVQUFBLFVBQUE7d0JBQ0EsRUFBQSxRQUFBLFVBQUEsVUFBQSxLQUFBOzRCQUNBLFVBQUEsS0FBQSxFQUFBLFFBQUEsSUFBQSxVQUFBLE9BQUEsSUFBQTs7O29CQUdBLE9BQUE7OztnQkFHQSxPQUFBO29CQUNBLE9BQUEsaUJBQUE7b0JBQ0EsUUFBQSxpQkFBQTtvQkFDQSxRQUFBLGlCQUFBOzs7Ozs7UUFNQSxlQUFBLFFBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxNQUFBOztnQkFFQSxJQUFBLG1CQUFBLEtBQUEsWUFBQSxLQUFBLFlBQUEsS0FBQTtnQkFDQSxPQUFBLElBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0E7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7OztZQUdBLE9BQUEsSUFBQTs7O1FBR0EsZUFBQSxjQUFBLFVBQUEsTUFBQTtZQUNBLElBQUEsUUFBQSxRQUFBLE9BQUE7Z0JBQ0EsT0FBQTtxQkFDQSxJQUFBLGVBQUE7O1lBRUEsT0FBQSxlQUFBLE1BQUE7OztRQUdBLE9BQUE7OztBQzVLQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxRQUFBLDBDQUFBLFVBQUEsUUFBQSxhQUFBO1FBQ0EsSUFBQSxlQUFBLFVBQUEsSUFBQSxNQUFBLE9BQUEsYUFBQSxVQUFBLFNBQUEsZUFBQTtZQUNBLEtBQUEsS0FBQTtZQUNBLEtBQUEsT0FBQTtZQUNBLEtBQUEsUUFBQTtZQUNBLEtBQUEsY0FBQTtZQUNBLEtBQUEsV0FBQTtZQUNBLEtBQUEsVUFBQTtZQUNBLEtBQUEsb0JBQUEsVUFBQSxPQUFBLElBQUEsU0FBQSxnQkFBQTtZQUNBLEtBQUEsZ0JBQUE7WUFDQSxLQUFBLDBCQUFBLGdCQUFBLE9BQUEsSUFBQSxlQUFBLGdCQUFBOzs7O1FBSUEsYUFBQSxZQUFBOzs7OztRQUtBLGFBQUEsUUFBQSxV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QUFBO1lBQ0EsT0FBQSxxQkFBQTtZQUNBLE9BQUEsa0JBQUE7O1lBRUEsT0FBQSxVQUFBOztZQUVBLElBQUEsQ0FBQSxPQUFBLGlCQUFBLFFBQUEsT0FBQSxpQkFBQSxTQUFBLElBQUE7Z0JBQ0EsT0FBQSxtQkFBQTtnQkFDQSxLQUFBO21CQUNBO2dCQUNBLEtBQUEsbUJBQUEsT0FBQTs7Ozs7Ozs7Ozs7Ozs7UUFjQSxPQUFBLG9CQUFBLFlBQUE7WUFDQSxPQUFBLE9BQUEsZUFBQSxTQUFBOzs7Ozs7Ozs7O1FBVUEsT0FBQSxxQkFBQSxVQUFBLFNBQUE7WUFDQSxPQUFBLGVBQUE7WUFDQSxPQUFBLGVBQUEsWUFBQSxZQUFBLGdCQUFBO1lBQ0EsT0FBQSxlQUFBLFlBQUEsWUFBQSxnQkFBQTtZQUNBLEtBQUE7OztRQUdBLE9BQUEsa0JBQUEsVUFBQSxNQUFBO1lBQ0EsT0FBQSxZQUFBO1lBQ0EsT0FBQSxtQkFBQSxFQUFBLFdBQUE7WUFDQSxPQUFBLFdBQUEsU0FBQSxRQUFBLGdCQUFBO1lBQ0EsT0FBQSxZQUFBLFNBQUEsU0FBQSxnQkFBQTtZQUNBLE9BQUEsWUFBQSxTQUFBLFNBQUEsZ0JBQUE7WUFDQSxPQUFBLGNBQUEsU0FBQSxXQUFBLGdCQUFBO1lBQ0EsT0FBQSxlQUFBLFNBQUEsWUFBQSxnQkFBQTtZQUNBLEtBQUE7OztRQUdBLE9BQUEsaUJBQUEsWUFBQTtZQUNBLE9BQUEsa0JBQUEsQ0FBQSxPQUFBO1lBQ0EsSUFBQSxPQUFBLGlCQUFBO2dCQUNBLE9BQUEsZ0JBQUE7bUJBQ0E7Z0JBQ0EsT0FBQSxnQkFBQTs7OztRQUlBLEtBQUEsYUFBQSxZQUFBO1lBQ0EsV0FBQSxlQUFBO1lBQ0EsS0FBQTs7Ozs7Ozs7Ozs7Ozs7UUFjQSxLQUFBLGVBQUEsWUFBQTtZQUNBLGVBQUEsZUFBQSxLQUFBLFVBQUEsUUFBQTtnQkFDQSxPQUFBLHFCQUFBLE9BQUE7ZUFDQSxNQUFBLFVBQUEsT0FBQTtnQkFDQSxRQUFBLElBQUE7Z0JBQ0EsT0FBQSxTQUFBOzs7O1FBSUEsS0FBQSxjQUFBLFVBQUEsSUFBQTtZQUNBLGVBQUEsbUJBQUEsSUFBQSxLQUFBLFVBQUEsUUFBQTtnQkFDQSxPQUFBLG1DQUFBLE9BQUE7ZUFDQSxNQUFBLFVBQUEsT0FBQTtnQkFDQSxRQUFBLElBQUE7Ozs7UUFJQSxLQUFBLHFCQUFBLFVBQUEsVUFBQTtZQUNBLGVBQUEsbUJBQUEsU0FBQSxNQUFBLEtBQUEsVUFBQSxRQUFBO2dCQUNBLE9BQUEsMEJBQUE7Z0JBQ0EsRUFBQSxRQUFBLE9BQUEsU0FBQSxVQUFBLFFBQUE7b0JBQ0EsT0FBQSxxQkFBQSxPQUFBLG1CQUFBLFdBQUEsSUFBQSxFQUFBLFdBQUEsT0FBQSxTQUFBLE9BQUEscUJBQUEsT0FBQSxFQUFBLFdBQUEsT0FBQTs7Z0JBRUEsT0FBQSxrQkFBQSxFQUFBLFlBQUEsT0FBQSxTQUFBLENBQUEsUUFBQSxZQUFBLENBQUEsTUFBQTs7Z0JBRUEsSUFBQSx5QkFBQTtnQkFDQSxFQUFBLFFBQUEsT0FBQSxpQkFBQSxVQUFBLFFBQUE7b0JBQ0EsdUJBQUEsS0FBQTt3QkFDQSxPQUFBLE9BQUEsVUFBQSxPQUFBLFFBQUEsTUFBQSxPQUFBLFVBQUEsT0FBQTt3QkFDQSxPQUFBLE9BQUEsVUFBQSxPQUFBLFFBQUEsTUFBQSxPQUFBLFVBQUEsT0FBQTt3QkFDQSxPQUFBLE9BQUE7OztnQkFHQSxPQUFBLHlCQUFBO2dCQUNBLE9BQUEsVUFBQSxFQUFBLFlBQUEsT0FBQSxTQUFBLENBQUEsVUFBQSxDQUFBO2dCQUNBLE9BQUEsU0FBQSxPQUFBOzs7Z0JBR0EsSUFBQSxzQkFBQTtvQkFDQSxlQUFBLEVBQUEsTUFBQSxFQUFBLFFBQUEsT0FBQSxTQUFBO2dCQUNBLEVBQUEsUUFBQSxjQUFBLFVBQUEsT0FBQTtvQkFDQSxJQUFBLFNBQUE7d0JBQ0EsT0FBQSxFQUFBLEtBQUEsT0FBQSxRQUFBLEVBQUEsTUFBQSxNQUFBLE1BQUE7d0JBQ0EsVUFBQTs7b0JBRUEsRUFBQSxRQUFBLE1BQUEsSUFBQSxVQUFBLFFBQUE7d0JBQ0EsSUFBQSxRQUFBOzRCQUNBLE9BQUEsT0FBQTs0QkFDQSxPQUFBLE9BQUE7NEJBQ0EsT0FBQSxPQUFBOzt3QkFFQSxPQUFBLFNBQUEsS0FBQTs7b0JBRUEsb0JBQUEsS0FBQTs7Z0JBRUEsb0JBQUEsUUFBQTtvQkFDQSxPQUFBO29CQUNBLE9BQUE7b0JBQ0EsT0FBQTs7Z0JBRUEsT0FBQSxzQkFBQTtlQUNBLE1BQUEsVUFBQSxNQUFBO2dCQUNBLFFBQUEsSUFBQTtnQkFDQSxPQUFBLFNBQUE7Ozs7UUFJQSxLQUFBOztRQUVBLE9BQUEsT0FBQSxnQkFBQSxVQUFBLE9BQUE7WUFDQSxRQUFBLElBQUE7Ozs7UUFJQSxLQUFBLFlBQUEsWUFBQTs7O1lBR0EsWUFBQTtZQUNBLElBQUEsV0FBQTtnQkFDQSxjQUFBO1lBQ0EsRUFBQSxRQUFBLFFBQUEsVUFBQSxLQUFBLEtBQUE7Z0JBQ0EsSUFBQSxNQUFBLEdBQUE7b0JBQ0EsU0FBQSxLQUFBLElBQUE7OztZQUdBLEVBQUEsUUFBQSxPQUFBLFdBQUEsVUFBQSxHQUFBO2dCQUNBLGNBQUEsWUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsZ0JBQUE7Ozs7WUFJQSxFQUFBLFFBQUEsVUFBQSxVQUFBLFNBQUE7Z0JBQ0EsSUFBQSxhQUFBLEVBQUEsS0FBQSxhQUFBLFVBQUEsTUFBQTtvQkFDQSxPQUFBLFNBQUE7O2dCQUVBLElBQUEsQ0FBQSxZQUFBO29CQUNBLFVBQUEsS0FBQTs7Ozs7WUFLQSxTQUFBO1lBQ0EsT0FBQTtZQUNBLFdBQUE7OztZQUdBLElBQUEsVUFBQSxPQUFBLElBQUEsT0FBQSxjQUFBLE1BQUEsS0FBQSxLQUFBLE9BQUEsSUFBQSxPQUFBLGVBQUEsZUFBQSxRQUFBLE1BQUEsT0FBQTtZQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxTQUFBLEtBQUE7Z0JBQ0EsS0FBQSxLQUFBLE9BQUEsSUFBQSxPQUFBLGVBQUEsZUFBQSxRQUFBLEtBQUEsSUFBQSxHQUFBLEtBQUE7Ozs7WUFJQSxFQUFBLFFBQUEsT0FBQSxXQUFBLFVBQUEsTUFBQTtnQkFDQSxJQUFBLFdBQUE7b0JBQ0EsUUFBQSxLQUFBO29CQUNBLGNB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QUNBLElBQUEsSUFBQSxHQUFBO2dCQUNBLElBQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSxhQUFBLE9BQUE7Z0JBQ0EsTUFBQSxJQUFBLEtBQUEsUUFBQSxVQUFBLE1BQUE7b0JBQ0EsRUFBQSxRQUFBO21CQUNBLE1BQUEsVUFBQSxPQUFBO29CQUNBLEVBQUEsT0FBQTs7Z0JBRUEsT0FBQSxFQUFBOztZQUVBLGFBQUEsVUFBQSxRQUFBO2dCQUNBLElBQUEsU0FBQSxVQUFBO29CQUNBLElBQUEsR0FBQTs7Z0JBRUEsTUFBQTtvQkFDQSxRQUFBO29CQUNBLEtBQUEsWUFBQSxLQUFBLFlBQUEsYUFBQSxPQUFBLFdBQUE7b0JBQ0EsUUFBQTttQkFDQSxRQUFBLFVBQUEsTUFBQTtvQkFDQSxFQUFBLFFBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOzs7Z0JBR0EsT0FBQSxFQUFBOztZQUVBLHNCQUFBLFVBQUEsS0FBQTtnQkFDQSxJQUFBLElBQUEsR0FBQTs7Z0JBRUEsSUFBQSxZQUFBO29CQUNBLE9BQUE7b0JBQ0EsTUFBQTtvQkFDQSxVQUFBO29CQUNBLFNBQUE7OztnQkFHQSxJQUFBLFVBQUEsT0FBQSxJQUFBLElBQUEsT0FBQSxPQUFBLEtBQUEsT0FBQSxJQUFBLElBQUEsT0FBQSxVQUFBLE9BQUE7O2dCQUVBLEVBQUEsUUFBQSxJQUFBLE1BQUEsaUJBQUEsVUFBQSxRQUFBO29CQUNBLElBQUEsZUFBQTt3QkFDQSxRQUFBO3dCQUNBLE9BQUEsT0FBQSxJQUFBLElBQUEsT0FBQSxTQUFBLE9BQUE7d0JBQ0EsT0FBQSxPQUFBLElBQUEsSUFBQSxPQUFBLE9BQUEsT0FBQTt3QkFDQSxPQUFBO3dCQUNBLE9BQUE7d0JBQ0EsUUFBQTs7O29CQUdBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxTQUFBLEtBQUE7d0JBQ0EsSUFBQSxJQUFBLE1BQUEsZUFBQSxTQUFBLEdBQUE7NEJBQ0EsRUFBQSxRQUFBLElBQUEsTUFBQSxnQkFBQSxVQUFBLFFBQUE7Z0NBQ0EsYUFBQSxPQUFBLEtBQUE7b0NBQ0EsTUFBQSxPQUFBLElBQUEsSUFBQSxPQUFBLFNBQUEsSUFBQSxHQUFBLEtBQUEsT0FBQTtvQ0FDQSxPQUFBLEtBQUEsTUFBQSxLQUFBLFlBQUEsT0FBQSxJQUFBLE1BQUE7b0NBQ0EsSUFBQSxPQUFBOzs7K0JBR0E7NEJBQ0EsYUFBQSxPQUFBLEtBQUE7Z0NBQ0EsTUFBQSxPQUFBLElBQUEsSUFBQSxPQUFBLFNBQUEsSUFBQSxHQUFBLEtBQUEsT0FBQTtnQ0FDQSxPQUFBLEtBQUEsTUFBQSxLQUFBLFlBQUEsT0FBQSxJQUFBLE1BQUE7Ozs7b0JBSUEsVUFBQSxRQUFBLEtBQUE7OztnQkFHQSxFQUFBLFFBQUE7O2dCQUVBLE9BQUEsRUFBQTs7Ozs7O0FDMUdBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFdBQUEsaUhBQUEsU0FBQSxRQUFBLFdBQUEsU0FBQSxhQUFBLGNBQUEsY0FBQSxZQUFBO1FBQ0EsU0FBQSxxQkFBQSxRQUFBLEdBQUEsTUFBQSxrQkFBQSxZQUFBLE9BQUE7O1FBRUEsT0FBQSxVQUFBO1FBQ0EsT0FBQSxhQUFBO1FBQ0EsT0FBQSxVQUFBLFlBQUEsS0FBQTs7UUFFQSxPQUFBLE9BQUEsU0FBQSxLQUFBO1lBQ0EsVUFBQSxPQUFBO1lBQ0EsVUFBQSxLQUFBOzs7UUFHQSxJQUFBLGtCQUFBLFdBQUE7WUFDQSxPQUFBLGFBQUEsV0FBQTs7O1FBR0EsSUFBQSxhQUFBLFdBQUE7WUFDQSxXQUFBLGlCQUFBOztZQUVBLGFBQUEsYUFBQSxLQUFBLFVBQUEsTUFBQTtnQkFDQSxPQUFBLFVBQUEsS0FBQTtnQkFDQSxhQUFBLFdBQUEsS0FBQTs7O1FBR0E7Ozs7QUMzQkEsQ0FBQSxZQUFBO0lBQ0E7Ozs7Ozs7Ozs7O0lBV0EsUUFBQSxPQUFBLFlBQUEsUUFBQSw0QkFBQSxVQUFBLFdBQUE7O1FBRUEsS0FBQSxXQUFBOztRQUVBLElBQUEsWUFBQTs7UUFFQSxLQUFBLG1CQUFBLFNBQUEsVUFBQTtZQUNBLFVBQUEsS0FBQTs7O1FBR0EsS0FBQSxrQkFBQSxXQUFBO1lBQ0EsUUFBQSxRQUFBLFdBQUEsU0FBQSxVQUFBO2dCQUNBOzs7O1FBSUEsS0FBQSxpQkFBQSxTQUFBLFlBQUE7WUFDQSxLQUFBLFdBQUE7WUFDQSxLQUFBOzs7Ozs7QUM5QkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsUUFBQSwwQ0FBQSxVQUFBLE9BQUEsYUFBQTtRQUNBLElBQUEsY0FBQTs7UUFFQSxLQUFBLGlCQUFBLFVBQUEsTUFBQTtZQUNBLGNBQUE7OztRQUdBLEtBQUEsaUJBQUEsWUFBQTtZQUNBLE9BQUE7Ozs7QUNYQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxXQUFBLDBIQUFBLFNBQUEsUUFBQSxXQUFBLGNBQUEsVUFBQSxZQUFBLGFBQUEsY0FBQTtRQUNBLE9BQUEsU0FBQSxhQUFBO1FBQ0EsT0FBQSxlQUFBOztRQUVBLElBQUEsaUJBQUEsVUFBQSxRQUFBO1lBQ0EsWUFBQSxRQUFBLFFBQUEsTUFBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxPQUFBOzs7O1FBSUEsSUFBQSxhQUFBLFdBQUE7WUFDQSxXQUFBLGVBQUE7O1lBRUEsZUFBQSxPQUFBO1lBQ0EsRUFBQSxNQUFBLFlBQUE7Z0JBQ0EsT0FBQSxVQUFBOzs7O1FBSUE7Ozs7Ozs7O0FDdEJBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFdBQUEsb0ZBQUEsU0FBQSxRQUFBLFdBQUEsVUFBQSxZQUFBLGFBQUE7UUFDQSxPQUFBLGFBQUE7UUFDQSxPQUFBLFVBQUE7UUFDQSxPQUFBLFlBQUE7UUFDQSxPQUFBLGFBQUE7UUFDQSxPQUFBLG1CQUFBO1FBQ0EsT0FBQSxrQkFBQTtRQUNBLE9BQUEsd0JBQUE7UUFDQSxPQUFBLFdBQUE7WUFDQSxNQUFBO1lBQ0EsUUFBQTs7O1FBR0EsSUFBQSxnQkFBQTs7UUFFQSxJQUFBLG9CQUFBLFVBQUEsU0FBQSxNQUFBO1lBQ0EsSUFBQSxjQUFBLFVBQUE7Z0JBQ0EsU0FBQSxPQUFBLGNBQUE7O1lBRUEsY0FBQSxXQUFBLFNBQUEsWUFBQTtnQkFDQSxPQUFBLFdBQUEsU0FBQTtlQUNBOzs7UUFHQSxPQUFBLGFBQUEsWUFBQTtZQUNBLGtCQUFBLGNBQUEsT0FBQTs7O1FBR0EsSUFBQSxXQUFBLFlBQUE7WUFDQSxZQUFBLFdBQUEsS0FBQSxNQUFBLE1BQUEsVUFBQSxNQUFBO2dCQUNBLElBQUEsS0FBQSxXQUFBO29CQUNBLE9BQUEsYUFBQTtvQkFDQSxPQUFBLFNBQUEsT0FBQSxLQUFBO29CQUNBLE9BQUE7dUJBQ0E7b0JBQ0EsSUFBQSxLQUFBLGNBQUEsS0FBQSxlQUFBLElBQUE7d0JBQ0EsT0FBQSxtQkFBQSxLQUFBOztvQkFFQSxPQUFBLGFBQUE7Ozs7O1FBS0EsSUFBQSxnQkFBQSxZQUFBO1lBQ0EsWUFBQSxjQUFBLE1BQUEsTUFBQSxPQUFBLE9BQUEsWUFBQSxLQUFBLE1BQUEsS0FBQSxNQUFBLE1BQUEsVUFBQSxNQUFBO2dCQUNBLElBQUEsS0FBQSxXQUFBO29CQUNBLE9BQUEsa0JBQUE7b0JBQ0EsT0FBQSxTQUFBLFNBQUEsS0FBQTtvQkFDQSxPQUFBO3VCQUNBO29CQUNBLElBQUEsS0FBQSxjQUFBLEtBQUEsZUFBQSxJQUFBO3dCQUNBLE9BQUEsd0JBQUEsS0FBQTs7b0JBRUEsT0FBQSxrQkFBQTs7Ozs7UUFLQSxJQUFBLGFBQUEsV0FBQTtZQUNBO1lBQ0E7WUFDQSxFQUFBLE1BQUEsWUFBQTtnQkFDQSxPQUFBLFVBQUE7O1lBRUEsV0FBQSxlQUFBOzs7UUFHQTs7O0FDdEVBLENBQUEsV0FBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFdBQUEsbUVBQUEsVUFBQSxZQUFBLFFBQUEsYUFBQTtRQUNBLE9BQUEsb0JBQUE7UUFDQSxPQUFBLGtCQUFBO1FBQ0EsT0FBQSx3QkFBQTtRQUNBLE9BQUEsYUFBQTtRQUNBLE9BQUEsZUFBQTtRQUNBLE9BQUEsb0JBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLHdCQUFBO1FBQ0EsT0FBQSw4QkFBQTtRQUNBLE9BQUEsZUFBQTtRQUNBLE9BQUEsYUFBQTs7UUFFQSxJQUFBLGdCQUFBLFlBQUE7WUFDQSxPQUFBLG9CQUFBO1lBQ0EsWUFBQSxjQUFBLE1BQUEsTUFBQSxPQUFBLFVBQUEsTUFBQSxLQUFBLE1BQUEsTUFBQSxVQUFBLE1BQUE7Z0JBQ0EsSUFBQSxLQUFBLFdBQUE7b0JBQ0EsT0FBQSxhQUFBLEtBQUEsUUFBQTs7b0JBRUEsSUFBQSxlQUFBO3dCQUNBLG9CQUFBO3dCQUNBLGNBQUE7d0JBQ0EsOEJBQUE7d0JBQ0Esd0JBQUE7O29CQUVBLEVBQUEsUUFBQSxLQUFBLFNBQUEsVUFBQSxHQUFBO3dCQUNBLElBQUEsQ0FBQSxFQUFBLFdBQUE7OzRCQUVBLElBQUEsRUFBQSxLQUFBLGtCQUFBO2dDQUNBLDRCQUFBLEtBQUE7bUNBQ0EsSUFBQSxFQUFBLEtBQUEsV0FBQTtnQ0FDQSxzQkFBQSxLQUFBO21DQUNBO2dDQUNBLGFBQUEsS0FBQTs7K0JBRUE7OzRCQUVBLElBQUEsRUFBQSxLQUFBLGtCQUFBO2dDQUNBLGtCQUFBLEtBQUE7bUNBQ0EsSUFBQSxFQUFBLEtBQUEsV0FBQTtnQ0FDQSxZQUFBLEtBQUE7Ozs7O29CQUtBLE9BQUEsZUFBQSxhQUFBO29CQUNBLE9BQUEsb0JBQUEsa0JBQUE7b0JBQ0EsT0FBQSxjQUFBLFlBQUE7b0JBQ0EsT0FBQSw4QkFBQSw0QkFBQTtvQkFDQSxPQUFBLHdCQUFBLHNCQUFBOzs7b0JBR0EsT0FBQSxlQUFBLE9BQUEsYUFBQSxPQUFBLGVBQUEsT0FBQSxvQkFBQSxPQUFBLGNBQUEsT0FBQSx3QkFBQSxPQUFBOztvQkFFQSxJQUFBLFlBQUE7OztvQkFHQSxJQUFBLFlBQUEsT0FBQSxhQUFBLElBQUEsQ0FBQSxDQUFBLE9BQUEsZUFBQSxPQUFBLGNBQUEsS0FBQSxRQUFBLEtBQUE7O29CQUVBLElBQUEsT0FBQSxlQUFBLEdBQUE7d0JBQ0EsVUFBQSxLQUFBOzRCQUNBLFFBQUE7NEJBQ0EsT0FBQSxPQUFBOzs7O29CQUlBLElBQUEsT0FBQSxvQkFBQSxHQUFBO3dCQUNBLFVBQUEsS0FBQTs0QkFDQSxRQUFBOzRCQUNBLE9BQUEsT0FBQTs7OztvQkFJQSxJQUFBLE9BQUEsY0FBQSxHQUFBO3dCQUNBLFVBQUEsS0FBQTs0QkFDQSxRQUFBOzRCQUNBLE9BQUEsT0FBQTs7OztvQkFJQSxJQUFBLE9BQUEsdUJBQUE7d0JBQ0EsVUFBQSxLQUFBOzRCQUNBLFFBQUE7NEJBQ0EsT0FBQSxPQUFBOzs7O29CQUlBLElBQUEsT0FBQSw2QkFBQTt3QkFDQSxVQUFBLEtBQUE7NEJBQ0EsUUFBQTs0QkFDQSxPQUFBLE9BQUE7Ozs7b0JBSUEsT0FBQSxhQUFBO3dCQUNBLFdBQUE7d0JBQ0EsV0FBQTs7dUJBRUE7b0JBQ0EsSUFBQSxLQUFBLGNBQUEsS0FBQSxlQUFBLElBQUE7d0JBQ0EsT0FBQSx3QkFBQSxLQUFBOztvQkFFQSxPQUFBLGtCQUFBOztnQkFFQSxPQUFBLG9CQUFBOzs7O1FBSUE7O1FBRUEsV0FBQSxJQUFBLG9CQUFBLFlBQUE7WUFDQTs7UUFFQSxVQUFBLGlCQUFBLFVBQUE7Ozs7U0FJQSxPQUFBO2FBQ0EsWUFBQTthQUNBLGFBQUE7YUFDQSxVQUFBO2FBQ0EsT0FBQTtpQkFDQSxVQUFBO2lCQUNBLGlCQUFBOzs7Ozs7QUM5SEEsQ0FBQSxVQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsUUFBQSwwQ0FBQSxVQUFBLGVBQUEsY0FBQTtRQUNBLElBQUEsT0FBQSxVQUFBLElBQUEsVUFBQSxNQUFBLFVBQUEsV0FBQSxrQkFBQSxXQUFBLFVBQUEsU0FBQSxZQUFBLGVBQUEsa0JBQUEsV0FBQTtZQUNBLEtBQUEsS0FBQTtZQUNBLEtBQUEsV0FBQTtZQUNBLEtBQUEsT0FBQTtZQUNBLEtBQUEsV0FBQTtZQUNBLEtBQUEsWUFBQTtZQUNBLEtBQUEsbUJBQUE7WUFDQSxLQUFBLFlBQUE7WUFDQSxLQUFBLFdBQUE7WUFDQSxLQUFBLFVBQUE7WUFDQSxLQUFBLGFBQUE7WUFDQSxLQUFBLGdCQUFBO1lBQ0EsS0FBQSxtQkFBQTtZQUNBLEtBQUEsWUFBQSxjQUFBLFlBQUE7Ozs7UUFJQSxLQUFBLFlBQUE7WUFDQSxVQUFBLFlBQUE7Z0JBQ0EsT0FBQTs7WUFFQSxhQUFBLFlBQUE7Z0JBQ0EsT0FBQSxhQUFBLGtCQUFBLEtBQUEsU0FBQSxLQUFBOztZQUVBLGFBQUEsWUFBQTs7Z0JBRUEsT0FBQSxLQUFBOztZQUVBLGNBQUEsWUFBQTtnQkFDQSxPQUFBLEtBQUE7Ozs7O1FBS0EsS0FBQSxRQUFBLFVBQUEsTUFBQTtZQUNBLElBQUEsTUFBQTtnQkFDQSxPQUFBLElBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTs7O1lBR0EsT0FBQSxJQUFBOzs7UUFHQSxLQUFBLGNBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxPQUFBO3FCQUNBLElBQUEsS0FBQTs7WUFFQSxPQUFBLEtBQUEsTUFBQTs7O1FBR0EsT0FBQTs7OztBQ25FQSxDQUFBLFVBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxRQUFBLGlCQUFBLFVBQUE7UUFDQSxJQUFBLGdCQUFBLFVBQUEsT0FBQSxXQUFBLE1BQUE7WUFDQSxLQUFBLFFBQUE7WUFDQSxLQUFBLFlBQUE7WUFDQSxLQUFBLE9BQUE7Ozs7UUFJQSxjQUFBLFlBQUE7Ozs7Ozs7UUFPQSxjQUFBLFFBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxNQUFBO2dCQUNBLE9BQUEsSUFBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTs7O1lBR0EsT0FBQSxJQUFBOzs7UUFHQSxjQUFBLGNBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxPQUFBO3FCQUNBLElBQUEsY0FBQTtxQkFDQSxPQUFBOztZQUVBLE9BQUEsY0FBQSxNQUFBOzs7UUFHQSxPQUFBOzs7O0FDdENBLENBQUEsV0FBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFFBQUEsMkVBQUEsVUFBQSxhQUFBLG1CQUFBLE1BQUEsY0FBQTtRQUNBLElBQUEsYUFBQSxVQUFBLE1BQUEsV0FBQSxnQkFBQSxrQkFBQTtZQUNBLEtBQUEsT0FBQSxLQUFBLFlBQUE7WUFDQSxLQUFBLFlBQUE7WUFDQSxLQUFBLGlCQUFBO1lBQ0EsS0FBQSxtQkFBQSxhQUFBLFlBQUE7Ozs7UUFJQSxXQUFBLFlBQUE7WUFDQSxVQUFBLFlBQUE7Z0JBQ0EsT0FBQTs7WUFFQSxjQUFBLFlBQUE7Z0JBQ0EsSUFBQSxZQUFBLEVBQUEsS0FBQSxLQUFBLGdCQUFBLFVBQUE7Z0JBQ0EsT0FBQSxZQUFBLFVBQUEsUUFBQTs7WUFFQSxXQUFBLFlBQUE7Z0JBQ0EsSUFBQSxTQUFBLEVBQUEsS0FBQSxLQUFBLGdCQUFBLFVBQUE7Z0JBQ0EsT0FBQSxTQUFBLE9BQUEsUUFBQTs7WUFFQSxhQUFBLFlBQUE7Z0JBQ0EsSUFBQSxRQUFBO2dCQUNBLElBQUEsS0FBQSxXQUFBO29CQUNBLElBQUEsS0FBQSxLQUFBLGtCQUFBO3dCQUNBLFFBQUEsWUFBQSxPQUFBOzJCQUNBLElBQUEsS0FBQSxLQUFBLFdBQUE7d0JBQ0EsUUFBQSxZQUFBLE9BQUE7MkJBQ0E7d0JBQ0EsUUFBQSxZQUFBLE9BQUE7O3VCQUVBO29CQUNBLFFBQUEsWUFBQSxPQUFBOztnQkFFQSxPQUFBOztZQUVBLFlBQUEsWUFBQTtnQkFDQSxPQUFBLEVBQUEsT0FBQTs7WUFFQSxjQUFBLFlBQUE7Z0JBQ0EsT0FBQSxhQUFBLEtBQUE7O1lBRUEsY0FBQSxZQUFBO2dCQUNBLE9BQUEsZ0JBQUEsS0FBQTs7WUFFQSxlQUFBLFlBQUE7Z0JBQ0EsSUFBQSxLQUFBLFdBQUE7b0JBQ0EsSUFBQSxLQUFBLEtBQUEsa0JBQUE7d0JBQ0EsT0FBQTsyQkFDQSxJQUFBLEtBQUEsS0FBQSxXQUFBO3dCQUNBLE9BQUE7MkJBQ0E7d0JBQ0EsT0FBQTs7dUJBRUE7b0JBQ0EsT0FBQTs7O1lBR0EsYUFBQSxZQUFBO2dCQUNBLElBQUEsT0FBQTtnQkFDQSxFQUFBLFFBQUEsS0FBQSxrQkFBQSxVQUFBLGNBQUE7b0JBQ0EsT0FBQSxhQUFBLElBQUEsU0FBQTtvQkFDQSxPQUFBLE1BQUEsUUFBQSxhQUFBLElBQUEsU0FBQSxZQUFBO29CQUNBLE9BQUEsTUFBQSxRQUFBLFlBQUEsa0JBQUE7O2dCQUVBLE9BQUE7O1lBRUEsb0JBQUEsWUFBQTtnQkFDQSxPQUFBLEtBQUEsS0FBQSxZQUFBLGFBQUE7O1lBRUEsaUJBQUEsVUFBQSxjQUFBO2dCQUNBLElBQUEsYUFBQTtvQkFDQSxVQUFBLEtBQUEsS0FBQTtvQkFDQSxNQUFBLEtBQUEsS0FBQTtvQkFDQSxjQUFBLGdCQUFBO29CQUNBLFdBQUEsQ0FBQSxLQUFBLEtBQUE7O2dCQUVBLE9BQUEsa0JBQUEsV0FBQSxLQUFBLEtBQUEsSUFBQSxZQUFBLEtBQUEsVUFBQSxRQUFBO29CQUNBLE9BQUEsS0FBQSxZQUFBO21CQUNBLE1BQUEsVUFBQSxPQUFBO29CQUNBLFFBQUEsSUFBQTs7Ozs7O1FBTUEsV0FBQSxRQUFBLFVBQUEsTUFBQTtZQUNBLElBQUEsTUFBQTtnQkFDQSxPQUFBLElBQUE7b0JBQ0EsS0FBQTtvQkFDQSxLQUFBO29CQUNBLEtBQUE7b0JBQ0EsS0FBQTs7O1lBR0EsT0FBQSxJQUFBOzs7UUFHQSxXQUFBLGNBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxRQUFBLFFBQUEsT0FBQTtnQkFDQSxPQUFBO3FCQUNBLElBQUEsV0FBQTs7WUFFQSxPQUFBLFdBQUEsTUFBQTs7O1FBR0EsT0FBQTs7OztBQzdHQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxRQUFBLDRHQUFBLFVBQUEsT0FBQSxJQUFBLFdBQUEsYUFBQSxNQUFBLFlBQUEsUUFBQSxlQUFBOzs7Ozs7Ozs7Ozs7Ozs7UUFlQSxJQUFBLHNCQUFBLFVBQUEsTUFBQSxXQUFBLFNBQUEsT0FBQTtZQUNBLElBQUEsU0FBQTs7WUFFQSxHQUFBLE1BQUEsRUFBQSxPQUFBLE9BQUE7WUFDQSxHQUFBLFdBQUEsRUFBQSxPQUFBLFlBQUE7WUFDQSxHQUFBLFNBQUEsRUFBQSxPQUFBLFVBQUE7WUFDQSxHQUFBLE9BQUEsRUFBQSxPQUFBLFFBQUE7O1lBRUEsT0FBQTs7O1FBR0EsT0FBQTtZQUNBLFVBQUEsWUFBQTtnQkFDQSxJQUFBLGdCQUFBLFVBQUEsWUFBQSxLQUFBLFlBQUE7b0JBQ0EsY0FBQSxjQUFBLFVBQUEsZUFBQSxZQUFBLGNBQUE7O2dCQUVBLE9BQUEsWUFBQSxRQUFBLEtBQUEsTUFBQSxNQUFBLFVBQUEsTUFBQTtvQkFDQSxJQUFBLEtBQUEsV0FBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7d0JBdUJBLEtBQUEsVUFBQSxLQUFBLFlBQUEsS0FBQTsyQkFDQTt3QkFDQSxZQUFBOztvQkFFQSxPQUFBOzs7WUFHQSxjQUFBLFlBQUE7Z0JBQ0EsSUFBQSxJQUFBLEdBQUE7Z0JBQ0EsTUFBQSxJQUFBLFlBQUEsS0FBQSxZQUFBLFVBQUEsUUFBQSxVQUFBLE1BQUE7b0JBQ0EsSUFBQSxhQUFBLEtBQUEsWUFBQSxLQUFBO29CQUNBLEVBQUEsUUFBQTttQkFDQSxNQUFBLFVBQUEsT0FBQTtvQkFDQSxFQUFBLE9BQUE7O2dCQUVBLE9BQUEsRUFBQTs7WUFFQSxTQUFBLFVBQUEsU0FBQTtnQkFDQSxJQUFBLElBQUEsR0FBQTtnQkFDQSxNQUFBLElBQUEsWUFBQSxLQUFBLFlBQUEsV0FBQSxVQUFBLEtBQUEsUUFBQSxVQUFBLE1BQUE7b0JBQ0EsSUFBQSxhQUFBLEtBQUEsWUFBQTtvQkFDQSxFQUFBLFFBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOztnQkFFQSxPQUFBLEVBQUE7O1lBRUEsZUFBQSxVQUFBLE1BQUEsV0FBQSxTQUFBLE9BQUE7Z0JBQ0EsSUFBQSxTQUFBLG9CQUFBLE1BQUEsV0FBQSxTQUFBOztnQkFFQSxJQUFBLHFCQUFBLFVBQUEsWUFBQSxLQUFBLFlBQUEsaUJBQUE7b0JBQ0EsbUJBQUEsY0FBQSxVQUFBLG9CQUFBLFlBQUEsY0FBQTs7Z0JBRUEsT0FBQSxpQkFBQSxRQUFBLEtBQUEsTUFBQSxNQUFBLFVBQUEsTUFBQTtvQkFDQSxJQUFBLEtBQUEsV0FBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7d0JBaUJBLEtBQUEsVUFBQSxXQUFBLFlBQUEsS0FBQTsyQkFDQTt3QkFDQSxpQkFBQTs7b0JBRUEsT0FBQTs7O1lBR0EsbUJBQUEsVUFBQSxNQUFBLFdBQUEsU0FBQSxPQUFBO2dCQUNBLElBQUEsSUFBQSxHQUFBO2dCQUNBLElBQUEsU0FBQSxvQkFBQSxNQUFBLFdBQUEsU0FBQTtnQkFDQSxNQUFBO29CQUNBLEtBQUEsWUFBQSxLQUFBLFlBQUE7b0JBQ0EsUUFBQTtvQkFDQSxRQUFBO21CQUNBLFFBQUEsVUFBQSxNQUFBO29CQUNBLEtBQUEsVUFBQSxXQUFBLFlBQUEsS0FBQTtvQkFDQSxFQUFBLFFBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOztnQkFFQSxPQUFBLEVBQUE7O1lBRUEsYUFBQSxVQUFBLFNBQUEsT0FBQTtnQkFDQSxJQUFBLE9BQUE7b0JBQ0EsT0FBQTs7Z0JBRUEsUUFBQSxTQUFBOztnQkFFQSxPQUFBLEtBQUEsV0FBQSxLQUFBLFVBQUEsT0FBQTtvQkFDQSxLQUFBLFFBQUE7b0JBQ0EsT0FBQSxLQUFBLGNBQUEsT0FBQSxLQUFBLFVBQUEsT0FBQTt3QkFDQSxLQUFBLFFBQUE7d0JBQ0EsT0FBQTs7Ozs7Ozs7O0FDN0lBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFFBQUEsNERBQUEsVUFBQSxPQUFBLElBQUEsYUFBQSxNQUFBO1FBQ0EsSUFBQSxvQkFBQSxVQUFBLFVBQUEsTUFBQSxjQUFBLFdBQUE7WUFDQSxPQUFBO2dCQUNBLFVBQUE7Z0JBQ0EsTUFBQTtnQkFDQSxjQUFBO2dCQUNBLFdBQUE7Ozs7UUFJQSxPQUFBO1lBQ0EsWUFBQSxVQUFBLElBQUEsTUFBQTtnQkFDQSxPQUFBLFFBQUE7Z0JBQ0EsSUFBQSxJQUFBLEdBQUE7O2dCQUVBLE1BQUE7b0JBQ0EsS0FBQSxZQUFBLEtBQUEsWUFBQSxXQUFBLEtBQUE7b0JBQ0EsUUFBQTtvQkFDQSxNQUFBO21CQUNBLFFBQUEsVUFBQSxRQUFBO29CQUNBLEVBQUEsUUFBQSxLQUFBLFlBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOzs7Z0JBR0EsT0FBQSxFQUFBOzs7Ozs7QUM1QkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsV0FBQSx5TUFBQSxTQUFBLFlBQUEsUUFBQSxZQUFBLGFBQUEsWUFBQSxnQkFBQSxlQUFBLGNBQUEsYUFBQSxjQUFBLGtCQUFBLGFBQUE7UUFDQSxPQUFBLE9BQUEsSUFBQTtRQUNBLE9BQUEsV0FBQTtRQUNBLE9BQUEsaUJBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLFdBQUE7UUFDQSxPQUFBLFlBQUE7UUFDQSxPQUFBLFVBQUE7WUFDQSxNQUFBO1lBQ0EsUUFBQTs7UUFFQSxPQUFBLG9CQUFBO1FBQ0EsT0FBQSxTQUFBO1FBQ0EsT0FBQSxnQkFBQTtRQUNBLE9BQUEsY0FBQTtRQUNBLE9BQUEsb0JBQUE7UUFDQSxPQUFBLGVBQUE7UUFDQSxPQUFBLG9CQUFBO1FBQ0EsT0FBQSxrQkFBQTtRQUNBLE9BQUEsdUJBQUE7UUFDQSxPQUFBLFVBQUE7UUFDQSxPQUFBLFdBQUE7UUFDQSxPQUFBLG9CQUFBO1FBQ0EsT0FBQSxPQUFBLFlBQUE7UUFDQSxPQUFBLDBCQUFBLE9BQUEsT0FBQSxPQUFBLEtBQUEsV0FBQSx1QkFBQSxjQUFBO1FBQ0EsT0FBQSxvQkFBQTs7UUFFQSxPQUFBLGtCQUFBLFlBQUE7WUFDQSxPQUFBLG9CQUFBLENBQUEsT0FBQTtZQUNBLElBQUEsZ0JBQUE7Z0JBQ0EsV0FBQSxPQUFBOztZQUVBLGlCQUFBLGdCQUFBLGVBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxrQkFBQSxLQUFBLFlBQUEsV0FBQTtnQkFDQSxPQUFBLHVCQUFBLEtBQUEsWUFBQSxrQkFBQTtnQkFDQSxPQUFBLG9CQUFBLEtBQUEsWUFBQSxZQUFBO2VBQ0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsUUFBQSxJQUFBOzs7O1FBSUEsSUFBQSxhQUFBLFlBQUE7WUFDQSxPQUFBLFdBQUEsY0FBQSxPQUFBOzs7UUFHQSxJQUFBLGNBQUEsWUFBQTtZQUNBLGVBQUEsY0FBQSxLQUFBLE1BQUEsTUFBQSxVQUFBLE1BQUE7Z0JBQ0EsSUFBQSxLQUFBLFdBQUE7b0JBQ0EsT0FBQSxXQUFBO29CQUNBLE9BQUEsUUFBQSxPQUFBLEtBQUE7b0JBQ0E7dUJBQ0E7b0JBQ0EsSUFBQSxLQUFBLGNBQUEsS0FBQSxlQUFBLElBQUE7d0JBQ0EsT0FBQSxpQkFBQSxLQUFBOztvQkFFQSxPQUFBLFdBQUE7O2dCQUVBLE9BQUEsY0FBQTs7OztRQUlBLElBQUEsWUFBQSxZQUFBO1lBQ0EsSUFBQSxXQUFBLGFBQUEsWUFBQSxPQUFBLE9BQUEsR0FBQSxLQUFBO2dCQUNBLFdBQUEsYUFBQSxZQUFBLFVBQUEsVUFBQSxHQUFBLEtBQUE7Z0JBQ0EsWUFBQSxhQUFBLFlBQUEsUUFBQSxRQUFBLEdBQUEsS0FBQTs7WUFFQSxjQUFBLFlBQUEsS0FBQSxNQUFBLE1BQUEsVUFBQSxRQUFBO2dCQUNBLElBQUEsT0FBQSxXQUFBO29CQUNBLE9BQUEsY0FBQTtvQkFDQSxPQUFBLFNBQUE7b0JBQ0EsU0FBQSxPQUFBLE9BQUE7b0JBQ0EsU0FBQSxPQUFBLE9BQUE7b0JBQ0EsVUFBQSxPQUFBLE9BQUE7b0JBQ0EsT0FBQSxlQUFBLE9BQUEsT0FBQSxZQUFBLFdBQUE7b0JBQ0EsT0FBQSxvQkFBQSxPQUFBLE9BQUEsWUFBQSxrQkFBQTtvQkFDQSxJQUFBLE9BQUEsVUFBQSxXQUFBO3dCQUNBLE9BQUEsa0JBQUEsT0FBQSxVQUFBLFlBQUEsV0FBQTt3QkFDQSxPQUFBLHVCQUFBLE9BQUEsVUFBQSxZQUFBLGtCQUFBO3dCQUNBLE9BQUEsb0JBQUEsT0FBQSxVQUFBO3dCQUNBLE9BQUEsb0JBQUEsT0FBQSxVQUFBLFlBQUEsWUFBQTsyQkFDQTt3QkFDQSxPQUFBLGtCQUFBLE9BQUEsVUFBQSxZQUFBLG9CQUFBO3dCQUNBLE9BQUEsdUJBQUE7d0JBQ0EsT0FBQSxvQkFBQSxPQUFBLFVBQUE7d0JBQ0EsT0FBQSxvQkFBQSxPQUFBLFVBQUEsWUFBQSxZQUFBOztvQkFFQSxJQUFBLE9BQUEsVUFBQSxVQUFBLE9BQUEsT0FBQSxVQUFBLE1BQUEsS0FBQTt3QkFDQSxPQUFBLFVBQUEsYUFBQSx5QkFBQSxPQUFBLFVBQUEsVUFBQSxPQUFBLFFBQUEsYUFBQSx5QkFBQSxPQUFBLFVBQUEsTUFBQTs7b0JBRUEsSUFBQSxPQUFBLFVBQUEsVUFBQSxRQUFBLE9BQUEsVUFBQSxNQUFBLE1BQUE7d0JBQ0EsT0FBQSxXQUFBLGFBQUEseUJBQUEsT0FBQSxVQUFBLFVBQUEsUUFBQSxRQUFBLGFBQUEseUJBQUEsT0FBQSxVQUFBLE1BQUE7O3VCQUVBO29CQUNBLElBQUEsT0FBQSxjQUFBLE9BQUEsZUFBQSxJQUFBO3dCQUNBLE9BQUEsb0JBQUEsT0FBQTs7b0JBRUEsT0FBQSxjQUFBOztnQkFFQSxPQUFBLGdCQUFBOzs7O1FBSUEsV0FBQSxJQUFBLGlCQUFBLFVBQUEsT0FBQSxNQUFBO1lBQ0EsT0FBQSxRQUFBLFNBQUE7WUFDQTs7O1FBR0EsSUFBQSxhQUFBLFlBQUE7WUFDQTtZQUNBO1lBQ0EsV0FBQSxlQUFBOzs7UUFHQTs7OztBQ3BIQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxRQUFBLGlFQUFBLFNBQUEsT0FBQSxJQUFBLFdBQUEsYUFBQTs7UUFFQSxPQUFBO1lBQ0EsZUFBQSxZQUFBO2dCQUNBLElBQUEsSUFBQSxHQUFBO2dCQUNBLElBQUEsTUFBQSxZQUFBLEtBQUEsWUFBQTs7Z0JBRUEsTUFBQTtvQkFDQSxLQUFBO29CQUNBLFFBQUE7bUJBQ0EsUUFBQSxVQUFBLE1BQUE7b0JBQ0EsRUFBQSxRQUFBLEtBQUE7bUJBQ0EsTUFBQSxVQUFBLE9BQUE7b0JBQ0EsRUFBQSxPQUFBOztnQkFFQSxPQUFBLEVBQUE7Ozs7Ozs7OztBQ2xCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxXQUFBLCtKQUFBLFVBQUEsWUFBQSxRQUFBLFdBQUEsY0FBQSxZQUFBLGVBQUEsYUFBQSxlQUFBLGFBQUE7O1FBRUEsSUFBQSxPQUFBOztRQUVBLE9BQUEsU0FBQTtRQUNBLE9BQUEsV0FBQSxhQUFBO1FBQ0EsT0FBQSxjQUFBLFlBQUEsWUFBQTtRQUNBLGNBQUEsZUFBQTtRQUNBLE9BQUEsc0JBQUE7UUFDQSxPQUFBLFlBQUE7UUFDQSxPQUFBLG1CQUFBOztRQUVBLEtBQUEsa0JBQUEsVUFBQSxVQUFBO1lBQ0EsT0FBQSxzQkFBQTtZQUNBLGNBQUEsaUJBQUEsVUFBQSxLQUFBLFVBQUEsTUFBQTtnQkFDQSxPQUFBLFNBQUE7Z0JBQ0EsY0FBQSxvQkFBQSxLQUFBLFlBQUEsSUFBQSxLQUFBLFNBQUEsV0FBQTtvQkFDQSxPQUFBLGFBQUE7bUJBQ0EsTUFBQSxTQUFBLE1BQUE7bUJBQ0EsUUFBQSxJQUFBOztlQUVBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLFFBQUEsSUFBQTtlQUNBLFFBQUEsWUFBQTtnQkFDQSxPQUFBLHNCQUFBOzs7O1FBSUEsS0FBQSxhQUFBLFlBQUE7WUFDQSxXQUFBLGVBQUE7WUFDQSxXQUFBLE9BQUEsWUFBQTs7WUFFQSxLQUFBLGdCQUFBLE9BQUE7Ozs7O1FBS0EsT0FBQSxZQUFBLFVBQUEsS0FBQTtZQUNBLEVBQUEsTUFBQSxPQUFBLFdBQUE7WUFDQSxPQUFBLFlBQUE7WUFDQSxFQUFBLE1BQUEsT0FBQSxXQUFBOzs7UUFHQSxLQUFBOzs7O0FDOUNBLENBQUEsVUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBLFdBQUEsc0xBQUEsU0FBQSxRQUFBLE1BQUEsV0FBQSxjQUFBLFdBQUEsWUFBQSxlQUFBLFlBQUEsZUFBQSxnQkFBQSxhQUFBOztRQUVBLE9BQUEsT0FBQSxJQUFBO1FBQ0EsT0FBQSxVQUFBO1FBQ0EsT0FBQSxlQUFBLFNBQUEsYUFBQTs7UUFFQSxPQUFBLGdCQUFBOztRQUVBLE9BQUEsY0FBQSxZQUFBLFlBQUE7UUFDQSxjQUFBLGVBQUE7O1FBRUEsT0FBQSxRQUFBLENBQUEsU0FBQSxTQUFBO1FBQ0EsT0FBQSxvQkFBQTtRQUNBLE9BQUEsV0FBQTs7UUFFQSxJQUFBLGNBQUEsWUFBQTtZQUNBLGVBQUEsa0JBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxnQkFBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLFFBQUEsSUFBQTtlQUNBLFFBQUEsWUFBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7UUFJQSxPQUFBLGFBQUEsVUFBQSxNQUFBO1dBQ0EsSUFBQSxnQkFBQSxVQUFBLEtBQUE7YUFDQSxXQUFBLE9BQUE7YUFDQSxhQUFBO2FBQ0EsT0FBQTthQUNBLE1BQUE7OztXQUdBLGNBQUEsT0FBQSxLQUFBLFlBQUE7YUFDQSxPQUFBLFdBQUEsT0FBQTtjQUNBLFlBQUE7Ozs7O1NBS0EsT0FBQSxhQUFBLFNBQUEsZ0JBQUE7YUFDQSxPQUFBLFdBQUEsV0FBQSxXQUFBO2FBQ0EsT0FBQTs7O1NBR0EsT0FBQSxhQUFBLFNBQUEsS0FBQTthQUNBLE9BQUEsZUFBQTs7O1FBR0EsT0FBQSxhQUFBLFdBQUE7WUFDQTtZQUNBLFdBQUEsZUFBQTtZQUNBLEdBQUEsT0FBQSxhQUFBO2dCQUNBLE9BQUEsb0JBQUEsT0FBQTs7Z0JBRUE7Z0JBQ0EsT0FBQSxhQUFBLFdBQUE7Ozs7O1FBS0EsT0FBQSxzQkFBQSxVQUFBLElBQUE7WUFDQSxjQUFBLG9CQUFBLElBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxhQUFBO2dCQUNBLElBQUEsT0FBQSxhQUFBO29CQUNBLE9BQUE7Ozs7O1FBS0EsT0FBQSxpQkFBQSxVQUFBO2dCQUNBLFFBQUEsSUFBQSxPQUFBLFdBQUE7OztRQUdBLE9BQUE7Ozs7QUM3RUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLFlBQUEsV0FBQSxxUEFBQSxVQUFBLFlBQUEsUUFBQSxjQUFBLFdBQUEsV0FBQSxTQUFBLGNBQUEsWUFBQSxlQUFBLGVBQUEsZ0JBQUEsYUFBQSxZQUFBLGFBQUEsY0FBQTtRQUNBLE9BQUEsVUFBQTtRQUNBLE9BQUEsaUJBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLGdCQUFBO1FBQ0EsT0FBQSx3QkFBQSxTQUFBLGFBQUE7UUFDQSxPQUFBLG1CQUFBO1FBQ0EsT0FBQSxhQUFBO1FBQ0EsT0FBQSxPQUFBLElBQUE7UUFDQSxPQUFBLFVBQUE7UUFDQSxPQUFBLE9BQUE7UUFDQSxPQUFBLGFBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLGFBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLGVBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLGdCQUFBO1FBQ0EsT0FBQSxtQkFBQTtRQUNBLE9BQUEsZUFBQTtRQUNBLE9BQUEsY0FBQTtRQUNBLE9BQUEsY0FBQTtRQUNBLE9BQUEsaUJBQUE7UUFDQSxPQUFBLG1CQUFBO1FBQ0EsT0FBQSxPQUFBLFlBQUE7UUFDQSxPQUFBLGNBQUE7UUFDQSxPQUFBLG1CQUFBOztRQUVBLE9BQUEsY0FBQSxZQUFBLFlBQUE7UUFDQSxjQUFBLGVBQUE7O1FBRUEsSUFBQSxhQUFBLFlBQUE7WUFDQSxXQUFBLGVBQUE7WUFDQSxXQUFBLE9BQUEsWUFBQTtZQUNBOzs7O1FBSUEsSUFBQSxpQkFBQSxZQUFBO1lBQ0EsY0FBQSxpQkFBQSxLQUFBLFVBQUEsTUFBQTtnQkFDQSxPQUFBLGNBQUE7Z0JBQ0EsSUFBQSxZQUFBLFFBQUE7b0JBQ0EsSUFBQSxJQUFBO3dCQUNBLFFBQUE7d0JBQ0E7b0JBQ0EsT0FBQSxPQUFBLGFBQUEsSUFBQSxJQUFBLEtBQUE7d0JBQ0EsTUFBQSxRQUFBLGFBQUEsUUFBQTs7b0JBRUEsRUFBQSxPQUFBLEVBQUEsTUFBQSxRQUFBLFVBQUEsR0FBQTt3QkFDQSxJQUFBLEVBQUEsU0FBQSxFQUFBLElBQUEsZUFBQTs0QkFDQSxJQUFBLE9BQUEsS0FBQSxNQUFBLEVBQUE7NEJBQ0EsT0FBQSxpQkFBQSxLQUFBOzRCQUNBLE9BQUEsWUFBQSxLQUFBOzs7O2dCQUlBLE9BQUEsZ0JBQUEsRUFBQSxNQUFBLE1BQUE7Z0JBQ0EsT0FBQSxxQkFBQSxPQUFBO2dCQUNBLFFBQUEsT0FBQTtxQkFDQSxJQUFBO3dCQUNBLE9BQUE7d0JBQ0EsYUFBQTt3QkFDQSxVQUFBLFlBQUE7NEJBQ0EsSUFBQSxPQUFBLGtCQUFBO2dDQUNBLElBQUEsTUFBQSxFQUFBLFFBQUEsT0FBQSxlQUFBLE9BQUEsaUJBQUE7Z0NBQ0EsSUFBQSxNQUFBLEdBQUE7b0NBQ0EsT0FBQSxlQUFBLE9BQUEsY0FBQSxNQUFBOzs7O3VCQUlBLElBQUE7d0JBQ0EsT0FBQTt3QkFDQSxhQUFBO3dCQUNBLFVBQUEsWUFBQTs0QkFDQSxJQUFBLE9BQUEsa0JBQUE7Z0NBQ0EsSUFBQSxNQUFBLEVBQUEsUUFBQSxPQUFBLGVBQUEsT0FBQSxpQkFBQTtnQ0FDQSxJQUFBLE9BQUEsT0FBQSxjQUFBLFNBQUEsSUFBQTtvQ0FDQSxPQUFBLGVBQUEsT0FBQSxjQUFBLE1BQUE7Ozs7O2VBS0EsTUFBQSxVQUFBLE9BQUE7Z0JBQ0EsUUFBQSxJQUFBO2VBQ0EsUUFBQSxZQUFBO2dCQUNBLElBQUEsT0FBQSxTQUFBO29CQUNBLE9BQUEsVUFBQTs7Ozs7UUFLQSxPQUFBLHdCQUFBLFlBQUE7WUFDQSxFQUFBLFFBQUEsT0FBQSxrQkFBQSxVQUFBLE1BQUE7Z0JBQ0EsYUFBQSxXQUFBLGVBQUEsS0FBQTs7WUFFQSxVQUFBLEtBQUE7OztRQUdBLE9BQUEsZ0JBQUEsVUFBQTtZQUNBLFVBQUEsS0FBQTs7O1FBR0EsT0FBQSx1QkFBQSxVQUFBLGNBQUE7WUFDQSxJQUFBLGVBQUEsR0FBQTtnQkFDQSxjQUFBLG9CQUFBLGNBQUEsS0FBQSxVQUFBLE1BQUE7b0JBQ0EsT0FBQSxtQkFBQTs7bUJBRUEsSUFBQSxpQkFBQSxHQUFBO2dCQUNBLE9BQUEsbUJBQUEsSUFBQTs7OztRQUlBLE9BQUEsaUJBQUEsVUFBQSxJQUFBO1lBQ0EsSUFBQSxPQUFBLG9CQUFBLE9BQUEsaUJBQUEsVUFBQTtnQkFDQSxzQkFBQSxLQUFBLFlBQUE7O29CQUVBLFVBQUEsS0FBQSxvQkFBQTttQkFDQSxZQUFBOzs7O21CQUlBO2dCQUNBLFVBQUEsS0FBQSxvQkFBQTs7OztRQUlBLElBQUEsc0JBQUEsWUFBQTtZQUNBLElBQUEsZ0JBQUEsVUFBQSxLQUFBO2dCQUNBLFdBQUEsT0FBQTtnQkFDQSxhQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsTUFBQTs7O1lBR0EsT0FBQSxjQUFBOzs7UUFHQSxPQUFBLGVBQUEsVUFBQSxnQkFBQTtZQUNBLElBQUEsT0FBQSxtQkFBQSxhQUFBO2dCQUNBLE9BQUEsaUJBQUE7bUJBQ0E7Z0JBQ0EsT0FBQSxpQkFBQSxDQUFBLE9BQUE7O1lBRUEsT0FBQSxjQUFBLE9BQUEsaUJBQUEsdUJBQUE7WUFDQSxPQUFBLGNBQUEsT0FBQSxpQkFBQSxjQUFBO1lBQ0EsT0FBQSxtQkFBQSxPQUFBLGlCQUFBLHdCQUFBOzs7UUFHQSxXQUFBLElBQUEsY0FBQSxVQUFBLE9BQUEsTUFBQTtZQUNBLE9BQUEsYUFBQSxTQUFBOzs7UUFHQTs7UUFFQSxXQUFBLElBQUEsa0JBQUEsWUFBQTtZQUNBLE9BQUEsbUJBQUE7WUFDQSxPQUFBLGVBQUE7OztRQUdBLFFBQUEsUUFBQSxVQUFBLE1BQUEsWUFBQTs7WUFFQSxJQUFBLFdBQUEsYUFBQTtnQkFDQSxTQUFBLFlBQUE7Z0JBQ0EscUJBQUEsU0FBQSxTQUFBOztZQUVBLE9BQUEsaUJBQUEsYUFBQSxxQkFBQSxxQkFBQSxxQkFBQTs7OztBQ3hLQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxXQUFBLDRLQUFBLFVBQUEsWUFBQSxRQUFBLFdBQUEsY0FBQSxZQUFBLGFBQUEsaUJBQUEsYUFBQSxlQUFBLGVBQUE7O1FBRUEsSUFBQSxnQkFBQTtZQUNBLE1BQUEsTUFBQSxXQUFBLE1BQUEsU0FBQSxNQUFBLE9BQUEsTUFBQSxPQUFBLFdBQUEsMEJBQUEsTUFBQSxTQUFBLE1BQUEsV0FBQSxNQUFBLEtBQUE7Ozs7UUFJQSxFQUFBLFFBQUEsRUFBQSxNQUFBLGdCQUFBLFVBQUEsT0FBQTtZQUNBLElBQUEsUUFBQSxFQUFBLEdBQUEsVUFBQSxVQUFBLE1BQUE7WUFDQSxJQUFBLE1BQUEsU0FBQSxHQUFBO2dCQUNBLGNBQUEsTUFBQSxNQUFBLE1BQUEsU0FBQSxJQUFBLFFBQUEsTUFBQTs7OztRQUlBLElBQUEsaUJBQUEsY0FBQSxRQUFBO1lBQ0EsdUJBQUEsY0FBQSxVQUFBLE9BQUE7WUFDQSxrQkFBQSxjQUFBLFFBQUEsT0FBQTs7O1FBR0EsT0FBQSxjQUFBO1FBQ0EsT0FBQSxVQUFBO1FBQ0EsT0FBQSxtQkFBQTtRQUNBLE9BQUEscUJBQUEsY0FBQSxXQUFBO1FBQ0EsT0FBQSxjQUFBLFlBQUEsWUFBQTtRQUNBLE9BQUEsWUFBQTtRQUNBLE9BQUEsb0JBQUEsY0FBQSxVQUFBLE9BQUEsSUFBQSxjQUFBLFNBQUEsV0FBQSxPQUFBLE1BQUEsU0FBQSxHQUFBLFNBQUEsUUFBQSxLQUFBO1FBQ0EsT0FBQSx5QkFBQTtZQUNBLFFBQUE7O1FBRUEsT0FBQSw2QkFBQSxVQUFBLFFBQUE7WUFDQSxPQUFBO1lBQ0EsT0FBQSx1QkFBQSxTQUFBOztRQUVBLE9BQUEsbUJBQUEsY0FBQSxRQUFBLE9BQUEsSUFBQSxjQUFBLE9BQUEsV0FBQSxPQUFBLE1BQUEsTUFBQSxLQUFBO1FBQ0EsT0FBQSx3QkFBQTtZQUNBLFFBQUE7O1FBRUEsT0FBQSw0QkFBQSxVQUFBLFFBQUE7WUFDQSxPQUFBO1lBQ0EsT0FBQSxzQkFBQSxTQUFBOztRQUVBLE9BQUEsbUJBQUE7WUFDQSxVQUFBOzs7UUFHQSxjQUFBLGVBQUE7O1FBRUEsSUFBQSxvQkFBQTtZQUNBO2dCQUNBLE9BQUE7Z0JBQ0EsYUFBQTtnQkFDQSxjQUFBO2dCQUNBLHNCQUFBOzs7WUFHQTtnQkFDQSxPQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsaUJBQUE7Z0JBQ0EsY0FBQTs7WUFFQTtnQkFDQSxPQUFBO2dCQUNBLGFBQUE7Z0JBQ0EsaUJBQUE7Z0JBQ0EsY0FBQTs7O1lBR0E7Z0JBQ0EsT0FBQTtnQkFDQSxpQkFBQTtnQkFDQSxlQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsY0FBQTs7WUFFQTtnQkFDQSxPQUFBO2dCQUNBLGlCQUFBO2dCQUNBLGVBQUE7Z0JBQ0EsY0FBQTs7OztRQUlBLE9BQUEsY0FBQSxZQUFBO1FBQ0EsT0FBQSxZQUFBLHdCQUFBLFNBQUEsY0FBQSxRQUFBO1FBQ0EsT0FBQSxZQUFBLHFCQUFBLFNBQUEsY0FBQSxjQUFBLE9BQUEsWUFBQTtRQUNBLElBQUEsVUFBQSxXQUFBLGdCQUFBLFdBQUEsZ0JBQUE7UUFDQSxPQUFBLFlBQUEsYUFBQSxZQUFBLGdCQUFBLFNBQUE7UUFDQSxPQUFBLFlBQUEsT0FBQTtRQUNBLE9BQUEsWUFBQSxnQkFBQSxVQUFBLFNBQUE7O1lBRUEsT0FBQSxVQUFBO1lBQ0EsT0FBQSxRQUFBLFVBQUEsR0FBQSxvQkFBQSxRQUFBLFVBQUEsS0FBQTtnQkFDQSxPQUFBLE9BQUEsVUFBQTtvQkFDQSxVQUFBLEtBQUEscUJBQUEsSUFBQSxPQUFBOzs7O1lBSUEsT0FBQSxRQUFBLFdBQUEsR0FBQSxrQkFBQSxRQUFBLFVBQUEsYUFBQSxVQUFBO2dCQUNBLGNBQUEsT0FBQTtnQkFDQSxjQUFBLFlBQUE7Z0JBQ0EsUUFBQSxJQUFBO2dCQUNBLE9BQUE7O1lBRUEsT0FBQSxRQUFBLEtBQUEsR0FBQSxZQUFBLFFBQUEsVUFBQSxNQUFBLGFBQUE7Z0JBQ0EsV0FBQSxnQkFBQTtnQkFDQSxFQUFBLFFBQUEsT0FBQSxRQUFBLEtBQUEsU0FBQSxVQUFBLEtBQUE7b0JBQ0EsSUFBQSxPQUFBLE9BQUEsSUFBQTs7Z0JBRUEsV0FBQSxnQkFBQSxPQUFBLFFBQUEsS0FBQSxRQUFBO2dCQUNBLElBQUEsVUFBQTtnQkFDQSxFQUFBLFFBQUEsYUFBQSxVQUFBLEtBQUE7b0JBQ0EsUUFBQSxLQUFBLElBQUEsS0FBQSxjQUFBLFNBQUEsTUFBQSxJQUFBLFFBQUEsSUFBQTs7Z0JBRUEsa0JBQUE7Ozs7UUFJQSxPQUFBLFVBQUEsVUFBQSxRQUFBLFlBQUEsVUFBQSxLQUFBO1lBQ0EsT0FBQSxVQUFBO1lBQ0EsY0FBQSxXQUFBLFFBQUEsWUFBQSxVQUFBLEtBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsSUFBQSxVQUFBO2dCQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxPQUFBLFlBQUEsb0JBQUEsS0FBQTtvQkFDQSxJQUFBLEtBQUEsUUFBQSxJQUFBO3dCQUNBLFFBQUEsS0FBQSxLQUFBLFFBQUE7OztnQkFHQSxPQUFBLFlBQUEsT0FBQTtnQkFDQSxPQUFBLFlBQUEsYUFBQSxLQUFBO2dCQUNBLE9BQUEsV0FBQTtnQkFDQSxpQkFBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLFFBQUEsSUFBQTtlQUNBLFFBQUEsWUFBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7UUFJQSxPQUFBLGdCQUFBLFlBQUE7WUFDQSxFQUFBLFFBQUEsRUFBQSxNQUFBLGdCQUFBLFVBQUEsT0FBQTtnQkFDQSxVQUFBLE9BQUEsTUFBQSxJQUFBLE1BQUE7O1lBRUEsT0FBQSxVQUFBO1lBQ0E7OztRQUdBLElBQUEsYUFBQSxZQUFBO1lBQ0EsY0FBQSxXQUFBLGVBQUEsS0FBQSxVQUFBLE1BQUE7Z0JBQ0EsT0FBQSxjQUFBO2dCQUNBLE9BQUEsWUFBQSxhQUFBLEtBQUE7Z0JBQ0EsT0FBQSxZQUFBLE9BQUEsS0FBQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLFFBQUEsSUFBQTtlQUNBLFFBQUEsWUFBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7UUFJQSxJQUFBLGlCQUFBLFlBQUE7WUFDQSxjQUFBLGlCQUFBLEtBQUEsVUFBQSxNQUFBO2dCQUNBLE9BQUEsbUJBQUE7Z0JBQ0EsT0FBQSxpQkFBQSxRQUFBLEVBQUEsTUFBQSxZQUFBLE9BQUEsWUFBQSxTQUFBLElBQUEsSUFBQTtnQkFDQTtlQUNBLE1BQUEsVUFBQSxPQUFBO2dCQUNBLE9BQUEsVUFBQTtnQkFDQSxRQUFBLElBQUE7Ozs7UUFJQSxJQUFBLG9CQUFBLFVBQUEsU0FBQTtZQUNBLGNBQUEsUUFBQSxRQUFBLFNBQUEsSUFBQSxVQUFBO1lBQ0Esa0JBQUEsUUFBQSxTQUFBO1lBQ0EsT0FBQTs7O1FBR0EsSUFBQSxtQkFBQSxVQUFBLE9BQUE7WUFDQSxJQUFBLFNBQUEsY0FBQSxTQUFBO2dCQUNBLGNBQUEsT0FBQTs7WUFFQSxjQUFBLFVBQUEsU0FBQSxJQUFBLE9BQUE7WUFDQSxjQUFBLFlBQUEsT0FBQSxZQUFBO1lBQ0EsUUFBQSxJQUFBO1lBQ0EsSUFBQSxDQUFBLE9BQUEsU0FBQTtnQkFD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Q0EsWUFBQSxHQUFBLE1BQUE7Z0JBQ0EsTUFBQSxLQUFBLGFBQUEsZUFBQSxHQUFBLE1BQUEsWUFBQTtvQkFDQSxXQUFBLFlBQUE7O1lBRUEsSUFBQSxLQUFBOztZQUVBLFNBQUEsSUFBQSxRQUFBOzs7WUFHQSxRQUFBLElBQUEsUUFBQSxTQUFBO1lBQ0EsTUFBQSxTQUFBO2dCQUNBLFNBQUE7Z0JBQ0EsU0FBQTtnQkFDQSxTQUFBO2dCQUNBLFNBQUE7Z0JBQ0EsU0FBQTs7OztRQUlBLFlBQUEsWUFBQTs7WUFFQSxPQUFBLFlBQUEsVUFBQSxNQUFBO2dCQUNBLElBQUEsUUFBQSxRQUFBLFFBQUEsU0FBQSxlQUFBLGlCQUFBO2dCQUNBLE1BQUEsT0FBQSxZQUFBO29CQUNBLE1BQUEsVUFBQTs7OztZQUlBLE9BQUEsV0FBQSxVQUFBLFNBQUEsV0FBQTtnQkFDQSxFQUFBLE1BQUEsU0FBQSxRQUFBO2dCQUNBLElBQUEsUUFBQSxRQUFBLFFBQUEsU0FBQSxlQUFBLGlCQUFBO2dCQUNBLE1BQUEsT0FBQSxZQUFBO29CQUNBLE1BQUEsU0FBQSxTQUFBOzs7O1lBSUEsT0FBQSxzQkFBQSxVQUFBLGlCQUFBO2dCQUNBLEVBQUEsVUFBQSxRQUFBO2dCQUNBLElBQUEsUUFBQSxRQUFBLFFBQUEsU0FBQSxlQUFBLGlCQUFBO2dCQUNBLE1BQUEsT0FBQSxZQUFBO29CQUNBLE1BQUEsb0JBQUE7Ozs7WUFJQSxPQUFBLFlBQUEsVUFBQSxTQUFBLFVBQUE7Z0JBQ0EsRUFBQSxNQUFBLFNBQUEsUUFBQTtnQkFDQSxJQUFBLFFBQUEsUUFBQSxRQUFBLFNBQUEsZUFBQSxpQkFBQTtnQkFDQSxNQUFBLE9BQUEsWUFBQTtvQkFDQSxNQUFBLFVBQUEsU0FBQTs7OztZQUlBLElBQUEsT0FBQSxRQUFBO2dCQUNBLE9BQUEsbUJBQUEsT0FBQSxPQUFBLGdCQUFBLE9BQUEsU0FBQSxPQUFBLElBQUEsT0FBQSxPQUFBLGVBQUEsS0FBQSxPQUFBLFFBQUEsU0FBQSxRQUFBOzs7WUFHQSxJQUFBLE9BQUE7WUFDQSxJQUFBLE9BQUEsV0FB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O0lBQ0EsSUFBQSxZQUFBO0lBQ0EsSUFBQSxhQUFBO0lBQ0EsSUFBQSxTQUFBLFNBQUEsS0FBQSxlQUFBLE9BQUEsTUFBQSxPQUFBLE9BQUE7SUFDQSxJQUFBLFFBQUEsU0FBQSxLQUFBLGNBQUEsT0FBQSxRQUFBLE9BQUEsS0FBQTtDQUNBLElBQUEsV0FBQTtDQUNBLElBQUEsUUFBQTtDQUNBLElBQUEsUUFBQTs7SUFFQSxJQUFBLGFBQUE7O0lBRUEsSUFBQSxjQUFBLFNBQUEsR0FBQTtFQUNBLE9BQUEsRUFBQSxTQUFBLEVBQUEsV0FBQSxFQUFBOzs7SUFHQSxJQUFBLGdCQUFBLFNBQUEsR0FBQTtFQUNBLE9BQUEsZUFBQSxFQUFBLEVBQUEsVUFBQSxNQUFBLEVBQUEsRUFBQSxZQUFBOzs7SUFHQSxJQUFBLElBQUEsR0FBQSxLQUFBLFFBQUEsT0FBQSxFQUFBLGlCQUFBLGlCQUFBLE1BQUEsRUFBQSxHQUFBLFNBQUEsTUFBQTs7SUFFQSxJQUFBLElBQUEsR0FBQSxNQUFBLFVBQUEsT0FBQSxXQUFBLGdCQUFBLEVBQUEsR0FBQSxTQUFBLE9BQUEsTUFBQSxPQUFBLFVBQUE7O0lBRUEsSUFBQSxRQUFBLEdBQUEsSUFBQSxPQUFBLE1BQUEsR0FBQSxPQUFBLFVBQUEsV0FBQSxHQUFBLEtBQUEsT0FBQSxhQUFBLGNBQUE7TUFDQSxTQUFBLEdBQUEsWUFBQTs7SUFFQSxJQUFBLFFBQUEsR0FBQSxJQUFBLE9BQUEsTUFBQSxHQUFBLE9BQUEsUUFBQSxTQUFBOztJQUVBLElBQUEsaUJBQUEsU0FBQSxPQUFBO0NBQ0EsSUFBQSxtQkFBQSxzQkFBQTtLQUNBLElBQUEsVUFBQSxhQUFBLE1BQUEsU0FBQSxHQUFBO0VBQ0Esa0JBQUEsR0FBQSxLQUFBLElBQUEsT0FBQSxJQUFBLFFBQUEsQ0FBQTtFQUNBLGdCQUFBLEdBQUEsS0FBQSxLQUFBLE9BQUEsSUFBQSxRQUFBLENBQUE7RUFDQTs7S0FFQSxNQUFBLEtBQUEsU0FBQSxHQUFBLEdBQUE7RUFDQSxPQUFBLEVBQUEsU0FBQSxFQUFBOztLQUVBLGdCQUFBLE1BQUEsTUFBQSxTQUFBLEdBQUE7S0FDQSxNQUFBLEtBQUEsU0FBQSxHQUFBLEdBQUE7RUFDQSxPQUFBLEVBQUEsU0FBQSxFQUFBOztLQUVBLGtCQUFBLE1BQUEsR0FBQTs7OztJQUlBLElBQUEsV0FBQSxXQUFBO0NBQ0EsSUFBQSxHQUFBLEtBQUEsUUFBQSxPQUFBLEVBQUEsaUJBQUEsaUJBQUEsTUFBQSxFQUFBLEdBQUEsU0FBQSxNQUFBO0NBQ0EsSUFBQSxHQUFBLE1BQUEsVUFBQSxPQUFBLFdBQUEsZ0JBQUEsRUFBQSxHQUFBLFNBQUEsT0FBQSxNQUFBLE9BQUEsVUFBQTtDQUNBLFFBQUEsR0FBQSxJQUFBLE9BQUEsTUFBQSxHQUFBLE9BQUEsVUFBQSxNQUFBLEtBQUEsS0FBQSxNQUFBLE1BQUEsV0FBQSxHQUFBLEtBQUEsT0FBQSxhQUFBLGNBQUE7R0FDQSxTQUFBLEdBQUEsWUFBQTs7Q0FFQSxRQUFBLEdBQUEsSUFBQSxPQUFBLE1BQUEsR0FBQSxPQUFBLFFBQUEsU0FBQTs7O0lBR0EsU0FBQSxNQUFBLE9BQUE7O0NBRUEsZUFBQTtDQUNBOztDQUVBLElBQUEsTUFBQSxHQUFBLE9BQUE7RUFDQSxPQUFBO0VBQ0EsS0FBQSxTQUFBO0VBQ0EsS0FBQSxTQUFBLFFBQUEsT0FBQSxPQUFBLE9BQUE7RUFDQSxLQUFBLFVBQUEsU0FBQSxPQUFBLE1BQUEsT0FBQTtFQUNBLE9BQUE7U0FDQSxLQUFBLFNBQUE7RUFDQSxLQUFBLFNBQUEsUUFBQSxPQUFBLE9BQUEsT0FBQTtFQUNBLEtBQUEsVUFBQSxTQUFBLE9BQUEsTUFBQSxPQUFBO0VBQ0EsS0FBQSxhQUFBLGVBQUEsT0FBQSxPQUFBLE9BQUEsT0FBQSxNQUFBOztNQUVBLElBQUEsVUFBQTtHQUNBLEtBQUEsT0FBQSxhQUFBO0dBQ0EsT0FBQTtHQUNBLEtBQUEsTUFBQTtVQUNBLEtBQUEsTUFBQTtHQUNBLEtBQUEsU0FBQSxTQUFBLEVBQUE7TUFDQSxHQUFBLFdBQUEsRUFBQSxXQUFBLEtBQUEsRUFBQSxPQUFBO01BQ0EsT0FBQSxXQUFBLEVBQUE7O0dBRUEsS0FBQSxLQUFBO0dBQ0EsS0FBQSxhQUFBO0dBQ0EsS0FBQSxVQUFBLFNBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQTtHQUNBLEtBQUEsU0FBQSxTQUFBLEdBQUE7TUFDQSxRQUFBLEVBQUEsRUFBQSxVQUFBLEVBQUEsRUFBQTs7OztFQUlBLElBQUEsT0FBQTtHQUNBLEtBQUEsU0FBQTtHQUNBLEtBQUEsYUFBQSxtQkFBQSxTQUFBLE9BQUEsTUFBQSxPQUFBLFVBQUE7R0FDQTtHQUNBLEtBQUE7O0VBRUEsSUFBQSxPQUFBLEtBQUEsS0FBQSxTQUFBLFVBQUEsYUFBQSxLQUFBOztFQUVBLE9BQUE7O0tBRUE7O0lBRUEsTUFBQSxTQUFBLFNBQUEsT0FBQTtRQUNBLFFBQUEsSUFBQTtDQUNBLGVBQUE7Q0FDQTs7UUFFQSxJQUFBLE1BQUEsR0FBQSxPQUFBOztRQUVBLElBQUEsa0JBQUEsSUFBQSxPQUFBO1FBQ0EsSUFBQSxPQUFBLGdCQUFBLFVBQUEsUUFBQSxLQUFBLE9BQUE7O1FBRUEsS0FBQTtVQUNBLE9BQUEsT0FBQTtVQUNBLEtBQUEsTUFBQTtVQUNBLEtBQUEsTUFBQTtHQUNBLEtBQUEsU0FBQSxTQUFBLEVBQUE7TUFDQSxHQUFBLFdBQUEsRUFBQSxXQUFBLEtBQUEsRUFBQSxPQUFBO01BQ0EsT0FBQSxXQUFBLEVBQUE7O0dBRUE7R0FDQSxLQUFBLEtBQUE7R0FDQSxLQUFBLGFBQUE7R0FDQSxLQUFBLFVBQUEsU0FBQSxHQUFBLEVBQUEsT0FBQSxFQUFBO0lBQ0EsS0FBQSxTQUFBLFNBQUEsR0FBQTtNQUNBLFFBQUEsRUFBQSxFQUFBLFVBQUEsRUFBQSxFQUFBOzs7UUFHQSxLQUFBO1dBQ0EsS0FBQSxhQUFBO0dBQ0EsS0FBQSxVQUFBLFNBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQTtHQUNBLEtBQUEsU0FBQSxTQUFBLEdBQUE7TUFDQSxRQUFBLEVBQUEsRUFBQSxVQUFBLEVBQUEsRUFBQTs7O0NBR0EsS0FBQSxPQUFBOztDQUVBLElBQUEsT0FBQSxNQUFBLGFBQUEsS0FBQTtDQUNBLElBQUEsT0FBQSxNQUFBLGFBQUEsS0FBQTs7Q0FFQSxPQUFBOzs7SUFHQSxNQUFBLFNBQUEsU0FBQSxPQUFBO0NBQ0EsSUFBQSxDQUFBLFVBQUE7S0FDQSxPQUFBO0NBQ0EsU0FBQTtDQUNBLE9BQUE7OztJQUdBLE1BQUEsYUFBQSxTQUFBLE9BQUE7Q0FDQSxJQUFBLENBQUEsVUFBQTtLQUNBLE9BQUEsRUFBQSxpQkFBQTtDQUNBLGtCQUFBLENBQUEsTUFBQSxJQUFBLGdCQUFBLENBQUEsTUFBQTtDQUNBLE9BQUE7Ozs7Ozs7O0lBUUEsTUFBQSxpQkFBQSxTQUFBLE9BQUE7Q0FDQSxJQUFBLENBQUEsVUFBQTtLQUNBLE9BQUE7UUFDQSxpQkFBQTtRQUNBLE9BQUE7Ozs7SUFJQSxNQUFBLFlBQUEsU0FBQSxPQUFBO0NBQ0EsSUFBQSxDQUFBLFVBQUE7S0FDQSxPQUFBO0NBQ0EsWUFBQTtDQUNBLE9BQUE7OztJQUdBLE1BQUEsYUFBQSxTQUFBLE9BQUE7Q0FDQSxJQUFBLENBQUEsVUFBQTtLQUNBLE9BQUE7Q0FDQSxhQUFBO0NBQ0EsT0FBQTs7O0NBR0EsTUFBQSxRQUFBLFNBQUEsTUFBQTtFQUNBLEdBQUEsQ0FBQSxVQUFBLE9BQUE7R0FDQSxPQUFBOztFQUVBLFFBQUE7RUFDQSxPQUFBOzs7Q0FHQSxNQUFBLFFBQUEsU0FBQSxNQUFBO0VBQ0EsR0FBQSxDQUFBLFVBQUEsT0FBQTtHQUNBLE9BQUE7O0VBRUEsUUFBQTtFQUNBLE9BQUE7OztJQUdBLE1BQUEsUUFBQSxTQUFBLE9BQUE7Q0FDQSxJQUFBLENBQUEsVUFBQTtLQUNBLE9BQUE7Q0FDQSxRQUFBLENBQUE7Q0FDQSxPQUFBOzs7SUFHQSxNQUFBLFNBQUEsU0FBQSxPQUFBO0NBQ0EsSUFBQSxDQUFBLFVBQUE7S0FDQSxPQUFBO0NBQ0EsU0FBQSxDQUFBO0NBQ0EsT0FBQTs7O0lBR0EsTUFBQSxhQUFBLFNBQUEsT0FBQTtDQUNBLElBQUEsQ0FBQSxVQUFBO0tBQ0EsT0FBQTtDQUNBLGFBQUE7Q0FDQSxPQUFBOzs7Q0FHQSxNQUFBLFdBQUEsU0FBQSxPQUFBO0VBQ0EsR0FBQSxDQUFBLFVBQUEsT0FBQTtHQUNBLE9BQUE7O0VBRUEsV0FBQTtFQUNBLE9BQUE7Ozs7O0lBS0EsT0FBQTs7O0FDaFFBLFNBQUEsTUFBQSxpQkFBQTtBQUNBO0lBQ0EsS0FBQSxrQkFBQTs7SUFFQSxJQUFBLE9BQUE7O0lBRUEsS0FBQSxZQUFBLFNBQUE7SUFDQTtRQUNBLEtBQUEsU0FBQTs7UUFFQSxLQUFBLE9BQUEsT0FBQSxLQUFBLE9BQUEsT0FBQTs7UUFFQSxLQUFBLE9BQUEsU0FBQSxLQUFBLE9BQUEsT0FBQSxPQUFBO1FBQ0EsS0FBQSxPQUFBLEtBQUEsS0FBQSxPQUFBLE9BQUE7UUFDQSxLQUFBLE9BQUEsS0FBQSxLQUFBLE9BQUEsT0FBQTs7UUFFQSxLQUFBLE9BQUEsTUFBQSxhQUFBLGNBQUEsTUFBQSxjQUFBLE1BQUE7UUFDQSxLQUFBLE9BQUEsTUFBQSxhQUFBLGNBQUEsTUFBQSxjQUFBLE1BQUE7UUFDQSxLQUFBLE9BQUEsUUFBQSxLQUFBLE9BQUEsTUFBQSxLQUFBLE9BQUE7O1FBRUEsS0FBQSxPQUFBLGFBQUEsY0FBQSxjQUFBO1FBQ0EsS0FBQSxPQUFBLGFBQUEsY0FBQSxjQUFBOztRQUVBLEtBQUEsT0FBQSxjQUFBLGNBQUEsY0FBQTtRQUNBLEtBQUEsT0FBQSxjQUFBLGNBQUEsZUFBQTtRQUNBLEtBQUEsT0FBQSxZQUFBLGNBQUEsWUFBQTs7UUFFQSxLQUFBLE9BQUEscUJBQUEsY0FBQSxzQkFBQTs7O0lBR0EsS0FBQSxTQUFBO0lBQ0E7UUFDQSxLQUFBLE9BQUEsR0FBQSxPQUFBLE1BQUEsS0FBQTthQUNBLE9BQUE7YUFDQSxLQUFBLFNBQUE7YUFDQSxLQUFBLFNBQUEsS0FBQSxPQUFBO2FBQ0EsS0FBQSxVQUFBLEtBQUEsT0FBQTs7UUFFQSxLQUFBLEtBQUEsT0FBQTthQUNBLEtBQUEsU0FBQTthQUNBLEtBQUEsTUFBQSxLQUFBLE9BQUE7YUFDQSxLQUFBLE1BQUEsS0FBQSxPQUFBO2FBQ0EsS0FBQSxLQUFBLEtBQUEsT0FBQSxTQUFBO2FBQ0EsTUFBQSxRQUFBOzs7O1FBSUEsS0FBQSxLQUFBLE9BQUE7YUFDQSxLQUFBLE1BQUEsS0FBQSxPQUFBO2FBQ0EsS0FBQSxNQUFBLEtBQUEsT0FBQTthQUNBLEtBQUEsS0FBQSxNQUFBLEtBQUEsT0FBQTthQUNBLE1BQUEsUUFBQTthQUNBLE1BQUEsVUFBQTthQUNBLE1BQUEsZ0JBQUE7O1FBRUEsS0FBQSxJQUFBLFlBQUEsS0FBQSxPQUFBO1FBQ0E7WUFDQSxLQUFBLFNBQUEsS0FBQSxPQUFBLFdBQUEsVUFBQSxNQUFBLEtBQUEsT0FBQSxXQUFBLFVBQUEsSUFBQSxLQUFBLE9BQUE7OztRQUdBLEtBQUEsSUFBQSxhQUFBLEtBQUEsT0FBQTtRQUNBO1lBQ0EsS0FBQSxTQUFBLEtBQUEsT0FBQSxZQUFBLFdBQUEsTUFBQSxLQUFBLE9BQUEsWUFBQSxXQUFBLElBQUEsS0FBQSxPQUFBOzs7UUFHQSxLQUFBLElBQUEsVUFBQSxLQUFBLE9BQUE7UUFDQTtZQUNBLEtBQUEsU0FBQSxLQUFBLE9BQUEsU0FBQSxRQUFBLE1BQUEsS0FBQSxPQUFBLFNBQUEsUUFBQSxJQUFBLEtBQUEsT0FBQTs7O1FBR0EsSUFBQSxXQUFBOztRQUVBLElBQUEsYUFBQSxLQUFBLE9BQUE7UUFDQTtZQUNBLFdBQUEsS0FBQSxNQUFBLEtBQUEsT0FBQSxPQUFBO1lBQ0EsS0FBQSxLQUFBLE9BQUE7aUJBQ0EsS0FBQSxLQUFBLEtBQUEsT0FBQTtpQkFDQSxLQUFBLEtBQUEsS0FBQSxPQUFBLEtBQUEsSUFBQSxXQUFBO2lCQUNBLEtBQUEsTUFBQSxXQUFBO2lCQUNBLEtBQUEsZUFBQTtpQkFDQSxLQUFBLEtBQUEsT0FBQTtpQkFDQSxNQUFBLGFBQUEsV0FBQTtpQkFDQSxNQUFBLFFBQUE7aUJBQ0EsTUFBQSxnQkFBQTs7O1FBR0EsV0FBQSxLQUFBLE1BQUEsS0FBQSxPQUFBLE9BQUE7UUFDQSxJQUFBLGFBQUEsS0FBQSxPQUFBLFNBQUEsS0FBQSxPQUFBLGFBQUE7UUFDQSxLQUFBLElBQUEsUUFBQSxLQUFBLE9BQUEsS0FBQSxTQUFBLEtBQUEsT0FBQSxLQUFBLFNBQUE7UUFDQTtZQUNBLElBQUEsYUFBQSxhQUFBLEtBQUEsT0FBQTtnQkFDQSxTQUFBO2dCQUNBLFNBQUE7WUFDQSxLQUFBLElBQUEsUUFBQSxRQUFBLFlBQUEsUUFBQSxLQUFBLElBQUEsUUFBQSxZQUFBLEtBQUEsT0FBQSxNQUFBLFNBQUE7WUFDQTtnQkFDQSxTQUFBLEtBQUEsYUFBQSxPQUFBO2dCQUNBLFNBQUEsS0FBQSxhQUFBLE9BQUE7O2dCQUVBLEtBQUEsS0FBQSxPQUFBO3FCQUNBLEtBQUEsTUFBQSxPQUFBO3FCQUNBLEtBQUEsTUFBQSxPQUFBO3FCQUNBLEtBQUEsTUFBQSxPQUFBO3FCQUNBLEtBQUEsTUFBQSxPQUFBO3FCQUNBLE1BQUEsVUFBQTtxQkFDQSxNQUFBLGdCQUFBOzs7WUFHQSxTQUFBLEtBQUEsYUFBQSxPQUFBO1lBQ0EsU0FBQSxLQUFBLGFBQUEsT0FBQTs7WUFFQSxLQUFBLEtBQUEsT0FBQTtpQkFDQSxLQUFBLE1BQUEsT0FBQTtpQkFDQSxLQUFBLE1BQUEsT0FBQTtpQkFDQSxLQUFBLE1BQUEsT0FBQTtpQkFDQSxLQUFBLE1BQUEsT0FBQTtpQkFDQSxNQUFBLFVBQUE7aUJBQ0EsTUFBQSxnQkFBQTs7WUFFQSxJQUFBLFNBQUEsS0FBQSxPQUFBLE9BQUEsU0FBQSxLQUFBLE9BQUE7WUFDQTtnQkFDQSxJQUFBLFFBQUEsS0FBQSxhQUFBLE9BQUE7O2dCQUVBLEtBQUEsS0FBQSxPQUFBO3FCQUNBLEtBQUEsS0FBQSxNQUFBO3FCQUNBLEtBQUEsS0FBQSxNQUFBO3FCQUNBLEtBQUEsTUFBQSxXQUFBO3FCQUNBLEtBQUEsZUFBQSxTQUFBLEtBQUEsT0FBQSxNQUFBLFVBQUE7cUJBQ0EsS0FBQTtxQkFDQSxNQUFBLGFBQUEsV0FBQTtxQkFDQSxNQUFBLFFBQUE7cUJBQ0EsTUFBQSxnQkFBQTs7OztRQUlBLElBQUEsbUJBQUEsS0FBQSxLQUFBLE9BQUEsU0FBQSxLQUFBLFNBQUE7O1FBRUEsSUFBQSxXQUFBLENBQUEsS0FBQSxPQUFBLE1BQUEsS0FBQSxPQUFBLE9BQUE7O1FBRUEsSUFBQSxjQUFBLEtBQUEsaUJBQUE7O1FBRUEsSUFBQSxjQUFBLEdBQUEsSUFBQTthQUNBLEVBQUEsU0FBQSxHQUFBLEVBQUEsT0FBQSxFQUFBO2FBQ0EsRUFBQSxTQUFBLEdBQUEsRUFBQSxPQUFBLEVBQUE7YUFDQSxZQUFBOztRQUVBLGlCQUFBLFVBQUE7YUFDQSxLQUFBLENBQUE7YUFDQTthQUNBLE9BQUE7YUFDQSxLQUFBLEtBQUE7YUFDQSxNQUFBLFFBQUE7O1FBRUEsaUJBQUEsT0FBQTthQUNBLEtBQUEsTUFBQSxLQUFBLE9BQUE7YUFDQSxLQUFBLE1BQUEsS0FBQSxPQUFBO2FBQ0EsS0FBQSxLQUFBLE9BQUEsS0FBQSxPQUFBO2FBQ0EsTUFBQSxRQUFBOztRQUVBLFdBQUEsS0FBQSxNQUFBLEtBQUEsT0FBQSxPQUFBO1FBQ0EsaUJBQUEsVUFBQTthQUNBLEtBQUEsQ0FBQTthQUNBO2FBQ0EsT0FBQTthQUNBLEtBQUEsS0FBQSxLQUFBLE9BQUE7YUFDQSxLQUFBLEtBQUEsS0FBQSxPQUFBLE9BQUEsS0FBQSxPQUFBLEtBQUEsSUFBQTthQUNBLEtBQUEsTUFBQSxXQUFBO2FBQ0EsS0FBQSxlQUFBO2FBQ0EsTUFBQSxhQUFBLFdBQUE7YUFDQSxNQUFBLFFBQUE7YUFDQSxNQUFBLGdCQUFBOztRQUVBLEtBQUEsT0FBQSxLQUFBLE9BQUEsS0FBQTs7O0lBR0EsS0FBQSxtQkFBQSxTQUFBO0lBQ0E7UUFDQSxJQUFBLFFBQUEsS0FBQSxPQUFBLFFBQUE7O1FBRUEsSUFBQSxPQUFBLGFBQUEsT0FBQTtRQUNBLElBQUEsUUFBQSxhQUFBLFFBQUEsT0FBQTtRQUNBLElBQUEsUUFBQSxhQUFBLFFBQUEsT0FBQTs7UUFFQSxJQUFBLFlBQUEsU0FBQSxLQUFBLE9BQUEsU0FBQSxHQUFBLElBQUEsUUFBQTtRQUNBLElBQUEsT0FBQSxhQUFBLFdBQUE7UUFDQSxJQUFBLFFBQUEsYUFBQSxZQUFBLE9BQUE7UUFDQSxJQUFBLFFBQUEsYUFBQSxZQUFBLE9BQUE7O1FBRUEsT0FBQSxDQUFBLE1BQUEsT0FB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QSxXQUFBLFVBQUEsWUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsUUFBQSxJQUFBLE1BQUEsSUFBQSxLQUFBLElBQUEsTUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLElBQUEsU0FBQSxJQUFBLFVBQUEsS0FBQSxFQUFBLEVBQUEsTUFBQSxLQUFBLElBQUEsSUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsSUFBQSxRQUFBLEVBQUEsS0FBQSxFQUFBLFdBQUEsRUFBQSxVQUFBLFNBQUEsUUFBQSxRQUFBLEVBQUEsRUFBQSxHQUFBLFVBQUEsRUFBQSxHQUFBLFFBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxLQUFBLEVBQUEsR0FBQSxPQUFBLEVBQUEsS0FBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLEtBQUEsTUFBQSxhQUFBLE1BQUEsRUFBQSxDQUFBLEdBQUEsS0FBQSxZQUFBLEVBQUEsS0FBQSxTQUFBLEVBQUEsS0FBQSxPQUFBLEVBQUEsS0FBQSxRQUFBLEVBQUEsS0FBQSxXQUFBLEVBQUEsS0FBQSxVQUFBLEtBQUEsU0FBQSxHQUFBLENBQUEsSUFBQSxJQUFBLEVBQUEsRUFBQSxRQUFBLE9BQUEsS0FBQSxDQUFBLElBQUEsRUFBQSxFQUFBLFFBQUEsR0FBQSxHQUFBLENBQUEsRUFBQSxZQUFBLEVBQUEsSUFBQSxTQUFBLEdBQUEsQ0FBQSxFQUFBLFlBQUEsQ0FBQSxFQUFBLFlBQUEsRUFBQSxhQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxZQUFBLEVBQUEsS0FBQSxDQUFBLFFBQUEsU0FBQSxlQUFBLEVBQUEsT0FBQSxJQUFBLENBQUEsR0FBQSxFQUFBLElBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsQ0FBQSxRQUFBLFNBQUEsWUFBQSxFQUFBLE9BQUEsVUFBQSxTQUFBLEtBQUEsR0FBQSxHQUFBLG9CQUFBLElBQUEsRUFBQSxFQUFBLFlBQUEsRUFBQSxFQUFBLFNBQUEsRUFBQSxFQUFBLE9BQUEsRUFBQSxFQUFBLFdBQUEsRUFBQSxFQUFBLFFBQUEsRUFBQSxFQUFBLE9BQUEsYUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxpQkFBQSxRQUFBLFlBQUEsS0FBQSxFQUFBLGlCQUFBLEtBQUEsSUFBQSxJQUFBLEVBQUEsQ0FBQSxHQUFBLFlBQUEsT0FBQSxFQUFBLENBQUEsRUFBQSxFQUFBLGFBQUEsUUFBQSxFQUFBLElBQUEsSUFBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsR0FBQSxjQUFBLEVBQUEsRUFBQSxRQUFBLEVBQUEsSUFBQSxDQUFBLElBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsUUFBQSxFQUFBLFdBQUEsRUFBQSxFQUFBLFNBQUEsY0FBQSxHQUFBLENBQUEsSUFBQSxFQUFBLFVBQUEsS0FBQSxRQUFBLGVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsSUFBQSxHQUFBLEVBQUEsS0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsTUFBQSxHQUFBLEVBQUEsRUFBQSxNQUFBLEtBQUEsYUFBQSxVQUFBLE9BQUEsRUFBQSxVQUFBLEtBQUEsRUFBQSxFQUFBLEdBQUEsR0FBQSxVQUFBLEtBQUEsRUFBQSxFQUFBLElBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxPQUFBLEVBQUEsUUFBQSxLQUFBLEdBQUEsRUFBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLElBQUEsRUFBQSxhQUFBLEVBQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxVQUFBLE9BQUEsR0FBQSxRQUFBLFFBQUEsR0FBQSxDQUFBLElBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxLQUFBLEVBQUEsRUFBQSxFQUFBLEtBQUEsRUFBQSxPQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxRQUFBLEVBQUEsSUFBQSxPQUFBLEVBQUEsQ0FBQSxHQUFBLEVBQUEsUUFBQSxHQUFBLE1BQUEsT0FBQSxFQUFBLEVBQUEsUUFBQSxHQUFBLE1BQUEsT0FBQSxFQUFBLFFBQUEsR0FBQSxNQUFBLFFBQUEsR0FBQSxHQUFBLEVBQUEsUUFBQSxPQUFBLEVBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUEsSUFBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxRQUFBLE9BQUEsSUFBQSxHQUFBLEVBQUEsRUFBQSxRQUFBLEdBQUEsRUFBQSxNQUFBLFFBQUEsR0FBQSxDQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsQ0FBQSxFQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsT0FBQSxFQUFBLE9BQUEsSUFBQSxFQUFBLEVBQUEsS0FBQSxHQUFBLEVBQUEsSUFBQSxXQUFBLFVBQUEsQ0FBQSxJQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsS0FBQSxPQUFBLEtBQUEsRUFBQSxFQUFBLEVBQUEsS0FBQSxVQUFBLENBQUEsSUFBQSxTQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLFVBQUEsT0FBQSxFQUFBLEVBQUEsTUFBQSxLQUFBLFdBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxLQUFBLEtBQUEsR0FBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsT0FBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLEdBQUEsYUFBQSxNQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLFNBQUEsRUFBQSxDQUFBLEVBQUEsTUFBQSxNQUFBLElBQUEsRUFBQSxPQUFBLFVBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLFVBQUEsVUFBQSxhQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsRUFBQSxVQUFBLEtBQUEsUUFBQSxlQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsRUFBQSxpQkFBQSxRQUFBLEVBQUEsaUJBQUEsRUFBQSxVQUFBLE9BQUEsVUFBQSxDQUFBLEdBQUEsT0FBQSxLQUFBLFVBQUEsQ0FBQSxJQUFBLElBQUEsRUFBQSxLQUFBLE1BQUEsR0FBQSxFQUFBLEVBQUEsTUFBQSxRQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLEVBQUEsSUFBQSxLQUFBLFVBQUEsRUFBQSxPQUFBLEtBQUEsV0FBQSxJQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsUUFBQSxHQUFBLEVBQUEsWUFBQSxDQUFBLEVBQUEsRUFBQSxNQUFBLEtBQUEsY0FBQSxFQUFBLE9BQUEsS0FBQSxlQUFBLEVBQUEsT0FBQSxLQUFBLGVBQUEsRUFBQSxpQkFBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEdBQUEsS0FBQSxZQUFBLEVBQUEsSUFBQSxzQkFBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLElBQUEsR0FBQSxFQUFBLFNBQUEsUUFBQSxRQUFBLEVBQUEsUUFBQSxTQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLENBQUEsVUFBQSxPQUFBLEdBQUEsYUFBQSxVQUFBLEVBQUEsR0FBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsQ0FBQSxFQUFBLEVBQUEsTUFBQSxLQUFBLE9BQUEsS0FBQSxrQkFBQSxDQUFBLElBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxRQUFBLFFBQUEsS0FBQSxVQUFBLEVBQUEsS0FBQSxpQkFBQSxLQUFBLHNCQUFBLEdBQUEsQ0FBQSxJQUFBLEdBQUEsSUFBQSxFQUFBLG1CQUFBLEVBQUEsRUFBQSxNQUFBLFFBQUEsUUFBQSxHQUFBLE9BQUEsRUFBQSxHQUFBLElBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLFNBQUEsS0FBQSxTQUFBLGlCQUFBLEVBQUEsa0JBQUEsS0FBQSxrQkFBQSxpQkFBQSxLQUFBLGlCQUFBLHNCQUFBLEtBQUEsc0JBQUEsV0FBQSxLQUFBLFdBQUEsYUFBQSxFQUFBLGNBQUEsS0FBQSxlQUFBLE9BQUEsT0FBQSxVQUFBLFNBQUEsQ0FBQSxVQUFBLFNBQUEsRUFBQSxDQUFBLE1BQUEsQ0FBQSxTQUFBLElBQUEsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxRQUFBLEVBQUEsTUFBQSxFQUFBLFFBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLFVBQUEsT0FBQSxFQUFBLGNBQUEsRUFBQSxjQUFBLE1BQUEsVUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsWUFBQSxFQUFBLGtCQUFBLFNBQUEsRUFBQSxPQUFBLEVBQUEsYUFBQSxRQUFBLE1BQUEsRUFBQSxLQUFBLFdBQUEsVUFBQSxDQUFBLEVBQUEsSUFBQSxVQUFBLElBQUEsQ0FBQSxVQUFBLFNBQUEsRUFBQSxRQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxPQUFBLEVBQUEsaUJBQUEsS0FBQSxFQUFBLGlCQUFBLEVBQUEsRUFBQSxDQUFBLEdBQUEsS0FBQSxFQUFBLFlBQUEsS0FBQSxFQUFBLEdBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQSxHQUFBLFlBQUEsRUFBQSxLQUFBLENBQUEsSUFBQSxFQUFBLE9BQUEsYUFBQSxFQUFBLE9BQUEsT0FBQSxFQUFBLFdBQUEsRUFBQSxFQUFBLGVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxPQUFBLE9BQUEsYUFBQSxFQUFBLE9BQUEsY0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsT0FBQSxFQUFBLE9BQUEsS0FBQSxPQUFBLEVBQUEsT0FBQSxLQUFBLEtBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsR0FBQSxPQUFBLEVBQUEsVUFBQSxFQUFBLEtBQUEsU0FBQSxFQUFBLFFBQUEsRUFBQSxLQUFBLE9BQUEsRUFBQSxTQUFBLEVBQUEsS0FBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLEtBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsT0FBQSxFQUFBLGVBQUEsS0FBQSxFQUFBLGlCQUFBLEtBQUEsRUFBQSxZQUFBLENBQUEsR0FBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLE9BQUEsRUFBQSxnQkFBQSxLQUFBLEVBQUEsa0JBQUEsS0FBQSxFQUFBLGFBQUEsQ0FBQSxHQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsTUFBQSxTQUFBLEdBQUEsUUFBQSxHQUFBLE9BQUEsR0FBQSxRQUFBLEVBQUEsU0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsSUFBQSxJQUFBLEtBQUEsRUFBQSxFQUFBLElBQUEsSUFBQSxHQUFBLEVBQUEsZUFBQSxLQUFBLEVBQUEsRUFBQSxJQUFBLEdBQUEsT0FBQSxFQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLE9BQUEsSUFBQSxFQUFBLElBQUEsR0FBQSxVQUFBLFlBQUEsWUFBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLFdBQUEsRUFBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLE1BQUEsTUFBQSxFQUFBLENBQUEsTUFBQSxFQUFBLEVBQUEsUUFBQSxTQUFBLFNBQUEsRUFBQSxNQUFBLE1BQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsRUFBQSxFQUFBLElBQUEsR0FBQSxZQUFBLEdBQUEsRUFBQSxLQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsS0FBQSxVQUFBLEVBQUEsSUFBQSxFQUFBLEtBQUEsR0FBQSxPQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxDQUFBLElBQUEsRUFBQSxVQUFBLEVBQUEsT0FBQSxHQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxPQUFBLElBQUEsRUFBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsV0FBQSxHQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsR0FBQSxJQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUEsSUFBQSxLQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEdBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxLQUFBLEdBQUEsQ0FBQSxFQUFBLFdBQUEsR0FBQSxNQUFBLEdBQUEsSUFBQSxTQUFBLEdBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsV0FBQSxHQUFBLE9BQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLFdBQUEsR0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsS0FBQSxFQUFBLEVBQUEsTUFBQSxFQUFBLFFBQUEsR0FBQSxFQUFBLFNBQUEsWUFBQSxHQUFBLENBQUEsRUFBQSxTQUFBLENBQUEsRUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLFlBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQSxDQUFBLEdBQUEsSUFBQSxFQUFBLFdBQUEsR0FBQSxPQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsR0FBQSxPQUFBLEVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLGFBQUEsRUFBQSxFQUFBLFFBQUEsRUFBQSxXQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsS0FBQSxDQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLFVBQUEsT0FBQSxFQUFBLFFBQUEsRUFBQSxNQUFBLEVBQUEsU0FBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLEdBQUEsRUFBQSxNQUFBLFNBQUEsRUFBQSxNQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxHQUFBLEtBQUEsRUFBQSxVQUFBLEVBQUEsRUFBQSxHQUFBLEdBQUEsU0FBQSxHQUFBLENBQUEsYUFBQSxHQUFBLEVBQUEsV0FBQSxFQUFBLEtBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLE9BQUEsVUFBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxLQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxVQUFBLElBQUEsRUFBQSxFQUFBLElBQUEsV0FBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsSUFBQSxRQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLElBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUEsV0FBQSxFQUFBLElBQUEsR0FBQSxFQUFBLEVBQUEsRUFBQSxRQUFBLE9BQUEsS0FBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLE1BQUEsS0FBQSxPQUFBLEVBQUEsT0FBQSxFQUFBLEtBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxXQUFBLEVBQUEsS0FBQSxFQUFBLFdBQUEsRUFBQSxNQUFBLEdBQUEsRUFBQSxFQUFBLElBQUEsRUFBQSxVQUFBLENBQUEsS0FBQSxFQUFBLFFBQUEsRUFBQSxFQUFBLEdBQUEsS0FBQSxFQUFBLFdBQUEsRUFBQSxLQUFBLEVBQUEsVUFBQSxRQUFBLENBQUEsU0FBQSxFQUFBLFVBQUEsRUFBQSxVQUFBLE9BQUEsRUFBQSxPQUFBLElBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxLQUFBLElBQUEsRUFBQSxLQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxhQUFBLEdBQUEsT0FBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLE9BQUEsRUFBQSxFQUFBLFdBQUEsR0FBQSxFQUFBLFdBQUEsR0FBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsV0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsTUFBQSxFQUFBLEtBQUEsSUFBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxFQUFBLEdBQUEsT0FBQSxFQUFBLFNBQUEsRUFBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsS0FBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLFNBQUEsRUFBQSxFQUFBLEdBQUEsTUFBQSxFQUFBLEdBQUEsVUFBQSxHQUFBLEVBQUEsRUFBQSxHQUFBLFNBQUEsRUFBQSxFQUFBLEdBQUEsT0FBQSxJQUFBLEVBQUEsWUFBQSxFQUFBLE1BQUEsRUFBQSxFQUFBLE1BQUEsR0FBQSxFQUFBLElBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLFdBQUEsRUFBQSxNQUFBLEVBQUEsY0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsRUFBQSxXQUFBLEdBQUEsRUFBQSxFQUFBLFVBQUEsR0FBQSxFQUFBLEVBQUEsUUFBQSxHQUFBLElBQUEsSUFBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLFlBQUEsRUFBQSxNQUFBLEdBQUEsUUFBQSxHQUFBLFFBQUEsR0FBQSxPQUFBLEdBQUEsTUFBQSxHQUFBLFdBQUEsR0FBQSxNQUFBLEdBQUEsUUFBQSxHQUFBLFNBQUEsR0FBQSxXQUFBLEdBQUEsTUFBQSxHQUFBLE9BQUEsR0FBQSxPQUFBLEdBQUEsS0FBQSxHQUFBLFFBQUEsR0FBQSxPQUFBLEdBQUEsTUFBQSxHQUFBLE1BQUEsR0FBQSxPQUFBLEdBQUEsT0FBQSxJQUFBLFFBQUEsRUFBQSxDQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLEtBQUEsSUFBQSxJQUFBLElBQUEsS0FBQSxFQUFBLENBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLEVBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxFQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxJQUFBLElBQUEsSUFBQSxNQUFBLEVBQUEsQ0FBQSxPQUFBLE1BQUEsUUFBQSxPQUFBLFNBQUEsUUFBQSxPQUFBLE1BQUEsS0FBQSxJQUFBLElBQUEsdUJBQUEsS0FBQSxVQUFBLFVBQUEsT0FBQSxRQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsSUFBQSxHQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsRUFBQSxVQUFBLEtBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLE9BQUEsRUFBQSxhQUFBLE1BQUEsRUFBQSxDQUFBLEdBQUEsRUFBQSxjQUFBLEtBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxHQUFBLEVBQUEsVUFBQSxPQUFBLFNBQUEsRUFBQSxFQUFBLENBQUEsSUFBQSxFQUFBLEtBQUEsT0FBQSxFQUFBLEtBQUEsS0FBQSxFQUFBLEVBQUEsVUFBQSxHQUFBLElBQUEsRUFBQSxVQUFBLFFBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQSxJQUFBLEVBQUEsS0FBQSxPQUFBLEVBQUEsV0FBQSxFQUFBLElBQUEsSUFBQSxFQUFBLFdBQUEsRUFBQSxJQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsRUFBQSxVQUFBLE1BQUEsVUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLE9BQUEsRUFBQSxXQUFBLEdBQUEsRUFBQSxXQUFBLEdBQUEsR0FBQSxFQUFBLFVBQUEsYUFBQSxTQUFBLEVBQUEsRUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLE1BQUEsQ0FBQSxJQUFBLEVBQUEsVUFBQSxLQUFBLFFBQUEsZUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLFFBQUEsQ0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLFVBQUEsRUFBQSxTQUFBLFlBQUEsRUFBQSxTQUFBLEVBQUEsbUJBQUEsRUFBQSxVQUFBLFVBQUEsVUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLE9BQUEsRUFBQSxXQUFBLE1BQUEsRUFBQSxZQUFBLEVBQUEsS0FBQSxVQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsR0FBQSxJQUFBLElBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxPQUFBLEtBQUEsRUFBQSxHQUFBLFNBQUEsRUFBQSxDQUFBLE9BQUEsVUFBQSxDQUFBLE9BQUEsRUFBQSxHQUFBLE1BQUEsRUFBQSxhQUFBLEtBQUEsRUFBQSxPQUFBLEVBQUEsVUFBQSxFQUFBLGFBQUEsT0FBQSxRQUFBLE9BQUEsVUFBQSxPQUFBLFFBQUEsR0FBQSxZQUFBLE9BQUEsUUFBQSxPQUFBLEtBQUEsT0FBQSxVQUFBLENBQUEsT0FBQSxLQUFBLE9BQUE7QUNOQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQSxvQkFBQSxVQUFBLFVBQUE7UUFDQSxTQUFBLFVBQUEsZ0JBQUEsUUFBQSxLQUFBLElBQUE7UUFDQSxzREFBQSxVQUFBLGNBQUEsYUFBQSxnQkFBQTs7UUFFQSxJQUFBLFVBQUEsVUFBQSxLQUFBO1lBQ0EsSUFBQSxVQUFBLElBQUE7WUFDQSxRQUFBLEtBQUEsT0FBQSxLQUFBO1lBQ0EsUUFBQSxLQUFBO1lBQ0EsT0FBQSxDQUFBLFFBQUEsUUFBQSxRQUFBLFVBQUE7Ozs7UUFJQSxJQUFBLHFCQUFBLElBQUEsT0FBQSxNQUFBLFlBQUEsS0FBQSxZQUFBLG1CQUFBO1FBQ0EsYUFBQSxRQUFBLG9CQUFBLFFBQUEsWUFBQTtZQUNBLElBQUEsVUFBQSxLQUFBLE1BQUEsUUFBQSxnQ0FBQTtnQkFDQSxZQUFBLE9BQUEsTUFBQSxTQUFBLEdBQUEsS0FBQSxRQUFBLEtBQUE7Z0JBQ0EsVUFBQSxPQUFBLE1BQUEsSUFBQSxHQUFBLEtBQUEsUUFBQSxLQUFBO2dCQUNBLFdBQUEsT0FBQSxJQUFBLFNBQUEsS0FBQSxPQUFBLElBQUEsWUFBQTtnQkFDQSxXQUFBO2dCQUNBLFNBQUE7Z0JBQ0EsVUFBQTs7WUFFQSxFQUFBLFFBQUEsUUFBQSxTQUFBLFVBQUEsUUFBQTtnQkFDQSxTQUFBOztnQkFFQSxLQUFBLElBQUEsSUFBQSxHQUFBLElBQUEsVUFBQSxLQUFBO29CQUNBLFdBQUEsT0FBQSxJQUFBLFdBQUEsSUFBQSxHQUFBLEtBQUE7b0JBQ0EsT0FBQSxLQUFBO3dCQUNBLE1BQUE7d0JBQ0EsT0FBQSxLQUFBLE1BQUEsS0FBQSxZQUFBLE1BQUEsSUFBQSxNQUFBO3dCQUNBLE1BQUEsS0FBQSxNQUFB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QSxJQUFBLGtCQUFBLElBQUEsT0FBQSxNQUFBLFlBQUEsS0FBQSxZQUFBLGlCQUFBO1FBQ0EsYUFBQSxRQUFBLGlCQUFBLFFBQUEsWUFBQTtZQUNBLE9BQUEsUUFBQTs7OztRQUlBLElBQUEsa0JBQUE7UUFDQSxJQUFBLFlBQUEsSUFBQSxPQUFBLE1BQUEsWUFBQSxLQUFBLFlBQUEsYUFBQTtRQUNBLGFBQUEsUUFBQSxXQUFBLFFBQUEsWUFBQTtZQUNBLE9BQUEsUUFBQTs7OztRQUlBLElBQUEsbUJBQUE7UUFDQSxJQUFBLGFBQUEsSUFBQSxPQUFBLE1BQUEsWUFBQSxLQUFBLFlBQUEsVUFBQTtRQUNBLGFBQUEsUUFBQSxZQUFBLFFBQUEsWUFBQTtZQUNBLE9BQUEsUUFBQTs7OztRQUlBLElBQUEseUJBQUE7UUFDQSxJQUFBLG1CQUFBLElBQUEsT0FBQSxNQUFBLFlBQUEsS0FBQSxZQUFBLGlCQUFBO1FBQ0EsYUFBQSxRQUFBLGtCQUFBLFFBQUEsWUFBQTtZQUNBLE9BQUEsUUFBQTs7OztRQUlBLElBQUEsMkJBQUE7UUFDQSxJQUFBLHFCQUFBLElBQUEsT0FBQSxNQUFBLFlBQUEsS0FBQSxZQUFBLGVBQUE7UUFDQSxhQUFBLFFBQUEsb0JBQUEsUUFBQSxVQUFBLFFBQUEsS0FBQTs7WUFFQSxNQUFBLElBQUE7WUFDQSxJQUFBLEtBQUEsSUFBQSxVQUFBLElBQUEsVUFBQSxFQUFBLElBQUEsWUFBQSxNQUFBLFlBQUEsS0FBQSxFQUFBLElBQUEsT0FBQTtZQUNBLDJCQUFBLDBDQUFBLEtBQUE7WUFDQSxPQUFBLFFBQUE7Ozs7UUFJQSxJQUFBLHFCQUFBO1FBQ0EsSUFBQSxlQUFBLElBQUEsT0FBQSxNQUFBLFlBQUEsS0FBQSxZQUFBLFlBQUE7UUFDQSxhQUFBLFFBQUEsY0FBQSxRQUFBLFlBQUE7WUFDQSxPQUFBLFFBQUE7Ozs7UUFJQSxJQUFBLGtDQUFBO1FBQ0EsSUFBQSw0QkFBQSxJQUFBLE9BQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSw0QkFBQTtRQUNBLGFBQUEsU0FBQSwyQkFBQSxRQUFBLFlBQUE7WUFDQSxPQUFBLFFBQUE7Ozs7UUFJQSxJQUFBLCtCQUFBO1FBQ0EsSUFBQSx5QkFBQSxJQUFBLE9BQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSxvQkFBQTtRQUNBLGFBQUEsUUFBQSx3QkFBQSxRQUFBLFVBQUEsUUFBQSxLQUFBOztZQUVBLE1BQUEsSUFBQTtZQUNBLElBQUEsS0FBQSxJQUFBLFVBQUEsSUFBQSxVQUFBLEVBQUEsSUFBQSxZQUFBLE1BQUEsWUFBQSxLQUFBLEVBQUEsSUFBQSxPQUFBO1lBQ0EsK0JBQUEsc0NBQUEsS0FBQTtZQUNBLElBQUEsY0FBQSxRQUFBO1lBQ0EsSUFBQSxZQUFBLE9BQUEsS0FBQTtnQkFDQSxjQUFBLGFBQUEsUUFBQSxlQUFBO2dCQUNBLE9BQUEsQ0FBQSxLQUFBLEtBQUEsTUFBQSxjQUFBO21CQUNBO2dCQUNBLE9BQUE7Ozs7O1FBS0EsSUFBQSx5QkFBQTtRQUNBLElBQUEsbUJBQUEsSUFBQSxPQUFBLE1BQUEsWUFBQSxLQUFBLFlBQUEsaUJBQUE7UUFDQSxhQUFBLFFBQUEsa0JBQUEsUUFBQSxZQUFBO1lBQ0EsT0FBQSxRQUFBOzs7O1FBSUEsSUFBQSxzQkFBQSxJQUFBLE9BQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSxpQkFBQTtRQUNBLGFBQUEsU0FBQSxxQkFBQSxRQUFBLFVBQUEsUUFBQSxLQUFBLE1BQUE7WUFDQSxJQUFBLGlCQUFBO2dCQUNBLHdCQUFBO2dCQUNBLGNBQUEsUUFBQTtnQkFDQSxXQUFBLEtBQUEsTUFBQSxZQUFBLElBQUE7Z0JBQ0EsYUFBQSxLQUFBLE1BQUE7Z0JBQ0EsdUJBQUEsRUFBQSxLQUFBLFdBQUEsV0FBQSxNQUFBO1lBQ0EsRUFBQSxRQUFBLHNCQUFBLFVBQUEsS0FBQTtnQkFDQSxlQUFBLEtBQUEsRUFBQSxLQUFBLFVBQUEsVUFBQSxTQUFBO29CQUNBLE9BQUEsUUFBQSxTQUFBLElBQUEsU0FBQSxRQUFBLFFBQUEsWUFBQSxJQUFBLFNBQUE7OztZQUdBLEVBQUEsUUFBQSxnQkFBQSxVQUFBLFNBQUE7Z0JBQ0EsSUFBQSxLQUFBLFFBQUEsZ0NBQUEsUUFBQSxLQUFBO2dCQUNBLHNCQUFBLEtBQUEsS0FBQSxNQUFBLEdBQUE7O1lBRUEsSUFBQSxlQUFBO2dCQUNBLElBQUEsS0FBQSxNQUFBLEtBQUEsWUFBQSxRQUFBLElBQUEsTUFBQTtnQkFDQSxNQUFBLFdBQUE7Z0JBQ0EsU0FBQSxXQUFBO2dCQUNBLE9BQUEsV0FBQTtnQkFDQSxhQUFBLFdBQUE7Z0JBQ0EsV0FBQTtnQkFDQSxZQUFBLFdBQUE7Z0JBQ0EsY0FBQTtnQkFDQSxTQUFBLElBQUEsT0FBQTtnQkFDQSxlQUFBLElBQUEsT0FBQTtnQkFDQSxVQUFBO2dCQUNBLGNBQUEsV0FBQTtnQkFDQSxXQUFBOztZQUVBLE9BQUEsQ0FBQSxLQUFBLEtBQUEsVUFBQSxlQUFBOzs7O1FBSUEsSUFBQSxvQkFBQTtRQUNBLElBQUEsY0FBQSxJQUFBLE9BQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSxXQUFBO1FBQ0EsYUFBQSxRQUFBLGFBQUEsUUFBQSxZQUFBO1lBQ0EsT0FBQSxRQUFBOzs7O1FBSUEsSUFBQSxxQkFBQTtRQUNBLElBQUEsZUFBQSxJQUFBLE9BQUEsTUFBQSxZQUFBLEtBQUEsWUFBQSxlQUFBO1FBQ0EsYUFBQSxRQUFBLGNBQUEsUUFBQSxZQUFBO1lBQ0EsT0FBQSxRQUFBOzs7O1FBSUEsSUFBQSx3QkFBQTtRQUNBLElBQUEsa0JBQUEsSUFBQSxPQUFBLE1BQUEsWUFBQSxLQUFBLFlBQUEsZUFBQTtRQUNBLGFBQUEsUUFBQSxpQkFBQSxRQUFBLFlBQUE7WUFDQSxPQUFBLFFBQUE7Ozs7Ozs7O1FBUUEsYUFBQSxRQUFBLFVBQUE7UUFDQSxhQUFBLFNBQUEsVUFBQTs7O0FBR0EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJywgW1xuICAgICAgICAnc2NhbGVDb25maWdNb2R1bGUnLFxuICAgICAgICAnbmdSZXNvdXJjZScsXG4gICAgICAgICduZ1Nhbml0aXplJyxcbiAgICAgICAgJ25nUm91dGUnLFxuICAgICAgICAnZW1ndW8ucG9sbGVyJyxcbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICd1aS5ncmlkJyxcbiAgICAgICAgJ3VpLmdyaWQuc2VsZWN0aW9uJyxcbiAgICAgICAgJ3VpLmdyaWQucGFnaW5hdGlvbicsXG4gICAgICAgICd1aS5ncmlkLnJlc2l6ZUNvbHVtbnMnLFxuICAgICAgICAnY2ZwLmhvdGtleXMnXG4gICAgXSk7XG5cbiAgICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkcmVzb3VyY2VQcm92aWRlciwgcG9sbGVyQ29uZmlnKSB7XG4gICAgICAgIC8vIHN0b3AgcG9sbGVycyB3aGVuIHJvdXRlIGNoYW5nZXNcbiAgICAgICAgcG9sbGVyQ29uZmlnLnN0b3BPblJvdXRlQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgcG9sbGVyQ29uZmlnLnNtYXJ0ID0gdHJ1ZTtcblxuICAgICAgICAvLyBwcmVzZXJ2ZSB0cmFpbGluZyBzbGFzaGVzXG4gICAgICAgICRyZXNvdXJjZVByb3ZpZGVyLmRlZmF1bHRzLnN0cmlwVHJhaWxpbmdTbGFzaGVzID0gZmFsc2U7XG5cbiAgICAgICAgLy9yb3V0aW5nXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnb3ZDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvb3ZlcnZpZXcvcGFydGlhbHMvb3ZUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvYWRtaW4vbG9naW4nLHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5Mb2dpbkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9hZG1pbi9wYXJ0aWFscy9hZG1pbkxvZ2luVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL2FkbWluL2xvZ291dCcse1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dvdXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvYWRtaW4vcGFydGlhbHMvYWRtaW5Mb2dpblRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9hYm91dCcsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnYWJvdXRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvYWJvdXQvcGFydGlhbHMvYWJvdXRUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvZmVlZCcsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnZmVlZERldGFpbHNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvZmVlZC9wYXJ0aWFscy9mZWVkRGV0YWlsc1RlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvZmVlZC9pbmdlc3RzJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdpbmdlc3RSZWNvcmRzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2ZlZWQvcGFydGlhbHMvaW5nZXN0UmVjb3Jkc1RlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvbWV0cmljcycsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWV0cmljc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9tZXRyaWNzL3BhcnRpYWxzL21ldHJpY3NUZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2VcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL25vZGVzJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdub2Rlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9ub2Rlcy9wYXJ0aWFscy9ub2Rlc1RlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9ub2Rlcy86aWQnLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ25vZGVEZXRhaWxzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL25vZGVzL3BhcnRpYWxzL25vZGVEZXRhaWxzVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL2xvYWQnLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvYWRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvbG9hZC9wYXJ0aWFscy9sb2FkVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL2xvYWQvcnVubmluZycsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncXVldWVSdW5uaW5nQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2xvYWQvcGFydGlhbHMvcXVldWVSdW5uaW5nVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL2xvYWQvZGVwdGgnLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvYWREZXB0aENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9sb2FkL3BhcnRpYWxzL2xvYWREZXB0aFRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9yZWNpcGVzJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdyZWNpcGVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3JlY2lwZXMvcGFydGlhbHMvcmVjaXBlc1RlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvcmVjaXBlcy9yZWNpcGUvOmlkJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdyZWNpcGVEZXRhaWxzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3JlY2lwZXMvcGFydGlhbHMvcmVjaXBlRGV0YWlsc1RlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9yZWNpcGVzL3R5cGVzLzppZD8nLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3JlY2lwZVR5cGVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3JlY2lwZXMvcGFydGlhbHMvcmVjaXBlVHlwZXNUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvcmVjaXBlcy9idWlsZGVyJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdyZWNpcGVFZGl0b3JDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvcmVjaXBlcy9wYXJ0aWFscy9yZWNpcGVFZGl0b3JUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvcmVjaXBlcy9idWlsZGVyLzppZCcsIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncmVjaXBlRWRpdG9yQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3JlY2lwZXMvcGFydGlhbHMvcmVjaXBlRWRpdG9yVGVtcGxhdGUuaHRtbCdcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL2pvYnMnLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2pvYnNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvam9icy9wYXJ0aWFscy9qb2JzVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9qb2JzL2pvYi86aWQnLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2pvYkRldGFpbENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9qb2JzL3BhcnRpYWxzL2pvYkRldGFpbFRlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9qb2JzL3R5cGVzLzppZD8nLCB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2pvYlR5cGVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2pvYnMvcGFydGlhbHMvam9iVHlwZXNUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvam9icy9mYWlsdXJlLXJhdGVzJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdqb2JUeXBlc0ZhaWx1cmVSYXRlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvam9icy9wYXJ0aWFscy9qb2JUeXBlc0ZhaWx1cmVSYXRlc1RlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvam9icy9leGVjdXRpb25zJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdqb2JFeGVjdXRpb25zQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2pvYnMvcGFydGlhbHMvam9iRXhlY3V0aW9uc1RlbXBsYXRlLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oJy9qb2JzL2V4ZWN1dGlvbnMvOmlkJywge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdqb2JFeGVjdXRpb25EZXRhaWxDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvam9icy9wYXJ0aWFscy9qb2JFeGVjdXRpb25EZXRhaWxUZW1wbGF0ZS5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICAgICAgfSk7XG4gICAgfSlcbiAgICAudmFsdWUoJ21vbWVudCcsIHdpbmRvdy5tb21lbnQpXG4gICAgLnZhbHVlKCdsb2NhbFN0b3JhZ2UnLCB3aW5kb3cubG9jYWxTdG9yYWdlKVxuICAgIC52YWx1ZSgnWE1MSHR0cFJlcXVlc3QnLCB3aW5kb3cuWE1MSHR0cFJlcXVlc3QpXG4gICAgLnZhbHVlKCd0b2FzdHInLCB3aW5kb3cudG9hc3RyKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUNvbmZpZ01vZHVsZScsIFtdKS5wcm92aWRlcignc2NhbGVDb25maWcnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY2FsZUNvbmZpZyA9IHt9LFxuICAgICAgICAgICAgc2NhbGVDb25maWdMb2NhbCA9IHt9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogJ2NvbmZpZy9zY2FsZUNvbmZpZy5qc29uJyxcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChjb25maWcuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICBzY2FsZUNvbmZpZyA9IGNvbmZpZy5yZXNwb25zZUpTT04uc2NhbGVDb25maWc7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnTG9jYWwgPSAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnY29uZmlnL3NjYWxlQ29uZmlnLmxvY2FsLmpzb24nLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZ0xvY2FsLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlQ29uZmlnTG9jYWwgPSBjb25maWdMb2NhbC5yZXNwb25zZUpTT04uc2NhbGVDb25maWdMb2NhbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfLm1lcmdlKHNjYWxlQ29uZmlnLCBzY2FsZUNvbmZpZ0xvY2FsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHNjYWxlQ29uZmlnO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdhaXNIZWFkZXJDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgc3VibmF2U2VydmljZSkge1xuICAgICAgICAkc2NvcGUuZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICRzY29wZS5jdXJyZW50UGF0aCA9IHN1Ym5hdlNlcnZpY2UuZ2V0Q3VycmVudFBhdGgoKTtcbiAgICB9KVxuICAgIC5kaXJlY3RpdmUoJ2Fpc0hlYWRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzYWdlOiA8YWlzLWhlYWRlciBuYW1lPXtuYW1lfT48L2Fpcy1oZWFkZXI+XG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fpc0hlYWRlckNvbnRyb2xsZXInLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9oZWFkZXIvaGVhZGVyVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG5hbWU6ICc9JyxcbiAgICAgICAgICAgICAgICBoaWRlVGl0bGU6ICc9JyxcbiAgICAgICAgICAgICAgICBsb2FkaW5nOiAnPScsIC8vIG9wdGlvbmFsIC0gd2lsbCBvdmVybGF5IGEgbG9hZGluZyBzcGlubmVyIG9uIHRoZSBwYWdlIGJhc2VkIG9uIHRoZSBwYXNzZWQtaW4gdmFsdWVcbiAgICAgICAgICAgICAgICBzaG93U3VibmF2OiAnPScsXG4gICAgICAgICAgICAgICAgc3VibmF2TGlua3M6ICc9J1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5kaXJlY3RpdmUoJ3NjYWxlTmF2aWdhdGlvbicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvbmF2aWdhdGlvbi9wYXJ0aWFscy9uYXZUZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICduYXZDb250cm9sbGVyJ1xuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignYWJvdXRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICR3aW5kb3csIG5hdlNlcnZpY2UsIHN0YXRlU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuc3RhdGVTZXJ2aWNlID0gc3RhdGVTZXJ2aWNlO1xuICAgICAgICAkc2NvcGUudmVyc2lvbiA9ICcnO1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdhYm91dCcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGluaXRpYWxpemUoKTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdzdGF0ZVNlcnZpY2UuZ2V0VmVyc2lvbigpJywgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAkc2NvcGUudmVyc2lvbiA9IG5ld1ZhbHVlO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2Fpc0RhdGFGZWVkQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsIHNjYWxlQ29uZmlnLCBsb2FkU2VydmljZSwgc2NhbGVTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS5kYXlzID0gW107XG4gICAgICAgICRzY29wZS5ob3VycyA9IFswLDEsMiwzLDQsNSw2LDcsOCw5LDEwLDExLDEyLDEzLDE0LDE1LDE2LDE3LDE4LDE5LDIwLDIxLDIyLDIzXTtcbiAgICAgICAgJHNjb3BlLnZhbHVlcyA9IHt9O1xuICAgICAgICB2YXIgcHJvY2Vzc05ld0ZlZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIGN1cnJlbnREYXkgPSBtb21lbnQudXRjKCk7XG4gICAgICAgICAgICAkc2NvcGUuZGF5cyA9IFtdO1xuICAgICAgICAgICAgdmFyIGRheSA9ICcnO1xuICAgICAgICAgICAgaWYoJHNjb3BlLmZlZWQpe1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUuZmVlZC52YWx1ZXMsIGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWxkYXkgPSBtb21lbnQudXRjKHZhbC50aW1lKS5mb3JtYXQoc2NhbGVDb25maWcuZGF0ZUZvcm1hdHMuZGF5KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGhvdXIgPSBtb21lbnQudXRjKHZhbC50aW1lKS5ob3VyKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IHZhbGRheSArICdfJyArIHZhbGhvdXI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS52YWx1ZXNbaWRdID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICBpZih2YWxkYXkgIT09IGRheSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXkgPSB2YWxkYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF5cy5wdXNoKHZhbGRheSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBidWlsZFRhYmxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGJ1aWxkVGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VyckRheSA9IG1vbWVudCgpLnV0YygpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXkpO1xuICAgICAgICAgICAgdmFyIGN1cnJIb3VyID0gbW9tZW50KCkudXRjKCkuaG91cigpO1xuXG4gICAgICAgICAgICB2YXIgdGFibGVfaHRtbCA9ICc8ZGl2IGNsYXNzPVwidGFibGUtcmVzcG9uc2l2ZVwiPjx0YWJsZT4nO1xuICAgICAgICAgICAgdGFibGVfaHRtbCArPSAnPHRyPjx0aD5Ib3VyIChVVEMpPC90aD4nO1xuICAgICAgICAgICAgZm9yKGRheSBpbiAkc2NvcGUuZGF5cyl7XG4gICAgICAgICAgICAgICAgdGFibGVfaHRtbCArPSAnPHRkIGNsYXNzPVwiZGF5LWxhYmVsXCIgdGl0bGU9XCInICsgJHNjb3BlLmRheXNbZGF5XSArICdcIj48ZGl2IGNsYXNzPVwiZGF5LW9mLXdlZWtcIj4nICsgc2NhbGVTZXJ2aWNlLmdldERheVN0cmluZyhtb21lbnQoJHNjb3BlLmRheXNbZGF5XSkuZGF5KCkpICsgJzwvZGl2PicgKyBtb21lbnQoJHNjb3BlLmRheXNbZGF5XSkuZm9ybWF0KCdNTS9ERCcpICsgJzwvdGQ+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzwvdHI+JztcbiAgICAgICAgICAgIGZvcih2YXIgaG91ciBpbiAkc2NvcGUuaG91cnMpe1xuICAgICAgICAgICAgICAgIGhvdXIgPSAyMy1ob3VyO1xuICAgICAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzx0cj4nO1xuICAgICAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzx0aCB0aXRsZT1cIicgKyAkc2NvcGUuaG91cnNbaG91cl0gKyAnOjAwXCI+JyArICRzY29wZS5ob3Vyc1tob3VyXSArICc8L3RoPic7XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIGRheSBpbiAkc2NvcGUuZGF5cyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSAgJHNjb3BlLmRheXNbZGF5XSArICdfJyArICRzY29wZS5ob3Vyc1tob3VyXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVzID0gJHNjb3BlLnZhbHVlc1trZXldLmZpbGVzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9ICRzY29wZS52YWx1ZXNba2V5XS5zaXplO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xzID0gJ2dvb2QnO1xuICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuZGF5c1tkYXldID09PSBjdXJyRGF5KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5ob3Vyc1tob3VyXSA9PT0gY3VyckhvdXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNscyA9ICdjdXJyZW50JztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoJHNjb3BlLmhvdXJzW2hvdXJdID4gY3VyckhvdXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHMgPSAnZnV0dXJlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihmaWxlcyA9PT0gMCAmJiBzaXplID09PSAwICYmIGNscyAhPT0gJ2N1cnJlbnQnICYmIGNscyAhPT0gJ2Z1dHVyZScpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xzID0gJ3Vua25vd24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgdGFibGVfaHRtbCArPSAnPHRkIGlkPVwiJyArIGtleSArICdcIiB0aXRsZT1cIicgKyAkc2NvcGUuZGF5c1tkYXldICsgJyAnICsgJHNjb3BlLmhvdXJzW2hvdXJdICsgJzowMFwiPic7XG4gICAgICAgICAgICAgICAgICAgIGlmKGNscyA9PT0gJ2Z1dHVyZScpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy90YWJsZV9odG1sICs9ICc8c3BhbiBjbGFzcz1cIicgKyBjbHMgKyAnXCIgaWQ9XCJzcGFuXycgKyAkc2NvcGUuZGF5c1tkYXldICsgJ18nICsgJHNjb3BlLmhvdXJzW2hvdXJdICsgJ1wiIHN0eWxlPVwiZGlzcGxheTogYmxvY2s7XCI+PGRpdiBjbGFzcz1cImZpbGUtY291bnRcIj4mbmJzcDs8L2Rpdj48ZGl2IGNsYXNzPVwiZmlsZS1zaXplXCI+Jm5ic3A7PC9kaXY+PC9zcGFuPjwvdGQ+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzxzcGFuIGNsYXNzPVwiJyArIGNscyArICdcIiBpZD1cInNwYW5fJyArICRzY29wZS5kYXlzW2RheV0gKyAnXycgKyAkc2NvcGUuaG91cnNbaG91cl0gKyAnXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcIj4mbmJzcDs8L3NwYW4+PC90ZD4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RhYmxlX2h0bWwgKz0gJzxzcGFuIGNsYXNzPVwiJyArIGNscyArICdcIiBpZD1cInNwYW5fJyArICRzY29wZS5kYXlzW2RheV0gKyAnXycgKyAkc2NvcGUuaG91cnNbaG91cl0gKyAnXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcIj48ZGl2IGNsYXNzPVwiZmlsZS1jb3VudFwiPicgKyBmaWxlcyArICc8L2Rpdj48ZGl2IGNsYXNzPVwiZmlsZS1zaXplXCI+JyArIHNjYWxlU2VydmljZS5jYWxjdWxhdGVGaWxlU2l6ZUZyb21CeXRlcyhzaXplLDEpICsgJzwvZGl2Pjwvc3Bhbj48L3RkPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RhYmxlX2h0bWwgKz0gJzxzcGFuIGNsYXNzPVwiJyArIGNscyArICdcIiBpZD1cInNwYW5fJyArICRzY29wZS5kYXlzW2RheV0gKyAnXycgKyAkc2NvcGUuaG91cnNbaG91cl0gKyAnXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcIj48c3BhbiBjbGFzcz1cImZpbGUtY291bnRcIj4nICsgZmlsZXMgKyAnPC9zcGFuPiAvIDxzcGFuIGNsYXNzPVwiZmlsZS1zaXplXCI+JyArIHNjYWxlU2VydmljZS5jYWxjdWxhdGVGaWxlU2l6ZUZyb21CeXRlcyhzaXplLDEpICsgJzwvc3Bhbj48L3NwYW4+PC90ZD4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfaHRtbCArPSAnPHNwYW4gY2xhc3M9XCInICsgY2xzICsgJ1wiIGlkPVwic3Bhbl8nICsgJHNjb3BlLmRheXNbZGF5XSArICdfJyArICRzY29wZS5ob3Vyc1tob3VyXSArICdcIiBzdHlsZT1cImRpc3BsYXk6IGJsb2NrO1wiPicgKyBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tQnl0ZXMoc2l6ZSwxKSArICcgLyAnICsgZmlsZXMgKyAnPC9zcGFuPjwvdGQ+JztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzwvdHI+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhYmxlX2h0bWwgKz0gJzwvdGFibGU+PC9kaXY+JztcbiAgICAgICAgICAgICQoJyNoaXN0b3J5JykuaHRtbCh0YWJsZV9odG1sKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2ZlZWQnLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZigkc2NvcGUuZmVlZCl7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NOZXdGZWVkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgIH0pLmRpcmVjdGl2ZSgnYWlzRGF0YUZlZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWlzRGF0YUZlZWRDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9jaGFydHMvZGF0YUZlZWQvZGF0YUZlZWRUZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGZlZWQ6ICc9JyAvLyBGZWVkIGRhdGFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignYWlzRG9udXRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgc2NhbGVDb25maWcpIHtcbiAgICAgICAgdmFyIGNoYXJ0ID0gbnVsbDtcblxuICAgICAgICB2YXIgZ2VuQ2hhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoY2hhcnQpIHtcbiAgICAgICAgICAgICAgICAvL2NoYXJ0LmRhdGEoKVxuICAgICAgICAgICAgICAgIC8vJHNjb3BlLmNvbERhdGFcbiAgICAgICAgICAgICAgICB2YXIgb2xkRGF0YSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICByZW1vdmVJZHMgPSBbXTtcblxuICAgICAgICAgICAgICAgIC8vIHJlYXNzZW1ibGUgY3VycmVudGx5IGRpc3BsYXllZCBkYXRhIHRvIG1hdGNoICRzY29wZS5jb2xEYXRhXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKGNoYXJ0LmRhdGEoKSwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgb2xkRGF0YS5wdXNoKFtkLnZhbHVlc1swXS5pZCwgZC52YWx1ZXNbMF0udmFsdWVdKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSB3aGljaCBlbGVtZW50cyB0byByZW1vdmVcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gob2xkRGF0YSwgZnVuY3Rpb24gKG9kKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZWVwID0gXy5maW5kKCRzY29wZS5jb2xEYXRhLCBmdW5jdGlvbiAoY2QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZFswXSA9PT0gb2RbMF07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWtlZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUlkcy5wdXNoKG9kWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIGNoYXJ0XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSgkc2NvcGUuY29sRGF0YSkpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVtb3ZlSWRzKSk7XG4gICAgICAgICAgICAgICAgY2hhcnQubG9hZCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6ICRzY29wZS5jb2xEYXRhLFxuICAgICAgICAgICAgICAgICAgICB1bmxvYWQ6IHJlbW92ZUlkc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFydCA9IGMzLmdlbmVyYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgYmluZHRvOiAkZWxlbWVudFswXSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uczogJHNjb3BlLmNvbERhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkc2NvcGUudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd246IHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9yZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FybmluZzogc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X3llbGxvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cDogc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X2dyZWVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbXBsZXRlZDogc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X2dyZWVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERvbmU6ICcjMzY4MWJmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBRdWV1ZTogc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X3llbGxvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGYWlsZWQ6IHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9yZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQUxHT1JJVEhNOiBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9hbGdvcml0aG0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgREFUQTogc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTWVNURU06IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX3N5c3RlbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPZmZsaW5lOiBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfcmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdIaWdoIEZhaWx1cmUgUmF0ZSc6IHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9vcmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUGF1c2VkOiBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfeWVsbG93XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA3MDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcGllOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogZDMuZm9ybWF0KCcsJylcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZG9udXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiAkc2NvcGUuc2hvd0xhYmVsID8gZDMuZm9ybWF0KCcsJykgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICRzY29wZS53aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAkc2NvcGUubmFtZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZDMuZm9ybWF0KCcsJylcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAkc2NvcGUuc2l6ZSB8fCAzMjBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGVsZW1lbnRbMF0uc3R5bGUucG9zaXRpb24gPSAnc3RhdGljJztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdENvbHVtbkRhdGEgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgJHNjb3BlLmNvbERhdGEgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5kYXRhLmZvckVhY2goZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29sRGF0YS5wdXNoKFtvYmouc3RhdHVzLG9iai5jb3VudF0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGluaXRDb2x1bW5EYXRhKCk7XG4gICAgICAgICAgICBnZW5DaGFydCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2RhdGEnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemUoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKCRlbGVtZW50WzBdKS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHdpZHRoID0gJCgkZWxlbWVudFswXSkud2lkdGgoKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyh3aWR0aCk7XG4gICAgICAgICAgZ2VuQ2hhcnQoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZGlyZWN0aXZlKCdhaXNEb251dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhaXNEb251dENvbnRyb2xsZXInLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZGF0YTogJz0nLFxuICAgICAgICAgICAgICAgIHR5cGU6ICc9JyxcbiAgICAgICAgICAgICAgICBzaXplOiAnPScsXG4gICAgICAgICAgICAgICAgc2hvd0xhYmVsOiAnPScsXG4gICAgICAgICAgICAgICAgd2lkdGg6ICc9JyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnPSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2Fpc0dyaWRDaGFydENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24sICR1aWJNb2RhbCwgdXNlclNlcnZpY2UsIHNjYWxlQ29uZmlnLCBzY2FsZVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHN2ZyA9IG51bGwsXG4gICAgICAgICAgICByZWN0ID0gbnVsbCxcbiAgICAgICAgICAgIHNjYWxlID0gcGFyc2VGbG9hdCgkc2NvcGUuc2NhbGUpLFxuICAgICAgICAgICAgdGlwID0gZDMudGlwKClcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnZDMtdGlwJylcbiAgICAgICAgICAgICAgICAub2Zmc2V0KFstMTAsIDBdKVxuICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmVzID0gZC5zdGF0dXMuZ2V0RmFpbHVyZXMoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxTdHIgPSBmYWlsdXJlcy5sZW5ndGggPiAwID8gJzxiciAvPjxiciAvPicgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBnZXRDZWxsQWN0aXZpdHlUb3RhbChkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZCA9IGdldENlbGxUb3RhbChkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1N0ciA9IHJ1bm5pbmcgPiAwIHx8IGNvbXBsZXRlZCA+IDAgPyAnPGJyIC8+JyA6ICcnO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChydW5uaW5nID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzU3RyID0gc3RhdHVzU3RyICsgJzxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtcnVubmluZ1wiPlJ1bm5pbmc6ICcgKyBydW5uaW5nICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNTdHIgPSBzdGF0dXNTdHIgKyAnIDxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtY29tcGxldGVkXCI+Q29tcGxldGVkOiAnICsgY29tcGxldGVkICsgJzwvc3Bhbj4nO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZmFpbHVyZXMgPSBfLnNvcnRCeU9yZGVyKGZhaWx1cmVzLCBbJ29yZGVyJ10pO1xuXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChmYWlsdXJlcywgZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxTdHIgPSBmYWlsU3RyICsgJzxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtJyArIGYuc3RhdHVzLnRvTG93ZXJDYXNlKCkgKyAnXCI+JyArIF8uY2FwaXRhbGl6ZShmLnN0YXR1cy50b0xvd2VyQ2FzZSgpKSArICc6ICcgKyBmLmNvdW50ICsgJzwvc3Bhbj4gJztcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRpdGxlICsgJyAnICsgZC52ZXJzaW9uICsgJzxiciAvPicgKyBzdGF0dXNTdHIgKyBmYWlsU3RyO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmRhdGFWYWx1ZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmNlbGxXaWR0aCA9IDUwICogc2NhbGU7XG4gICAgICAgICRzY29wZS5jZWxsSGVpZ2h0ID0gNTAgKiBzY2FsZTtcbiAgICAgICAgJHNjb3BlLmVuYWJsZVpvb20gPSB0eXBlb2YgJHNjb3BlLm1vZGUgIT09ICd1bmRlZmluZWQnID8gJHNjb3BlLm1vZGUgPT09ICd6b29tJyA6IHRydWU7XG4gICAgICAgICRzY29wZS5lbmFibGVUb29sdGlwID0gdHlwZW9mICRzY29wZS5tb2RlICE9PSAndW5kZWZpbmVkJyA/ICRzY29wZS5tb2RlID09PSAndG9vbHRpcCcgOiBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmVuYWJsZVJldmVhbCA9IHR5cGVvZiAkc2NvcGUucmV2ZWFsICE9PSAndW5kZWZpbmVkJyA/ICRzY29wZS5yZXZlYWwgOiB0cnVlO1xuICAgICAgICAkc2NvcGUudXNlciA9IHVzZXJTZXJ2aWNlLmdldFVzZXJDcmVkcygpO1xuICAgICAgICAkc2NvcGUucGF1c2VSZWFzb24gPSAnJztcbiAgICAgICAgJHNjb3BlLmdyaWREYXRhID0gW107XG4gICAgICAgICRzY29wZS5ncmlkQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmljb25zID09PSB0cnVlID8gJ2ljb25zJyA6ICcnO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciB3aWR0aCA9ICQoJy5ncmlkLWNoYXJ0Jykud2lkdGgoKSxcbiAgICAgICAgICAgIGhlaWdodCA9ICRzY29wZS5yb3dzID8gKCRzY29wZS5jZWxsSGVpZ2h0ICogJHNjb3BlLnJvd3MpICsgMTAgOiAkc2NvcGUubW9kZSA9PT0gJ3pvb20nID8gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLmhlaWdodCAqIDIgOiAoJHNjb3BlLmNlbGxIZWlnaHQgKiA2KSArIDEwLCAvLyBtdWx0aXBseSBjZWxsIGhlaWdodCBieSA4IChoaWdoZXN0IHpvb20gc2NhbGUgZXh0ZW50IHZhbHVlKSBwbHVzIHNvbWUgYnJlYXRoaW5nIHJvb21cbiAgICAgICAgICAgIGNvbHMgPSAwLFxuICAgICAgICAgICAgcm93cyA9IDAsXG4gICAgICAgICAgICBjZWxsRm9udExnID0gLjQsXG4gICAgICAgICAgICBjZWxsRm9udFNtID0gLjM7XG5cbiAgICAgICAgdmFyIGdldERhdGFWYWx1ZXMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmdyaWREYXRhID0gW107XG4gICAgICAgICAgICAkc2NvcGUuZGF0YVZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgaWYgKGRhdGEuZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhVHlwZSA9IGRhdGEuZGF0YS50b1N0cmluZygpLnNwbGl0KCcsJylbMF07XG4gICAgICAgICAgICAgICAgaWYgKGRhdGFUeXBlID09PSAnSm9iVHlwZScpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGFWYWx1ZXMgPSBfLnNvcnRCeU9yZGVyKF8udmFsdWVzKGRhdGEuZGF0YSksIFsnbmFtZSddLCBbJ2FzYyddKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXNzb2NpYXRlIEpvYlR5cGUgd2l0aCBKb2JUeXBlU3RhdHVzXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUuZGF0YVZhbHVlcywgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsLnN0YXR1cyA9IF8uZmluZChkYXRhLnN0YXR1cywgJ2pvYl90eXBlLmlkJywgdmFsLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhVmFsdWVzID0gXy5zb3J0QnlPcmRlcihfLnZhbHVlcyhkYXRhLmRhdGEpLCBbJ3N0YXR1cy5oYXNfcnVubmluZycsICdzdGF0dXMuZGVzY3JpcHRpb24nLCAnbmFtZSddLCBbJ2FzYycsICdhc2MnLCAnYXNjJ10pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVR5cGUgPT09ICdOb2RlJykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YVZhbHVlcyA9IF8udmFsdWVzKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGFWYWx1ZXMgPSBfLnNvcnRCeU9yZGVyKF8udmFsdWVzKGRhdGEuZGF0YSksIFsnaG9zdG5hbWUnXSwgWydhc2MnXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzc29jaWF0ZSBOb2RlIHdpdGggTm9kZVN0YXR1c1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLmRhdGFWYWx1ZXMsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbC5zdGF0dXMgPSBfLmZpbmQoZGF0YS5zdGF0dXMsICdub2RlLmlkJywgdmFsLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vJHNjb3BlLmRhdGFWYWx1ZXMgPSBfLnNvcnRCeU9yZGVyKCRzY29wZS5kYXRhVmFsdWVzLCBbJ2hvc3RuYW1lJ10sIFsnYXNjJ10pOyAvLyBzb3J0IGJ5IGhvc3ROYW1lIGFzY1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhVmFsdWVzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbHMgPSAkc2NvcGUuY29sdW1ucyA/ICRzY29wZS5jb2x1bW5zIDogTWF0aC5mbG9vcih3aWR0aCAvICRzY29wZS5jZWxsV2lkdGgpO1xuICAgICAgICAgICAgICAgIHJvd3MgPSAkc2NvcGUucm93cyA/ICRzY29wZS5yb3dzIDogTWF0aC5jZWlsKCRzY29wZS5kYXRhVmFsdWVzLmxlbmd0aCAvIGNvbHMpO1xuXG4gICAgICAgICAgICAgICAgZDMucmFuZ2Uocm93cykubWFwKGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgZDMucmFuZ2UoY29scykubWFwKGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2wgPD0gJHNjb3BlLmRhdGFWYWx1ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhT2JqID0gJHNjb3BlLmRhdGFWYWx1ZXNbKGNvbHMgKiByb3cpICsgY29sXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YU9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhT2JqLmNvb3JkcyA9IFtjb2wgKiAkc2NvcGUuY2VsbEhlaWdodCwgcm93ICogJHNjb3BlLmNlbGxXaWR0aF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ncmlkRGF0YS5wdXNoKGRhdGFPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB1cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgcmV2ZWFsRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLmNlbGwtdGV4dCcpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLmNlbGwtdGV4dC1kZXRhaWwnKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpO1xuICAgICAgICAgICAgZDMuc2VsZWN0QWxsKCcuY2VsbC1wYXVzZS1yZXN1bWUtaWNvbicpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGhpZGVEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZDMuc2VsZWN0QWxsKCcuY2VsbC10ZXh0JylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLmNlbGwtdGV4dC1kZXRhaWwnKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5jZWxsLXBhdXNlLXJlc3VtZS1pY29uJylcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbHMgPSAkc2NvcGUuY29sdW1ucyA/ICRzY29wZS5jb2x1bW5zIDogTWF0aC5mbG9vcih3aWR0aCAvICRzY29wZS5jZWxsV2lkdGgpO1xuICAgICAgICAgICAgcm93cyA9ICRzY29wZS5yb3dzID8gJHNjb3BlLnJvd3MgOiBNYXRoLmNlaWwoJHNjb3BlLmRhdGFWYWx1ZXMubGVuZ3RoIC8gY29scyk7XG5cbiAgICAgICAgICAgIHZhciB0aWNrVmFsdWVzID0gQXJyYXkuYXBwbHkobnVsbCwge2xlbmd0aDogcm93c30pLm1hcChOdW1iZXIuY2FsbCwgTnVtYmVyKTtcblxuICAgICAgICAgICAgdmFyIHpvb20gPSBkMy5iZWhhdmlvci56b29tKClcbiAgICAgICAgICAgICAgICAuc2NhbGVFeHRlbnQoWzEsIDZdKVxuICAgICAgICAgICAgICAgIC8vLmNlbnRlcihbMCwgMF0pXG4gICAgICAgICAgICAgICAgLm9uKCd6b29tJywgem9vbWVkKTtcblxuICAgICAgICAgICAgaWYgKCRzY29wZS5lbmFibGVab29tKSB7XG4gICAgICAgICAgICAgICAgc3ZnID0gZDMuc2VsZWN0KCcuZ3JpZC1jaGFydCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh6b29tKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdnJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5lbmFibGVUb29sdGlwKSB7XG4gICAgICAgICAgICAgICAgc3ZnID0gZDMuc2VsZWN0KCcuZ3JpZC1jaGFydCcpLmFwcGVuZCgnc3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh0aXApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdmcgPSBkMy5zZWxlY3QoJy5ncmlkLWNoYXJ0JykuYXBwZW5kKCdzdmcnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodClcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnZycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdmcuYXBwZW5kKCdyZWN0JylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnb3ZlcmxheScpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCk7XG5cbiAgICAgICAgICAgIGlmICgkc2NvcGUuc2hvd0F4ZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgeSA9IGQzLnNjYWxlLmxpbmVhcigpXG4gICAgICAgICAgICAgICAgICAgIC5kb21haW4oWzAsIHJvd3NdKVxuICAgICAgICAgICAgICAgICAgICAucmFuZ2UoWzAsIGhlaWdodC0xMF0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIHlBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgICAgICAgICAuc2NhbGUoeSlcbiAgICAgICAgICAgICAgICAgICAgLm9yaWVudCgnbGVmdCcpXG4gICAgICAgICAgICAgICAgICAgIC50aWNrVmFsdWVzKHRpY2tWYWx1ZXMpO1xuXG4gICAgICAgICAgICAgICAgc3ZnLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIDI1ICsgJywnICsgMCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICd5IGF4aXMnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgMCArICcsJyArICRzY29wZS5jZWxsSGVpZ2h0IC8gMiArICcpJylcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeUF4aXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZXREYXRhVmFsdWVzKGRhdGEpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB6b29tZWQoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHMgPSBkMy5ldmVudC5zY2FsZTtcblxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuZW5hYmxlUmV2ZWFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzID4gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZWFsRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZURhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocyA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnNob3dBeGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tLnRyYW5zbGF0ZShbMjUsIDBdKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb20udHJhbnNsYXRlKFswLCAwXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3ZnLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHpvb20udHJhbnNsYXRlKCkgKyAnKXNjYWxlKCcgKyBkMy5ldmVudC5zY2FsZSArICcpJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRyYWdPZmZzZXRYID0gMCxcbiAgICAgICAgICAgIGRyYWdPZmZzZXRZID0gMCxcbiAgICAgICAgICAgIGNsaWNrT2Zmc2V0WCA9IDAsXG4gICAgICAgICAgICBjbGlja09mZnNldFkgPSAwO1xuXG4gICAgICAgIHZhciBkcmFnID0gZDMuYmVoYXZpb3IuZHJhZygpXG4gICAgICAgICAgICAub24oJ2RyYWdzdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyB0cmFjayBvZmZzZXRYIGFuZCBvZmZzZXRZIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gZHJhZyBhbmQgY2xpY2tcbiAgICAgICAgICAgICAgICBkcmFnT2Zmc2V0WCA9IGQzLmV2ZW50LnNvdXJjZUV2ZW50LmxheWVyWDtcbiAgICAgICAgICAgICAgICBkcmFnT2Zmc2V0WSA9IGQzLmV2ZW50LnNvdXJjZUV2ZW50LmxheWVyWTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBnZXRDZWxsRmlsbCA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBpZiAoZCAmJiBkLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnN0YXR1cy5nZXRDZWxsRmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICdub25lJztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0Q2VsbFRleHQgPSBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgaWYgKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5nZXRDZWxsVGV4dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsQWN0aXZpdHkgPSBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgaWYgKGQgJiYgZC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0UnVubmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsUGF1c2VSZXN1bWUgPSBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgaWYgKGQgJiYgZC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0Q2VsbFBhdXNlUmVzdW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldENlbGxBY3Rpdml0eVRvdGFsID0gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgIGlmIChkICYmIGQuc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuc3RhdHVzLmdldENlbGxBY3Rpdml0eVRvdGFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldENlbGxUaXRsZSA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBpZiAoZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmdldENlbGxUaXRsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsRXJyb3IgPSBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgaWYgKGQgJiYgZC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0Q2VsbEVycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ0ZhaWxlZDogVW5hdmFpbGFibGUnO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsVG90YWwgPSBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgaWYgKGQgJiYgZC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0Q2VsbFRvdGFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJ0NvbXBsZXRlZDogVW5hdmFpbGFibGUnO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsU3RhdHVzID0gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgIGlmIChkICYmIGQuc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ05vZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnN0YXR1cy5nZXRDZWxsU3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICdTdGF0dXMgVW5hdmFpbGFibGUnO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRDZWxsSm9icyA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBpZiAoZCAmJiBkLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGlmIChkLnRvU3RyaW5nKCkgPT09ICdOb2RlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0Q2VsbEpvYnMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldENlbGxGYWlsdXJlcyA9IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICBpZiAoZCAmJiBkLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGlmIChkLnRvU3RyaW5nKCkgPT09ICdKb2JUeXBlJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5zdGF0dXMuZ2V0Q2VsbEZhaWx1cmVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBjZWxsQ2xpY2tIYW5kbGVyID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICAgICAgLy8gdHJhY2sgb2Zmc2V0WCBhbmQgb2Zmc2V0WSB0byBkaXN0aW5ndWlzaCBiZXR3ZWVuIGRyYWcgYW5kIGNsaWNrXG4gICAgICAgICAgICBjbGlja09mZnNldFggPSBkMy5ldmVudC5sYXllclg7XG4gICAgICAgICAgICBjbGlja09mZnNldFkgPSBkMy5ldmVudC5sYXllclk7XG4gICAgICAgICAgICBpZiAoZHJhZ09mZnNldFggPT09IGNsaWNrT2Zmc2V0WCAmJiBkcmFnT2Zmc2V0WSA9PT0gY2xpY2tPZmZzZXRZKSB7XG4gICAgICAgICAgICAgICAgLy8gb2Zmc2V0cyBhcmUgdGhlIHNhbWU7IG5vIGRyYWdnaW5nIG9jY3VycmVkOyBwcm9jZXNzIGFzIGNsaWNrIGV2ZW50XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQudG9TdHJpbmcoKSA9PT0gJ0pvYlR5cGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2pvYnMnKS5zZWFyY2goJ2pvYl90eXBlX2lkJywgdGFyZ2V0LmlkKS5zZWFyY2goJ3N0YXR1cycsIHRhcmdldC5zdGF0dXMuaGFzX3J1bm5pbmcuc3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQudG9TdHJpbmcoKSA9PT0gJ05vZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL25vZGVzLycgKyB0YXJnZXQuaWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIERBVEEgSk9JTlxuICAgICAgICAgICAgLy8gSm9pbiBuZXcgZGF0YSB3aXRoIG9sZCBlbGVtZW50cywgaWYgYW55LlxuICAgICAgICAgICAgaWYgKCRzY29wZS5lbmFibGVUb29sdGlwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lckdyb3VwID0gc3ZnLnNlbGVjdEFsbCgnLmNlbGwtZ3JvdXAnKVxuICAgICAgICAgICAgICAgICAgICAuZGF0YSgkc2NvcGUuZ3JpZERhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmNvb3JkczsgfSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKCdtb3VzZW92ZXInLCB0aXAuc2hvdylcbiAgICAgICAgICAgICAgICAgICAgLm9uKCdtb3VzZW91dCcsIHRpcC5oaWRlKVxuICAgICAgICAgICAgICAgICAgICAub24oJ2NsaWNrJywgdGlwLmhpZGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyR3JvdXAgPSBzdmcuc2VsZWN0QWxsKCcuY2VsbC1ncm91cCcpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVVBEQVRFXG4gICAgICAgICAgICAvLyBVcGRhdGUgb2xkIGVsZW1lbnRzIGFzIG5lZWRlZC5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLnN0b3AxJylcbiAgICAgICAgICAgICAgICAuYXR0cignb2Zmc2V0JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmVzID0gZ2V0Q2VsbEZhaWx1cmVzKGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMgJiYgZmFpbHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWx1cmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnMTAwJSc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzAlJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzAlJztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKCdzdG9wLWNvbG9yJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmVzID0gZ2V0Q2VsbEZhaWx1cmVzKGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMgJiYgZmFpbHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWx1cmVzWzBdID09PSAnU1lTVEVNJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX3N5c3RlbSA6IGZhaWx1cmVzWzBdID09PSAnREFUQScgPyBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9kYXRhIDogc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfYWxnb3JpdGhtO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsRmlsbChkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29udGFpbmVyR3JvdXAuc2VsZWN0QWxsKCcuc3RvcDInKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdvZmZzZXQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc1MCUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmYWlsdXJlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnMCUnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbHVyZXNbMV0gPT09ICdTWVNURU0nID8gc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfc3lzdGVtIDogZmFpbHVyZXNbMV0gPT09ICdEQVRBJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX2RhdGEgOiBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9hbGdvcml0aG07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxGaWxsKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb250YWluZXJHcm91cC5zZWxlY3RBbGwoJy5zdG9wMycpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ29mZnNldCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlcyA9IGdldENlbGxGYWlsdXJlcyhkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWx1cmVzICYmIGZhaWx1cmVzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnMCUnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbHVyZXNbMl0gPT09ICdTWVNURU0nID8gc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfc3lzdGVtIDogZmFpbHVyZXNbMl0gPT09ICdEQVRBJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX2RhdGEgOiBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9hbGdvcml0aG07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxGaWxsKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb250YWluZXJHcm91cC5zZWxlY3RBbGwoJy5jZWxsJylcbiAgICAgICAgICAgICAgICAuZGF0YSgkc2NvcGUuZ3JpZERhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmNvb3JkczsgfSlcbiAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlID0gZ2V0Q2VsbEFjdGl2aXR5KGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlLmNvdW50ID4gMCA/ICdjZWxsIGNlbGwtYWN0aXZpdHknIDogJ2NlbGwnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnY2VsbCc7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkID8gJyNmZmYnIDogJ25vbmUnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ05vZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEZpbGwoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGNnID0gY29udGFpbmVyR3JvdXAuc2VsZWN0QWxsKCcuY2VsbC1ncmFkaWVudCcpO1xuXG4gICAgICAgICAgICBjb250YWluZXJHcm91cC5zZWxlY3RBbGwoJy5jZWxsLXRleHQnKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsVGV4dChkKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd5JywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ0pvYlR5cGUnICYmIGdldENlbGxBY3Rpdml0eVRvdGFsKGQpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5jZWxsSGVpZ2h0IC8gMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCRzY29wZS5jZWxsSGVpZ2h0IC8gMikgKyAxMDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29udGFpbmVyR3JvdXAuc2VsZWN0QWxsKCcuY2VsbC10b3RhbC1hY3RpdmUnKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnRvU3RyaW5nKCkgPT09ICdKb2JUeXBlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxBY3Rpdml0eVRvdGFsKGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtcGF1c2UtcmVzdW1lLWljb24nKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsUGF1c2VSZXN1bWUoZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtdGl0bGUnKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC5odG1sKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsVGl0bGUoZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsRXJyb3IoZCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtdG90YWwnKVxuICAgICAgICAgICAgICAgIC5kYXRhKCRzY29wZS5ncmlkRGF0YSwgZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuY29vcmRzOyB9KVxuICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsVG90YWwoZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtc3RhdHVzJylcbiAgICAgICAgICAgICAgICAuZGF0YSgkc2NvcGUuZ3JpZERhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmNvb3JkczsgfSlcbiAgICAgICAgICAgICAgICAudGV4dChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbFN0YXR1cyhkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29udGFpbmVyR3JvdXAuc2VsZWN0QWxsKCcuY2VsbC1qb2JzJylcbiAgICAgICAgICAgICAgICAuZGF0YSgkc2NvcGUuZ3JpZERhdGEsIGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmNvb3JkczsgfSlcbiAgICAgICAgICAgICAgICAuaHRtbChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEpvYnMoZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtb3ZlcmxheScpXG4gICAgICAgICAgICAgICAgLmRhdGEoJHNjb3BlLmdyaWREYXRhLCBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5jb29yZHM7IH0pXG4gICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbENsaWNrSGFuZGxlcih0YXJnZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBFTlRFUlxuICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBlbGVtZW50cyBhcyBuZWVkZWQuXG4gICAgICAgICAgICB2YXIgY2VsbEdyb3VwID0gY29udGFpbmVyR3JvdXAuZW50ZXIoKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjZWxsLWdyb3VwJyk7XG5cbiAgICAgICAgICAgIHZhciBkZWZzID0gY2VsbEdyb3VwLmFwcGVuZCgnZGVmcycpO1xuICAgICAgICAgICAgdmFyIGdyYWRpZW50ID0gZGVmcy5hcHBlbmQoJ2xpbmVhckdyYWRpZW50JylcbiAgICAgICAgICAgICAgICAuYXR0cignaWQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5uYW1lO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NlbGwtZ3JhZGllbnQnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIDApXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3kxJywgMClcbiAgICAgICAgICAgICAgICAuYXR0cigneDInLCAwKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIDEpO1xuICAgICAgICAgICAgZ3JhZGllbnQuYXBwZW5kKCdzdG9wJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3RvcDEnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdvZmZzZXQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcxMDAlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnMCUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnMCUnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbHVyZXNbMF0gPT09ICdTWVNURU0nID8gc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfc3lzdGVtIDogZmFpbHVyZXNbMF0gPT09ICdEQVRBJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX2RhdGEgOiBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9hbGdvcml0aG07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxGaWxsKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZ3JhZGllbnQuYXBwZW5kKCdzdG9wJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3RvcDInKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdvZmZzZXQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc1MCUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmYWlsdXJlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnMCUnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFpbHVyZXNbMV0gPT09ICdTWVNURU0nID8gc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfc3lzdGVtIDogZmFpbHVyZXNbMV0gPT09ICdEQVRBJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX2RhdGEgOiBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9hbGdvcml0aG07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxGaWxsKGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZ3JhZGllbnQuYXBwZW5kKCdzdG9wJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3RvcDMnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdvZmZzZXQnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZXMgPSBnZXRDZWxsRmFpbHVyZXMoZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmYWlsdXJlcyAmJiBmYWlsdXJlcy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcxMDAlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzAlJztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKCdzdG9wLWNvbG9yJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmVzID0gZ2V0Q2VsbEZhaWx1cmVzKGQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZXMgJiYgZmFpbHVyZXMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWx1cmVzWzJdID09PSAnU1lTVEVNJyA/IHNjYWxlQ29uZmlnLmNvbG9ycy5mYWlsdXJlX3N5c3RlbSA6IGZhaWx1cmVzWzJdID09PSAnREFUQScgPyBzY2FsZUNvbmZpZy5jb2xvcnMuZmFpbHVyZV9kYXRhIDogc2NhbGVDb25maWcuY29sb3JzLmZhaWx1cmVfYWxnb3JpdGhtO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsRmlsbChkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2VsbEdyb3VwLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZSA9IGdldENlbGxBY3Rpdml0eShkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZS5jb3VudCA+IDAgPyAnY2VsbCBjZWxsLWFjdGl2aXR5JyA6ICdjZWxsJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2NlbGwnO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgJHNjb3BlLmNlbGxXaWR0aClcbiAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgJHNjb3BlLmNlbGxIZWlnaHQpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ05vZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEZpbGwoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKCdmaWxsJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ0pvYlR5cGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3VybCgjJyArIGQubmFtZSArICcpJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZCA/ICcjZmZmJyA6ICdub25lJztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKTtcblxuICAgICAgICAgICAgY2VsbEdyb3VwLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NlbGwtdGV4dCcpXG4gICAgICAgICAgICAgICAgLmh0bWwoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxUZXh0KGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3gnLCAkc2NvcGUuY2VsbFdpZHRoIC8gMilcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkLnRvU3RyaW5nKCkgPT09ICdKb2JUeXBlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdldENlbGxBY3Rpdml0eVRvdGFsKGQpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuY2VsbEhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCRzY29wZS5jZWxsSGVpZ2h0IC8gMikgKyAxMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmNlbGxIZWlnaHQgLyAyO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdmb250LXNpemUnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZC50b1N0cmluZygpID09PSAnTm9kZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuc2NhbGUgKiA4ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3R5bGUoJ2Rpc3BsYXknLCAkc2NvcGUuZW5hYmxlUmV2ZWFsID8gJ2Jsb2NrJyA6ICdub25lJyk7XG5cbiAgICAgICAgICAgIGNlbGxHcm91cC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjZWxsLXRvdGFsLWFjdGl2ZScpXG4gICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQudG9TdHJpbmcoKSA9PT0gJ0pvYlR5cGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEFjdGl2aXR5VG90YWwoZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmNlbGxXaWR0aCAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAkc2NvcGUuY2VsbEhlaWdodCAtIDUpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJHNjb3BlLmVuYWJsZVJldmVhbCA/ICdibG9jaycgOiAnbm9uZScpO1xuXG4gICAgICAgICAgICB2YXIgZGV0YWlsID0gY2VsbEdyb3VwLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NlbGwtdGV4dC1kZXRhaWwnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmNlbGxXaWR0aCAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCBNYXRoLmZsb29yKCRzY29wZS5jZWxsSGVpZ2h0ICouMTUpKSAvLyAxNSUgZnJvbSB0b3Agb2YgY2VsbFxuICAgICAgICAgICAgICAgIC5hdHRyKCdkeScsIDApXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdkaXNwbGF5JywgJHNjb3BlLmVuYWJsZVJldmVhbCA/ICdub25lJyA6ICdibG9jaycpO1xuXG4gICAgICAgICAgICBkZXRhaWwuYXBwZW5kKCd0c3BhbicpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NlbGwtdGl0bGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmNlbGxXaWR0aCAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCBNYXRoLmZsb29yKCRzY29wZS5jZWxsSGVpZ2h0ICogLjE1KSkgLy8gMTUlIGZyb20gdG9wIG9mIGNlbGxcbiAgICAgICAgICAgICAgICAuYXR0cignZHknLCAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgY2VsbEZvbnRTbSAqIHNjYWxlICsgJ2VtJylcbiAgICAgICAgICAgICAgICAuaHRtbChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbFRpdGxlKGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhbGwod3JhcCk7XG5cbiAgICAgICAgICAgIGRldGFpbC5hcHBlbmQoJ3RzcGFuJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2VsbC1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3gnLCAkc2NvcGUuY2VsbFdpZHRoIC8gMilcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIE1hdGguZmxvb3IoJHNjb3BlLmNlbGxIZWlnaHQgKi4zKSkgLy8gMzAlIGZyb20gdG9wIG9mIGNlbGxcbiAgICAgICAgICAgICAgICAuYXR0cignZHknLCAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgY2VsbEZvbnRTbSAqIHNjYWxlICsgJ2VtJylcbiAgICAgICAgICAgICAgICAudGV4dChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEVycm9yKGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhbGwod3JhcCk7XG5cbiAgICAgICAgICAgIGRldGFpbC5hcHBlbmQoJ3RzcGFuJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2VsbC10b3RhbCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3gnLCAkc2NvcGUuY2VsbFdpZHRoIC8gMilcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIE1hdGguZmxvb3IoJHNjb3BlLmNlbGxIZWlnaHQgKi40KSkgLy8gNDAlIGZyb20gdG9wIG9mIGNlbGxcbiAgICAgICAgICAgICAgICAuYXR0cignZHknLCAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgY2VsbEZvbnRTbSAqIHNjYWxlICsgJ2VtJylcbiAgICAgICAgICAgICAgICAudGV4dChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbFRvdGFsKGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhbGwod3JhcCk7XG5cbiAgICAgICAgICAgIGRldGFpbC5hcHBlbmQoJ3RzcGFuJylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY2VsbC1zdGF0dXMnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmNlbGxXaWR0aCAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCBNYXRoLmZsb29yKCRzY29wZS5jZWxsSGVpZ2h0ICogLjU1KSkgLy8gNTUlIGZyb20gdG9wIG9mIGNlbGxcbiAgICAgICAgICAgICAgICAuYXR0cignZHknLCAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgY2VsbEZvbnRMZyAqIHNjYWxlICsgJ2VtJylcbiAgICAgICAgICAgICAgICAudGV4dChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbFN0YXR1cyhkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZGV0YWlsLmFwcGVuZCgndHNwYW4nKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjZWxsLWpvYnMnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmNlbGxXaWR0aCAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCBNYXRoLmZsb29yKCRzY29wZS5jZWxsSGVpZ2h0ICogLjc1KSkgLy8gNzUlIGZyb20gdG9wIG9mIGNlbGxcbiAgICAgICAgICAgICAgICAuYXR0cignZHknLCAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgY2VsbEZvbnRTbSAqIHNjYWxlICsgJ2VtJylcbiAgICAgICAgICAgICAgICAuaHRtbChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEpvYnMoZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2FsbCh3cmFwKTtcblxuICAgICAgICAgICAgY2VsbEdyb3VwLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NlbGwtb3ZlcmxheScpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgJHNjb3BlLmNlbGxXaWR0aClcbiAgICAgICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgJHNjb3BlLmNlbGxIZWlnaHQpXG4gICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgJyNmZmYnKVxuICAgICAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbC1vcGFjaXR5JywgJzAuMjUnKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsLW9wYWNpdHknLCAnMCcpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNlbGxDbGlja0hhbmRsZXIoZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2FsbChkcmFnKTtcblxuICAgICAgICAgICAgaWYgKCRzY29wZS51c2VyICYmICRzY29wZS51c2VyLmlzX2FkbWluKSB7XG4gICAgICAgICAgICAgICAgY2VsbEdyb3VwLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjZWxsLXBhdXNlLXJlc3VtZS1pY29uJylcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwoZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRDZWxsUGF1c2VSZXN1bWUoZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdzdGFydCcpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgJHNjb3BlLmVuYWJsZVJldmVhbCA/IDIgOiA1KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigneScsICRzY29wZS5lbmFibGVSZXZlYWwgPyAkc2NvcGUuc2NhbGUgKiA4IDogMjApXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZGlzcGxheScsICRzY29wZS5lbmFibGVSZXZlYWwgPyAnbm9uZScgOiAnYmxvY2snKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsICRzY29wZS5lbmFibGVSZXZlYWwgPyAkc2NvcGUuc2NhbGUgKiA3ICsgJ3B4JyA6ICcxLjNlbScpXG4gICAgICAgICAgICAgICAgICAgIC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdjdXJzb3InLCAncG9pbnRlcicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X2JsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAub24oJ21vdXNlb3V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ3doaXRlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF1c2VSZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldERhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGF0YSA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGF0YS5zdGF0dXMucGF1c2VSZXN1bWVDZWxsKCRzY29wZS5wYXVzZVJlYXNvbikudGhlbihmdW5jdGlvbiAodXBkYXRlZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXREYXRhLnRvU3RyaW5nKCkgPT09ICdOb2RlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB0YXJnZXQgZGF0YSB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREYXRhLmlzX3BhdXNlZCA9IHVwZGF0ZWREYXRhLmlzX3BhdXNlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREYXRhLnBhdXNlX3JlYXNvbiA9IHVwZGF0ZWREYXRhLnBhdXNlX3JlYXNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREYXRhLnN0YXR1cy5ub2RlID0gdXBkYXRlZERhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1cGRhdGVOb2RlSGVhbHRoJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgZ3JpZCBjZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVDZWxsRmlsbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUGF1c2VSZXN1bWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25seSBwcm9tcHQgZm9yIHJlYXNvbiB3aGVuIHBhdXNpbmcgKG5vdCByZXN1bWluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0LmlzX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGF1c2VEaWFsb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXVzZVJlc3VtZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXVzZVJlc3VtZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRU5URVIgKyBVUERBVEVcbiAgICAgICAgICAgIC8vIEFwcGVuZGluZyB0byB0aGUgZW50ZXIgc2VsZWN0aW9uIGV4cGFuZHMgdGhlIHVwZGF0ZSBzZWxlY3Rpb24gdG8gaW5jbHVkZVxuICAgICAgICAgICAgLy8gZW50ZXJpbmcgZWxlbWVudHM7IHNvLCBvcGVyYXRpb25zIG9uIHRoZSB1cGRhdGUgc2VsZWN0aW9uIGFmdGVyIGFwcGVuZGluZyB0b1xuICAgICAgICAgICAgLy8gdGhlIGVudGVyIHNlbGVjdGlvbiB3aWxsIGFwcGx5IHRvIGJvdGggZW50ZXJpbmcgYW5kIHVwZGF0aW5nIG5vZGVzLlxuICAgICAgICAgICAgY29udGFpbmVyR3JvdXAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcbiAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0cmFuc2xhdGUoJyArIGQuY29vcmRzICsgJyknO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgdXBkYXRlQ2VsbEZpbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyR3JvdXAuc2VsZWN0QWxsKCcuY2VsbCcpXG4gICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKDI1MClcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQgPyAnI2ZmZicgOiAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbEZpbGwoZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHVwZGF0ZVBhdXNlUmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLnNlbGVjdEFsbCgnLmNlbGwtcGF1c2UtcmVzdW1lLWljb24nKVxuICAgICAgICAgICAgICAgICAgICAuaHRtbChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENlbGxQYXVzZVJlc3VtZShkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgdXBkYXRlQ2VsbFN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXJHcm91cC5zZWxlY3RBbGwoJy5jZWxsLXN0YXR1cycpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q2VsbFN0YXR1cyhkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBFWElUXG4gICAgICAgICAgICAvLyBSZW1vdmUgb2xkIGVsZW1lbnRzIGFzIG5lZWRlZC5cbiAgICAgICAgICAgIGNvbnRhaW5lckdyb3VwLmV4aXQoKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjZWxsLWV4aXQnKVxuICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsMCknKVxuICAgICAgICAgICAgICAgIC5yZW1vdmUoKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gd3JhcCAodGV4dCwgd2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0ZXh0LmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IGQzLnNlbGVjdCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmRzID0gdGV4dC50ZXh0KCkuc3BsaXQoL1xccysvKS5yZXZlcnNlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlciA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0ID0gMS4xLFxuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHRleHQuYXR0cigneScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSBwYXJzZUZsb2F0KHRleHQuYXR0cignZHknKSksXG4gICAgICAgICAgICAgICAgICAgICAgICB0c3BhbiA9IHRleHQudGV4dChudWxsKS5hcHBlbmQoJ3RzcGFuJykuYXR0cigneCcsICRzY29wZS5jZWxsV2lkdGggLyAyKS5hdHRyKCd5JywgeSkuYXR0cignZHknLCBkeSArICdlbScpO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAod29yZCA9IHdvcmRzLnBvcCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod29yZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lLnB1c2god29yZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNwYW4udGV4dChsaW5lLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRzcGFuLm5vZGUoKS5nZXRDb21wdXRlZFRleHRMZW5ndGgoKSA+ICgkc2NvcGUuY2VsbFdpZHRoIC0gMTApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzcGFuLnRleHQobGluZS5qb2luKCcgJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gW3dvcmRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c3BhbiA9IHRleHQuYXBwZW5kKCd0c3BhbicpLmF0dHIoJ3gnLCAkc2NvcGUuY2VsbFdpZHRoIC8gMikuYXR0cigneScsIHkpLmF0dHIoJ2R5JywgKytsaW5lTnVtYmVyICogbGluZUhlaWdodCArIGR5ICsgJ2VtJykudGV4dCh3b3JkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdkYXRhJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChfLmtleXMoZGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICQoJy5ncmlkLWNoYXJ0JykuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCdyZWRyYXdHcmlkJywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICBnZXREYXRhVmFsdWVzKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmRpcmVjdGl2ZSgnYWlzR3JpZENoYXJ0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fpc0dyaWRDaGFydENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NoYXJ0cy9ncmlkL2dyaWRDaGFydFRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZGF0YTogJz0nLFxuICAgICAgICAgICAgICAgIGljb25zOiAnPScsIC8vIGluZGljYXRlcyB3aGV0aGVyIGNlbGwtdGV4dCBpcyBlbnRpcmVseSBtYWRlIHVwIG9mIGljb25zXG4gICAgICAgICAgICAgICAgc2NhbGU6ICc9JywgLy8gbXVsdGlwbGllciB0byBpbmNyZWFzZSBjZWxsIHNpemVcbiAgICAgICAgICAgICAgICByZXZlYWw6ICc9JywgLy8gaWYgdHJ1ZSwgbGVzcyBkYXRhIHdpbGwgc2hvdyB3aGVuIHpvb21lZCBvdXRcbiAgICAgICAgICAgICAgICBtb2RlOiAnQCcsIC8vIHZhbGlkIHZhbHVlcyBhcmUgem9vbSBvciB0b29sdGlwXG4gICAgICAgICAgICAgICAgY29sdW1uczogJz0nLFxuICAgICAgICAgICAgICAgIHJvd3M6ICc9JyxcbiAgICAgICAgICAgICAgICBzaG93QXhlczogJz0nXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdhaXNIZWFsdGhDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgZ2F1Z2VGYWN0b3J5KSB7XG4gICAgICAgIHZhciBnYXVnZSA9IG51bGwsXG4gICAgICAgICAgICBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNjYWxlID0gJHNjb3BlLnNjYWxlIHx8IDE7XG4gICAgICAgICAgICAvLyRzY29wZS5nYXVnZVNpemUgPSAxNTAgKiBzY2FsZTtcbiAgICAgICAgICAgIC8vJHNjb3BlLmdhdWdlV2lkdGggPSAyNSAqIHNjYWxlO1xuICAgICAgICAgICAgJHNjb3BlLmRvbnV0U2l6ZSA9IDI3NSAqIHNjYWxlO1xuICAgICAgICAgICAgJHNjb3BlLmRvbnV0V2lkdGggPSAyNSAqIHNjYWxlO1xuICAgICAgICAgICAgLy9nYXVnZSA9IGdhdWdlRmFjdG9yeS5jcmVhdGVHYXVnZSgkc2NvcGUudHlwZSwgJ0ZhaWx1cmUgUmF0ZScpXG4gICAgICAgIH07XG5cbiAgICAgICAgLyp2YXIgcmVkcmF3R2F1Z2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoZ2F1Z2UpIHtcbiAgICAgICAgICAgICAgICBnYXVnZS5yZWRyYXcoJHNjb3BlLmRhdGEuZ2F1Z2VEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTsqL1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2RhdGEnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoXy5rZXlzKGRhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vcmVkcmF3R2F1Z2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmRpcmVjdGl2ZSgnYWlzSGVhbHRoJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fpc0hlYWx0aENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NoYXJ0cy9oZWFsdGgvaGVhbHRoVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnPScsXG4gICAgICAgICAgICAgICAgZGF0YTogJz0nLFxuICAgICAgICAgICAgICAgIHNjYWxlOiAnPScsXG4gICAgICAgICAgICAgICAgZXJyb3JMYWJlbDogJz0nLFxuICAgICAgICAgICAgICAgIHR5cGU6ICc9J1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignYWlzSm9iTG9hZENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCBzY2FsZUNvbmZpZywgc2NhbGVTZXJ2aWNlLCBsb2FkU2VydmljZSkge1xuICAgICAgICB2YXIgY2hhcnQgPSBudWxsLFxuICAgICAgICAgICAgY29sQXJyID0gW10sXG4gICAgICAgICAgICB4QXJyID0gW10sXG4gICAgICAgICAgICBwZW5kaW5nQXJyID0gW10sXG4gICAgICAgICAgICBxdWV1ZWRBcnIgPSBbXSxcbiAgICAgICAgICAgIHJ1bm5pbmdBcnIgPSBbXSxcbiAgICAgICAgICAgIHJlbW92ZUlkcyA9IFtdLFxuICAgICAgICAgICAgbGVnZW5kSGlkZSA9IFtdO1xuXG4gICAgICAgICRzY29wZS5maWx0ZXJWYWx1ZSA9IDE7XG4gICAgICAgICRzY29wZS5maWx0ZXJEdXJhdGlvbiA9ICd3JztcbiAgICAgICAgJHNjb3BlLmZpbHRlckR1cmF0aW9ucyA9IFsnTScsICd3JywgJ2QnXTtcbiAgICAgICAgJHNjb3BlLnpvb21FbmFibGVkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS56b29tQ2xhc3MgPSAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAkc2NvcGUuem9vbVRleHQgPSAnRW5hYmxlIFpvb20nO1xuICAgICAgICAkc2NvcGUuam9iTG9hZERhdGEgPSB7fTtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmdKb2JMb2FkID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmpvYkxvYWRFcnJvciA9IG51bGw7XG4gICAgICAgICRzY29wZS5qb2JMb2FkRXJyb3JTdGF0dXMgPSBudWxsO1xuICAgICAgICAkc2NvcGUudG90YWwgPSAwO1xuICAgICAgICAkc2NvcGUuY2hhcnRTdHlsZSA9ICcnO1xuXG4gICAgICAgIHZhciBqb2JMb2FkUGFyYW1zID0ge1xuICAgICAgICAgICAgc3RhcnRlZDogbW9tZW50LnV0YygpLnN1YnRyYWN0KCRzY29wZS5maWx0ZXJWYWx1ZSwgJHNjb3BlLmZpbHRlckR1cmF0aW9uKS5zdGFydE9mKCdkJykudG9EYXRlKCksIGVuZGVkOiBtb21lbnQudXRjKCkuZW5kT2YoJ2QnKS50b0RhdGUoKSwgam9iX3R5cGVfaWQ6IG51bGwsIGpvYl90eXBlX25hbWU6IG51bGwsIGpvYl90eXBlX2NhdGVnb3J5OiBudWxsLCB1cmw6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudG9nZ2xlWm9vbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS56b29tRW5hYmxlZCA9ICEkc2NvcGUuem9vbUVuYWJsZWQ7XG4gICAgICAgICAgICBjaGFydC56b29tLmVuYWJsZSgkc2NvcGUuem9vbUVuYWJsZWQpO1xuICAgICAgICAgICAgaWYgKCRzY29wZS56b29tRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICRzY29wZS56b29tQ2xhc3MgPSAnYnRuLXByaW1hcnknO1xuICAgICAgICAgICAgICAgICRzY29wZS56b29tVGV4dCA9ICdEaXNhYmxlIFpvb20nO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuem9vbUNsYXNzID0gJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgICAgICAgICAkc2NvcGUuem9vbVRleHQgPSAnRW5hYmxlIFpvb20nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0Q2hhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb2xBcnIgPSBbXTtcbiAgICAgICAgICAgIHhBcnIgPSBbXTtcbiAgICAgICAgICAgIHBlbmRpbmdBcnIgPSBbXTtcbiAgICAgICAgICAgIHF1ZXVlZEFyciA9IFtdO1xuICAgICAgICAgICAgcnVubmluZ0FyciA9IFtdO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgLy8geCBheGlzIHZhbHVlc1xuICAgICAgICAgICAgdmFyIG51bUhvdXJzID0gbW9tZW50LnV0Yyhqb2JMb2FkUGFyYW1zLmVuZGVkKS5kaWZmKG1vbWVudC51dGMoam9iTG9hZFBhcmFtcy5zdGFydGVkKSwgJ2gnKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtSG91cnM7IGkrKykge1xuICAgICAgICAgICAgICAgIHhBcnIucHVzaChtb21lbnQudXRjKGpvYkxvYWRQYXJhbXMuc3RhcnRlZCkuYWRkKGksICdoJykuc3RhcnRPZignaCcpLnRvRGF0ZSgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGF0YSB2YWx1ZXNcbiAgICAgICAgICAgIF8uZm9yRWFjaCh4QXJyLCBmdW5jdGlvbiAoeERhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YU9iaiA9IF8uZmluZCgkc2NvcGUuam9iTG9hZERhdGEucmVzdWx0cywgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudC51dGMoZC50aW1lKS5zdGFydE9mKCdoJykuaXNTYW1lKHhEYXRlLCAnaG91cicpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIHB1c2ggMCBpZiBkYXRhIGZvciB4RGF0ZSBpcyBub3QgcHJlc2VudCBpbiBxdWVyeURhdGVzXG4gICAgICAgICAgICAgICAgcGVuZGluZ0Fyci5wdXNoKGRhdGFPYmogPyBkYXRhT2JqLnBlbmRpbmdfY291bnQgOiAwKTtcbiAgICAgICAgICAgICAgICBxdWV1ZWRBcnIucHVzaChkYXRhT2JqID8gZGF0YU9iai5xdWV1ZWRfY291bnQgOiAwKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nQXJyLnB1c2goZGF0YU9iaiA/IGRhdGFPYmoucnVubmluZ19jb3VudCA6IDApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHhBcnIudW5zaGlmdCgneCcpO1xuICAgICAgICAgICAgcGVuZGluZ0Fyci51bnNoaWZ0KCdQZW5kaW5nJyk7XG4gICAgICAgICAgICBxdWV1ZWRBcnIudW5zaGlmdCgnUXVldWVkJyk7XG4gICAgICAgICAgICBydW5uaW5nQXJyLnVuc2hpZnQoJ1J1bm5pbmcnKTtcbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHhBcnIgPSBfLnBsdWNrKCRzY29wZS5qb2JMb2FkRGF0YS5yZXN1bHRzLCAndGltZScpO1xuICAgICAgICAgICAgXy5mb3JFYWNoKHhBcnIsIGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgICAgICAgICAgeEFycltpXSA9IG1vbWVudC51dGMoZCkudG9EYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHhBcnIudW5zaGlmdCgneCcpO1xuXG4gICAgICAgICAgICB2YXIgcGVuZGluZ0FyciA9IF8ucGx1Y2soJHNjb3BlLmpvYkxvYWREYXRhLnJlc3VsdHMsICdwZW5kaW5nX2NvdW50JyksXG4gICAgICAgICAgICAgICAgcXVldWVkQXJyID0gXy5wbHVjaygkc2NvcGUuam9iTG9hZERhdGEucmVzdWx0cywgJ3F1ZXVlZF9jb3VudCcpLFxuICAgICAgICAgICAgICAgIHJ1bm5pbmdBcnIgPSBfLnBsdWNrKCRzY29wZS5qb2JMb2FkRGF0YS5yZXN1bHRzLCAncnVubmluZ19jb3VudCcpO1xuXG4gICAgICAgICAgICBwZW5kaW5nQXJyLnVuc2hpZnQoJ1BlbmRpbmcnKTtcbiAgICAgICAgICAgIHF1ZXVlZEFyci51bnNoaWZ0KCdRdWV1ZWQnKTtcbiAgICAgICAgICAgIHJ1bm5pbmdBcnIudW5zaGlmdCgnUnVubmluZycpO1xuXG4gICAgICAgICAgICAvLyBhZGQgdG8gY29sQXJyXG4gICAgICAgICAgICBjb2xBcnIgPSBbeEFyciwgcGVuZGluZ0FyciwgcXVldWVkQXJyLCBydW5uaW5nQXJyXTtcblxuICAgICAgICAgICAgdmFyIHR5cGVzID0ge30sXG4gICAgICAgICAgICAgICAgdHlwZSA9IHt9LFxuICAgICAgICAgICAgICAgIGdyb3VwcyA9IFtdO1xuXG4gICAgICAgICAgICBfLmZvckVhY2goY29sQXJyLCBmdW5jdGlvbihjb2wpe1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2xbMF0gIT09ICd4Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZVtjb2xbMF1dID0gJ2FyZWEnO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzLnB1c2goY29sWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHR5cGVzLCB0eXBlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvL2lmIChjaGFydCkge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgY2hhcnQuZ3JvdXBzKFtncm91cHNdKTtcbiAgICAgICAgICAgICAgICBjaGFydC5sb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogY29sQXJyLFxuICAgICAgICAgICAgICAgICAgICB0eXBlczogdHlwZXMsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgIGNoYXJ0LmZsb3coe1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBjb2xBcnJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLy99IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGNoYXJ0KSB7XG4gICAgICAgICAgICAgICAgY2hhcnQuZmx1c2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBjaGFydCBjb25maWdcbiAgICAgICAgICAgICAgICBjaGFydCA9IGMzLmdlbmVyYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgYmluZHRvOiAnI2pvYi1sb2FkJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogJ3gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uczogY29sQXJyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXM6IHR5cGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzOiBbZ3JvdXBzXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBlbmRpbmc6IHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9waW5rLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFF1ZXVlZDogc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X3B1cnBsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSdW5uaW5nOiBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfYmx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogNzAwXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRvb2x0aXA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50LnV0Yyh4KS5zdGFydE9mKCdoJykuZm9ybWF0KHNjYWxlQ29uZmlnLmRhdGVGb3JtYXRzLmRheV9zZWNvbmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYXhpczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0aW1lc2VyaWVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQudXRjKGQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL31cbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nSm9iTG9hZCA9IGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JMb2FkID0gZnVuY3Rpb24gKHNob3dQYWdlTG9hZCkge1xuICAgICAgICAgICAgaWYgKHNob3dQYWdlTG9hZCkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kcGFyZW50LmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZ0pvYkxvYWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgam9iTG9hZFBhcmFtcy5zdGFydGVkID0gbW9tZW50LnV0YygpLnN1YnRyYWN0KCRzY29wZS5maWx0ZXJWYWx1ZSwgJHNjb3BlLmZpbHRlckR1cmF0aW9uKS5zdGFydE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICAgICBqb2JMb2FkUGFyYW1zLmVuZGVkID0gbW9tZW50LnV0Yyhqb2JMb2FkUGFyYW1zLnN0YXJ0ZWQpLmFkZCgxLCAkc2NvcGUuZmlsdGVyRHVyYXRpb24pLmVuZE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICAgICBqb2JMb2FkUGFyYW1zLnBhZ2Vfc2l6ZSA9IDEwMDA7XG5cbiAgICAgICAgICAgIGxvYWRTZXJ2aWNlLmdldEpvYkxvYWQoam9iTG9hZFBhcmFtcykudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkxvYWREYXRhID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICBpbml0Q2hhcnQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1c1RleHQgJiYgcmVzdWx0LnN0YXR1c1RleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iTG9hZEVycm9yU3RhdHVzID0gcmVzdWx0LnN0YXR1c1RleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkxvYWRFcnJvciA9ICdVbmFibGUgdG8gcmV0cmlldmUgam9iIGxvYWQuJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNob3dQYWdlTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJHBhcmVudC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdKb2JMb2FkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnVwZGF0ZUpvYkxvYWRSYW5nZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdvbGRlcicpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyVmFsdWUrKztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnbmV3ZXInKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5maWx0ZXJWYWx1ZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclZhbHVlLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICd0b2RheScpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyVmFsdWUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2V0Sm9iTG9hZCh0cnVlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdmaWx0ZXJWYWx1ZScsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyICRqb2JMb2FkTmV3ZXIgPSAkKCcuam9iLWxvYWQtbmV3ZXInKSxcbiAgICAgICAgICAgICAgICAkam9iTG9hZFRvZGF5ID0gJCgnLmpvYi1sb2FkLXRvZGF5Jyk7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAkam9iTG9hZE5ld2VyLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJGpvYkxvYWRUb2RheS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkam9iTG9hZE5ld2VyLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJGpvYkxvYWRUb2RheS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIGlmICgkc2NvcGUuYXV0b0hlaWdodCkge1xuICAgICAgICAgICAgLy8gc2V0IGNoYXJ0IGhlaWdodFxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgICAgIHZhciB2aWV3cG9ydCA9IHNjYWxlU2VydmljZS5nZXRWaWV3cG9ydFNpemUoKSxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gc2NhbGVDb25maWcuaGVhZGVyT2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJPZmZzZXQgPSAkKCcuam9iLWxvYWQtaGVhZGVyJykuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIGxlZ2VuZE9mZnNldCA9ICQoJy5qb2ItbG9hZC1sZWdlbmQtbGFiZWwnKS5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyT2Zmc2V0ID0gJCgnLmpvYi1sb2FkLWZpbHRlcicpLm91dGVySGVpZ2h0KHRydWUpLFxuICAgICAgICAgICAgICAgICAgICBjaGFydE1heEhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCAtIG9mZnNldCAtIGhlYWRlck9mZnNldCAtIGxlZ2VuZE9mZnNldCAtIGZpbHRlck9mZnNldCAtIDU7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhcnRTdHlsZSA9ICdoZWlnaHQ6ICcgKyBjaGFydE1heEhlaWdodCArICdweDsgbWF4LWhlaWdodDogJyArIGNoYXJ0TWF4SGVpZ2h0ICsgJ3B4Oyc7XG4gICAgICAgICAgICAgICAgZ2V0Sm9iTG9hZCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZXRKb2JMb2FkKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmRpcmVjdGl2ZSgnYWlzSm9iTG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhaXNKb2JMb2FkQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvY2hhcnRzL2pvYkxvYWQvam9iTG9hZFRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgc2hvd0ZpbHRlcjogJz0nLCAvLyBzaG93IHRpbWUgcmFuZ2UgZmlsdGVyIFVJXG4gICAgICAgICAgICAgICAgY3VsbExlZ2VuZDogJz0nLCAvLyBvbmx5IHNob3cgam9iIHR5cGVzIGluIGxlZ2VuZCB3aG9zZSB2YWx1ZSBpcyA+IDBcbiAgICAgICAgICAgICAgICBoaWRlVGl0bGU6ICc9JyxcbiAgICAgICAgICAgICAgICBhdXRvSGVpZ2h0OiAnPSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2Fpc1JhZGlhbFBlcmNlbnRhZ2VDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgc2NhbGVDb25maWcpIHtcbiAgICB2YXIgaXNJbml0aWFsaXplZCA9IGZhbHNlLFxuICAgICAgICBmb3JlZ3JvdW5kID0gJycsXG4gICAgICAgIHRleHQgPSAnJyxcbiAgICAgICAgYXJjVHdlZW4gPSAnJyxcbiAgICAgICAgdGV4dFR3ZWVuID0gJyc7XG5cbiAgICB2YXIgZ2V0Rm9yZWdyb3VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gcGFyc2VGbG9hdCgkc2NvcGUucGVyY2VudGFnZSk7XG4gICAgICAgIGlmICh2YWx1ZSA+PSA3NSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9ncmVlbjtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDc1ICYmIHZhbHVlID49IDUwKSB7XG4gICAgICAgICAgICByZXR1cm4gc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X3llbGxvdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfcmVkO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGhhbmRsZSBpbnB1dCBlaXRoZXIgLjgzIG9yIDgzXG4gICAgICAgIHZhciBwZXJjZW50YWdlID0gJHNjb3BlLnBlcmNlbnRhZ2UgfHwgMDtcbiAgICAgICAgaWYgKHBlcmNlbnRhZ2UgPiAxKSB7XG4gICAgICAgICAgICBwZXJjZW50YWdlIC89IDEwMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNpemUgdGhlIGNoYXJ0IHRvIHRoZSBwYXJlbnQgY29udGFpbmVyLiBJdCdzIHNxdWFyZSwgc28gdGFrZSB0aGVcbiAgICAgICAgLy8gc21hbGxlciBvZiB3aWR0aC9oZWlnaHRcbiAgICAgICAgdmFyIHNpemUgPSAkZWxlbWVudFswXS5wYXJlbnROb2RlLmNsaWVudFdpZHRoO1xuICAgICAgICBpZiAoJGVsZW1lbnRbMF0ucGFyZW50Tm9kZS5jbGllbnRIZWlnaHQgPCBzaXplKSB7XG4gICAgICAgICAgICBzaXplID0gJGVsZW1lbnRbMF0ucGFyZW50Tm9kZS5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHZhciBkdXJhdGlvbiA9IDEwMDA7XG4gICAgICAgIHZhciBmb3JtYXRQZXJjZW50ID0gZDMuZm9ybWF0KCcuMCUnKTtcblxuICAgICAgICB2YXIgYXJjID0gZDMuc3ZnLmFyYygpXG4gICAgICAgICAgICAuc3RhcnRBbmdsZSgwKVxuICAgICAgICAgICAgLm91dGVyUmFkaXVzKHNpemUgKiAwLjk1IC8gMilcbiAgICAgICAgICAgIC5pbm5lclJhZGl1cyhzaXplICogMC44MCAvIDIpO1xuXG4gICAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3QoJGVsZW1lbnRbMF0pLmFwcGVuZCgnc3ZnJykuYXR0cih7XG4gICAgICAgICAgICB3aWR0aDogc2l6ZSxcbiAgICAgICAgICAgIGhlaWdodDogc2l6ZVxuICAgICAgICB9KS5hcHBlbmQoJ2cnKS5hdHRyKHtcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlKCcgKyBzaXplIC8gMiArICcsJyArIHNpemUgLyAyICsgJyknLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2Fpc1JhZGlhbCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIG1ldGVyID0gc3ZnLmFwcGVuZCgnZycpLmF0dHIoe1xuICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdyb3RhdGUoMTgwKSdcbiAgICAgICAgfSk7XG4gICAgICAgIG1ldGVyLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAuZGF0dW0oe1xuICAgICAgICAgICAgICAgIGVuZEFuZ2xlOiAoMiAqIE1hdGguUEkpLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kJylcbiAgICAgICAgICAgIC5hdHRyKCdkJywgYXJjKTtcblxuICAgICAgICBmb3JlZ3JvdW5kID0gbWV0ZXIuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgIC5kYXR1bSh7XG4gICAgICAgICAgICAgICAgZW5kQW5nbGU6IDBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICAgICAgJ2QnOiBhcmNcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEZvcmVncm91bmQoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRleHQgPSBzdmcuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgIC5kYXR1bSh7XG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAgICAgLmF0dHIoJ2R5JywgJy4zNWVtJyk7XG5cblxuICAgICAgICB0ZXh0VHdlZW4gPSBmdW5jdGlvbih0cmFuc2l0aW9uLCBuZXdQZXJjZW50YWdlKSB7XG4gICAgICAgICAgICB0cmFuc2l0aW9uLmF0dHJUd2VlbigndGV4dCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGQgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaSA9IGQzLmludGVycG9sYXRlKGQucGVyY2VudGFnZSwgbmV3UGVyY2VudGFnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5wZXJjZW50YWdlID0gaSh0KTtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC50ZXh0KGZvcm1hdFBlcmNlbnQoaSh0KSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgYXJjVHdlZW4gPSBmdW5jdGlvbih0cmFuc2l0aW9uLCBuZXdBbmdsZSkge1xuICAgICAgICAgICAgdHJhbnNpdGlvbi5hdHRyVHdlZW4oJ2QnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSBkMy5pbnRlcnBvbGF0ZShkLmVuZEFuZ2xlLCBuZXdBbmdsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5lbmRBbmdsZSA9IGkodCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmMoZCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgICAgIHJlZHJhdyhwZXJjZW50YWdlKTtcblxuICAgICAgICAvLyBnZXQgcHJvZ3Jlc3MuLi5cblxuICAgICAgICAvL2ZvcmVncm91bmQuYXR0cignZCcsIGFyYy5lbmRBbmdsZSgoTWF0aC5QSSAqIDIpICogMC44MykpO1xuICAgICAgICAvL3RleHQudGV4dChmb3JtYXRQZXJjZW50KHBlcmNlbnRhZ2UpKTtcbiAgICB9O1xuXG4gICAgdmFyIHJlZHJhdyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoaXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChwZXJjZW50YWdlID4gMSkge1xuICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2UgLz0gMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnU2V0dGluZyBwZXJjZW50YWdlIHRvOiAnICsgcGVyY2VudGFnZSk7XG5cbiAgICAgICAgICAgIC8vZm9yZWdyb3VuZC50cmFuc2l0aW9uKCkuZHVyYXRpb24oNTAwMCkuYXR0cignZCcsIGFyYyk7XG4gICAgICAgICAgICBmb3JlZ3JvdW5kLnRyYW5zaXRpb24oKS5kdXJhdGlvbigxMDAwKVxuICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEZvcmVncm91bmQoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYWxsKGFyY1R3ZWVuLCAoTWF0aC5QSSAqIDIpICogcGVyY2VudGFnZSk7XG4gICAgICAgICAgICAvL3RleHQudGV4dChmb3JtYXRQZXJjZW50KHBlcmNlbnRhZ2UpKTtcbiAgICAgICAgICAgIHRleHQudHJhbnNpdGlvbigpLmR1cmF0aW9uKDEwMDApLmNhbGwodGV4dFR3ZWVuLCBwZXJjZW50YWdlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUuJHdhdGNoKCdwZXJjZW50YWdlJywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmICFpc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICBpbml0aWFsaXplKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWRyYXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfSlcbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5kaXJlY3RpdmUoJ2Fpc1JhZGlhbFBlcmNlbnRhZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29udHJvbGxlcjogJ2Fpc1JhZGlhbFBlcmNlbnRhZ2VDb250cm9sbGVyJyxcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHBlcmNlbnRhZ2U6ICdAJ1xuICAgICAgICB9XG4gICAgfTtcbn0pO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdhaXNUaW1lbGluZURpcmVjdGl2ZUNvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgc2NhbGVDb25maWcpIHtcblxuICAgICAgICB2YXIgZ2FudHQgPSBudWxsO1xuXG4gICAgICAgICRlbGVtZW50WzBdLm9ucmVzaXplID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbGVtZW50IHJlc2l6ZScpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCd0YXNrcycsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRyYXdUaW1lbGluZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRyYXdUaW1lbGluZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZigkc2NvcGUudGFza3MgJiYgJHNjb3BlLnRhc2tzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICRzY29wZS50YXNrcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFbJHNjb3BlLmVuZGVkXSAtIGJbJHNjb3BlLmVuZGVkXTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICRzY29wZS50YXNrTmFtZXMgPSBfKCRzY29wZS50YXNrcykucGx1Y2soJ3Rhc2tOYW1lJykudW5pcSgpLnZhbHVlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9ICRzY29wZS50YXNrTmFtZXMubGVuZ3RoICogMzAgKyAyMDtcblxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9ICRlbGVtZW50WzBdLmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgICAgIGlmICghd2lkdGggfHwgd2lkdGggPT09IDApIHsgd2lkdGggPSA2MDA7IH1cblxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRhc2tzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVskc2NvcGUuc3RhcnRlZF0gLSBiWyRzY29wZS5zdGFydGVkXTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgbWluRGF0ZSA9ICRzY29wZS50YXNrc1swXVskc2NvcGUuc3RhcnRlZF07XG4gICAgICAgICAgICAgICAgdmFyIG1heERhdGUgPSAkc2NvcGUudGFza3NbJHNjb3BlLnRhc2tzLmxlbmd0aCAtIDFdWyRzY29wZS5lbmRlZF07XG4gICAgICAgICAgICAgICAgdmFyIGRheXNEaWZmID0gbW9tZW50LnV0YyhtYXhEYXRlKS5kaWZmKG1vbWVudC51dGMobWluRGF0ZSksJ2RheXMnKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0ID0gJyVIOiVNOiVTLiVtJztcbiAgICAgICAgICAgICAgICBpZihkYXlzRGlmZiA+IDApe1xuICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSBcIiVtLyVkLyV5ICVIOiVNXCI7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZ2FudHQgPSBkMy5nYW50dCgpLnJlbmRlclRvKFwiI2Fpcy10aW1lbGluZVwiKS50YXNrVHlwZXMoJHNjb3BlLnRhc2tOYW1lcykudGFza1N0YXR1cyhzY2FsZUNvbmZpZy50YXNrU3RhdHVzU3R5bGVzKS50aWNrRm9ybWF0KGZvcm1hdCkuYmVnaW4oJHNjb3BlLnN0YXJ0ZWQpLmVuZGVkKCRzY29wZS5lbmRlZCkuaGVpZ2h0KGhlaWdodCkud2lkdGgod2lkdGgpO1xuXG4gICAgICAgICAgICAgICAgZ2FudHQudGltZURvbWFpbk1vZGUoXCJmaXRcIik7XG5cbiAgICAgICAgICAgICAgICBnYW50dCgkc2NvcGUudGFza3MpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0ZW5kKCkge1xuICAgICAgICAgICAgdmFyIGxhc3RlbmQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgaWYgKCRzY29wZS50YXNrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbGFzdGVuZCA9ICRzY29wZS50YXNrc1skc2NvcGUudGFza3MubGVuZ3RoIC0gMV1bJHNjb3BlLmVuZGVkXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGxhc3RlbmQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmZvcm1hdERhdGUgPSBmdW5jdGlvbihkYXRlKXtcbiAgICAgICAgICAgIGlmKGRhdGUpe1xuICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQudXRjKGRhdGUpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgfSkuZGlyZWN0aXZlKCdhaXNUaW1lbGluZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhaXNUaW1lbGluZURpcmVjdGl2ZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2NoYXJ0cy90aW1lbGluZS90aW1lbGluZURpcmVjdGl2ZVRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgdGFza3M6ICc9JyxcbiAgICAgICAgICAgICAgICBzdGFydGVkOiAnPScsXG4gICAgICAgICAgICAgICAgZW5kZWQ6ICc9J1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdhZG1pbkxvZ2luQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkdGltZW91dCwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCB1c2VyU2VydmljZSkge1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckNyZWRzKCk7XG4gICAgICAgICAgICBpZighJHJvb3RTY29wZS51c2VyKXtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSB1c2VyU2VydmljZS5sb2dpbignYWRtaW4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coJHJvb3RTY29wZS51c2VyKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBBbnkgY29kZSBpbiBoZXJlIHdpbGwgYXV0b21hdGljYWxseSBoYXZlIGFuICRzY29wZS5hcHBseSgpIHJ1biBhZnRlcndhcmRzXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2xvZ291dENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHRpbWVvdXQsICRyb290U2NvcGUsICRsb2NhdGlvbiwgdXNlclNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHVzZXJTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAvLyBBbnkgY29kZSBpbiBoZXJlIHdpbGwgYXV0b21hdGljYWxseSBoYXZlIGFuICRzY29wZS5hcHBseSgpIHJ1biBhZnRlcndhcmRzXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2ZlZWREZXRhaWxzQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBzY2FsZUNvbmZpZywgbmF2U2VydmljZSwgc3VibmF2U2VydmljZSwgZmVlZFNlcnZpY2UsIG1vbWVudCkge1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICRzY29wZS5mZWVkRGF0YSA9IHt9O1xuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5mZWVkO1xuICAgICAgICAkc2NvcGUudXNlSW5nZXN0VGltZSA9ICdmYWxzZSc7XG4gICAgICAgICRzY29wZS5maWx0ZXJWYWx1ZSA9IDE7XG4gICAgICAgICRzY29wZS5maWx0ZXJEdXJhdGlvbiA9ICd3JztcblxuICAgICAgICAkc2NvcGUuY2hhbmdlRmVlZFNlbGVjdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZXRGZWVkVXJsKCk7XG4gICAgICAgICAgICAvL2dldEZlZWQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hhbmdlSW5nZXN0VGltZVNlbGVjdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzZXRGZWVkVXJsKCk7XG4gICAgICAgICAgICBnZXRGZWVkKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldEZlZWRQYXJhbXMgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgdmFyIHN0cmlrZUlkID0gJHNjb3BlLnNlbGVjdGVkRmVlZCA/ICRzY29wZS5zZWxlY3RlZEZlZWQuc3RyaWtlLmlkIDogbnVsbDtcbiAgICAgICAgICAgIHZhciB1c2VJbmdlc3RUaW1lID0gJHNjb3BlLnVzZUluZ2VzdFRpbWUgPyAkc2NvcGUudXNlSW5nZXN0VGltZSA6IG51bGw7XG5cbiAgICAgICAgICAgIHBhcmFtcy5zdGFydGVkID0gbW9tZW50LnV0YygpLnN1YnRyYWN0KCRzY29wZS5maWx0ZXJWYWx1ZSwgJHNjb3BlLmZpbHRlckR1cmF0aW9uKS5zdGFydE9mKCdkJykudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIHBhcmFtcy5lbmRlZCA9IG1vbWVudC51dGMocGFyYW1zLnN0YXJ0ZWQpLmFkZCgxLCAkc2NvcGUuZmlsdGVyRHVyYXRpb24pLmVuZE9mKCdkJykudG9JU09TdHJpbmcoKTtcblxuICAgICAgICAgICAgaWYgKHN0cmlrZUlkICE9ICRsb2NhdGlvbi5zZWFyY2goKS5zdHJpa2VfaWQpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMuc3RyaWtlX2lkID0gc3RyaWtlSWQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5zdHJpa2VfaWQpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMuc3RyaWtlX2lkID0gJGxvY2F0aW9uLnNlYXJjaCgpLnN0cmlrZV9pZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHVzZUluZ2VzdFRpbWUgIT0gJGxvY2F0aW9uLnNlYXJjaCgpLnVzZV9pbmdlc3RfdGltZSkge1xuICAgICAgICAgICAgICAgcGFyYW1zLnVzZV9pbmdlc3RfdGltZSA9IHVzZUluZ2VzdFRpbWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS51c2VfaW5nZXN0X3RpbWUpIHtcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRGZWVkUGFyYW1zIHVzZV9pbmdlc3RfdGltZTogJyArICRsb2NhdGlvbi5zZWFyY2goKS51c2VfaW5nZXN0X3RpbWUpO1xuICAgICAgICAgICAgICAgcGFyYW1zLnVzZV9pbmdlc3RfdGltZSA9ICRsb2NhdGlvbi5zZWFyY2goKS51c2VfaW5nZXN0X3RpbWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldEZlZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoJGxvY2F0aW9uLnNlYXJjaCgpLnVzZV9pbmdlc3RfdGltZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VJbmdlc3RUaW1lID0gJGxvY2F0aW9uLnNlYXJjaCgpLnVzZV9pbmdlc3RfdGltZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmZWVkUGFyYW1zID0gZ2V0RmVlZFBhcmFtcygpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaChmZWVkUGFyYW1zKTtcbiAgICAgICAgICAgIGZlZWRTZXJ2aWNlLmdldEZlZWQoZmVlZFBhcmFtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5hbGxGZWVkcyA9IF8uc29ydEJ5T3JkZXIoZGF0YS5yZXN1bHRzLCBbJ3N0cmlrZS5uYW1lJ10sIFsnYXNjJ10pO1xuICAgICAgICAgICAgICAgIHZhciBzdHJpa2VJZCA9ICRsb2NhdGlvbi5zZWFyY2goKS5zdHJpa2VfaWQ7XG4gICAgICAgICAgICAgICAgaWYoc3RyaWtlSWQpe1xuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgc2VsZWN0ZWRGZWVkID0gbmV3IGZlZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZlZWQgPSBfLmZpbmQoJHNjb3BlLmFsbEZlZWRzLCBmdW5jdGlvbihmZWVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmZWVkLnN0cmlrZS5pZCA9PSBzdHJpa2VJZDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEZlZWQgPSBmZWVkID8gZmVlZCA6IG51bGw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkRmVlZCA9ICRzY29wZS5hbGxGZWVkc1swXTtcbiAgICAgICAgICAgICAgICAgICAgc2V0RmVlZFVybCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnVwZGF0ZUZlZWRSYW5nZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdvbGRlcicpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyVmFsdWUrKztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnbmV3ZXInKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5maWx0ZXJWYWx1ZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclZhbHVlLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICd0b2RheScpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyVmFsdWUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2V0RmVlZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBzZXRGZWVkVXJsID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vIHNldCBwYXJhbSBpbiBVUkxcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBnZXRGZWVkUGFyYW1zKCk7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKHBhcmFtcyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdmZWVkJyk7XG4gICAgICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdmZWVkJyk7XG4gICAgICAgICAgICBnZXRGZWVkKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2ZpbHRlclZhbHVlJywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgJGZlZWROZXdlciA9ICQoJy5mZWVkLW5ld2VyJyksXG4gICAgICAgICAgICAgICAgJGZlZWRUb2RheSA9ICQoJy5mZWVkLXRvZGF5Jyk7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IDEpIHtcbiAgICAgICAgICAgICAgICAkZmVlZE5ld2VyLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJGZlZWRUb2RheS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkZmVlZE5ld2VyLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJGZlZWRUb2RheS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2luZ2VzdFJlY29yZHNDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sIHNjYWxlQ29uZmlnLCBzY2FsZVNlcnZpY2UsIGdyaWRGYWN0b3J5LCBuYXZTZXJ2aWNlLCBzdWJuYXZTZXJ2aWNlLCBmZWVkU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5mZWVkO1xuXG4gICAgICAgIHZhciBncmlkUGFyYW1zID0ge1xuICAgICAgICAgICAgcGFnZTogMSwgcGFnZV9zaXplOiAyNSwgc3RhcnRlZDogbnVsbCwgZW5kZWQ6IG51bGwsIG9yZGVyOiAnLXRyYW5zZmVyX3N0YXJ0ZWQnLCBzdGF0dXM6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBjaGVjayBmb3IgZ3JpZFBhcmFtcyBpbiBxdWVyeSBzdHJpbmcsIGFuZCB1cGRhdGUgYXMgbmVjZXNzYXJ5XG4gICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKGdyaWRQYXJhbXMpLCBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IF8uYXQoJGxvY2F0aW9uLnNlYXJjaCgpLCBwYXJhbVswXSk7XG4gICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGdyaWRQYXJhbXNbcGFyYW1bMF1dID0gdmFsdWUubGVuZ3RoID4gMSA/IHZhbHVlIDogdmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBmaWx0ZXJlZEJ5U3RhdHVzID0gZ3JpZFBhcmFtcy5zdGF0dXMgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBmaWx0ZXJlZEJ5T3JkZXIgPSBncmlkUGFyYW1zLm9yZGVyID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RhcnQgPSBncmlkUGFyYW1zLnN0YXJ0ZWQgPyBtb21lbnQudXRjKGdyaWRQYXJhbXMuc3RhcnRlZCkudG9EYXRlKCkgOiBtb21lbnQudXRjKCkuc3VidHJhY3QoMSwgJ3dlZWtzJykuc3RhcnRPZignZCcpLnRvRGF0ZSgpO1xuXG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdGFydFBvcHVwID0ge1xuICAgICAgICAgICAgb3BlbmVkOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUub3Blbkxhc3RNb2RpZmllZFN0YXJ0UG9wdXAgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RhcnRQb3B1cC5vcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RvcCA9IGdyaWRQYXJhbXMuZW5kZWQgPyBtb21lbnQudXRjKGdyaWRQYXJhbXMuZW5kZWQpLnRvRGF0ZSgpIDogbW9tZW50LnV0YygpLmVuZE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdG9wUG9wdXAgPSB7XG4gICAgICAgICAgICBvcGVuZWQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vcGVuTGFzdE1vZGlmaWVkU3RvcFBvcHVwID0gZnVuY3Rpb24gKCRldmVudCkge1xuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgJHNjb3BlLmxhc3RNb2RpZmllZFN0b3BQb3B1cC5vcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZGF0ZU1vZGVsT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHRpbWV6b25lOiAnKzAwMCdcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc3RhdHVzVmFsdWVzID0gc2NhbGVDb25maWcuaW5nZXN0U3RhdHVzO1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRTdGF0dXMgPSBncmlkUGFyYW1zLnN0YXR1cyB8fCAkc2NvcGUuc3RhdHVzVmFsdWVzWzBdO1xuICAgICAgICAkc2NvcGUuJHdhdGNoKCdzZWxlY3RlZFN0YXR1cycsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkQnlTdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3RhdHVzKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkQnlTdGF0dXMgPSB2YWx1ZSAhPT0gJ1ZJRVcgQUxMJztcbiAgICAgICAgICAgICAgICB1cGRhdGVTdGF0dXModmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdsYXN0TW9kaWZpZWRTdGFydCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIGdyaWRQYXJhbXMuc3RhcnRlZCA9IHZhbHVlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnbGFzdE1vZGlmaWVkU3RvcCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBncmlkUGFyYW1zLmVuZGVkID0gdmFsdWUudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIHZhciB1cGRhdGVTdGF0dXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSBncmlkUGFyYW1zLnN0YXR1cykge1xuICAgICAgICAgICAgICAgIGdyaWRQYXJhbXMucGFnZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBncmlkUGFyYW1zLnN0YXR1cyA9IHZhbHVlID09PSAnVklFVyBBTEwnID8gbnVsbCA6IHZhbHVlO1xuICAgICAgICAgICAgZ3JpZFBhcmFtcy5wYWdlX3NpemUgPSAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplO1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJSZXN1bHRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRlZmF1bHRDb2x1bW5EZWZzID0gW1xuICAgICAgICAgICAgeyBmaWVsZDogJ2ZpbGVfbmFtZScsIGRpc3BsYXlOYW1lOiAnRmlsZSBOYW1lJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnZmlsZV9zaXplJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0ZpbGUgU2l6ZScsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+e3sgcm93LmVudGl0eS5maWxlX3NpemVfZm9ybWF0dGVkIH19PC9kaXY+J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ3N0cmlrZS5pZCcsXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdTdHJpa2UgUHJvY2VzcycsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+e3sgcm93LmVudGl0eS5zdHJpa2UuaWQgfX08L2Rpdj4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnc3RhdHVzJyxcbiAgICAgICAgICAgICAgICBmaWx0ZXJIZWFkZXJUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWZpbHRlci1jb250YWluZXJcIj48c2VsZWN0IGNsYXNzPVwiZm9ybS1jb250cm9sIGlucHV0LXNtXCIgbmctbW9kZWw9XCJncmlkLmFwcFNjb3BlLnNlbGVjdGVkU3RhdHVzXCI+PG9wdGlvbiBuZy1zZWxlY3RlZD1cInt7IGdyaWQuYXBwU2NvcGUuc3RhdHVzVmFsdWVzWyRpbmRleF0gPT0gZ3JpZC5hcHBTY29wZS5zZWxlY3RlZFN0YXR1cyB9fVwiIHZhbHVlPVwie3sgZ3JpZC5hcHBTY29wZS5zdGF0dXNWYWx1ZXNbJGluZGV4XSB9fVwiIG5nLXJlcGVhdD1cInN0YXR1cyBpbiBncmlkLmFwcFNjb3BlLnN0YXR1c1ZhbHVlcyB0cmFjayBieSAkaW5kZXhcIj57eyBzdGF0dXMudG9VcHBlckNhc2UoKSB9fTwvb3B0aW9uPjwvc2VsZWN0PjwvZGl2PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICd0cmFuc2Zlcl9zdGFydGVkJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5LnRyYW5zZmVyX3N0YXJ0ZWRfZm9ybWF0dGVkIH19PC9kaXY+J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ3RyYW5zZmVyX2VuZGVkJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5LnRyYW5zZmVyX2VuZGVkX2Zvcm1hdHRlZCB9fTwvZGl2PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICdpbmdlc3Rfc3RhcnRlZCcsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+e3sgcm93LmVudGl0eS5pbmdlc3Rfc3RhcnRlZF9mb3JtYXR0ZWQgfX08L2Rpdj4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnaW5nZXN0X2VuZGVkJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5LmluZ2VzdF9lbmRlZF9mb3JtYXR0ZWQgfX08L2Rpdj4nXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zID0gZ3JpZEZhY3RvcnkuZGVmYXVsdEdyaWRPcHRpb25zKCk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uQ3VycmVudFBhZ2UgPSBwYXJzZUludChncmlkUGFyYW1zLnBhZ2UgfHwgMSk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemUgPSBwYXJzZUludChncmlkUGFyYW1zLnBhZ2Vfc2l6ZSkgfHwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZTtcbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmNvbHVtbkRlZnMgPSBncmlkRmFjdG9yeS5hcHBseVNvcnRDb25maWcoZGVmYXVsdENvbHVtbkRlZnMsIGdyaWRQYXJhbXMpO1xuICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IFtdO1xuICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMub25SZWdpc3RlckFwaSA9IGZ1bmN0aW9uIChncmlkQXBpKSB7XG4gICAgICAgICAgICAgICAgLy9zZXQgZ3JpZEFwaSBvbiBzY29wZVxuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkQXBpID0gZ3JpZEFwaTtcbiAgICAgICAgICAgICAgICAvLyAkc2NvcGUuZ3JpZEFwaS5zZWxlY3Rpb24ub24ucm93U2VsZWN0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKCRzY29wZS5hY3Rpb25DbGlja2VkKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAkc2NvcGUuYWN0aW9uQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvZmVlZC9pbmdlc3RzLycgKyByb3cuZW50aXR5LmlkKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaS5wYWdpbmF0aW9uLm9uLnBhZ2luYXRpb25DaGFuZ2VkKCRzY29wZSwgZnVuY3Rpb24gKGN1cnJlbnRQYWdlLCBwYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBncmlkUGFyYW1zLnBhZ2UgPSBjdXJyZW50UGFnZTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZFBhcmFtcy5wYWdlX3NpemUgPSBwYWdlU2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dyaWRBcGkucGFnaW5hdGlvbkNoYW5nZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaS5jb3JlLm9uLnNvcnRDaGFuZ2VkKCRzY29wZSwgZnVuY3Rpb24gKGdyaWQsIHNvcnRDb2x1bW5zKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY29sRGVmcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUuZ3JpZEFwaS5ncmlkLmNvbHVtbnMsIGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5jb2xEZWYuc29ydCA9IGNvbC5zb3J0O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jb2xEZWZzID0gJHNjb3BlLmdyaWRBcGkuZ3JpZC5vcHRpb25zLmNvbHVtbkRlZnM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3J0QXJyID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChzb3J0Q29sdW1ucywgZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc29ydEFyci5wdXNoKGNvbC5zb3J0LmRpcmVjdGlvbiA9PT0gJ2Rlc2MnID8gJy0nICsgY29sLmZpZWxkIDogY29sLmZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yZGVyKHNvcnRBcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKGdyaWRQYXJhbXMpLCBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKHBhcmFtWzBdLCBwYXJhbVsxXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGdldEluZ2VzdHMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgdXBkYXRlT3JkZXIgPSBmdW5jdGlvbiAoc29ydEFycikge1xuICAgICAgICAgICAgZ3JpZFBhcmFtcy5vcmRlciA9IHNvcnRBcnIubGVuZ3RoID4gMCA/IHNvcnRBcnIgOiBudWxsO1xuICAgICAgICAgICAgZmlsdGVyZWRCeU9yZGVyID0gc29ydEFyci5sZW5ndGggPiAwO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0SW5nZXN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGZlZWRTZXJ2aWNlLmdldEluZ2VzdHNPbmNlKGdyaWRQYXJhbXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5nZXN0cyA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMudG90YWxJdGVtcyA9IGRhdGEuY291bnQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSAkc2NvcGUuaW5nZXN0cztcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdmZWVkJyk7XG4gICAgICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdmZWVkL2luZ2VzdHMnKTtcbiAgICAgICAgICAgIGlmICghZ3JpZFBhcmFtcy5zdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xhc3RNb2RpZmllZFN0YXJ0OiAnICsgJHNjb3BlLmxhc3RNb2RpZmllZFN0YXJ0KTtcbiAgICAgICAgICAgICAgICBncmlkUGFyYW1zLnN0YXJ0ZWQgPSBtb21lbnQudXRjKCRzY29wZS5sYXN0TW9kaWZpZWRTdGFydCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdzdGFydGVkJywgZ3JpZFBhcmFtcy5zdGFydGVkKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdyaWRQYXJhbXMuZW5kZWQpIHtcbiAgICAgICAgICAgICAgICBncmlkUGFyYW1zLmVuZGVkID0gbW9tZW50LnV0Yygkc2NvcGUubGFzdE1vZGlmaWVkU3RvcCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdlbmRlZCcsIGdyaWRQYXJhbXMuZW5kZWQpLnJlcGxhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdldEluZ2VzdHMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG5cbiAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBzZXQgY29udGFpbmVyIGhlaWdodHMgZXF1YWwgdG8gYXZhaWxhYmxlIHBhZ2UgaGVpZ2h0XG4gICAgICAgICAgICB2YXIgdmlld3BvcnQgPSBzY2FsZVNlcnZpY2UuZ2V0Vmlld3BvcnRTaXplKCksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gc2NhbGVDb25maWcuaGVhZGVyT2Zmc2V0ICsgc2NhbGVDb25maWcuZm9vdGVyT2Zmc2V0ICsgc2NhbGVDb25maWcuZGF0ZUZpbHRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBncmlkTWF4SGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0IC0gb2Zmc2V0O1xuXG4gICAgICAgICAgICAkc2NvcGUuZ3JpZFN0eWxlID0gJ2hlaWdodDogJyArIGdyaWRNYXhIZWlnaHQgKyAncHg7IG1heC1oZWlnaHQ6ICcgKyBncmlkTWF4SGVpZ2h0ICsgJ3B4OyBvdmVyZmxvdy15OiBhdXRvOyc7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnRmVlZCcsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZykge1xuICAgICAgICB2YXIgRmVlZCA9IGZ1bmN0aW9uICh2YWx1ZSwgc3RhdHVzKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBGZWVkLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGZWVkJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsVGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldENlbGxUaXRsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgRmVlZC5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmVlZChcbiAgICAgICAgICAgICAgICAgICAgZGF0YS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0dXNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGZWVkKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgRmVlZC50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChGZWVkLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEZlZWQuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEZlZWQ7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdGZWVkU3RhdHVzJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnKSB7XG4gICAgICAgIHZhciBGZWVkU3RhdHVzID0gZnVuY3Rpb24gKHN0YXR1cykge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgRmVlZFN0YXR1cy5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnRmVlZFN0YXR1cyc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEZpbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X2dyZWVuO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldENlbGxBY3Rpdml0eTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsQWN0aXZpdHlUb3RhbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsRXJyb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbFRvdGFsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBGZWVkU3RhdHVzLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGZWVkU3RhdHVzKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXR1c1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZlZWRTdGF0dXMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBGZWVkU3RhdHVzLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKEZlZWRTdGF0dXMuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRmVlZFN0YXR1cy5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gRmVlZFN0YXR1cztcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ0luZ2VzdCcsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgc2NhbGVTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBJbmdlc3QgPSBmdW5jdGlvbiAoaWQsIGZpbGVfbmFtZSwgc3RyaWtlLCBzdGF0dXMsIGJ5dGVzX3RyYW5zZmVycmVkLCB0cmFuc2Zlcl9zdGFydGVkLCB0cmFuc2Zlcl9lbmRlZCwgbWVkaWFfdHlwZSwgZmlsZV9zaXplLCBkYXRhX3R5cGUsIGluZ2VzdF9zdGFydGVkLCBpbmdlc3RfZW5kZWQsIHNvdXJjZV9maWxlLCBjcmVhdGVkLCBsYXN0X21vZGlmaWVkKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLmZpbGVfbmFtZSA9IGZpbGVfbmFtZTtcbiAgICAgICAgICAgIHRoaXMuc3RyaWtlID0gc3RyaWtlO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgICAgICB0aGlzLmJ5dGVzX3RyYW5zZmVycmVkID0gYnl0ZXNfdHJhbnNmZXJyZWQ7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZmVyX3N0YXJ0ZWQgPSB0cmFuc2Zlcl9zdGFydGVkO1xuICAgICAgICAgICAgdGhpcy50cmFuc2Zlcl9zdGFydGVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGModHJhbnNmZXJfc3RhcnRlZCkuZm9ybWF0KHNjYWxlQ29uZmlnLmRhdGVGb3JtYXRzLmRheV9zZWNvbmRfdXRjX25vbGFiZWwpO1xuICAgICAgICAgICAgdGhpcy50cmFuc2Zlcl9lbmRlZCA9IHRyYW5zZmVyX2VuZGVkO1xuICAgICAgICAgICAgdGhpcy50cmFuc2Zlcl9lbmRlZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKHRyYW5zZmVyX2VuZGVkKS5mb3JtYXQoc2NhbGVDb25maWcuZGF0ZUZvcm1hdHMuZGF5X3NlY29uZF91dGNfbm9sYWJlbCk7XG4gICAgICAgICAgICB0aGlzLm1lZGlhX3R5cGUgPSBtZWRpYV90eXBlO1xuICAgICAgICAgICAgdGhpcy5maWxlX3NpemUgPSBmaWxlX3NpemU7XG4gICAgICAgICAgICB0aGlzLmZpbGVfc2l6ZV9mb3JtYXR0ZWQgPSBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tQnl0ZXMoZmlsZV9zaXplKTtcbiAgICAgICAgICAgIHRoaXMuZGF0YV90eXBlID0gZGF0YV90eXBlO1xuICAgICAgICAgICAgdGhpcy5pbmdlc3Rfc3RhcnRlZCA9IGluZ2VzdF9zdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5pbmdlc3Rfc3RhcnRlZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKGluZ2VzdF9zdGFydGVkKS5mb3JtYXQoc2NhbGVDb25maWcuZGF0ZUZvcm1hdHMuZGF5X3NlY29uZF91dGNfbm9sYWJlbCk7XG4gICAgICAgICAgICB0aGlzLmluZ2VzdF9lbmRlZCA9IGluZ2VzdF9lbmRlZDtcbiAgICAgICAgICAgIHRoaXMuaW5nZXN0X2VuZGVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMoaW5nZXN0X2VuZGVkKS5mb3JtYXQoc2NhbGVDb25maWcuZGF0ZUZvcm1hdHMuZGF5X3NlY29uZF91dGNfbm9sYWJlbCk7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZV9maWxlID0gc291cmNlX2ZpbGU7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWQgPSBjcmVhdGVkO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMoY3JlYXRlZCkuZm9ybWF0KHNjYWxlQ29uZmlnLmRhdGVGb3JtYXRzLmRheV9zZWNvbmRfdXRjX25vbGFiZWwpO1xuICAgICAgICAgICAgdGhpcy5sYXN0X21vZGlmaWVkID0gbGFzdF9tb2RpZmllZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKGxhc3RfbW9kaWZpZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Y19ub2xhYmVsKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBJbmdlc3QucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIEluZ2VzdC5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW5nZXN0KFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmZpbGVfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdHJpa2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmJ5dGVzX3RyYW5zZmVycmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRyYW5zZmVyX3N0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudHJhbnNmZXJfZW5kZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWVkaWFfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5maWxlX3NpemUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGF0YV90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmluZ2VzdF9zdGFydGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmluZ2VzdF9lbmRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zb3VyY2VfZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jcmVhdGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmxhc3RfbW9kaWZpZWRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmdlc3QoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBJbmdlc3QudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSW5nZXN0LmJ1aWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBJbmdlc3QuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEluZ2VzdDtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCdmZWVkU2VydmljZScsIGZ1bmN0aW9uICgkbG9jYXRpb24sICR0aW1lb3V0LCAkcSwgJGh0dHAsIHNjYWxlQ29uZmlnLCBJbmdlc3QpIHtcblxuICAgICAgICB2YXIgZ2V0RmVlZFBhcmFtcyA9IGZ1bmN0aW9uKHBhcmFtcyl7XG4gICAgICAgICAgICBpZighcGFyYW1zKXsgcGFyYW1zID0ge307IH1cbiAgICAgICAgICAgIHZhciBwID0ge307XG4gICAgICAgICAgICBwLnBhZ2Vfc2l6ZSA9IDEwMDA7XG4gICAgICAgICAgICBwLnN0YXJ0ZWQgPSBwYXJhbXMuc3RhcnRlZCA/IHBhcmFtcy5zdGFydGVkIDogbW9tZW50LnV0YygpLmFkZCgtNywnZGF5cycpLnN0YXJ0T2YoJ2QnKS50b0RhdGUoKTtcbiAgICAgICAgICAgIHAuZW5kZWQgPSBwYXJhbXMuZW5kZWQgPyBwYXJhbXMuZW5kZWQgOiBtb21lbnQudXRjKCkudG9EYXRlKCk7XG4gICAgICAgICAgICBwLnVzZV9pbmdlc3RfdGltZSA9IHBhcmFtcy51c2VfaW5nZXN0X3RpbWUgPyBwYXJhbXMudXNlX2luZ2VzdF90aW1lIDogbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBwO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRJbmdlc3RzUGFyYW1zID0gZnVuY3Rpb24ocGFyYW1zKXtcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEZlZWQ6IGZ1bmN0aW9uKHBhcmFtcyl7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBnZXRGZWVkUGFyYW1zKHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2luZ2VzdHMvc3RhdHVzLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEluZ2VzdHNPbmNlOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGdldEluZ2VzdHNQYXJhbXMocGFyYW1zKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnaW5nZXN0cy8nLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzID0gSW5nZXN0LnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5kaXJlY3RpdmUoJ2Fpc011bHRpc2VsZWN0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHJlcXVpcmU6ICdebmdNb2RlbCcsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG11bHRpc2VsZWN0RGF0YVByb3ZpZGVyOiAnPScsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiAnPScsXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiAnPScsXG4gICAgICAgICAgICAgICAgbnVtYmVyRGlzcGxheWVkOiAnPScsXG4gICAgICAgICAgICAgICAgaW5jbHVkZVNlbGVjdEFsbE9wdGlvbjogJz0nLFxuICAgICAgICAgICAgICAgIG5vblNlbGVjdGVkVGV4dDogJz0nLFxuICAgICAgICAgICAgICAgIG5nTW9kZWw6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCA9ICQoZWxlbWVudFswXSk7XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50Lm11bHRpc2VsZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBzY29wZS5lbmFibGVGaWx0ZXJpbmcsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZUNhc2VJbnNlbnNpdGl2ZUZpbHRlcmluZzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiBzY29wZS5tYXhIZWlnaHQgfHwgMzAwLFxuICAgICAgICAgICAgICAgICAgICBudW1iZXJEaXNwbGF5ZWQ6IHNjb3BlLm51bWJlckRpc3BsYXllZCB8fCAzLFxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlU2VsZWN0QWxsT3B0aW9uOiBzY29wZS5pbmNsdWRlU2VsZWN0QWxsT3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICBub25TZWxlY3RlZFRleHQ6IHNjb3BlLm5vblNlbGVjdGVkVGV4dCB8fCAnTm9uZSBTZWxlY3RlZCcsXG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiAob3B0aW9uRWxlbWVudCwgY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5uZ01vZGVsID0gZWxlbWVudC52YWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdtdWx0aXNlbGVjdERhdGFQcm92aWRlcicsIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuZXF1YWxzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm11bHRpc2VsZWN0KCdkYXRhcHJvdmlkZXInLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgIC8vIFdhdGNoIGZvciBhbnkgY2hhbmdlcyB0byB0aGUgbGVuZ3RoIG9mIG91ciBzZWxlY3QgZWxlbWVudFxuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50WzBdO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWJ1Z2dlcjtcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50Lm11bHRpc2VsZWN0KCdzZXRPcHRpb25zJywgZWxlbWVudFswXSk7XG4gICAgICAgICAgICAgICAgICAgIC8vZWxlbWVudC5tdWx0aXNlbGVjdCgncmVidWlsZCcpO1xuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgLy8gV2F0Y2ggZm9yIGFueSBjaGFuZ2VzIGZyb20gb3V0c2lkZSB0aGUgZGlyZWN0aXZlIGFuZCByZWZyZXNoXG4gICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGF0dHJpYnV0ZXMubmdNb2RlbCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm11bHRpc2VsZWN0KCdyZWZyZXNoJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnZ2F1Z2VGYWN0b3J5JywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnKSB7XG4gICAgICAgIHZhciBHYXVnZSA9IGZ1bmN0aW9uIChwbGFjZWhvbGRlck5hbWUsIGNvbmZpZ3VyYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXJOYW1lID0gcGxhY2Vob2xkZXJOYW1lO1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7IC8vIGZvciBpbnRlcm5hbCBkMyBmdW5jdGlvbnNcblxuICAgICAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbihjb25maWd1cmF0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlndXJhdGlvbjtcblxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLnNpemUgPSB0aGlzLmNvbmZpZy5zaXplICogMC45O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcucmFkaXVzID0gdGhpcy5jb25maWcuc2l6ZSAqIDAuOTcgLyAyO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmN4ID0gdGhpcy5jb25maWcuc2l6ZSAvIDI7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcuY3kgPSB0aGlzLmNvbmZpZy5zaXplIC8gMjtcblxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLm1pbiA9IHVuZGVmaW5lZCAhPSBjb25maWd1cmF0aW9uLm1pbiA/IGNvbmZpZ3VyYXRpb24ubWluIDogMDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5tYXggPSB1bmRlZmluZWQgIT0gY29uZmlndXJhdGlvbi5tYXggPyBjb25maWd1cmF0aW9uLm1heCA6IDEwMDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5yYW5nZSA9IHRoaXMuY29uZmlnLm1heCAtIHRoaXMuY29uZmlnLm1pbjtcblxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLm1ham9yVGlja3MgPSBjb25maWd1cmF0aW9uLm1ham9yVGlja3MgfHwgNTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5taW5vclRpY2tzID0gY29uZmlndXJhdGlvbi5taW5vclRpY2tzIHx8IDI7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5ncmVlbkNvbG9yIFx0PSBjb25maWd1cmF0aW9uLmdyZWVuQ29sb3IgfHwgJyM4ZmNhMGUnO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLnllbGxvd0NvbG9yID0gY29uZmlndXJhdGlvbi55ZWxsb3dDb2xvciB8fCAnI2ZmYzMxNyc7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcucmVkQ29sb3IgXHQ9IGNvbmZpZ3VyYXRpb24ucmVkQ29sb3IgfHwgJyNmNTRkMzYnO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcudHJhbnNpdGlvbkR1cmF0aW9uID0gY29uZmlndXJhdGlvbi50cmFuc2l0aW9uRHVyYXRpb24gfHwgNTAwO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5yZW5kZXIgPSBmdW5jdGlvbigpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5ID0gZDMuc2VsZWN0KCcjJyArIHRoaXMucGxhY2Vob2xkZXJOYW1lKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdzdmc6c3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2dhdWdlJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgdGhpcy5jb25maWcuc2l6ZSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHRoaXMuY29uZmlnLnNpemUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZCgnc3ZnOmNpcmNsZScpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdvdXRlci1jaXJjbGUnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCB0aGlzLmNvbmZpZy5jeClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgdGhpcy5jb25maWcuY3kpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdyJywgdGhpcy5jb25maWcucmFkaXVzKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnI2NjYycpO1xuICAgICAgICAgICAgICAgIC8qLnN0eWxlKCdzdHJva2UnLCAnIzAwMCcpXG4gICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgJzAuNXB4Jyk7Ki9cblxuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5hcHBlbmQoJ3N2ZzpjaXJjbGUnKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY3gnLCB0aGlzLmNvbmZpZy5jeClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N5JywgdGhpcy5jb25maWcuY3kpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdyJywgMC45ICogdGhpcy5jb25maWcucmFkaXVzKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnI2ZmZicpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyNlMGUwZTAnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZS13aWR0aCcsICcycHgnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGdyZWVuSWR4IGluIHRoaXMuY29uZmlnLmdyZWVuWm9uZXMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXdCYW5kKHRoaXMuY29uZmlnLmdyZWVuWm9uZXNbZ3JlZW5JZHhdLmZyb20sIHRoaXMuY29uZmlnLmdyZWVuWm9uZXNbZ3JlZW5JZHhdLnRvLCBzZWxmLmNvbmZpZy5ncmVlbkNvbG9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciB5ZWxsb3dJZHggaW4gdGhpcy5jb25maWcueWVsbG93Wm9uZXMpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXdCYW5kKHRoaXMuY29uZmlnLnllbGxvd1pvbmVzW3llbGxvd0lkeF0uZnJvbSwgdGhpcy5jb25maWcueWVsbG93Wm9uZXNbeWVsbG93SWR4XS50bywgc2VsZi5jb25maWcueWVsbG93Q29sb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIHJlZElkeCBpbiB0aGlzLmNvbmZpZy5yZWRab25lcylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd0JhbmQodGhpcy5jb25maWcucmVkWm9uZXNbcmVkSWR4XS5mcm9tLCB0aGlzLmNvbmZpZy5yZWRab25lc1tyZWRJZHhdLnRvLCBzZWxmLmNvbmZpZy5yZWRDb2xvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gMDtcblxuICAgICAgICAgICAgICAgIGlmICh1bmRlZmluZWQgIT0gdGhpcy5jb25maWcubGFiZWwpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBmb250U2l6ZSA9IE1hdGgucm91bmQodGhpcy5jb25maWcuc2l6ZSAvIDkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvZHkuYXBwZW5kKCdzdmc6dGV4dCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigneCcsIHRoaXMuY29uZmlnLmN4KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3knLCB0aGlzLmNvbmZpZy5jeSAvIDIgKyBmb250U2l6ZSAvIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignZHknLCBmb250U2l6ZSAvIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnbWlkZGxlJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KHRoaXMuY29uZmlnLmxhYmVsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmb250LXNpemUnLCBmb250U2l6ZSArICdweCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnIzMzMycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3N0cm9rZS13aWR0aCcsICcwcHgnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb250U2l6ZSA9IE1hdGgucm91bmQodGhpcy5jb25maWcuc2l6ZSAvIDE2KTtcbiAgICAgICAgICAgICAgICB2YXIgbWFqb3JEZWx0YSA9IHRoaXMuY29uZmlnLnJhbmdlIC8gKHRoaXMuY29uZmlnLm1ham9yVGlja3MgLSAxKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBtYWpvciA9IHRoaXMuY29uZmlnLm1pbjsgbWFqb3IgPD0gdGhpcy5jb25maWcubWF4OyBtYWpvciArPSBtYWpvckRlbHRhKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbm9yRGVsdGEgPSBtYWpvckRlbHRhIC8gdGhpcy5jb25maWcubWlub3JUaWNrcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50MSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludDIgPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBtaW5vciA9IG1ham9yICsgbWlub3JEZWx0YTsgbWlub3IgPCBNYXRoLm1pbihtYWpvciArIG1ham9yRGVsdGEsIHRoaXMuY29uZmlnLm1heCk7IG1pbm9yICs9IG1pbm9yRGVsdGEpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50MSA9IHRoaXMudmFsdWVUb1BvaW50KG1pbm9yLCAwLjc1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50MiA9IHRoaXMudmFsdWVUb1BvaW50KG1pbm9yLCAwLjg1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZCgnc3ZnOmxpbmUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MScsIHBvaW50MS54KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIHBvaW50MS55KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4MicsIHBvaW50Mi54KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MicsIHBvaW50Mi55KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyM2NjYnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgJzFweCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcG9pbnQxID0gdGhpcy52YWx1ZVRvUG9pbnQobWFqb3IsIDAuNyk7XG4gICAgICAgICAgICAgICAgICAgIHBvaW50MiA9IHRoaXMudmFsdWVUb1BvaW50KG1ham9yLCAwLjg1KTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvZHkuYXBwZW5kKCdzdmc6bGluZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigneDEnLCBwb2ludDEueClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd5MScsIHBvaW50MS55KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gyJywgcG9pbnQyLngpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigneTInLCBwb2ludDIueSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyMzMzMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAnMnB4Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1ham9yID09IHRoaXMuY29uZmlnLm1pbiB8fCBtYWpvciA9PSB0aGlzLmNvbmZpZy5tYXgpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludCA9IHRoaXMudmFsdWVUb1BvaW50KG1ham9yLCAwLjYzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZCgnc3ZnOnRleHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgcG9pbnQueClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigneScsIHBvaW50LnkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2R5JywgZm9udFNpemUgLyAzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsIG1ham9yID09IHRoaXMuY29uZmlnLm1pbiA/ICdzdGFydCcgOiAnZW5kJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dChtYWpvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsIGZvbnRTaXplICsgJ3B4JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnIzMzMycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAnMHB4Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRlckNvbnRhaW5lciA9IHRoaXMuYm9keS5hcHBlbmQoJ3N2ZzpnJykuYXR0cignY2xhc3MnLCAncG9pbnRlckNvbnRhaW5lcicpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1pZFZhbHVlID0gKHRoaXMuY29uZmlnLm1pbiArIHRoaXMuY29uZmlnLm1heCkgLyAyO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ZXJQYXRoID0gdGhpcy5idWlsZFBvaW50ZXJQYXRoKG1pZFZhbHVlKTtcblxuICAgICAgICAgICAgICAgIHZhciBwb2ludGVyTGluZSA9IGQzLnN2Zy5saW5lKClcbiAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54IH0pXG4gICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueSB9KVxuICAgICAgICAgICAgICAgICAgICAuaW50ZXJwb2xhdGUoJ2Jhc2lzJyk7XG5cbiAgICAgICAgICAgICAgICBwb2ludGVyQ29udGFpbmVyLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKFtwb2ludGVyUGF0aF0pXG4gICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ3N2ZzpwYXRoJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2QnLCBwb2ludGVyTGluZSlcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgJyM4ODgnKTtcblxuICAgICAgICAgICAgICAgIHBvaW50ZXJDb250YWluZXIuYXBwZW5kKCdzdmc6Y2lyY2xlJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2N4JywgdGhpcy5jb25maWcuY3gpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjeScsIHRoaXMuY29uZmlnLmN5KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigncicsIDAuMDcgKiB0aGlzLmNvbmZpZy5yYWRpdXMpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsICcjODg4Jyk7XG5cbiAgICAgICAgICAgICAgICBmb250U2l6ZSA9IE1hdGgucm91bmQodGhpcy5jb25maWcuc2l6ZSAvIDEwKTtcbiAgICAgICAgICAgICAgICBwb2ludGVyQ29udGFpbmVyLnNlbGVjdEFsbCgndGV4dCcpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKFttaWRWYWx1ZV0pXG4gICAgICAgICAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ3N2Zzp0ZXh0JylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3gnLCB0aGlzLmNvbmZpZy5jeClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3knLCB0aGlzLmNvbmZpZy5zaXplIC0gdGhpcy5jb25maWcuY3kgLyA0IC0gZm9udFNpemUpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkeScsIGZvbnRTaXplIC8gMilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgZm9udFNpemUgKyAncHgnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAnIzAwMCcpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgJzBweCcpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yZWRyYXcodGhpcy5jb25maWcubWluLCAwKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuYnVpbGRQb2ludGVyUGF0aCA9IGZ1bmN0aW9uKHZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IHRoaXMuY29uZmlnLnJhbmdlIC8gMTM7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVhZCA9IHZhbHVlVG9Qb2ludCh2YWx1ZSwgMC44NSk7XG4gICAgICAgICAgICAgICAgdmFyIGhlYWQxID0gdmFsdWVUb1BvaW50KHZhbHVlIC0gZGVsdGEsIDAuMTIpO1xuICAgICAgICAgICAgICAgIHZhciBoZWFkMiA9IHZhbHVlVG9Qb2ludCh2YWx1ZSArIGRlbHRhLCAwLjEyKTtcblxuICAgICAgICAgICAgICAgIHZhciB0YWlsVmFsdWUgPSB2YWx1ZSAtICh0aGlzLmNvbmZpZy5yYW5nZSAqICgxLygyNzAvMzYwKSkgLyAyKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFpbCA9IHZhbHVlVG9Qb2ludCh0YWlsVmFsdWUsIDAuMjgpO1xuICAgICAgICAgICAgICAgIHZhciB0YWlsMSA9IHZhbHVlVG9Qb2ludCh0YWlsVmFsdWUgLSBkZWx0YSwgMC4xMik7XG4gICAgICAgICAgICAgICAgdmFyIHRhaWwyID0gdmFsdWVUb1BvaW50KHRhaWxWYWx1ZSArIGRlbHRhLCAwLjEyKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBbaGVhZCwgaGVhZDEsIHRhaWwyLCB0YWlsLCB0YWlsMSwgaGVhZDIsIGhlYWRdO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdmFsdWVUb1BvaW50KHZhbHVlLCBmYWN0b3IpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBzZWxmLnZhbHVlVG9Qb2ludCh2YWx1ZSwgZmFjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQueCAtPSBzZWxmLmNvbmZpZy5jeDtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQueSAtPSBzZWxmLmNvbmZpZy5jeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuZHJhd0JhbmQgPSBmdW5jdGlvbihzdGFydCwgZW5kLCBjb2xvcilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoMCA+PSBlbmQgLSBzdGFydCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZCgnc3ZnOnBhdGgnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBjb2xvcilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2QnLCBkMy5zdmcuYXJjKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdGFydEFuZ2xlKHRoaXMudmFsdWVUb1JhZGlhbnMoc3RhcnQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVuZEFuZ2xlKHRoaXMudmFsdWVUb1JhZGlhbnMoZW5kKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbm5lclJhZGl1cygwLjY1ICogdGhpcy5jb25maWcucmFkaXVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm91dGVyUmFkaXVzKDAuODUgKiB0aGlzLmNvbmZpZy5yYWRpdXMpKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oKSB7IHJldHVybiAndHJhbnNsYXRlKCcgKyBzZWxmLmNvbmZpZy5jeCArICcsICcgKyBzZWxmLmNvbmZpZy5jeSArICcpIHJvdGF0ZSgyNzApJyB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMucmVkcmF3ID0gZnVuY3Rpb24odmFsdWUsIHRyYW5zaXRpb25EdXJhdGlvbilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRlckNvbnRhaW5lciA9IHRoaXMuYm9keS5zZWxlY3QoJy5wb2ludGVyQ29udGFpbmVyJyk7XG5cbiAgICAgICAgICAgICAgICBwb2ludGVyQ29udGFpbmVyLnNlbGVjdEFsbCgndGV4dCcpLnRleHQocGFyc2VGbG9hdCh2YWx1ZSkudG9GaXhlZCgyKSArICclJyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRlciA9IHBvaW50ZXJDb250YWluZXIuc2VsZWN0QWxsKCdwYXRoJyk7XG4gICAgICAgICAgICAgICAgcG9pbnRlci50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKHVuZGVmaW5lZCAhPSB0cmFuc2l0aW9uRHVyYXRpb24gPyB0cmFuc2l0aW9uRHVyYXRpb24gOiB0aGlzLmNvbmZpZy50cmFuc2l0aW9uRHVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAgIC8vLmRlbGF5KDApXG4gICAgICAgICAgICAgICAgICAgIC8vLmVhc2UoJ2xpbmVhcicpXG4gICAgICAgICAgICAgICAgICAgIC8vLmF0dHIoJ3RyYW5zZm9ybScsIGZ1bmN0aW9uKGQpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyVHdlZW4oJ3RyYW5zZm9ybScsIGZ1bmN0aW9uKClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50ZXJWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gc2VsZi5jb25maWcubWF4KSBwb2ludGVyVmFsdWUgPSBzZWxmLmNvbmZpZy5tYXggKyAwLjAyKnNlbGYuY29uZmlnLnJhbmdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBzZWxmLmNvbmZpZy5taW4pIHBvaW50ZXJWYWx1ZSA9IHNlbGYuY29uZmlnLm1pbiAtIDAuMDIqc2VsZi5jb25maWcucmFuZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0Um90YXRpb24gPSAoc2VsZi52YWx1ZVRvRGVncmVlcyhwb2ludGVyVmFsdWUpIC0gOTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRSb3RhdGlvbiA9IHNlbGYuX2N1cnJlbnRSb3RhdGlvbiB8fCB0YXJnZXRSb3RhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2N1cnJlbnRSb3RhdGlvbiA9IHRhcmdldFJvdGF0aW9uO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oc3RlcClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm90YXRpb24gPSBjdXJyZW50Um90YXRpb24gKyAodGFyZ2V0Um90YXRpb24tY3VycmVudFJvdGF0aW9uKSpzdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyBzZWxmLmNvbmZpZy5jeCArICcsICcgKyBzZWxmLmNvbmZpZy5jeSArICcpIHJvdGF0ZSgnICsgcm90YXRpb24gKyAnKSc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIG91dGVyQ2lyY2xlID0gdGhpcy5ib2R5LnNlbGVjdCgnLm91dGVyLWNpcmNsZScpXG4gICAgICAgICAgICAgICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+PSAwICYmIGkgPCA3NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNvbmZpZy5ncmVlbkNvbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID49IDc1ICYmIGkgPCA5MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNvbmZpZy55ZWxsb3dDb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLnJlZENvbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudmFsdWVUb0RlZ3JlZXMgPSBmdW5jdGlvbih2YWx1ZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyB0aGFua3MgQGNsb3NlYWxlcnRcbiAgICAgICAgICAgICAgICAvL3JldHVybiB2YWx1ZSAvIHRoaXMuY29uZmlnLnJhbmdlICogMjcwIC0gNDU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlIC8gdGhpcy5jb25maWcucmFuZ2UgKiAyNzAgLSAodGhpcy5jb25maWcubWluIC8gdGhpcy5jb25maWcucmFuZ2UgKiAyNzAgKyA0NSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnZhbHVlVG9SYWRpYW5zID0gZnVuY3Rpb24odmFsdWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVUb0RlZ3JlZXModmFsdWUpICogTWF0aC5QSSAvIDE4MDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudmFsdWVUb1BvaW50ID0gZnVuY3Rpb24odmFsdWUsIGZhY3RvcilcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBcdHg6IHRoaXMuY29uZmlnLmN4IC0gdGhpcy5jb25maWcucmFkaXVzICogZmFjdG9yICogTWF0aC5jb3ModGhpcy52YWx1ZVRvUmFkaWFucyh2YWx1ZSkpLFxuICAgICAgICAgICAgICAgICAgICB5OiB0aGlzLmNvbmZpZy5jeSAtIHRoaXMuY29uZmlnLnJhZGl1cyAqIGZhY3RvciAqIE1hdGguc2luKHRoaXMudmFsdWVUb1JhZGlhbnModmFsdWUpKSBcdFx0fTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIGluaXRpYWxpemF0aW9uXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZShjb25maWd1cmF0aW9uKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY3JlYXRlR2F1Z2U6IGZ1bmN0aW9uIChuYW1lLCBsYWJlbCwgbWluLCBtYXgsIHNpemUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplIHx8IHNjYWxlQ29uZmlnLmRlZmF1bHRHYXVnZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgICAgICAgICAgICAgIG1pbjogbWluIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIG1heDogbWF4IHx8IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgbWlub3JUaWNrczogNVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBjb25maWcubWF4IC0gY29uZmlnLm1pbjtcbiAgICAgICAgICAgICAgICBjb25maWcueWVsbG93Wm9uZXMgPSBbeyBmcm9tOiBjb25maWcubWluICsgcmFuZ2UqMC43NSwgdG86IGNvbmZpZy5taW4gKyByYW5nZSowLjkgfV07XG4gICAgICAgICAgICAgICAgY29uZmlnLnJlZFpvbmVzID0gW3sgZnJvbTogY29uZmlnLm1pbiArIHJhbmdlKjAuOSwgdG86IGNvbmZpZy5tYXggfV07XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2F1Z2UgPSBuZXcgR2F1Z2UobmFtZSArICdHYXVnZUNvbnRhaW5lcicsIGNvbmZpZyk7XG4gICAgICAgICAgICAgICAgZ2F1Z2UucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdhdWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnZ3JpZEZhY3RvcnknLCBmdW5jdGlvbiAodWlHcmlkQ29uc3RhbnRzKSB7XG5cbiAgICAgICAgdmFyIGdldFNvcnRDb25maWcgPSBmdW5jdGlvbihvcmRlclBhcmFtKXtcbiAgICAgICAgICAgIGlmKG9yZGVyUGFyYW0pe1xuICAgICAgICAgICAgICAgIHZhciBzb3J0RmllbGQgPSBvcmRlclBhcmFtXG4gICAgICAgICAgICAgICAgdmFyIHNvcnREaXJlY3Rpb24gPSAnYXNjJztcbiAgICAgICAgICAgICAgICBpZihfLnN0YXJ0c1dpdGgob3JkZXJQYXJhbSwgJy0nKSl7XG4gICAgICAgICAgICAgICAgICAgIHNvcnREaXJlY3Rpb24gPSAnZGVzYyc7XG4gICAgICAgICAgICAgICAgICAgIHNvcnRGaWVsZCA9IHNvcnRGaWVsZFswXS5sZW5ndGggPT09IDEgPyBzb3J0RmllbGQuc3Vic3RyaW5nKDEpIDogc29ydEZpZWxkWzBdLnN1YnN0cmluZygxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBzb3J0RGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBmaWVsZDogc29ydEZpZWxkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGVmYXVsdEdyaWRPcHRpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlUm93U2VsZWN0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVSb3dIZWFkZXJTZWxlY3Rpb246IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVIb3Jpem9udGFsU2Nyb2xsYmFyOiB1aUdyaWRDb25zdGFudHMuc2Nyb2xsYmFycy5ORVZFUixcbiAgICAgICAgICAgICAgICAgICAgbXVsdGlTZWxlY3Q6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVzZUV4dGVybmFsU29ydGluZzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdXNlRXh0ZXJuYWxGaWx0ZXJpbmc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVNvcnRpbmc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG1pblJvd3NUb1Nob3c6IDE3LFxuICAgICAgICAgICAgICAgICAgICBwYWdpbmF0aW9uUGFnZVNpemVzOiBbMjUsIDUwLCA3NSwgMTAwXSxcbiAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvblBhZ2VTaXplOiAyNSxcbiAgICAgICAgICAgICAgICAgICAgdXNlRXh0ZXJuYWxQYWdpbmF0aW9uOiB0cnVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFwcGx5U29ydENvbmZpZzogZnVuY3Rpb24oY29sdW1uRGVmcywgZ3JpZFBhcmFtcyl7XG4gICAgICAgICAgICAgICAgdmFyIHNvcnRDb25maWcgPSBnZXRTb3J0Q29uZmlnKGdyaWRQYXJhbXMub3JkZXIpO1xuICAgICAgICAgICAgICAgIGlmKHNvcnRDb25maWcuZmllbGQpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sRGVmID0gXy5maW5kKGNvbHVtbkRlZnMsIHtmaWVsZDogc29ydENvbmZpZy5maWVsZH0pO1xuICAgICAgICAgICAgICAgICAgICBpZihjb2xEZWYpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sRGVmLnNvcnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBzb3J0Q29uZmlnLmRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eTogMVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW5EZWZzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdwb2xsZXJGYWN0b3J5JywgZnVuY3Rpb24gKHBvbGxlcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmV3UG9sbGVyOiBmdW5jdGlvbiAocmVzb3VyY2UsIGludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvbGxlci5nZXQocmVzb3VyY2UsIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsYXk6IGludGVydmFsLFxuICAgICAgICAgICAgICAgICAgICBjYXRjaEVycm9yOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdTdGF0dXMnLCBmdW5jdGlvbiAoU3RhdHVzTWFzdGVyLCBTdGF0dXNTY2hlZHVsZXIsIFN0YXR1c1Jlc291cmNlcykge1xuICAgICAgICB2YXIgU3RhdHVzID0gZnVuY3Rpb24gKCRyZXNvbHZlZCwgbWFzdGVyLCBzY2hlZHVsZXIsIHF1ZXVlX2RlcHRoLCByZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIHRoaXMuJHJlc29sdmVkID0gJHJlc29sdmVkO1xuICAgICAgICAgICAgdGhpcy5tYXN0ZXIgPSBTdGF0dXNNYXN0ZXIudHJhbnNmb3JtZXIobWFzdGVyKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyID0gU3RhdHVzU2NoZWR1bGVyLnRyYW5zZm9ybWVyKHNjaGVkdWxlcik7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlX2RlcHRoID0gcXVldWVfZGVwdGg7XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlcyA9IFN0YXR1c1Jlc291cmNlcy50cmFuc2Zvcm1lcihyZXNvdXJjZXMpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIFN0YXR1cy5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICBnZXRDcHVVc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc291cmNlcy5zY2hlZHVsZWQuY3B1cyAmJiB0aGlzLnJlc291cmNlcy50b3RhbC5jcHVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc291cmNlcy50b3RhbC5jcHVzID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgodGhpcy5yZXNvdXJjZXMuc2NoZWR1bGVkLmNwdXMgLyB0aGlzLnJlc291cmNlcy50b3RhbC5jcHVzKSAqIDEwMCkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMC4wMDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRNZW1Vc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc291cmNlcy5zY2hlZHVsZWQubWVtICYmIHRoaXMucmVzb3VyY2VzLnRvdGFsLm1lbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXNvdXJjZXMudG90YWwubWVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgodGhpcy5yZXNvdXJjZXMuc2NoZWR1bGVkLm1lbSAvIHRoaXMucmVzb3VyY2VzLnRvdGFsLm1lbSkgKiAxMDApLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDAuMDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0RGlza1VzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzb3VyY2VzLnNjaGVkdWxlZC5kaXNrICYmIHRoaXMucmVzb3VyY2VzLnRvdGFsLmRpc2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzb3VyY2VzLnRvdGFsLmRpc2sgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCh0aGlzLnJlc291cmNlcy5zY2hlZHVsZWQuZGlzayAvIHRoaXMucmVzb3VyY2VzLnRvdGFsLmRpc2spICogMTAwKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwLjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBTdGF0dXMuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0YXR1cyhcbiAgICAgICAgICAgICAgICAgICAgZGF0YS4kcmVzb2x2ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWFzdGVyLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnNjaGVkdWxlcixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5xdWV1ZV9kZXB0aCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXNvdXJjZXNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGF0dXMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBTdGF0dXMudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoU3RhdHVzLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFN0YXR1cy5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gU3RhdHVzO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBcbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdTdGF0dXNNYXN0ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBTdGF0dXNNYXN0ZXIgPSBmdW5jdGlvbiAoaXNfb25saW5lLCBob3N0bmFtZSwgcG9ydCkge1xuICAgICAgICAgICAgdGhpcy5pc19vbmxpbmUgPSBpc19vbmxpbmU7XG4gICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gaG9zdG5hbWU7XG4gICAgICAgICAgICB0aGlzLnBvcnQgPSBwb3J0O1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIFN0YXR1c01hc3Rlci5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgU3RhdHVzTWFzdGVyLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGF0dXNNYXN0ZXIoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfb25saW5lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmhvc3RuYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnBvcnRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGF0dXNNYXN0ZXIoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBTdGF0dXNNYXN0ZXIudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoU3RhdHVzTWFzdGVyLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFN0YXR1c01hc3Rlci5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gU3RhdHVzTWFzdGVyO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1N0YXR1c1Jlc291cmNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgU3RhdHVzUmVzb3VyY2UgPSBmdW5jdGlvbiAoY3B1cywgbWVtLCBkaXNrKSB7XG4gICAgICAgICAgICB0aGlzLmNwdXMgPSBjcHVzO1xuICAgICAgICAgICAgdGhpcy5tZW0gPSBtZW07XG4gICAgICAgICAgICB0aGlzLmRpc2sgPSBkaXNrO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIFN0YXR1c1Jlc291cmNlLnByb3RvdHlwZSA9IHtcblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBTdGF0dXNSZXNvdXJjZS5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RhdHVzUmVzb3VyY2UoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3B1cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZW0sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0YXR1c1Jlc291cmNlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgU3RhdHVzUmVzb3VyY2UudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoU3RhdHVzUmVzb3VyY2UuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU3RhdHVzUmVzb3VyY2UuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFN0YXR1c1Jlc291cmNlO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1N0YXR1c1Jlc291cmNlcycsIGZ1bmN0aW9uIChTdGF0dXNSZXNvdXJjZSkge1xuICAgICAgICB2YXIgU3RhdHVzUmVzb3VyY2VzID0gZnVuY3Rpb24gKHRvdGFsLCBzY2hlZHVsZWQsIHVzZWQpIHtcbiAgICAgICAgICAgIHRoaXMudG90YWwgPSBTdGF0dXNSZXNvdXJjZS50cmFuc2Zvcm1lcih0b3RhbCk7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlZCA9IFN0YXR1c1Jlc291cmNlLnRyYW5zZm9ybWVyKHNjaGVkdWxlZCk7XG4gICAgICAgICAgICB0aGlzLnVzZWQgPSBTdGF0dXNSZXNvdXJjZS50cmFuc2Zvcm1lcih1c2VkKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBTdGF0dXNSZXNvdXJjZXMucHJvdG90eXBlID0ge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFN0YXR1c1Jlc291cmNlcy5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RhdHVzUmVzb3VyY2VzKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRvdGFsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnNjaGVkdWxlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS51c2VkXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgU3RhdHVzUmVzb3VyY2VzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgU3RhdHVzUmVzb3VyY2VzLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKFN0YXR1c1Jlc291cmNlcy5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTdGF0dXNSZXNvdXJjZXMuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFN0YXR1c1Jlc291cmNlcztcbiAgICB9KTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdTdGF0dXNTY2hlZHVsZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBTdGF0dXNTY2hlZHVsZXIgPSBmdW5jdGlvbiAoaXNfb25saW5lLCBpc19wYXVzZWQsIGhvc3RuYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmlzX29ubGluZSA9IGlzX29ubGluZTtcbiAgICAgICAgICAgIHRoaXMuaXNfcGF1c2VkID0gaXNfcGF1c2VkO1xuICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IGhvc3RuYW1lO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIFN0YXR1c1NjaGVkdWxlci5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgU3RhdHVzU2NoZWR1bGVyLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdGF0dXNTY2hlZHVsZXIoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfb25saW5lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3BhdXNlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ob3N0bmFtZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0YXR1c1NjaGVkdWxlcigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFN0YXR1c1NjaGVkdWxlci50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChTdGF0dXNTY2hlZHVsZXIuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU3RhdHVzU2NoZWR1bGVyLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBTdGF0dXNTY2hlZHVsZXI7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnc2NhbGVTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkaHR0cCwgc2NhbGVDb25maWcpIHtcbiAgICAgICAgZnVuY3Rpb24gcGFkV2l0aFplcm8gKGlucHV0LCBsZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIENhc3QgaW5wdXQgdG8gc3RyaW5nXG4gICAgICAgICAgICBpbnB1dCA9ICcnICsgaW5wdXQ7XG5cbiAgICAgICAgICAgIHZhciBwYWRkaW5nU2l6ZSA9IE1hdGgubWF4KDAsIGxlbmd0aCAtIGlucHV0Lmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEFycmF5KHBhZGRpbmdTaXplID4gMCA/IHBhZGRpbmdTaXplICsgMSA6IDApLmpvaW4oJzAnKSArIGlucHV0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhbGN1bGF0ZUZpbGVTaXplRnJvbU1pYjogZnVuY3Rpb24obnVtKXtcbiAgICAgICAgICAgICAgICBpZiAobnVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobnVtIDwgMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bS50b0ZpeGVkKDIpICsgJyBNQic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bSA+PSAxMDI0ICYmIG51bSA8IDEwMjQqMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChudW0vMTAyNCkudG9GaXhlZCgyKSArICcgR0InO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAobnVtLzEwMjQvMTAyNCkudG9GaXhlZCgyKSArICcgVEInO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVtO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhbGN1bGF0ZUZpbGVTaXplRnJvbUJ5dGVzOiBmdW5jdGlvbihudW0sZGVjaW1hbHMpe1xuICAgICAgICAgICAgICAgIC8vIGlmKHByZWNpc2lvbil7XG4gICAgICAgICAgICAgICAgLy8gICAgIC8vIHJvdW5kIG51bSB0byBzcGVjaWZpZWQgcHJlY2lzaW9uXG4gICAgICAgICAgICAgICAgLy8gICAgIG51bSA9IE1hdGgucm91bmQobnVtL3ByZWNpc2lvbik7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIGlmIChudW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudW0gPCAxMDI0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVtLnRvRml4ZWQoZGVjaW1hbHMpICsgJyBCeXRlcyc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bSA+PSAxMDI0ICYmIG51bSA8IDEwMjQqMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChudW0vMTAyNCkudG9GaXhlZChkZWNpbWFscykgKyAnIEtCJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobnVtID49IDEwMjQqMTAyNCAmJiBudW0gPCAxMDI0KjEwMjQqMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChudW0vMTAyNC8xMDI0KS50b0ZpeGVkKGRlY2ltYWxzKSArICcgTUInO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChudW0gPj0gMTAyNCoxMDI0KjEwMjQgJiYgbnVtIDwgMTAyNCoxMDI0KjEwMjQqMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChudW0vMTAyNC8xMDI0LzEwMjQpLnRvRml4ZWQoZGVjaW1hbHMpICsgJyBHQic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChudW0vMTAyNC8xMDI0LzEwMjQvMTAyNCkudG9GaXhlZChkZWNpbWFscykgKyAnIFRCJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRWaWV3cG9ydFNpemU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdyA9IHdpbmRvdyxcbiAgICAgICAgICAgICAgICAgICAgZCA9IGRvY3VtZW50LFxuICAgICAgICAgICAgICAgICAgICBlID0gZC5kb2N1bWVudEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGcgPSBkb2N1bWVudC5ib2R5LFxuICAgICAgICAgICAgICAgICAgICB4ID0gdy5pbm5lcldpZHRoIHx8IGUuY2xpZW50V2lkdGggfHwgZy5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgeSA9IHcuaW5uZXJIZWlnaHQgfHwgZS5jbGllbnRIZWlnaHQgfHwgZy5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogeCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB5XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYWxjdWxhdGVEdXJhdGlvbjogZnVuY3Rpb24gKHN0YXJ0LCBzdG9wKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvID0gbW9tZW50LnV0YyhzdG9wKSxcbiAgICAgICAgICAgICAgICAgICAgZnJvbSA9IG1vbWVudC51dGMoc3RhcnQpLFxuICAgICAgICAgICAgICAgICAgICBkaWZmID0gbW9tZW50LnV0Yyh0bykuZGlmZihtb21lbnQudXRjKGZyb20pKSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb25TdHIgPSAnJztcblxuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IG1vbWVudC5kdXJhdGlvbihkaWZmKTtcblxuICAgICAgICAgICAgICAgIGR1cmF0aW9uU3RyID0gZHVyYXRpb24uZGF5cygpID4gMCA/IGR1cmF0aW9uU3RyICsgcGFkV2l0aFplcm8oZHVyYXRpb24uZGF5cygpLCAyKSArICdkLCAnIDogZHVyYXRpb25TdHI7XG4gICAgICAgICAgICAgICAgZHVyYXRpb25TdHIgPSBkdXJhdGlvbi5ob3VycygpID4gMCA/IGR1cmF0aW9uU3RyICsgcGFkV2l0aFplcm8oZHVyYXRpb24uaG91cnMoKSwgMikgKyAnaCwgJyA6IGR1cmF0aW9uU3RyO1xuICAgICAgICAgICAgICAgIGR1cmF0aW9uU3RyID0gZHVyYXRpb24ubWludXRlcygpID4gMCA/IGR1cmF0aW9uU3RyICsgcGFkV2l0aFplcm8oZHVyYXRpb24ubWludXRlcygpLCAyKSArICdtLCAnIDogZHVyYXRpb25TdHI7XG4gICAgICAgICAgICAgICAgZHVyYXRpb25TdHIgPSBkdXJhdGlvblN0ciArIHBhZFdpdGhaZXJvKGR1cmF0aW9uLnNlY29uZHMoKSwgMikgKyAncyc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGR1cmF0aW9uU3RyO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldERheVN0cmluZzogZnVuY3Rpb24oZGF5TnVtYmVyKXtcbiAgICAgICAgICAgICAgICB2YXIgZGF5QXJyID0gWydTdW5kYXknLCdNb25kYXknLCdUdWVzZGF5JywnV2VkbmVzZGF5JywnVGh1cnNkYXknLCdGcmlkYXknLCdTYXR1cmRheSddO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXlBcnJbZGF5TnVtYmVyXTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc0lFOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICAgICAgICAgICAgIG9sZElFID0gdWEuaW5kZXhPZignTVNJRScpLFxuICAgICAgICAgICAgICAgICAgICBuZXdJRSA9IHVhLmluZGV4T2YoJ1RyaWRlbnQvJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoKG9sZElFID4gLTEpIHx8IChuZXdJRSA+IC0xKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldFZlcnNpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAndicgKyBzY2FsZUNvbmZpZy5tYWpvclZlcnNpb24gKyAnL3ZlcnNpb24vJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCdzY2hlZHVsZXJTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwLCAkcSwgc2NhbGVDb25maWcpIHtcbiAgICAgICAgdmFyIGdldFVwZGF0ZVNjaGVkdWxlckRhdGEgPSBmdW5jdGlvbiAoaXNfcGF1c2VkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlzX3BhdXNlZDogaXNfcGF1c2VkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cGRhdGVTY2hlZHVsZXI6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEgfHwgZ2V0VXBkYXRlU2NoZWR1bGVyRGF0YSgpO1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdzY2hlZHVsZXIvJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCdzdGF0ZVNlcnZpY2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2ZXJzaW9uID0gJyc7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZlcnNpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmVyc2lvbjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRWZXJzaW9uOiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHZlcnNpb24gPSB2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnc3RhdHVzU2VydmljZScsIGZ1bmN0aW9uICgkcmVzb3VyY2UsIHNjYWxlQ29uZmlnLCBwb2xsZXIsIHBvbGxlckZhY3RvcnksIFN0YXR1cykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0U3RhdHVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1c1Jlc291cmNlID0gJHJlc291cmNlKHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3N0YXR1cy8nKSxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzUG9sbGVyID0gcG9sbGVyRmFjdG9yeS5uZXdQb2xsZXIoc3RhdHVzUmVzb3VyY2UsIHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMuc3RhdHVzKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0dXNQb2xsZXIucHJvbWlzZS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFN0YXR1cy50cmFuc2Zvcm1lcihyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9yZXN1bHQgPSBhbmd1bGFyLmV4dGVuZChyZXN1bHQsIHJldHVyblJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNQb2xsZXIuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCd1c2VyU2VydmljZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRVc2VyQ3JlZHM6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIGNyZWRzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJDcmVkcycpO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGNyZWRzKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwYXJzaW5nIHVzZXIgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNyZWRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRVc2VyQ3JlZHM6IGZ1bmN0aW9uKHVzZXIpe1xuICAgICAgICAgICAgICAgIGlmICh1c2VyICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyQ3JlZHMnLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJDcmVkcycpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxvZ2luOiBmdW5jdGlvbiAodXNlcm5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICBpc19hZG1pbjogdHJ1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVc2VyQ3JlZHModXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXI7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9nb3V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVzZXJDcmVkcyhudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9iRGV0YWlsQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJHJvdXRlUGFyYW1zLCAkdWliTW9kYWwsIG5hdlNlcnZpY2UsIGpvYlNlcnZpY2UsIGpvYkV4ZWN1dGlvblNlcnZpY2UsIG5vZGVTZXJ2aWNlLCBsb2FkU2VydmljZSwgc2NhbGVDb25maWcsIHN1Ym5hdlNlcnZpY2UsIHVzZXJTZXJ2aWNlLCBzY2FsZVNlcnZpY2UsIHRvYXN0cikge1xuICAgICAgICAkc2NvcGUuam9iID0ge307XG4gICAgICAgICRzY29wZS5qb2JJZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3Muam9icztcbiAgICAgICAgc3VibmF2U2VydmljZS5zZXRDdXJyZW50UGF0aCgnam9icycpO1xuICAgICAgICAkc2NvcGUubG9hZGluZ0pvYkRldGFpbCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUubGF0ZXN0RXhlY3V0aW9uID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmV4ZWN1dGlvbkxvZyA9IG51bGw7XG4gICAgICAgICRzY29wZS5leGVjdXRpb25EZXRhaWxzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkRXhlY3R1aW9uRGV0YWlsVmFsdWVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnRpbWVsaW5lID0gW107XG4gICAgICAgICRzY29wZS5yZWFkb25seSA9IHRydWU7XG4gICAgICAgICRzY29wZS5qb2JFcnJvckNyZWF0ZWQgPSAnJztcbiAgICAgICAgJHNjb3BlLmpvYkVycm9yTGFzdE1vZGlmaWVkID0gJyc7XG4gICAgICAgICRzY29wZS5sYXN0U3RhdHVzQ2hhbmdlID0gJyc7XG4gICAgICAgICRzY29wZS50cmlnZ2VyT2NjdXJyZWQgPSAnJztcblxuICAgICAgICAkc2NvcGUuc2hvd0xvZyA9IGZ1bmN0aW9uIChleGVjdXRpb24pIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEV4ZWN1dGlvbkxvZyA9IGV4ZWN1dGlvbjtcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Nob3dMb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICAvL3NpemU6ICdsZycsXG4gICAgICAgICAgICAgICAgd2luZG93Q2xhc3M6ICdsb2ctbW9kYWwtd2luZG93J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnNob3dFeGVjdXRpb25EZXRhaWxzID0gZnVuY3Rpb24gKGV4ZWN1dGlvbklkKSB7XG4gICAgICAgICAgICBqb2JFeGVjdXRpb25TZXJ2aWNlLmdldEpvYkV4ZWN1dGlvbkRldGFpbHMoZXhlY3V0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRFeGVjdXRpb25EZXRhaWxzID0gZGF0YTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRFeGVjdXRpb25EZXRhaWxWYWx1ZXMgPSBfLnBhaXJzKGRhdGEpO1xuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2hvd0V4ZWN1dGlvbkRldGFpbHMuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6ICdsZydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5tZWRpYVR5cGVDbGFzcyA9IGZ1bmN0aW9uIChtZWRpYVR5cGUpIHtcbiAgICAgICAgICAgIHZhciBtZWRpYVR5cGVDZmcgPSBfLmZpbmQoc2NhbGVDb25maWcubWVkaWFUeXBlcywgJ21pbWVUeXBlJywgbWVkaWFUeXBlKTtcbiAgICAgICAgICAgIGlmIChtZWRpYVR5cGVDZmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVkaWFUeXBlQ2ZnLmljb247XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZXF1ZXVlSm9iID0gZnVuY3Rpb24gKGpvYklkKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICBsb2FkU2VydmljZS5yZXF1ZXVlSm9icyh7IGpvYl9pZHM6IFtqb2JJZF0gfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHRvYXN0clsnc3VjY2VzcyddKCdSZXF1ZXVlZCBKb2InKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iLnN0YXR1cyA9IGRhdGEuam9iX3N0YXR1cztcbiAgICAgICAgICAgICAgICBnZXRKb2JEZXRhaWwoam9iSWQpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydlcnJvciddKCdSZXF1ZXVlIHJlcXVlc3QgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5jYW5jZWxKb2IgPSBmdW5jdGlvbiAoam9iKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUuYWN0aW9uQ2xpY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWxTdGF0dXMgPSBqb2Iuc3RhdHVzO1xuICAgICAgICAgICAgam9iLnN0YXR1cyA9ICdDQU5DRUwnO1xuICAgICAgICAgICAgam9iU2VydmljZS51cGRhdGVKb2Ioam9iLmlkLCB7IHN0YXR1czogJ0NBTkNFTEVEJyB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydzdWNjZXNzJ10oJ0pvYiBDYW5jZWxlZCcpO1xuICAgICAgICAgICAgICAgIGpvYi5zdGF0dXMgPSAnQ0FOQ0VMRUQnO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydlcnJvciddKGVycm9yKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgam9iLnN0YXR1cyA9IG9yaWdpbmFsU3RhdHVzO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgJHNjb3BlLmNhbGN1bGF0ZUZpbGVTaXplID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tQnl0ZXMoc2l6ZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldEpvYkRldGFpbCA9IGZ1bmN0aW9uIChqb2JJZCkge1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdKb2JEZXRhaWwgPSB0cnVlO1xuICAgICAgICAgICAgam9iU2VydmljZS5nZXRKb2JEZXRhaWwoam9iSWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iID0gZGF0YTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGltZWxpbmUgPSBjYWxjdWxhdGVUaW1lbGluZShkYXRhKTtcbiAgICAgICAgICAgICAgICAvLyAkc2NvcGUucHVibGlzaGVkUHJvZHVjdHMgPSBfLndoZXJlKGRhdGEucHJvZHVjdHMsIHsgJ2lzX3B1Ymxpc2hlZCc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgLy8gJHNjb3BlLnVucHVibGlzaGVkUHJvZHVjdHMgPSBfLndoZXJlKGRhdGEucHJvZHVjdHMsIHsgJ2lzX3B1Ymxpc2hlZCc6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIC8vICRzY29wZS5wdWJsaXNoZWRQcm9kdWN0c0dyb3VwZWQgPSBfLnBhaXJzKF8uZ3JvdXBCeSgkc2NvcGUucHVibGlzaGVkUHJvZHVjdHMsICdqb2JfZXhlLmlkJykpO1xuICAgICAgICAgICAgICAgICRzY29wZS5sYXRlc3RFeGVjdXRpb24gPSBkYXRhLmdldExhdGVzdEV4ZWN1dGlvbigpO1xuICAgICAgICAgICAgICAgICRzY29wZS5qb2JFcnJvckNyZWF0ZWQgPSBkYXRhLmVycm9yID8gbW9tZW50LnV0YyhkYXRhLmVycm9yLmNyZWF0ZWQpLnRvSVNPU3RyaW5nKCkgOiAnJztcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFzdFN0YXR1c0NoYW5nZSA9IGRhdGEubGFzdF9zdGF0dXNfY2hhbmdlID8gbW9tZW50LmR1cmF0aW9uKG1vbWVudC51dGMoZGF0YS5sYXN0X3N0YXR1c19jaGFuZ2UpLmRpZmYobW9tZW50LnV0YygpKSkuaHVtYW5pemUodHJ1ZSkgOiAnJztcbiAgICAgICAgICAgICAgICAkc2NvcGUudHJpZ2dlck9jY3VycmVkID0gZGF0YS5ldmVudC5vY2N1cnJlZCA/IG1vbWVudC5kdXJhdGlvbihtb21lbnQudXRjKGRhdGEuZXZlbnQub2NjdXJyZWQpLmRpZmYobW9tZW50LnV0YygpKSkuaHVtYW5pemUodHJ1ZSkgOiAnJztcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW5wdXRzID0gZGF0YS5pbnB1dHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm91dHB1dHMgPSBkYXRhLm91dHB1dHM7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZ0pvYkRldGFpbCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZVRpbWVsaW5lID0gZnVuY3Rpb24gKGpvYikge1xuICAgICAgICAgICAgdmFyIHRsID0gW107XG4gICAgICAgICAgICB0bC5wdXNoKHsgdGFza05hbWU6ICdDcmVhdGVkJywgc3RhcnRlZDogam9iLmNyZWF0ZWQgPyBtb21lbnQudXRjKGpvYi5jcmVhdGVkKS50b0RhdGUoKSA6IGpvYi5jcmVhdGVkLCBlbmRlZDogam9iLnF1ZXVlZCA/IG1vbWVudC51dGMoam9iLnF1ZXVlZCkudG9EYXRlKCkgOiBqb2IucXVldWVkIH0pO1xuICAgICAgICAgICAgdGwucHVzaCh7IHRhc2tOYW1lOiAnUXVldWVkJywgc3RhcnRlZDogam9iLnF1ZXVlZCA/IG1vbWVudC51dGMoam9iLnF1ZXVlZCkudG9EYXRlKCkgOiBqb2IucXVldWVkLCBlbmRlZDogam9iLnN0YXJ0ZWQgPyBtb21lbnQudXRjKGpvYi5zdGFydGVkKS50b0RhdGUoKSA6IGpvYi5zdGFydGVkIH0pO1xuICAgICAgICAgICAgdGwucHVzaCh7IHRhc2tOYW1lOiAnRXhlY3V0ZWQnLCBzdGFydGVkOiBqb2Iuc3RhcnRlZCA/IG1vbWVudC51dGMoam9iLnN0YXJ0ZWQpLnRvRGF0ZSgpIDogam9iLnN0YXJ0ZWQsIGVuZGVkOiBqb2IuZW5kZWQgPyBtb21lbnQudXRjKGpvYi5lbmRlZCkudG9EYXRlKCkgOiBqb2IuZW5kZWQgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0bDtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG5hdlNlcnZpY2UudXBkYXRlTG9jYXRpb24oJ2pvYnMnKTtcblxuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckNyZWRzKCk7XG4gICAgICAgICAgICBpZigkcm9vdFNjb3BlLnVzZXIpe1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWFkb25seSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZXRKb2JEZXRhaWwoJHNjb3BlLmpvYklkKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdqb2JFeGVjdXRpb25EZXRhaWxDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIG5hdlNlcnZpY2UsIGpvYkV4ZWN1dGlvblNlcnZpY2UsIG5vZGVTZXJ2aWNlLCBzY2FsZUNvbmZpZywgc3VibmF2U2VydmljZSkge1xuICAgICAgICAkc2NvcGUuam9iRXhlY3V0aW9uID0ge307XG4gICAgICAgICRzY29wZS5qb2JFeGVjdXRpb25JZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5qb2JzO1xuICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdqb2JzL3J1bnMnKTtcblxuICAgICAgICB2YXIgZ2V0Sm9iRXhlY3V0aW9uRGV0YWlsID0gZnVuY3Rpb24gKGpvYkV4ZWN1dGlvbklkKSB7XG4gICAgICAgICAgICBqb2JFeGVjdXRpb25TZXJ2aWNlLmdldEpvYkV4ZWN1dGlvbkRldGFpbChpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5qb2JFeGVjdXRpb24gPSBkYXRhO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZ2V0Sm9iRXhlY3V0aW9uRGV0YWlsKCRyb3V0ZVBhcmFtcy5pZCk7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdqb2JzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2pvYkV4ZWN1dGlvbnNDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sIG5hdlNlcnZpY2UsIHN0YXRzU2VydmljZSwgam9iRXhlY3V0aW9uU2VydmljZSwgam9iVHlwZVNlcnZpY2UsIHVpR3JpZENvbnN0YW50cywgc2NhbGVDb25maWcsIHN1Ym5hdlNlcnZpY2UpIHtcblxuICAgICAgICAkc2NvcGUuam9iRXhlY3V0aW9ucyA9IFtdO1xuICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICRzY29wZS5qb2JUeXBlVmFsdWVzID0gW107XG4gICAgICAgICRzY29wZS5zZWxlY3RlZEpvYlR5cGUgPSAnJztcbiAgICAgICAgJHNjb3BlLmpvYlN0YXR1cyA9IHNjYWxlQ29uZmlnLmpvYlN0YXR1cztcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iU3RhdHVzID0gJyc7XG4gICAgICAgICRzY29wZS5zdWJuYXZMaW5rcyA9IHNjYWxlQ29uZmlnLnN1Ym5hdkxpbmtzLmpvYnM7XG4gICAgICAgIHN1Ym5hdlNlcnZpY2Uuc2V0Q3VycmVudFBhdGgoJ2pvYnMvZXhlY3V0aW9ucycpO1xuXG4gICAgICAgIHZhciBncmlkRmlsdGVyID0ge30sXG4gICAgICAgICAgICBncmlkUGFnZU51bWJlciA9IDE7XG5cbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zID0ge1xuICAgICAgICAgICAgZW5hYmxlUm93U2VsZWN0aW9uOiB0cnVlLFxuICAgICAgICAgICAgZW5hYmxlUm93SGVhZGVyU2VsZWN0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIGVuYWJsZUhvcml6b250YWxTY3JvbGxiYXI6IHVpR3JpZENvbnN0YW50cy5zY3JvbGxiYXJzLk5FVkVSLFxuICAgICAgICAgICAgbXVsdGlTZWxlY3Q6IGZhbHNlLFxuICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiB0cnVlLFxuICAgICAgICAgICAgdXNlRXh0ZXJuYWxGaWx0ZXJpbmc6IHRydWUsXG4gICAgICAgICAgICBlbmFibGVTb3J0aW5nOiB0cnVlLFxuICAgICAgICAgICAgbWluUm93c1RvU2hvdzogMTcsXG4gICAgICAgICAgICBwYWdpbmF0aW9uUGFnZVNpemVzOiBbMjUsNTAsNzVdLFxuICAgICAgICAgICAgcGFnaW5hdGlvblBhZ2VTaXplOiAyNSxcbiAgICAgICAgICAgIHVzZUV4dGVybmFsUGFnaW5hdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIGNvbHVtbkRlZnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiAnam9iVHlwZUlkJyxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdKb2IgVHlwZScsXG4gICAgICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj48c3BhbiBuZy1iaW5kLWh0bWw9XCJyb3cuZW50aXR5LmdldEljb24oKVwiPjwvc3Bhbj4ge3sgcm93LmVudGl0eS5qb2Iuam9iVHlwZS50aXRsZSB9fTwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlckhlYWRlclRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtZmlsdGVyLWNvbnRhaW5lclwiPjxzZWxlY3QgY2xhc3M9XCJmb3JtLWNvbnRyb2wgaW5wdXQtc21cIiBuZy1tb2RlbD1cImdyaWQuYXBwU2NvcGUuc2VsZWN0ZWRKb2JUeXBlXCI+PG9wdGlvbiB2YWx1ZT1cInt7IGdyaWQuYXBwU2NvcGUuam9iVHlwZVZhbHVlc1skaW5kZXhdLmlkIH19XCIgbmctcmVwZWF0PVwiam9iVHlwZSBpbiBncmlkLmFwcFNjb3BlLmpvYlR5cGVWYWx1ZXMgdHJhY2sgYnkgJGluZGV4XCI+e3sgZ3JpZC5hcHBTY29wZS5qb2JUeXBlVmFsdWVzWyRpbmRleF0ubmFtZSB9fSB7eyBncmlkLmFwcFNjb3BlLmpvYlR5cGVWYWx1ZXNbJGluZGV4XS52ZXJzaW9uIH19PC9vcHRpb24+PC9zZWxlY3Q+J1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ2NyZWF0ZWQnLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLCBjZWxsRmlsdGVyOiAnZGF0ZTpcXCd5eXl5LU1NLWRkIEhIOm1tOnNzXFwnJyB9LFxuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdsYXN0TW9kaWZpZWQnLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLCBjZWxsRmlsdGVyOiAnZGF0ZTpcXCd5eXl5LU1NLWRkIEhIOm1tOnNzXFwnJyB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICdzdGF0dXMnLFxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJIZWFkZXJUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWZpbHRlci1jb250YWluZXJcIj48c2VsZWN0IGNsYXNzPVwiZm9ybS1jb250cm9sIGlucHV0LXNtXCIgbmctbW9kZWw9XCJncmlkLmFwcFNjb3BlLnNlbGVjdGVkSm9iU3RhdHVzXCI+PG9wdGlvbiBuZy1yZXBlYXQ9XCJzdGF0dXMgaW4gZ3JpZC5hcHBTY29wZS5qb2JTdGF0dXMgdHJhY2sgYnkgJGluZGV4XCI+e3sgc3RhdHVzLnRvVXBwZXJDYXNlKCkgfX08L29wdGlvbj48L3NlbGVjdD4nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAnaWQnLCBkaXNwbGF5TmFtZTogJ0lEJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgICBvblJlZ2lzdGVyQXBpOiBmdW5jdGlvbiAoZ3JpZEFwaSkge1xuICAgICAgICAgICAgICAgIC8vc2V0IGdyaWRBcGkgb24gc2NvcGVcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaSA9IGdyaWRBcGk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkuc2VsZWN0aW9uLm9uLnJvd1NlbGVjdGlvbkNoYW5nZWQoJHNjb3BlLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8kbG9jYXRpb24ucGF0aCgnL2pvYmV4ZWN1dGlvbnMvJyArIHJvdy5lbnRpdHkuaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocm93KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkucGFnaW5hdGlvbi5vbi5wYWdpbmF0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFBhZ2UoY3VycmVudFBhZ2UsIHBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdzZWxlY3RlZEpvYlR5cGUnLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICBncmlkRmlsdGVyLmpvYlR5cGVJZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRQYWdlKGdyaWRQYWdlTnVtYmVyLCAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplLCBncmlkRmlsdGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnc2VsZWN0ZWRKb2JTdGF0dXMnLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICBncmlkRmlsdGVyLmpvYlN0YXR1cyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRQYWdlKGdyaWRQYWdlTnVtYmVyLCAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplLCBncmlkRmlsdGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLmdldFBhZ2UgPSBmdW5jdGlvbiAocGFnZU51bWJlciwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGdyaWRQYWdlTnVtYmVyID0gcGFnZU51bWJlcjtcbiAgICAgICAgICAgIGpvYkV4ZWN1dGlvblNlcnZpY2UuZ2V0Sm9iRXhlY3V0aW9ucyhwYWdlTnVtYmVyLCBwYWdlU2l6ZSwgZ3JpZEZpbHRlcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZXhlY3V0aW9uc1tpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGRhdGEuZXhlY3V0aW9uc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSBuZXdEYXRhO1xuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy50b3RhbEl0ZW1zID0gZGF0YS5jb3VudDtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0Sm9iRXhlY3V0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYkV4ZWN1dGlvblNlcnZpY2UuZ2V0Sm9iRXhlY3V0aW9ucyhncmlkUGFnZU51bWJlciwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZSwgZ3JpZEZpbHRlcikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbJ3NjYWxlLWpvYmV4ZWN1dGlvbnMtdGltZSddID0gbW9tZW50LnV0YygpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZVsnc2NhbGUtam9iZXhlY3V0aW9ucyddID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLnRvdGFsSXRlbXMgPSBkYXRhLmNvdW50O1xuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gZGF0YS5leGVjdXRpb25zO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZ2V0Sm9iVHlwZXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzT25jZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcyA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcy51bnNoaWZ0KHsgbmFtZTogJycsIHZlcnNpb246ICcnLCBpZDogbnVsbCB9KTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZ2V0Sm9iRXhlY3V0aW9ucygpO1xuICAgICAgICAgICAgbmF2U2VydmljZS51cGRhdGVMb2NhdGlvbignam9icycpO1xuICAgICAgICB9O1xuICAgICAgICBpbml0aWFsaXplKCk7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9iVHlwZXNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sIGhvdGtleXMsIHNjYWxlU2VydmljZSwgbmF2U2VydmljZSwgam9iVHlwZVNlcnZpY2UsIHNjYWxlQ29uZmlnLCBzdWJuYXZTZXJ2aWNlLCBub2RlU2VydmljZSwgbG9jYWxTdG9yYWdlLCB1c2VyU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuY29udGFpbmVyU3R5bGUgPSAnJztcbiAgICAgICAgJHNjb3BlLnJlcXVlc3RlZEpvYlR5cGVJZCA9IHBhcnNlSW50KCRyb3V0ZVBhcmFtcy5pZCk7XG4gICAgICAgICRzY29wZS5qb2JUeXBlcyA9IFtdO1xuICAgICAgICAkc2NvcGUuam9iVHlwZUlkcyA9IFtdO1xuICAgICAgICAkc2NvcGUuam9iVHlwZUNvdW50ID0gMDtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGVEZXRhaWxzID0ge307XG4gICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlSW50ZXJmYWNlVmFsdWVzID0gW107XG4gICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlRXJyb3JzID0gW107XG4gICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlU3RhdHMgPSB7fTtcbiAgICAgICAgJHNjb3BlLnNob3dKb2JUeXBlRXJyb3JzID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGUgPSBudWxsO1xuICAgICAgICAkc2NvcGUuaGVhbHRoRGF0YTYgPSB7fTtcbiAgICAgICAgJHNjb3BlLmhlYWx0aERhdGExMiA9IHt9O1xuICAgICAgICAkc2NvcGUuaGVhbHRoRGF0YTI0ID0ge307XG4gICAgICAgICRzY29wZS5hY3Rpdml0eUljb24gPSAnPGkgY2xhc3M9XCJmYSBmYS1wdWxzZVwiPiYjeCcgKyBzY2FsZUNvbmZpZy5hY3Rpdml0eUljb25Db2RlICsgJzwvaT4nO1xuICAgICAgICAkc2NvcGUuam9iRGV0YWlsc0NsYXNzID0gJ2hpZGRlbic7XG4gICAgICAgICRzY29wZS5wYXVzZUJ0bkNsYXNzID0gJ2ZhLXBhdXNlJztcbiAgICAgICAgJHNjb3BlLnVzZXIgPSB1c2VyU2VydmljZS5nZXRVc2VyQ3JlZHMoKTtcbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3Muam9icztcbiAgICAgICAgc3VibmF2U2VydmljZS5zZXRDdXJyZW50UGF0aCgnam9icy90eXBlcycpO1xuXG4gICAgICAgIHZhciBqb2JUeXBlU3RhdHMgPSB7fTtcblxuICAgICAgICAkc2NvcGUudmlld0RldGFpbHMgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlID0gXy5maW5kKCRzY29wZS5qb2JUeXBlcywgJ2lkJywgaWQpO1xuICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGUuY3JlYXRlZCA9IGZvcm1hdERhdGVUaW1lKCRzY29wZS5hY3RpdmVKb2JUeXBlLmNyZWF0ZWQpO1xuICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGUubGFzdE1vZGlmaWVkID0gZm9ybWF0RGF0ZVRpbWUoJHNjb3BlLmFjdGl2ZUpvYlR5cGUubGFzdE1vZGlmaWVkKTtcblxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJ2pvYnMvdHlwZXMvJyArIGlkKTtcblxuICAgICAgICAgICAgZ2V0Sm9iVHlwZURldGFpbHMoJHNjb3BlLmFjdGl2ZUpvYlR5cGUuaWQpO1xuXG4gICAgICAgICAgICAvL2Zvcm1hdEpvYlR5cGVTdGF0cygpO1xuXG4gICAgICAgICAgICAkc2NvcGUuam9iRGV0YWlsc0NsYXNzID0gJ3Zpc2libGUnO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS50b2dnbGVQYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlLmlzX3BhdXNlZCA9ICEkc2NvcGUuYWN0aXZlSm9iVHlwZS5pc19wYXVzZWQ7XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlSm9iVHlwZURldGFpbHMuaXNfcGF1c2VkID0gJHNjb3BlLmFjdGl2ZUpvYlR5cGUuaXNfcGF1c2VkO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgam9iVHlwZVNlcnZpY2UudXBkYXRlSm9iVHlwZSgkc2NvcGUuYWN0aXZlSm9iVHlwZURldGFpbHMpLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGVEZXRhaWxzID0gZGF0YTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGF1c2VCdG5DbGFzcyA9ICRzY29wZS5nZXRQYXVzZUJ1dHRvbkNsYXNzKCRzY29wZS5hY3RpdmVKb2JUeXBlRGV0YWlscy5pc19wYXVzZWQpO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydlcnJvciddKGVycm9yKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmdldFBhdXNlQnV0dG9uQ2xhc3MgPSBmdW5jdGlvbihpc19wYXVzZWQpe1xuICAgICAgICAgICAgcmV0dXJuIGlzX3BhdXNlZCA/ICdmYS1wbGF5JyA6ICdmYS1wYXVzZSc7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuZ2V0Sm9iVHlwZUxpc3RJdGVtQ2xhc3MgPSBmdW5jdGlvbihqb2JUeXBlKXtcbiAgICAgICAgICAgIHJldHVybiBqb2JUeXBlLmlzX3BhdXNlZCA/ICdwYXVzZWQnIDogJyc7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZm9ybWF0RGF0ZVRpbWUgPSBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgICAgIHJldHVybiBtb21lbnQudXRjKGR0KS50b0lTT1N0cmluZygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzT25jZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZXMgPSBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmpvYlR5cGVJZHMgPSBfLnBsdWNrKGRhdGEucmVzdWx0cywgJ2lkJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmpvYlR5cGVDb3VudCA9IGRhdGEuY291bnQ7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZXF1ZXN0ZWRKb2JUeXBlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZpZXdEZXRhaWxzKCRzY29wZS5yZXF1ZXN0ZWRKb2JUeXBlSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhvdGtleXMuYmluZFRvKCRzY29wZSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21ibzogJ2N0cmwrdXAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdQcmV2aW91cyBKb2IgVHlwZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWN0aXZlSm9iVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gXy5pbmRleE9mKCRzY29wZS5qb2JUeXBlSWRzLCAkc2NvcGUuYWN0aXZlSm9iVHlwZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudmlld0RldGFpbHMoJHNjb3BlLmpvYlR5cGVJZHNbaWR4IC0gMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KS5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tYm86ICdjdHJsK2Rvd24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdOZXh0IEpvYiBUeXBlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVKb2JUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBfLmluZGV4T2YoJHNjb3BlLmpvYlR5cGVJZHMsICRzY29wZS5hY3RpdmVKb2JUeXBlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA8ICgkc2NvcGUuam9iVHlwZUlkcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnZpZXdEZXRhaWxzKCRzY29wZS5qb2JUeXBlSWRzW2lkeCArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlRGV0YWlscyA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgam9iVHlwZVNlcnZpY2UuZ2V0Sm9iVHlwZURldGFpbHMoaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlSm9iVHlwZURldGFpbHMgPSBkYXRhO1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlSW50ZXJmYWNlVmFsdWVzID0gXy5wYWlycyhkYXRhLmpvYl90eXBlX2ludGVyZmFjZSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhdXNlQnRuQ2xhc3MgPSAkc2NvcGUuZ2V0UGF1c2VCdXR0b25DbGFzcygkc2NvcGUuYWN0aXZlSm9iVHlwZURldGFpbHMuaXNfcGF1c2VkKTtcbiAgICAgICAgICAgICAgICAvLyBmb3JtYXQgZXJyb3IgbWFwcGluZ1xuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVKb2JUeXBlRXJyb3JzID0gW107XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dKb2JUeXBlRXJyb3JzID0gXy5rZXlzKGRhdGEuZXJyb3JfbWFwcGluZy5leGl0X2NvZGVzKS5sZW5ndGggPiAwO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2hvd0pvYlR5cGVFcnJvcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEuZXJyb3JfbWFwcGluZy5leGl0X2NvZGVzLCBmdW5jdGlvbiAoZXJyb3JfbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gXy5maW5kKGRhdGEuZXJyb3JzLCAnbmFtZScsIGVycm9yX25hbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXRDb2RlID0gXy5pbnZlcnQoZGF0YS5lcnJvcl9tYXBwaW5nLmV4aXRfY29kZXMpW2Vycm9yX25hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZUpvYlR5cGVFcnJvcnMucHVzaCh7Y29kZTogZXhpdENvZGUsIGRhdGE6IGVycm9yfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGZvcm1hdCBqb2IgdHlwZSBzdGF0c1xuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZSA9IGRhdGEuZ2V0UGVyZm9ybWFuY2UoKSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbHVyZXMgPSBkYXRhLmdldEZhaWx1cmVzKCk7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aXZlSm9iVHlwZVN0YXRzID0gcGVyZm9ybWFuY2U7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuaGVhbHRoRGF0YTYgPSB7XG4gICAgICAgICAgICAgICAgICAgIGdhdWdlRGF0YTogcGVyZm9ybWFuY2UuaG91cjYucmF0ZSxcbiAgICAgICAgICAgICAgICAgICAgZG9udXREYXRhOiBmYWlsdXJlcy5ob3VyNlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhlYWx0aERhdGExMiA9IHtcbiAgICAgICAgICAgICAgICAgICAgZ2F1Z2VEYXRhOiBwZXJmb3JtYW5jZS5ob3VyMTIucmF0ZSxcbiAgICAgICAgICAgICAgICAgICAgZG9udXREYXRhOiBmYWlsdXJlcy5ob3VyMTJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5oZWFsdGhEYXRhMjQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGdhdWdlRGF0YTogcGVyZm9ybWFuY2UuaG91cjI0LnJhdGUsXG4gICAgICAgICAgICAgICAgICAgIGRvbnV0RGF0YTogZmFpbHVyZXMuaG91cjI0XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGdldEpvYlR5cGVzKCk7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdqb2JzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHNjYWxlQ29uZmlnLmhlYWRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBjb250YWluZXJNYXhIZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgLSBvZmZzZXQ7XG5cbiAgICAgICAgICAgICRzY29wZS5jb250YWluZXJTdHlsZSA9ICdoZWlnaHQ6ICcgKyBjb250YWluZXJNYXhIZWlnaHQgKyAncHg7IG1heC1oZWlnaHQ6ICcgKyBjb250YWluZXJNYXhIZWlnaHQgKyAncHg7JztcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9iVHlwZXNGYWlsdXJlUmF0ZXNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBzY2FsZUNvbmZpZywgc2NhbGVTZXJ2aWNlLCBzdWJuYXZTZXJ2aWNlLCBqb2JUeXBlU2VydmljZSwgbWV0cmljc1NlcnZpY2UsIGdyaWRGYWN0b3J5LCBKb2JUeXBlLCB0b2FzdHIsIG1vbWVudCkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLmpvYlR5cGVQYXJhbXMgPSB7XG4gICAgICAgICAgICBwYWdlOiBudWxsLFxuICAgICAgICAgICAgcGFnZV9zaXplOiBudWxsLFxuICAgICAgICAgICAgc3RhcnRlZDogbnVsbCxcbiAgICAgICAgICAgIGVuZGVkOiBudWxsLFxuICAgICAgICAgICAgbmFtZTogbnVsbCxcbiAgICAgICAgICAgIGNhdGVnb3J5OiBudWxsLFxuICAgICAgICAgICAgb3JkZXI6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBjaGVjayBmb3Igam9iVHlwZVBhcmFtcyBpbiBxdWVyeSBzdHJpbmcsIGFuZCB1cGRhdGUgYXMgbmVjZXNzYXJ5XG4gICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKHZtLmpvYlR5cGVQYXJhbXMpLCBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IF8uYXQoJGxvY2F0aW9uLnNlYXJjaCgpLCBwYXJhbVswXSk7XG4gICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZtLmpvYlR5cGVQYXJhbXNbcGFyYW1bMF1dID0gdmFsdWUubGVuZ3RoID4gMSA/IHZhbHVlIDogdmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBzdGFydGVkID0gbW9tZW50LnV0YygpLnN1YnRyYWN0KDMwLCAnZCcpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBlbmRlZCA9IG1vbWVudC51dGMoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgam9iVHlwZXMgPSBbXSxcbiAgICAgICAgICAgIG51bURheXMgPSBtb21lbnQudXRjKGVuZGVkKS5kaWZmKG1vbWVudC51dGMoc3RhcnRlZCksICdkJyksXG4gICAgICAgICAgICBmaWx0ZXJlZEJ5Sm9iVHlwZSA9IHZtLmpvYlR5cGVQYXJhbXMubmFtZSA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICB2bS5zY2FsZVNlcnZpY2UgPSBzY2FsZVNlcnZpY2U7XG4gICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICB2bS5kYXRlcyA9IFtdO1xuICAgICAgICB2bS5wZXJmb3JtYW5jZURhdGEgPSBbXTtcbiAgICAgICAgdm0uam9iVHlwZVZhbHVlcyA9IFtdO1xuICAgICAgICB2bS5zZWxlY3RlZEpvYlR5cGUgPSB2bS5qb2JUeXBlUGFyYW1zLm5hbWUgfHwgJyc7XG4gICAgICAgIHZtLmdyaWRTdHlsZSA9ICcnO1xuICAgICAgICB2bS5zdWJuYXZMaW5rcyA9IHNjYWxlQ29uZmlnLnN1Ym5hdkxpbmtzLmpvYnM7XG4gICAgICAgIHN1Ym5hdlNlcnZpY2Uuc2V0Q3VycmVudFBhdGgoJ2pvYnMvZmFpbHVyZS1yYXRlcycpO1xuXG4gICAgICAgIHZhciBkZWZhdWx0Q29sdW1uRGVmcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2pvYl90eXBlJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0pvYiBUeXBlJyxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+PHNwYW4gbmctYmluZC1odG1sPVwicm93LmVudGl0eS5qb2JfdHlwZS5nZXRJY29uKClcIj48L3NwYW4+IHt7IHJvdy5lbnRpdHkuam9iX3R5cGUudGl0bGUgfX0ge3sgcm93LmVudGl0eS5qb2JfdHlwZS52ZXJzaW9uIH19PC9kaXY+JyxcbiAgICAgICAgICAgICAgICBmaWx0ZXJIZWFkZXJUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWZpbHRlci1jb250YWluZXJcIj48c2VsZWN0IGNsYXNzPVwiZm9ybS1jb250cm9sIGlucHV0LXNtXCIgbmctbW9kZWw9XCJncmlkLmFwcFNjb3BlLnZtLnNlbGVjdGVkSm9iVHlwZVwiPjxvcHRpb24gbmctaWY9XCJncmlkLmFwcFNjb3BlLnZtLmpvYlR5cGVWYWx1ZXNbJGluZGV4XVwiIG5nLXNlbGVjdGVkPVwie3sgZ3JpZC5hcHBTY29wZS52bS5qb2JUeXBlVmFsdWVzWyRpbmRleF0ubmFtZSA9PSBncmlkLmFwcFNjb3BlLnZtLnNlbGVjdGVkSm9iVHlwZSB9fVwiIHZhbHVlPVwie3sgZ3JpZC5hcHBTY29wZS52bS5qb2JUeXBlVmFsdWVzWyRpbmRleF0ubmFtZSB9fVwiIG5nLXJlcGVhdD1cImpvYlR5cGUgaW4gZ3JpZC5hcHBTY29wZS52bS5qb2JUeXBlVmFsdWVzIHRyYWNrIGJ5ICRpbmRleFwiPnt7IGdyaWQuYXBwU2NvcGUudm0uam9iVHlwZVZhbHVlc1skaW5kZXhdLnRpdGxlIH19IHt7IGdyaWQuYXBwU2NvcGUudm0uam9iVHlwZVZhbHVlc1skaW5kZXhdLnZlcnNpb24gfX08L29wdGlvbj48L3NlbGVjdD48L2Rpdj4nLFxuICAgICAgICAgICAgICAgIGVuYWJsZVNvcnRpbmc6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAndHdlbnR5Zm91cl9ob3VycycsXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICcyNCBIb3VycycsXG4gICAgICAgICAgICAgICAgZW5hYmxlU29ydGluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBoZWFkZXJDZWxsVGVtcGxhdGU6ICdncmlkSGVhZGVyLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJ2dyaWRSb3cuaHRtbCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICdmb3J0eWVpZ2h0X2hvdXJzJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJzQ4IEhvdXJzJyxcbiAgICAgICAgICAgICAgICBlbmFibGVTb3J0aW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGhlYWRlckNlbGxUZW1wbGF0ZTogJ2dyaWRIZWFkZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnZ3JpZFJvdy5odG1sJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ3RoaXJ0eV9kYXlzJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJzMwIERheXMnLFxuICAgICAgICAgICAgICAgIGVuYWJsZVNvcnRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVuYWJsZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgaGVhZGVyQ2VsbFRlbXBsYXRlOiAnZ3JpZEhlYWRlci5odG1sJyxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICdncmlkUm93Lmh0bWwnXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdm0uZ3JpZE9wdGlvbnMgPSBncmlkRmFjdG9yeS5kZWZhdWx0R3JpZE9wdGlvbnMoKTtcbiAgICAgICAgdm0uZ3JpZE9wdGlvbnMuY29sdW1uRGVmcyA9IGRlZmF1bHRDb2x1bW5EZWZzO1xuICAgICAgICB2bS5ncmlkT3B0aW9ucy5kYXRhID0gW107XG4gICAgICAgIHZtLmdyaWRPcHRpb25zLm9uUmVnaXN0ZXJBcGkgPSBmdW5jdGlvbiAoZ3JpZEFwaSkge1xuICAgICAgICAgICAgLy9zZXQgZ3JpZEFwaSBvbiBzY29wZVxuICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkgPSBncmlkQXBpO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkuc2VsZWN0aW9uLm9uLnJvd1NlbGVjdGlvbkNoYW5nZWQoJHNjb3BlLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3Rpb25DbGlja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3Rpb25DbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2pvYnMvdHlwZXMvJyArIHJvdy5lbnRpdHkuam9iX3R5cGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHZtLnNldFN0eWxlID0gZnVuY3Rpb24gKGNvbEZpZWxkLCBlcnJvclR5cGUpIHtcbiAgICAgICAgICAgIHZhciBlcnJvclZhbHVlID0gKGNvbEZpZWxkW2Vycm9yVHlwZV0gLyBjb2xGaWVsZC50b3RhbCkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIHZhciB0ZXh0Q29sb3IgPSBlcnJvclZhbHVlID49IDAuNSA/ICcjZmZmJyA6ICcjMDAwJztcbiAgICAgICAgICAgIHZhciByZ2IgPSBlcnJvclR5cGUgPT09ICdzeXN0ZW0nID8gJzEwMywgMCwgMTMnIDogZXJyb3JUeXBlID09PSAnYWxnb3JpdGhtJyA/ICcyMDMsIDI0LCAyOScgOiAnMjQxLCAxMDUsIDE5JztcbiAgICAgICAgICAgIHJldHVybiAnYmFja2dyb3VuZDogcmdiYSgnICsgcmdiICsgJywgJyArIGVycm9yVmFsdWUgKyAnKTsgY29sb3I6ICcgKyB0ZXh0Q29sb3I7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB2bS5nZXRQZXJjZW50YWdlT2ZUb3RhbCA9IGZ1bmN0aW9uIChlcnJvclRvdGFsLCB0b3RhbCkge1xuICAgICAgICAgICAgaWYgKHRvdGFsID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcxMDAlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAoKGVycm9yVG90YWwgLyB0b3RhbCkgKiAxMDApLnRvRml4ZWQoMCkgKyAnJSc7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uZmlsdGVyUmVzdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKHZtLmpvYlR5cGVQYXJhbXMpLCBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKHBhcmFtWzBdLCBwYXJhbVsxXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgaW5pdGlhbGl6ZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLnVwZGF0ZUpvYlR5cGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZtLmpvYlR5cGVQYXJhbXMubmFtZSA9IHZhbHVlID09PSAnVklFVyBBTEwnID8gbnVsbCA6IHZhbHVlO1xuICAgICAgICAgICAgaWYgKCF2bS5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgdm0uZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBmb3JtYXREYXRhID0gZnVuY3Rpb24gKGRhdGEsIG51bURheXMpIHtcbiAgICAgICAgICAgIHZhciBkYXRhQXJyID0gW107XG4gICAgICAgICAgICBfLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJlZFJlc3VsdCA9IF8uZmlsdGVyKHJlc3VsdCwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBtb21lbnQudXRjKGQuZGF0ZSwgJ1lZWVktTU0tREQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vbWVudC51dGMoKS5kaWZmKG1vbWVudC51dGMoZGF0ZSksICdkJykgPD0gbnVtRGF5cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBkYXRhQXJyLnB1c2goZmlsdGVyZWRSZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YUFycjtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZm9ybWF0Q29sdW1uID0gZnVuY3Rpb24gKGNEYXRhLCBpZCkge1xuICAgICAgICAgICAgdmFyIHN5c3RlbUVycm9ycyA9IGNEYXRhWzBdLFxuICAgICAgICAgICAgICAgIGFsZ29yaXRobUVycm9ycyA9IGNEYXRhWzFdLFxuICAgICAgICAgICAgICAgIGRhdGFFcnJvcnMgPSBjRGF0YVsyXSxcbiAgICAgICAgICAgICAgICB0b3RhbENvdW50ID0gY0RhdGFbM107XG5cbiAgICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgc3lzdGVtOiBfLnN1bShfLm1hcChfLmZpbHRlcihzeXN0ZW1FcnJvcnMsIHsgaWQ6IGlkIH0pLCAndmFsdWUnKSksXG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtOiBfLnN1bShfLm1hcChfLmZpbHRlcihhbGdvcml0aG1FcnJvcnMsIHsgaWQ6IGlkIH0pLCAndmFsdWUnKSksXG4gICAgICAgICAgICAgICAgZGF0YTogXy5zdW0oXy5tYXAoXy5maWx0ZXIoZGF0YUVycm9ycywgeyBpZDogaWQgfSksICd2YWx1ZScpKSxcbiAgICAgICAgICAgICAgICB0b3RhbDogXy5zdW0oXy5tYXAoXy5maWx0ZXIodG90YWxDb3VudCwgeyBpZDogaWQgfSksICd2YWx1ZScpKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG9iai5lcnJvclRvdGFsID0gb2JqLnN5c3RlbSArIG9iai5hbGdvcml0aG0gKyBvYmouZGF0YTtcblxuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzT25jZSgpLnRoZW4oZnVuY3Rpb24gKGpvYlR5cGVzRGF0YSkge1xuICAgICAgICAgICAgICAgIGpvYlR5cGVzID0gXy5jbG9uZURlZXAoam9iVHlwZXNEYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIHZtLmpvYlR5cGVWYWx1ZXMgPSBfLmNsb25lRGVlcChqb2JUeXBlc0RhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgdm0uam9iVHlwZVZhbHVlcy51bnNoaWZ0KHsgbmFtZTogJ1ZJRVcgQUxMJywgdGl0bGU6ICdWSUVXIEFMTCcsIHZlcnNpb246ICcnLCBpZDogMCB9KTtcbiAgICAgICAgICAgICAgICB2bS5ncmlkT3B0aW9ucy50b3RhbEl0ZW1zID0gam9iVHlwZXNEYXRhLmNvdW50O1xuXG4gICAgICAgICAgICAgICAgdmFyIG1ldHJpY3NQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRlZDogc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZW5kZWQ6IGVuZGVkLFxuICAgICAgICAgICAgICAgICAgICBjaG9pY2VfaWQ6IF8ubWFwKGpvYlR5cGVzLCAnaWQnKSxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBbJ3N5c3RlbV9lcnJvcl9jb3VudCcsICdhbGdvcml0aG1fZXJyb3JfY291bnQnLCAnZGF0YV9lcnJvcl9jb3VudCcsICd0b3RhbF9jb3VudCddLFxuICAgICAgICAgICAgICAgICAgICBncm91cDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqb2ItdHlwZXMnXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIG1ldHJpY3NTZXJ2aWNlLmdldFBsb3REYXRhKG1ldHJpY3NQYXJhbXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEucmVzdWx0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YTMwRGF5cyA9IF8ubWFwKGRhdGEucmVzdWx0cywgJ3ZhbHVlcycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE0OEhvdXJzID0gZm9ybWF0RGF0YShkYXRhMzBEYXlzLCAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhMjRIb3VycyA9IGZvcm1hdERhdGEoZGF0YTQ4SG91cnMsIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goam9iVHlwZXMsIGZ1bmN0aW9uIChqb2JUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0ucGVyZm9ybWFuY2VEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2JfdHlwZTogSm9iVHlwZS50cmFuc2Zvcm1lcihqb2JUeXBlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHdlbnR5Zm91cl9ob3VyczogZm9ybWF0Q29sdW1uKGRhdGEyNEhvdXJzLCBqb2JUeXBlLmlkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ydHllaWdodF9ob3VyczogZm9ybWF0Q29sdW1uKGRhdGE0OEhvdXJzLCBqb2JUeXBlLmlkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcnR5X2RheXM6IGZvcm1hdENvbHVtbihkYXRhMzBEYXlzLCBqb2JUeXBlLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLnBlcmZvcm1hbmNlRGF0YSA9IF8uc29ydEJ5T3JkZXIodm0ucGVyZm9ybWFuY2VEYXRhLCBmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkLnR3ZW50eWZvdXJfaG91cnMudG90YWwgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnR3ZW50eWZvdXJfaG91cnMuZXJyb3JUb3RhbCAvIGQudHdlbnR5Zm91cl9ob3Vycy50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBbJ2Rlc2MnXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZtLmdyaWRPcHRpb25zLmRhdGEgPSB2bS5wZXJmb3JtYW5jZURhdGE7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHJbJ2Vycm9yJ10oZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBpbml0aWFsaXplKCk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uc2VsZWN0ZWRKb2JUeXBlJywgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuZXF1YWxzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodm0ubG9hZGluZykge1xuICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZEJ5Sm9iVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICB2bS51cGRhdGVKb2JUeXBlKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkQnlKb2JUeXBlID0gbmV3VmFsdWUgIT09ICdWSUVXIEFMTCc7XG4gICAgICAgICAgICAgICAgdm0udXBkYXRlSm9iVHlwZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHNjYWxlQ29uZmlnLmhlYWRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBncmlkTWF4SGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0IC0gb2Zmc2V0O1xuXG4gICAgICAgICAgICB2bS5ncmlkU3R5bGUgPSAnaGVpZ2h0OiAnICsgZ3JpZE1heEhlaWdodCArICdweDsgbWF4LWhlaWdodDogJyArIGdyaWRNYXhIZWlnaHQgKyAncHg7IG92ZXJmbG93LXk6IGF1dG87JztcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9ic0NvbnRyb2xsZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhdGlvbiwgJHVpYk1vZGFsLCBuYXZTZXJ2aWNlLCBqb2JTZXJ2aWNlLCBqb2JUeXBlU2VydmljZSwgam9iRXhlY3V0aW9uU2VydmljZSwgdWlHcmlkQ29uc3RhbnRzLCBzY2FsZUNvbmZpZywgc3VibmF2U2VydmljZSwgZ3JpZEZhY3RvcnksIGxvYWRTZXJ2aWNlLCBzY2FsZVNlcnZpY2UsIHVzZXJTZXJ2aWNlLCBtb21lbnQsIHRvYXN0cikge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5qb2JzUGFyYW1zID0ge1xuICAgICAgICAgICAgcGFnZTogbnVsbCwgcGFnZV9zaXplOiBudWxsLCBzdGFydGVkOiBudWxsLCBlbmRlZDogbnVsbCwgb3JkZXI6ICRyb290U2NvcGUuam9ic0NvbnRyb2xsZXJPcmRlciB8fCAnLWxhc3RfbW9kaWZpZWQnLCBzdGF0dXM6IG51bGwsIGVycm9yX2NhdGVnb3J5OiBudWxsLCBqb2JfdHlwZV9pZDogbnVsbCwgam9iX3R5cGVfbmFtZTogbnVsbCwgam9iX3R5cGVfY2F0ZWdvcnk6IG51bGwsIHVybDogbnVsbFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGNoZWNrIGZvciBqb2JzUGFyYW1zIGluIHF1ZXJ5IHN0cmluZywgYW5kIHVwZGF0ZSBhcyBuZWNlc3NhcnlcbiAgICAgICAgXy5mb3JFYWNoKF8ucGFpcnMoc2VsZi5qb2JzUGFyYW1zKSwgZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBfLmF0KCRsb2NhdGlvbi5zZWFyY2goKSwgcGFyYW1bMF0pO1xuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzZWxmLmpvYnNQYXJhbXNbcGFyYW1bMF1dID0gdmFsdWUubGVuZ3RoID4gMSA/IHZhbHVlIDogdmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBncmlkUGFnZU51bWJlciA9IHNlbGYuam9ic1BhcmFtcy5wYWdlIHx8IDEsXG4gICAgICAgICAgICBmaWx0ZXJlZEJ5Sm9iVHlwZSA9IHNlbGYuam9ic1BhcmFtcy5qb2JfdHlwZV9pZCA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgIGZpbHRlcmVkQnlKb2JTdGF0dXMgPSBzZWxmLmpvYnNQYXJhbXMuc3RhdHVzID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICAgICAgZmlsdGVyZWRCeUVycm9yQ2F0ZWdvcnkgPSBzZWxmLmpvYnNQYXJhbXMuZXJyb3JfY2F0ZWdvcnkgPyB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgICBmaWx0ZXJlZEJ5T3JkZXIgPSBzZWxmLmpvYnNQYXJhbXMub3JkZXIgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgJHNjb3BlLmpvYnNEYXRhID0ge307XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmpvYlR5cGVWYWx1ZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmpvYkV4ZWN1dGlvbiA9IG51bGw7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZEpvYlR5cGUgPSBzZWxmLmpvYnNQYXJhbXMuam9iX3R5cGVfaWQgfHwgMDtcbiAgICAgICAgJHNjb3BlLmpvYlN0YXR1c1ZhbHVlcyA9IHNjYWxlQ29uZmlnLmpvYlN0YXR1cztcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iU3RhdHVzID0gc2VsZi5qb2JzUGFyYW1zLnN0YXR1cyB8fCAkc2NvcGUuam9iU3RhdHVzVmFsdWVzWzBdO1xuICAgICAgICAkc2NvcGUuZXJyb3JDYXRlZ29yeVZhbHVlcyA9IF8ubWFwKHNjYWxlQ29uZmlnLmVycm9yQ2F0ZWdvcmllcywgJ25hbWUnKTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkRXJyb3JDYXRlZ29yeSA9IHNlbGYuam9ic1BhcmFtcy5lcnJvcl9jYXRlZ29yeSB8fCAkc2NvcGUuZXJyb3JDYXRlZ29yeVZhbHVlc1swXTtcbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3Muam9icztcbiAgICAgICAgJHNjb3BlLmFjdGlvbkNsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmdyaWRTdHlsZSA9ICcnO1xuICAgICAgICAkc2NvcGUucmVhZG9ubHkgPSB0cnVlO1xuICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RhcnQgPSBzZWxmLmpvYnNQYXJhbXMuc3RhcnRlZCA/IG1vbWVudC51dGMoc2VsZi5qb2JzUGFyYW1zLnN0YXJ0ZWQpLnRvRGF0ZSgpIDogbW9tZW50LnV0YygpLnN1YnRyYWN0KDEsICd3ZWVrcycpLnN0YXJ0T2YoJ2QnKS50b0RhdGUoKTtcbiAgICAgICAgJHNjb3BlLmxhc3RNb2RpZmllZFN0YXJ0UG9wdXAgPSB7XG4gICAgICAgICAgICBvcGVuZWQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vcGVuTGFzdE1vZGlmaWVkU3RhcnRQb3B1cCA9IGZ1bmN0aW9uICgkZXZlbnQpIHtcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdGFydFBvcHVwLm9wZW5lZCA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdG9wID0gc2VsZi5qb2JzUGFyYW1zLmVuZGVkID8gbW9tZW50LnV0YyhzZWxmLmpvYnNQYXJhbXMuZW5kZWQpLnRvRGF0ZSgpIDogbW9tZW50LnV0YygpLmVuZE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdG9wUG9wdXAgPSB7XG4gICAgICAgICAgICBvcGVuZWQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vcGVuTGFzdE1vZGlmaWVkU3RvcFBvcHVwID0gZnVuY3Rpb24gKCRldmVudCkge1xuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgJHNjb3BlLmxhc3RNb2RpZmllZFN0b3BQb3B1cC5vcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZGF0ZU1vZGVsT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHRpbWV6b25lOiAnKzAwMCdcbiAgICAgICAgfTtcblxuICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdqb2JzJyk7XG5cbiAgICAgICAgdmFyIGRlZmF1bHRDb2x1bW5EZWZzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnam9iX3R5cGUnLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnSm9iIFR5cGUnLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj48c3BhbiBuZy1iaW5kLWh0bWw9XCJyb3cuZW50aXR5LmpvYl90eXBlLmdldEljb24oKVwiPjwvc3Bhbj4ge3sgcm93LmVudGl0eS5qb2JfdHlwZS50aXRsZSB9fSB7eyByb3cuZW50aXR5LmpvYl90eXBlLnZlcnNpb24gfX08L2Rpdj4nLFxuICAgICAgICAgICAgICAgIGZpbHRlckhlYWRlclRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtZmlsdGVyLWNvbnRhaW5lclwiPjxzZWxlY3QgY2xhc3M9XCJmb3JtLWNvbnRyb2wgaW5wdXQtc21cIiBuZy1tb2RlbD1cImdyaWQuYXBwU2NvcGUuc2VsZWN0ZWRKb2JUeXBlXCI+PG9wdGlvbiBuZy1pZj1cImdyaWQuYXBwU2NvcGUuam9iVHlwZVZhbHVlc1skaW5kZXhdXCIgbmctc2VsZWN0ZWQ9XCJ7eyBncmlkLmFwcFNjb3BlLmpvYlR5cGVWYWx1ZXNbJGluZGV4XS5pZCA9PSBncmlkLmFwcFNjb3BlLnNlbGVjdGVkSm9iVHlwZSB9fVwiIHZhbHVlPVwie3sgZ3JpZC5hcHBTY29wZS5qb2JUeXBlVmFsdWVzWyRpbmRleF0uaWQgfX1cIiBuZy1yZXBlYXQ9XCJqb2JUeXBlIGluIGdyaWQuYXBwU2NvcGUuam9iVHlwZVZhbHVlcyB0cmFjayBieSAkaW5kZXhcIj57eyBncmlkLmFwcFNjb3BlLmpvYlR5cGVWYWx1ZXNbJGluZGV4XS50aXRsZSB9fSB7eyBncmlkLmFwcFNjb3BlLmpvYlR5cGVWYWx1ZXNbJGluZGV4XS52ZXJzaW9uIH19PC9vcHRpb24+PC9zZWxlY3Q+PC9kaXY+J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2NyZWF0ZWQnLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnQ3JlYXRlZCAoWiknLFxuICAgICAgICAgICAgICAgIGVuYWJsZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtY2VsbC1jb250ZW50c1wiPnt7IHJvdy5lbnRpdHkuY3JlYXRlZF9mb3JtYXR0ZWQgfX08L2Rpdj4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnbGFzdF9tb2RpZmllZCcsXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdMYXN0IE1vZGlmaWVkIChaKScsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+e3sgcm93LmVudGl0eS5sYXN0X21vZGlmaWVkX2Zvcm1hdHRlZCB9fTwvZGl2PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICdkdXJhdGlvbicsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbmFibGVTb3J0aW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3aWR0aDogMTIwLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHMgdGV4dC1yaWdodFwiPnt7IHJvdy5lbnRpdHkuZ2V0RHVyYXRpb24oKSB9fTwvZGl2PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICdzdGF0dXMnLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtY2VsbC1jb250ZW50c1wiPjxkaXYgY2xhc3M9XCJwdWxsLXJpZ2h0XCI+PGJ1dHRvbiBuZy1zaG93PVwiKCghZ3JpZC5hcHBTY29wZS5yZWFkb25seSkgJiYgKHJvdy5lbnRpdHkuc3RhdHVzID09PSBcXCdGQUlMRURcXCcgfHwgcm93LmVudGl0eS5zdGF0dXMgPT09IFxcJ0NBTkNFTEVEXFwnKSlcIiBuZy1jbGljaz1cImdyaWQuYXBwU2NvcGUucmVxdWV1ZUpvYnMoeyBqb2JfaWRzOiBbcm93LmVudGl0eS5pZF0gfSlcIiBjbGFzcz1cImJ0biBidG4teHMgYnRuLWRlZmF1bHRcIiB0aXRsZT1cIlJlcXVldWUgSm9iXCI+PGkgY2xhc3M9XCJmYSBmYS1yZXBlYXRcIj48L2k+PC9idXR0b24+IDxidXR0b24gbmctc2hvdz1cIiFncmlkLmFwcFNjb3BlLnJlYWRvbmx5ICYmIHJvdy5lbnRpdHkuc3RhdHVzICE9PSBcXCdDT01QTEVURURcXCcgJiYgcm93LmVudGl0eS5zdGF0dXMgIT09IFxcJ0NBTkNFTEVEXFwnXCIgbmctY2xpY2s9XCJncmlkLmFwcFNjb3BlLmNhbmNlbEpvYihyb3cuZW50aXR5KVwiIGNsYXNzPVwiYnRuIGJ0bi14cyBidG4tZGVmYXVsdFwiIHRpdGxlPVwiQ2FuY2VsIEpvYlwiPjxpIGNsYXNzPVwiZmEgZmEtYmFuXCI+PC9pPjwvYnV0dG9uPjwvZGl2PiB7eyByb3cuZW50aXR5LnN0YXR1cyB9fTwvZGl2PicsXG4gICAgICAgICAgICAgICAgZmlsdGVySGVhZGVyVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1maWx0ZXItY29udGFpbmVyXCI+PHNlbGVjdCBjbGFzcz1cImZvcm0tY29udHJvbCBpbnB1dC1zbVwiIG5nLW1vZGVsPVwiZ3JpZC5hcHBTY29wZS5zZWxlY3RlZEpvYlN0YXR1c1wiPjxvcHRpb24gbmctc2VsZWN0ZWQ9XCJ7eyBncmlkLmFwcFNjb3BlLmpvYlN0YXR1c1ZhbHVlc1skaW5kZXhdID09IGdyaWQuYXBwU2NvcGUuc2VsZWN0ZWRKb2JTdGF0dXMgfX1cIiB2YWx1ZT1cInt7IGdyaWQuYXBwU2NvcGUuam9iU3RhdHVzVmFsdWVzWyRpbmRleF0gfX1cIiBuZy1yZXBlYXQ9XCJzdGF0dXMgaW4gZ3JpZC5hcHBTY29wZS5qb2JTdGF0dXNWYWx1ZXMgdHJhY2sgYnkgJGluZGV4XCI+e3sgc3RhdHVzLnRvVXBwZXJDYXNlKCkgfX08L29wdGlvbj48L3NlbGVjdD48L2Rpdj4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnZXJyb3IuY2F0ZWdvcnknLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdFcnJvciBDYXRlZ29yeScsXG4gICAgICAgICAgICAgICAgZmlsdGVySGVhZGVyVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1maWx0ZXItY29udGFpbmVyXCI+PHNlbGVjdCBjbGFzcz1cImZvcm0tY29udHJvbCBpbnB1dC1zbVwiIG5nLW1vZGVsPVwiZ3JpZC5hcHBTY29wZS5zZWxlY3RlZEVycm9yQ2F0ZWdvcnlcIj48b3B0aW9uIG5nLXNlbGVjdGVkPVwie3sgZ3JpZC5hcHBTY29wZS5lcnJvckNhdGVnb3J5VmFsdWVzWyRpbmRleF0gPT0gZ3JpZC5hcHBTY29wZS5zZWxlY3RlZEVycm9yQ2F0ZWdvcnkgfX1cIiB2YWx1ZT1cInt7IGdyaWQuYXBwU2NvcGUuZXJyb3JDYXRlZ29yeVZhbHVlc1skaW5kZXhdIH19XCIgbmctcmVwZWF0PVwiZXJyb3IgaW4gZ3JpZC5hcHBTY29wZS5lcnJvckNhdGVnb3J5VmFsdWVzIHRyYWNrIGJ5ICRpbmRleFwiPnt7IGVycm9yLnRvVXBwZXJDYXNlKCkgfX08L29wdGlvbj48L3NlbGVjdD48L2Rpdj4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnZXJyb3IudGl0bGUnLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRXJyb3InLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj48ZGl2IHVpYi10b29sdGlwPVwie3sgcm93LmVudGl0eS5lcnJvci5kZXNjcmlwdGlvbiB9fVwiIHRvb2x0aXAtYXBwZW5kLXRvLWJvZHk9XCJ0cnVlXCI+e3sgcm93LmVudGl0eS5lcnJvci50aXRsZSB9fTwvZGl2PjwvZGl2PicsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDIwMCxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnaWQnLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnTG9nJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHNvcnRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3aWR0aDogNjAsXG4gICAgICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtY2VsbC1jb250ZW50cyB0ZXh0LWNlbnRlclwiPjxidXR0b24gbmctY2xpY2s9XCJncmlkLmFwcFNjb3BlLnNob3dMb2cocm93LmVudGl0eS5pZClcIiBjbGFzcz1cImJ0biBidG4teHMgYnRuLWRlZmF1bHRcIj48aSBjbGFzcz1cImZhIGZhLWZpbGUtdGV4dFwiPjwvaT48L2J1dHRvbj48L2Rpdj4nXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zID0gZ3JpZEZhY3RvcnkuZGVmYXVsdEdyaWRPcHRpb25zKCk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uQ3VycmVudFBhZ2UgPSBwYXJzZUludChzZWxmLmpvYnNQYXJhbXMucGFnZSB8fCAxKTtcbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZSA9IHBhcnNlSW50KHNlbGYuam9ic1BhcmFtcy5wYWdlX3NpemUpIHx8ICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemU7XG4gICAgICAgIHZhciBjb2xEZWZzID0gJHJvb3RTY29wZS5jb2xEZWZzID8gJHJvb3RTY29wZS5jb2xEZWZzIDogZGVmYXVsdENvbHVtbkRlZnM7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5jb2x1bW5EZWZzID0gZ3JpZEZhY3RvcnkuYXBwbHlTb3J0Q29uZmlnKGNvbERlZnMsIHNlbGYuam9ic1BhcmFtcyk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gW107XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5vblJlZ2lzdGVyQXBpID0gZnVuY3Rpb24gKGdyaWRBcGkpIHtcbiAgICAgICAgICAgICAgICAvL3NldCBncmlkQXBpIG9uIHNjb3BlXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkgPSBncmlkQXBpO1xuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkQXBpLnNlbGVjdGlvbi5vbi5yb3dTZWxlY3Rpb25DaGFuZ2VkKCRzY29wZSwgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFjdGlvbkNsaWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3Rpb25DbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9qb2JzL2pvYi8nICsgcm93LmVudGl0eS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkucGFnaW5hdGlvbi5vbi5wYWdpbmF0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLnBhZ2UgPSBjdXJyZW50UGFnZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLnBhZ2Vfc2l6ZSA9IHBhZ2VTaXplO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ3JpZEFwaScpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkQXBpLmNvcmUub24uc29ydENoYW5nZWQoJHNjb3BlLCBmdW5jdGlvbiAoZ3JpZCwgc29ydENvbHVtbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jb2xEZWZzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5ncmlkQXBpLmdyaWQuY29sdW1ucywgZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmNvbERlZi5zb3J0ID0gY29sLnNvcnQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNvbERlZnMgPSAkc2NvcGUuZ3JpZEFwaS5ncmlkLm9wdGlvbnMuY29sdW1uRGVmcztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvcnRBcnIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKHNvcnRDb2x1bW5zLCBmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0QXJyLnB1c2goY29sLnNvcnQuZGlyZWN0aW9uID09PSAnZGVzYycgPyAnLScgKyBjb2wuZmllbGQgOiBjb2wuZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGVKb2JPcmRlcihzb3J0QXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuc2hvd1N0YXR1cyA9IGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgICAgICAgIHJldHVybiBfLmluY2x1ZGVzKCRzY29wZS5qb2JTdGF0dXNWYWx1ZXMsIHN0YXR1cyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi51cGRhdGVKb2JUeXBlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gc2VsZi5qb2JzUGFyYW1zLmpvYl90eXBlX2lkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLnBhZ2UgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLmpvYl90eXBlX2lkID0gdmFsdWUgPT0gMCA/IG51bGwgOiB2YWx1ZTtcbiAgICAgICAgICAgIHNlbGYuam9ic1BhcmFtcy5wYWdlX3NpemUgPSAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdGVkSm9iVHlwZScpO1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJSZXN1bHRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnc2VsZWN0ZWRKb2JUeXBlJywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyZWRCeUpvYlR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGVKb2JUeXBlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkQnlKb2JUeXBlID0gdmFsdWUgIT0gMDtcbiAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUpvYlR5cGUodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzZWxmLnVwZGF0ZUpvYlN0YXR1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9IHNlbGYuam9ic1BhcmFtcy5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmpvYnNQYXJhbXMucGFnZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmpvYnNQYXJhbXMuc3RhdHVzID0gdmFsdWUgPT09ICdWSUVXIEFMTCcgPyBudWxsIDogdmFsdWU7XG4gICAgICAgICAgICBzZWxmLmpvYnNQYXJhbXMucGFnZV9zaXplID0gJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3RlZEpvYlN0YXR1cycpO1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJSZXN1bHRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi51cGRhdGVFcnJvckNhdGVnb3J5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT0gc2VsZi5qb2JzUGFyYW1zLmVycm9yX2NhdGVnb3J5KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLnBhZ2UgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLmVycm9yX2NhdGVnb3J5ID0gdmFsdWUgPT09ICdWSUVXIEFMTCcgPyBudWxsIDogdmFsdWU7XG4gICAgICAgICAgICBzZWxmLmpvYnNQYXJhbXMucGFnZV9zaXplID0gJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3RlZEVycm9yQ2F0ZWdvcnknKTtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkSm9iU3RhdHVzJywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyZWRCeUpvYlN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUpvYlN0YXR1cyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZEJ5Sm9iU3RhdHVzID0gdmFsdWUgIT09ICdWSUVXIEFMTCc7XG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGVKb2JTdGF0dXModmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdzZWxlY3RlZEVycm9yQ2F0ZWdvcnknLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZEJ5RXJyb3JDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUVycm9yQ2F0ZWdvcnkodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRCeUVycm9yQ2F0ZWdvcnkgPSB2YWx1ZSAhPT0gJ1ZJRVcgQUxMJztcbiAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUVycm9yQ2F0ZWdvcnkodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzZWxmLnVwZGF0ZUpvYk9yZGVyID0gZnVuY3Rpb24gKHNvcnRBcnIpIHtcbiAgICAgICAgICAgIHNlbGYuam9ic1BhcmFtcy5vcmRlciA9IHNvcnRBcnIubGVuZ3RoID4gMCA/IHNvcnRBcnIgOiBudWxsO1xuICAgICAgICAgICAgZmlsdGVyZWRCeU9yZGVyID0gc29ydEFyci5sZW5ndGggPiAwO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdsYXN0TW9kaWZpZWRTdGFydCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIHNlbGYuam9ic1BhcmFtcy5zdGFydGVkID0gdmFsdWUudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdsYXN0TW9kaWZpZWRTdG9wJywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLmVuZGVkID0gdmFsdWUudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvKiRzY29wZS4kd2F0Y2goJ2dyaWRBcGknLCBmdW5jdGlvbiAoZ3JpZEFwaSkge1xuICAgICAgICAgICAgaWYgKGZpbHRlcmVkQnlPcmRlcikge1xuICAgICAgICAgICAgICAgIGdyaWRBcGkuY29yZS5yYWlzZS5zb3J0Q2hhbmdlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTsqL1xuXG4gICAgICAgICRzY29wZS5zaG93TG9nID0gZnVuY3Rpb24gKGpvYklkKSB7XG4gICAgICAgICAgICAvLyBzaG93IGxvZyBtb2RhbFxuICAgICAgICAgICAgJHNjb3BlLmFjdGlvbkNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Nob3cgbG9nIG1vZGFsJyk7XG4gICAgICAgICAgICBqb2JTZXJ2aWNlLmdldEpvYkRldGFpbChqb2JJZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYiA9IGRhdGEuam9iX3R5cGUudGl0bGUgKyAnICcgKyBkYXRhLmpvYl90eXBlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgJHNjb3BlLmpvYkV4ZWN1dGlvbiA9IGRhdGEuZ2V0TGF0ZXN0RXhlY3V0aW9uKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzaG93TG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiAnbGcnLFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dDbGFzczogJ2xvZy1tb2RhbC13aW5kb3cnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKHNlbGYuam9ic1BhcmFtcyksIGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2gocGFyYW1bMF0sIHBhcmFtWzFdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5nZXRKb2JzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnJlcXVldWVKb2JzID0gZnVuY3Rpb24gKGpvYnNQYXJhbXMpIHtcbiAgICAgICAgICAgIGlmICgham9ic1BhcmFtcykge1xuICAgICAgICAgICAgICAgIGpvYnNQYXJhbXMgPSBzZWxmLmpvYnNQYXJhbXMgPyBzZWxmLmpvYnNQYXJhbXMgOiB7IHN0YXJ0ZWQ6ICRzY29wZS5sYXN0TW9kaWZpZWRTdGFydC50b0lTT1N0cmluZygpLCBlbmRlZDogJHNjb3BlLmxhc3RNb2RpZmllZFN0b3AudG9JU09TdHJpbmcoKSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmFjdGlvbkNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgbG9hZFNlcnZpY2UucmVxdWV1ZUpvYnMoam9ic1BhcmFtcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydzdWNjZXNzJ10oJ1JlcXVldWUgU3VjY2Vzc2Z1bCcpO1xuICAgICAgICAgICAgICAgIHNlbGYuZ2V0Sm9icygpO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydlcnJvciddKCdSZXF1ZXVlIHJlcXVlc3QgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2FuY2VsSm9iID0gZnVuY3Rpb24gKGpvYikge1xuICAgICAgICAgICAgJHNjb3BlLmFjdGlvbkNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsU3RhdHVzID0gam9iLnN0YXR1cztcbiAgICAgICAgICAgIGpvYi5zdGF0dXMgPSAnQ0FOQ0VMJztcbiAgICAgICAgICAgIGpvYlNlcnZpY2UudXBkYXRlSm9iKGpvYi5pZCwgeyBzdGF0dXM6ICdDQU5DRUxFRCcgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHRvYXN0clsnc3VjY2VzcyddKCdKb2IgQ2FuY2VsZWQnKTtcbiAgICAgICAgICAgICAgICBqb2Iuc3RhdHVzID0gJ0NBTkNFTEVEJztcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRvYXN0clsnZXJyb3InXShlcnJvcik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIGpvYi5zdGF0dXMgPSBvcmlnaW5hbFN0YXR1cztcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmdldEpvYnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBqb2JTZXJ2aWNlLmdldEpvYnNPbmNlKHNlbGYuam9ic1BhcmFtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5qb2JzRGF0YSA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMudG90YWxJdGVtcyA9IGRhdGEuY291bnQ7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5nZXRKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzT25jZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcyA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcy51bnNoaWZ0KHsgbmFtZTogJ1ZJRVcgQUxMJywgdGl0bGU6ICdWSUVXIEFMTCcsIHZlcnNpb246ICcnLCBpZDogMCB9KTtcbiAgICAgICAgICAgICAgICAvKmlmICghZmlsdGVyZWRCeUpvYlR5cGUgJiYgIWZpbHRlcmVkQnlKb2JTdGF0dXMgJiYgIWZpbHRlcmVkQnlPcmRlcikge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmdldEpvYnMoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyZWRCeU9yZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUpvYk9yZGVyKHNlbGYuam9ic1BhcmFtcy5vcmRlcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICBzZWxmLmdldEpvYnMoc2VsZi5qb2JzUGFyYW1zKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAkcm9vdFNjb3BlLmNvbERlZnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgLy8gcm9vdCBjb2x1bW4gZGVmcyBoYXZlIG5vdCBiZWVuIGFsdGVyZWQgYnkgdXNlciwgc28gc2V0IHVwIGRlZmF1bHRzXG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmpvYnNQYXJhbXMub3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLm9yZGVyID0gJy1sYXN0X21vZGlmaWVkJztcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnb3JkZXInLCBzZWxmLmpvYnNQYXJhbXMub3JkZXIpLnJlcGxhY2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmpvYnNQYXJhbXMucGFnZV9zaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuam9ic1BhcmFtcy5wYWdlX3NpemUgPSAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplO1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdwYWdlX3NpemUnLCBzZWxmLmpvYnNQYXJhbXMucGFnZV9zaXplKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc2VsZi5qb2JzUGFyYW1zLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5qb2JzUGFyYW1zLnN0YXJ0ZWQgPSBtb21lbnQudXRjKCRzY29wZS5sYXN0TW9kaWZpZWRTdGFydCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnc3RhcnRlZCcsIHNlbGYuam9ic1BhcmFtcy5zdGFydGVkKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc2VsZi5qb2JzUGFyYW1zLmVuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuam9ic1BhcmFtcy5lbmRlZCA9IG1vbWVudC51dGMoJHNjb3BlLmxhc3RNb2RpZmllZFN0b3ApLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2VuZGVkJywgc2VsZi5qb2JzUGFyYW1zLmVuZGVkKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5nZXRKb2JUeXBlcygpO1xuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckNyZWRzKCk7XG5cbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLnVzZXIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVhZG9ubHkgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdlNlcnZpY2UudXBkYXRlTG9jYXRpb24oJ2pvYnMnKTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmluaXRpYWxpemUoKTtcblxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHNldCBjb250YWluZXIgaGVpZ2h0cyBlcXVhbCB0byBhdmFpbGFibGUgcGFnZSBoZWlnaHRcbiAgICAgICAgICAgIHZhciB2aWV3cG9ydCA9IHNjYWxlU2VydmljZS5nZXRWaWV3cG9ydFNpemUoKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBzY2FsZUNvbmZpZy5oZWFkZXJPZmZzZXQgKyBzY2FsZUNvbmZpZy5kYXRlRmlsdGVyT2Zmc2V0LFxuICAgICAgICAgICAgICAgIGdyaWRNYXhIZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgLSBvZmZzZXQ7XG5cbiAgICAgICAgICAgICRzY29wZS5ncmlkU3R5bGUgPSAnaGVpZ2h0OiAnICsgZ3JpZE1heEhlaWdodCArICdweDsgbWF4LWhlaWdodDogJyArIGdyaWRNYXhIZWlnaHQgKyAncHg7IG92ZXJmbG93LXk6IGF1dG87JztcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9iRXhlY3V0aW9uTG9nQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCAkZWxlbWVudCwgJHRpbWVvdXQsIGpvYkV4ZWN1dGlvblNlcnZpY2UsIHNjYWxlQ29uZmlnKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAkc2NvcGUuZm9yY2VTY3JvbGwgPSB0cnVlO1xuXG4gICAgICAgICAgICAkc2NvcGUuam9iTG9nRXJyb3IgPSBudWxsO1xuXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdleGVjdXRpb24nLCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5leGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgam9iRXhlY3V0aW9uU2VydmljZS5nZXRMb2coJHNjb3BlLmV4ZWN1dGlvbi5pZCkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGRpZmZlcmVuY2Ugb2YgbWF4IHNjcm9sbCBsZW5ndGggYW5kIGN1cnJlbnQgc2Nyb2xsIGxlbmd0aC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2dSZXN1bHQgPSByZXN1bHQuZXhlY3V0aW9uX2xvZztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC4kcmVzb2x2ZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXYgPSAkKCRlbGVtZW50WzBdKS5maW5kKCcuYmFzaCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY3JvbGxEaWZmID0gKGRpdi5zY3JvbGxUb3AoKSArIGRpdi5wcm9wKCdvZmZzZXRIZWlnaHQnKSkgLSBkaXYucHJvcCgnc2Nyb2xsSGVpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHNjb3BlLnNjcm9sbERpZmYgPj0gMCl7ICRzY29wZS5mb3JjZVNjcm9sbCA9IHRydWU7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXhlY0xvZyA9IGxvZ1Jlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXNUZXh0ICYmIHJlc3VsdC5zdGF0dXNUZXh0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iTG9nRXJyb3JTdGF0dXMgPSByZXN1bHQuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkxvZ0Vycm9yID0gJ1VuYWJsZSB0byByZXRyaWV2ZSBqb2IgbG9ncy4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2V4ZWNMb2cnLCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5leGVjTG9nKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCRzY29wZS5mb3JjZVNjcm9sbCB8fCAkc2NvcGUuc2Nyb2xsRGlmZiA+PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZvcmNlU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmxIZWlnaHQgPSAkKCRlbGVtZW50WzBdKS5maW5kKCcuYmFzaCcpLnByb3AoXCJzY3JvbGxIZWlnaHRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgkZWxlbWVudFswXSkuZmluZCgnLmJhc2gnKS5zY3JvbGxUb3Aoc2NybEhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2Nyb2xsaXRlbSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zdGRvdXRDaGFuZ2VkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGRvdXQgY2hhbmdlZC4nKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG5cbiAgICB9KS5kaXJlY3RpdmUoJ2pvYkV4ZWN1dGlvbkxvZycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdqb2JFeGVjdXRpb25Mb2dDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9qb2JzL2RpcmVjdGl2ZXMvam9iRXhlY3V0aW9uTG9nVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBleGVjdXRpb246ICc9J1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignYWlzSm9iSGVhbHRoQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIGpvYlR5cGVTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS5sb2FkaW5nSm9iSGVhbHRoID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmpvYkhlYWx0aEVycm9yID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmpvYkhlYWx0aEVycm9yU3RhdHVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmpvYkhlYWx0aCA9IHt9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlU3RhdHVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgam9iVHlwZVNlcnZpY2UuZ2V0Sm9iVHlwZVN0YXR1cyhudWxsLCBudWxsLCAkc2NvcGUuZHVyYXRpb24sIG51bGwpLnRoZW4obnVsbCwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkhlYWx0aEVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYlR5cGVTdGF0dXMgPSBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5mYWlsZWQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbHVyZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZGF0YS5yZXN1bHRzLCBmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJmb3JtYW5jZSA9IHN0YXR1cy5nZXRQZXJmb3JtYW5jZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvdGFsID0gJHNjb3BlLnRvdGFsICsgcGVyZm9ybWFuY2UudG90YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZmFpbGVkID0gJHNjb3BlLmZhaWxlZCArIHBlcmZvcm1hbmNlLmZhaWxlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1cmVzLnB1c2goc3RhdHVzLmdldEZhaWx1cmVzKCkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZURhdGEgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbUZhaWx1cmVzID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFGYWlsdXJlcyA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1GYWlsdXJlcyA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGZhaWx1cmVzLCBmdW5jdGlvbiAoZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGYsIGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuc3RhdHVzID09PSAnU1lTVEVNJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeXN0ZW1GYWlsdXJlcyA9IHN5c3RlbUZhaWx1cmVzICsgdHlwZS5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUuc3RhdHVzID09PSAnREFUQScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUZhaWx1cmVzID0gZGF0YUZhaWx1cmVzICsgdHlwZS5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUuc3RhdHVzID09PSAnQUxHT1JJVEhNJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG1GYWlsdXJlcyA9IGFsZ29yaXRobUZhaWx1cmVzICsgdHlwZS5jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHN5c3RlbUZhaWx1cmVzID4gMCB8fCBkYXRhRmFpbHVyZXMgPiAwIHx8IGFsZ29yaXRobUZhaWx1cmVzID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN5c3RlbUZhaWx1cmVzID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1cmVEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdTWVNURU0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogc3lzdGVtRmFpbHVyZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGdvcml0aG1GYWlsdXJlcyA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlRGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnQUxHT1JJVEhNJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IGFsZ29yaXRobUZhaWx1cmVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YUZhaWx1cmVzID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1cmVEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdEQVRBJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IGRhdGFGYWlsdXJlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkhlYWx0aCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhdWdlRGF0YTogJHNjb3BlLnRvdGFsID09PSAwID8gMCA6IDEwMCAtICgoJHNjb3BlLmZhaWxlZCAvICRzY29wZS50b3RhbCkgKiAxMDApLnRvRml4ZWQoMiksXG4gICAgICAgICAgICAgICAgICAgICAgICBkb251dERhdGE6IGZhaWx1cmVEYXRhXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5icm9hZGNhc3REYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2pvYlR5cGVTdGF0dXMnLCAkc2NvcGUuam9iVHlwZVN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXNUZXh0ICYmIGRhdGEuc3RhdHVzVGV4dCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5qb2JIZWFsdGhFcnJvclN0YXR1cyA9IGRhdGEuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iSGVhbHRoRXJyb3IgPSAnVW5hYmxlIHRvIHJldHJpZXZlIGpvYiBzdGF0aXN0aWNzLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nSm9iSGVhbHRoID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBnZXRKb2JUeXBlU3RhdHVzKCk7XG4gICAgfSkuZGlyZWN0aXZlKCdhaXNKb2JIZWFsdGgnLCBmdW5jdGlvbigpe1xuICAgICAgICAvKipcbiAgICAgICAgICogVXNhZ2U6IDxhaXMtam9iLWhlYWx0aCAvPlxuICAgICAgICAgKiovXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWlzSm9iSGVhbHRoQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvam9icy9kaXJlY3RpdmVzL2pvYkhlYWx0aFRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgZHVyYXRpb246ICc9JyxcbiAgICAgICAgICAgICAgICBicm9hZGNhc3REYXRhOiAnPScsIC8vIHNldCB0byB0cnVlIHdoZW4gdXNpbmcgYW5vdGhlciB3aWRnZXQgaW4gdGhlIHNhbWUgdmlldyB0aGF0IGFsc28gY2FsbHMgZ2V0Sm9iVHlwZVN0YXR1c1xuICAgICAgICAgICAgICAgIHNob3dEZXNjcmlwdGlvbjogJz0nXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignam9iVHlwZUludGVyZmFjZURpcmVjdGl2ZUNvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCBqb2JUeXBlU2VydmljZSkge1xuXG4gICAgfSkuZGlyZWN0aXZlKCdhaXNKb2JUeXBlSW50ZXJmYWNlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzYWdlOiA8YWlzLWpvYi1oZWFsdGggLz5cbiAgICAgICAgICoqL1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2pvYlR5cGVJbnRlcmZhY2VEaXJlY3RpdmVDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9qb2JzL2RpcmVjdGl2ZXMvam9iVHlwZUludGVyZmFjZVRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgam9iVHlwZUludGVyZmFjZTogJz0nXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2InLCBmdW5jdGlvbiAoc2NhbGVDb25maWcsIEpvYlR5cGUsIHNjYWxlU2VydmljZSkge1xuICAgICAgICB2YXIgSm9iID0gZnVuY3Rpb24gKGlkLCBqb2JfdHlwZSwgam9iX3R5cGVfcmV2LCBldmVudCwgZXJyb3IsIHN0YXR1cywgcHJpb3JpdHksIG51bV9leGVzLCB0aW1lb3V0LCBtYXhfdHJpZXMsIGNwdXNfcmVxdWlyZWQsIG1lbV9yZXF1aXJlZCwgZGlza19pbl9yZXF1aXJlZCwgZGlza19vdXRfcmVxdWlyZWQsIGNyZWF0ZWQsIHF1ZXVlZCwgc3RhcnRlZCwgZW5kZWQsIGxhc3Rfc3RhdHVzX2NoYW5nZSwgbGFzdF9tb2RpZmllZCkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZSA9IEpvYlR5cGUudHJhbnNmb3JtZXIoam9iX3R5cGUpO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZV9yZXYgPSBqb2JfdHlwZV9yZXY7XG4gICAgICAgICAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgICAgIHRoaXMubnVtX2V4ZXMgPSBudW1fZXhlcztcbiAgICAgICAgICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgICAgICB0aGlzLm1heF90cmllcyA9IG1heF90cmllcztcbiAgICAgICAgICAgIHRoaXMuY3B1c19yZXF1aXJlZCA9IGNwdXNfcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLm1lbV9yZXF1aXJlZCA9IG1lbV9yZXF1aXJlZDtcbiAgICAgICAgICAgIHRoaXMuZGlza19pbl9yZXF1aXJlZCA9IGRpc2tfaW5fcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLmRpc2tfb3V0X3JlcXVpcmVkID0gZGlza19vdXRfcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWQgPSBjcmVhdGVkO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMoY3JlYXRlZCkuZm9ybWF0KHNjYWxlQ29uZmlnLmRhdGVGb3JtYXRzLmRheV9zZWNvbmRfdXRjX25vbGFiZWwpO1xuICAgICAgICAgICAgdGhpcy5xdWV1ZWQgPSBxdWV1ZWQ7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBzdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5lbmRlZCA9IGVuZGVkO1xuICAgICAgICAgICAgdGhpcy5sYXN0X3N0YXR1c19jaGFuZ2UgPSBsYXN0X3N0YXR1c19jaGFuZ2U7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWQgPSBsYXN0X21vZGlmaWVkO1xuICAgICAgICAgICAgdGhpcy5sYXN0X21vZGlmaWVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMobGFzdF9tb2RpZmllZCkuZm9ybWF0KHNjYWxlQ29uZmlnLmRhdGVGb3JtYXRzLmRheV9zZWNvbmRfdXRjX25vbGFiZWwpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYi5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICBnZXREdXJhdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHRoaXMuc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdGhpcy5lbmRlZCA/IHRoaXMuZW5kZWQgOiBtb21lbnQudXRjKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUR1cmF0aW9uKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2IuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYihcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfdHlwZV9yZXYsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnByaW9yaXR5LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm51bV9leGVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRpbWVvdXQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWF4X3RyaWVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNwdXNfcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWVtX3JlcXVpcmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpc2tfaW5fcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19vdXRfcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5xdWV1ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lbmRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sYXN0X3N0YXR1c19jaGFuZ2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIEpvYi50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2IuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBKb2I7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2JEZXRhaWxFdmVudCcsIGZ1bmN0aW9uIChKb2JEZXRhaWxFdmVudFJ1bGUpIHtcbiAgICAgICAgdmFyIEpvYkRldGFpbEV2ZW50ID0gZnVuY3Rpb24gKGlkLCB0eXBlLCBydWxlLCBvY2N1cnJlZCkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIHRoaXMucnVsZSA9IEpvYkRldGFpbEV2ZW50UnVsZS50cmFuc2Zvcm1lcihydWxlKTtcbiAgICAgICAgICAgIHRoaXMub2NjdXJyZWQgPSBvY2N1cnJlZDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JEZXRhaWxFdmVudC5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgSm9iRGV0YWlsRXZlbnQuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYkRldGFpbEV2ZW50KFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucnVsZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5vY2N1cnJlZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYkRldGFpbEV2ZW50KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iRGV0YWlsRXZlbnQudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSm9iRGV0YWlsRXZlbnQuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iRGV0YWlsRXZlbnQuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYkRldGFpbEV2ZW50O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iRGV0YWlsRXZlbnRSdWxlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgSm9iRGV0YWlsRXZlbnRSdWxlID0gZnVuY3Rpb24gKGlkLCB0eXBlLCBpc19hY3RpdmUsIGNyZWF0ZWQsIGFyY2hpdmVkLCBsYXN0X21vZGlmaWVkKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5pc19hY3RpdmUgPSBpc19hY3RpdmU7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWQgPSBjcmVhdGVkO1xuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZCA9IGFyY2hpdmVkO1xuICAgICAgICAgICAgdGhpcy5sYXN0X21vZGlmaWVkID0gbGFzdF9tb2RpZmllZDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JEZXRhaWxFdmVudFJ1bGUucHJvdG90eXBlID0ge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIEpvYkRldGFpbEV2ZW50UnVsZS5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSm9iRGV0YWlsRXZlbnRSdWxlKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuYXJjaGl2ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYkRldGFpbEV2ZW50UnVsZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIEpvYkRldGFpbEV2ZW50UnVsZS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JEZXRhaWxFdmVudFJ1bGUuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iRGV0YWlsRXZlbnRSdWxlLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBKb2JEZXRhaWxFdmVudFJ1bGU7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2JEZXRhaWxJbnB1dERhdGEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBKb2JEZXRhaWxJbnB1dERhdGEgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIGZpbGVfaWQsIGZpbGVfaWRzLCBmaWxlcykge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZV9pZCA9IGZpbGVfaWQ7XG4gICAgICAgICAgICB0aGlzLmZpbGVfaWRzID0gZmlsZV9pZHM7XG4gICAgICAgICAgICB0aGlzLmZpbGVzID0gZmlsZXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgSm9iRGV0YWlsSW5wdXREYXRhLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbGVfaWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbGVfaWQ7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmlsZV9pZHMpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbGVfaWRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JEZXRhaWxJbnB1dERhdGEuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYkRldGFpbElucHV0RGF0YShcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmZpbGVfaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZmlsZV9pZHMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZmlsZXNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JEZXRhaWxJbnB1dERhdGEoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JEZXRhaWxJbnB1dERhdGEudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSm9iRGV0YWlsSW5wdXREYXRhLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYkRldGFpbElucHV0RGF0YS5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gSm9iRGV0YWlsSW5wdXREYXRhO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iRGV0YWlsT3V0cHV0RGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIEpvYkRldGFpbE91dHB1dERhdGEgPSBmdW5jdGlvbiAobmFtZSwgd29ya3NwYWNlX2lkLCBmaWxlcykge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgICAgIHRoaXMud29ya3NwYWNlX2lkID0gd29ya3NwYWNlX2lkO1xuICAgICAgICAgICAgdGhpcy5maWxlcyA9IGZpbGVzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYkRldGFpbE91dHB1dERhdGEucHJvdG90eXBlID0ge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIEpvYkRldGFpbE91dHB1dERhdGEuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYkRldGFpbE91dHB1dERhdGEoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS53b3Jrc3BhY2VfaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZmlsZXNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JEZXRhaWxPdXRwdXREYXRhKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iRGV0YWlsT3V0cHV0RGF0YS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JEZXRhaWxPdXRwdXREYXRhLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYkRldGFpbE91dHB1dERhdGEuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYkRldGFpbE91dHB1dERhdGE7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2JEZXRhaWxzJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBKb2JUeXBlLCBKb2JFeGVjdXRpb24sIFByb2R1Y3QsIEpvYkRldGFpbElucHV0RGF0YSwgSm9iRGV0YWlsT3V0cHV0RGF0YSwgUmVjaXBlLCBKb2JEZXRhaWxFdmVudCwgc2NhbGVTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBKb2JEZXRhaWxzID0gZnVuY3Rpb24gKGlkLCBqb2JfdHlwZSwgam9iX3R5cGVfcmV2LCBldmVudCwgZXJyb3IsIHN0YXR1cywgcHJpb3JpdHksIG51bV9leGVzLCB0aW1lb3V0LCBtYXhfdHJpZXMsIGNwdXNfcmVxdWlyZWQsIG1lbV9yZXF1aXJlZCwgZGlza19pbl9yZXF1aXJlZCwgZGlza19vdXRfcmVxdWlyZWQsIGNyZWF0ZWQsIHF1ZXVlZCwgc3RhcnRlZCwgZW5kZWQsIGxhc3Rfc3RhdHVzX2NoYW5nZSwgbGFzdF9tb2RpZmllZCwgZGF0YSwgcmVzdWx0cywgcmVjaXBlcywgam9iX2V4ZXMsIGlucHV0cywgb3V0cHV0cykge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZSA9IEpvYlR5cGUudHJhbnNmb3JtZXIoam9iX3R5cGUpO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZV9yZXYgPSBqb2JfdHlwZV9yZXY7XG4gICAgICAgICAgICB0aGlzLmV2ZW50ID0gSm9iRGV0YWlsRXZlbnQudHJhbnNmb3JtZXIoZXZlbnQpO1xuICAgICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgICAgICAgICB0aGlzLm51bV9leGVzID0gbnVtX2V4ZXM7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgdGhpcy5tYXhfdHJpZXMgPSBtYXhfdHJpZXM7XG4gICAgICAgICAgICB0aGlzLmNwdXNfcmVxdWlyZWQgPSBjcHVzX3JlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5tZW1fcmVxdWlyZWQgPSBtZW1fcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLmRpc2tfaW5fcmVxdWlyZWQgPSBkaXNrX2luX3JlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5kaXNrX291dF9yZXF1aXJlZCA9IGRpc2tfb3V0X3JlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkID0gY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKGNyZWF0ZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Yyk7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlZCA9IHF1ZXVlZDtcbiAgICAgICAgICAgIHRoaXMucXVldWVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMocXVldWVkKS5mb3JtYXQoc2NhbGVDb25maWcuZGF0ZUZvcm1hdHMuZGF5X3NlY29uZF91dGMpO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gc3RhcnRlZDtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKHN0YXJ0ZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Yyk7XG4gICAgICAgICAgICB0aGlzLmVuZGVkID0gZW5kZWQ7XG4gICAgICAgICAgICB0aGlzLmVuZGVkX2Zvcm1hdHRlZCA9IG1vbWVudC51dGMoZW5kZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Yyk7XG4gICAgICAgICAgICB0aGlzLmxhc3Rfc3RhdHVzX2NoYW5nZSA9IGxhc3Rfc3RhdHVzX2NoYW5nZTtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSB7XG4gICAgICAgICAgICAgICAgaW5wdXRfZGF0YTogSm9iRGV0YWlsSW5wdXREYXRhLnRyYW5zZm9ybWVyKGRhdGEuaW5wdXRfZGF0YSksXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogZGF0YS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgIG91dHB1dF9kYXRhOiBKb2JEZXRhaWxPdXRwdXREYXRhLnRyYW5zZm9ybWVyKGRhdGEub3V0cHV0X2RhdGEpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRzID0ge1xuICAgICAgICAgICAgICAgIG91dHB1dF9kYXRhOiBKb2JEZXRhaWxPdXRwdXREYXRhLnRyYW5zZm9ybWVyKHJlc3VsdHMub3V0cHV0X2RhdGEpLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IHJlc3VsdHMudmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVjaXBlcyA9IFJlY2lwZS50cmFuc2Zvcm1lcihyZWNpcGVzKTtcbiAgICAgICAgICAgIHRoaXMuam9iX2V4ZXMgPSBKb2JFeGVjdXRpb24udHJhbnNmb3JtZXIoam9iX2V4ZXMpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dHMgPSBpbnB1dHM7XG4gICAgICAgICAgICB0aGlzLm91dHB1dHMgPSBvdXRwdXRzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYkRldGFpbHMucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZ2V0RHVyYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUR1cmF0aW9uKHRoaXMuY3JlYXRlZCwgdGhpcy5sYXN0X21vZGlmaWVkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRMYXRlc3RFeGVjdXRpb246IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubnVtX2V4ZXMgPiAwICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5qb2JfZXhlc1swXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0U3RhdHVzQ2xhc3M6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gaWYodGhpcy5zdGF0dXMgPT09ICdDT01QTEVURUQnKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuICdsYWJlbC1zdWNjZXNzJztcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgLy8gZWxzZSBpZiggdGhpcy5zdGF0dXMgPT09ICdGQUlMRUQnKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuICdsYWJlbC1kZWZhdWx0JzsvLyAgICByZXR1cm4gJ2xhYmVsLWRhbmdlcic7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIC8vIGVsc2V7XG4gICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiAnbGFiZWwtZGVmYXVsdCc7XG4gICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXR1cy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JEZXRhaWxzLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JEZXRhaWxzKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlX3JldixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ldmVudCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJpb3JpdHksXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubnVtX2V4ZXMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudGltZW91dCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tYXhfdHJpZXMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3B1c19yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZW1fcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19pbl9yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kaXNrX291dF9yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jcmVhdGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnF1ZXVlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGFydGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmVuZGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmxhc3Rfc3RhdHVzX2NoYW5nZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sYXN0X21vZGlmaWVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZWNpcGVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9leGVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlucHV0cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5vdXRwdXRzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgSm9iRGV0YWlscygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIEpvYkRldGFpbHMudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSm9iRGV0YWlscy5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBKb2JEZXRhaWxzLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBKb2JEZXRhaWxzO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iRXhlY3V0aW9uJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBKb2IsIE5vZGUsIG1vbWVudCkge1xuICAgICAgICB2YXIgSm9iRXhlY3V0aW9uID0gZnVuY3Rpb24gKGlkLCBzdGF0dXMsIGNvbW1hbmRfYXJndW1lbnRzLCB0aW1lb3V0LCBwcmVfc3RhcnRlZCwgcHJlX2NvbXBsZXRlZCwgcHJlX2V4aXRfY29kZSwgam9iX3N0YXJ0ZWQsIGpvYl9jb21wbGV0ZWQsIGpvYl9leGl0X2NvZGUsIHBvc3Rfc3RhcnRlZCwgcG9zdF9jb21wbGV0ZWQsIHBvc3RfZXhpdF9jb2RlLCBjcmVhdGVkLCBxdWV1ZWQsIHN0YXJ0ZWQsIGVuZGVkLCBsYXN0X21vZGlmaWVkLCBqb2IsIG5vZGUsIGVycm9yLCBlbnZpcm9ubWVudCwgY3B1c19zY2hlZHVsZWQsIG1lbV9zY2hlZHVsZWQsIGRpc2tfaW5fc2NoZWR1bGVkLCBkaXNrX291dF9zY2hlZHVsZWQsIGRpc2tfdG90YWxfc2NoZWR1bGVkLCByZXN1bHRzLCBjdXJyZW50X3N0ZG91dF91cmwsIGN1cnJlbnRfc3RkZXJyX3VybCwgcmVzdWx0c19tYW5pZmVzdCkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRfYXJndW1lbnRzID0gY29tbWFuZF9hcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgdGhpcy5wcmVfc3RhcnRlZCA9IHByZV9zdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5wcmVfY29tcGxldGVkID0gcHJlX2NvbXBsZXRlZDtcbiAgICAgICAgICAgIHRoaXMucHJlX2V4aXRfY29kZSA9IHByZV9leGl0X2NvZGU7XG4gICAgICAgICAgICB0aGlzLmpvYl9zdGFydGVkID0gam9iX3N0YXJ0ZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYl9jb21wbGV0ZWQgPSBqb2JfY29tcGxldGVkO1xuICAgICAgICAgICAgdGhpcy5qb2JfZXhpdF9jb2RlID0gam9iX2V4aXRfY29kZTtcbiAgICAgICAgICAgIHRoaXMucG9zdF9zdGFydGVkID0gcG9zdF9zdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5wb3N0X2NvbXBsZXRlZCA9IHBvc3RfY29tcGxldGVkO1xuICAgICAgICAgICAgdGhpcy5wb3N0X2V4aXRfY29kZSA9IHBvc3RfZXhpdF9jb2RlO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkID0gY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZF9mb3JtYXR0ZWQgPSBjcmVhdGVkID8gbW9tZW50LnV0YyhjcmVhdGVkKS50b0lTT1N0cmluZygpIDogY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMucXVldWVkID0gcXVldWVkO1xuICAgICAgICAgICAgdGhpcy5xdWV1ZWRfZm9ybWF0dGVkID0gcXVldWVkID8gbW9tZW50LnV0YyhxdWV1ZWQpLnRvSVNPU3RyaW5nKCkgOiBxdWV1ZWQ7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBzdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkX2Zvcm1hdHRlZCA9IHN0YXJ0ZWQgPyBtb21lbnQudXRjKHN0YXJ0ZWQpLnRvSVNPU3RyaW5nKCkgOiBzdGFydGVkO1xuICAgICAgICAgICAgdGhpcy5lbmRlZCA9IGVuZGVkO1xuICAgICAgICAgICAgdGhpcy5lbmRlZF9mb3JtYXR0ZWQgPSBlbmRlZCA/IG1vbWVudC51dGMoZW5kZWQpLnRvSVNPU3RyaW5nKCkgOiBlbmRlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWRfZm9ybWF0dGVkID0gbGFzdF9tb2RpZmllZCA/IG1vbWVudC51dGMobGFzdF9tb2RpZmllZCkudG9JU09TdHJpbmcoKSA6IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYiA9IEpvYi50cmFuc2Zvcm1lcihqb2IpO1xuICAgICAgICAgICAgdGhpcy5ub2RlID0gTm9kZS50cmFuc2Zvcm1lcihub2RlKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDtcbiAgICAgICAgICAgIHRoaXMuY3B1c19zY2hlZHVsZWQgPSBjcHVzX3NjaGVkdWxlZDtcbiAgICAgICAgICAgIHRoaXMubWVtX3NjaGVkdWxlZCA9IG1lbV9zY2hlZHVsZWQ7XG4gICAgICAgICAgICB0aGlzLmRpc2tfaW5fc2NoZWR1bGVkID0gZGlza19pbl9zY2hlZHVsZWQ7XG4gICAgICAgICAgICB0aGlzLmRpc2tfb3V0X3NjaGVkdWxlZCA9IGRpc2tfb3V0X3NjaGVkdWxlZDtcbiAgICAgICAgICAgIHRoaXMuZGlza190b3RhbF9zY2hlZHVsZWQgPSBkaXNrX3RvdGFsX3NjaGVkdWxlZDtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfc3Rkb3V0X3VybCA9IGN1cnJlbnRfc3Rkb3V0X3VybDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9zdGRlcnJfdXJsID0gY3VycmVudF9zdGRlcnJfdXJsO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRzX21hbmlmZXN0ID0gcmVzdWx0c19tYW5pZmVzdDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JFeGVjdXRpb24ucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZ2V0RHVyYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50LnV0Yyh0aGlzLmpvYl9jb21wbGV0ZWQpLmRpZmYobW9tZW50LnV0Yyh0aGlzLmpvYl9zdGFydGVkKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0SWNvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmpvYi5qb2JUeXBlLmljb25Db2RlID8gJzxpIGNsYXNzPVwiZmFcIj4mI3gnICsgdGhpcy5qb2Iuam9iVHlwZS5pY29uQ29kZSArICc8L2k+JyA6ICc8aSBjbGFzcz1cImZhXCI+JiN4JyArIHNjYWxlQ29uZmlnLmRlZmF1bHRJY29uQ29kZSArICc8L2k+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgSm9iRXhlY3V0aW9uLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JFeGVjdXRpb24oXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbW1hbmRfYXJndW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRpbWVvdXQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJlX3N0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJlX2NvbXBsZXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wcmVfZXhpdF9jb2RlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9zdGFydGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9jb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX2V4aXRfY29kZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wb3N0X3N0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucG9zdF9jb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucG9zdF9leGl0X2NvZGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5xdWV1ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lbmRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sYXN0X21vZGlmaWVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmVudmlyb25tZW50LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNwdXNfc2NoZWR1bGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm1lbV9zY2hlZHVsZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19pbl9zY2hlZHVsZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19vdXRfc2NoZWR1bGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpc2tfdG90YWxfc2NoZWR1bGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3VycmVudF9zdGRvdXRfdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmN1cnJlbnRfc3RkZXJyX3VybCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzX21hbmlmZXN0XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgSm9iRXhlY3V0aW9uKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iRXhlY3V0aW9uLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKEpvYkV4ZWN1dGlvbi5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBKb2JFeGVjdXRpb24uYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYkV4ZWN1dGlvbjtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ0pvYkV4ZWN1dGlvbkxvZycsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgSm9iLCBOb2RlKSB7XG4gICAgICAgIHZhciBKb2JFeGVjdXRpb25Mb2cgPSBmdW5jdGlvbiAoaWQsIHN0YXR1cywgY29tbWFuZF9hcmd1bWVudHMsIHRpbWVvdXQsIGV4aXRfY29kZSwgY3JlYXRlZCwgcXVldWVkLCBzY2hlZHVsZWQsIHByZV9zdGFydGVkLCBwcmVfY29tcGxldGVkLCBqb2Jfc3RhcnRlZCwgam9iX2NvbXBsZXRlZCwgcG9zdF9zdGFydGVkLCBwb3N0X2NvbXBsZXRlZCwgZW5kZWQsIGxhc3RfbW9kaWZpZWQsIGpvYiwgbm9kZSwgZXJyb3IsIGlzX2ZpbmlzaGVkLCBzdGRvdXQsIHN0ZGVycikge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRfYXJndW1lbnRzID0gY29tbWFuZF9hcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgdGhpcy5leGl0X2NvZGUgPSBleGl0X2NvZGU7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWQgPSBjcmVhdGVkO1xuICAgICAgICAgICAgdGhpcy5xdWV1ZWQgPSBxdWV1ZWQ7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlZCA9IHNjaGVkdWxlZDtcbiAgICAgICAgICAgIHRoaXMucHJlX3N0YXJ0ZWQgPSBwcmVfc3RhcnRlZDtcbiAgICAgICAgICAgIHRoaXMucHJlX2NvbXBsZXRlZCA9IHByZV9jb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYl9zdGFydGVkID0gam9iX3N0YXJ0ZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYl9jb21wbGV0ZWQgPSBqb2JfY29tcGxldGVkO1xuICAgICAgICAgICAgdGhpcy5wb3N0X3N0YXJ0ZWQgPSBwb3N0X3N0YXJ0ZWQ7XG4gICAgICAgICAgICB0aGlzLnBvc3RfY29tcGxldGVkID0gcG9zdF9jb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aGlzLmVuZGVkID0gZW5kZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWQgPSBsYXN0X21vZGlmaWVkO1xuICAgICAgICAgICAgdGhpcy5qb2IgPSBKb2IudHJhbnNmb3JtZXIoam9iKTtcbiAgICAgICAgICAgIHRoaXMubm9kZSA9IE5vZGUudHJhbnNmb3JtZXIobm9kZSk7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICB0aGlzLmlzX2ZpbmlzaGVkID0gaXNfZmluaXNoZWQ7XG4gICAgICAgICAgICB0aGlzLnN0ZG91dCA9IHN0ZG91dDtcbiAgICAgICAgICAgIHRoaXMuc3Rkb3V0SHRtbCA9IHN0ZG91dCA/IHN0ZG91dC5yZXBsYWNlKG5ldyBSZWdFeHAoJ1xccj9cXG4nLCdnJyksICc8YnIgLz4nKSA6ICcnO1xuICAgICAgICAgICAgdGhpcy5zdGRlcnIgPSBzdGRlcnI7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgSm9iRXhlY3V0aW9uTG9nLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIHRvSHRtbDogZnVuY3Rpb24oaW5zdHIpe1xuICAgICAgICAgICAgICAgIHJldHVybiBpbnN0clxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIEpvYkV4ZWN1dGlvbkxvZy5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSm9iRXhlY3V0aW9uTG9nKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb21tYW5kX2FyZ3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50aW1lb3V0LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmV4aXRfY29kZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jcmVhdGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnF1ZXVlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zY2hlZHVsZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJlX3N0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJlX2NvbXBsZXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2Jfc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfY29tcGxldGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnBvc3Rfc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wb3N0X2NvbXBsZXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lbmRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sYXN0X21vZGlmaWVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX2ZpbmlzaGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0ZG91dCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGRlcnJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JFeGVjdXRpb25Mb2coKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JFeGVjdXRpb25Mb2cudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSm9iRXhlY3V0aW9uTG9nLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYkV4ZWN1dGlvbkxvZy5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gSm9iRXhlY3V0aW9uTG9nO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iVHlwZScsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgSm9iVHlwZUludGVyZmFjZSkge1xuICAgICAgICB2YXIgSm9iVHlwZSA9IGZ1bmN0aW9uIChpZCwgbmFtZSwgdGl0bGUsIHZlcnNpb24sIGRlc2NyaXB0aW9uLCBpc19zeXN0ZW0sIGlzX2xvbmdfcnVubmluZywgaXNfYWN0aXZlLCBpc19vcGVyYXRpb25hbCwgaXNfcGF1c2VkLCB1c2VzX2RvY2tlciwgZG9ja2VyX3ByaXZpbGVnZWQsIGRvY2tlcl9pbWFnZSwgcHJpb3JpdHksIHRpbWVvdXQsIG1heF90cmllcywgY3B1c19yZXF1aXJlZCwgbWVtX3JlcXVpcmVkLCBkaXNrX291dF9jb25zdF9yZXF1aXJlZCwgZGlza19vdXRfbXVsdF9yZXF1aXJlZCwgaWNvbl9jb2RlLCBjcmVhdGVkLCBhcmNoaXZlZCwgcGF1c2VkLCBsYXN0X21vZGlmaWVkLCBqb2JfdHlwZV9pbnRlcmZhY2UpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy5pc19zeXN0ZW0gPSBpc19zeXN0ZW07XG4gICAgICAgICAgICB0aGlzLmlzX2xvbmdfcnVubmluZyA9IGlzX2xvbmdfcnVubmluZztcbiAgICAgICAgICAgIHRoaXMuaXNfYWN0aXZlID0gaXNfYWN0aXZlO1xuICAgICAgICAgICAgdGhpcy5pc19vcGVyYXRpb25hbCA9IGlzX29wZXJhdGlvbmFsO1xuICAgICAgICAgICAgdGhpcy5pc19wYXVzZWQgPSBpc19wYXVzZWQ7XG4gICAgICAgICAgICB0aGlzLnVzZXNfZG9ja2VyID0gdXNlc19kb2NrZXI7XG4gICAgICAgICAgICB0aGlzLmRvY2tlcl9wcml2aWxlZ2VkID0gZG9ja2VyX3ByaXZpbGVnZWQ7XG4gICAgICAgICAgICB0aGlzLmRvY2tlcl9pbWFnZSA9IGRvY2tlcl9pbWFnZTtcbiAgICAgICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgICAgICB0aGlzLm1heF90cmllcyA9IG1heF90cmllcztcbiAgICAgICAgICAgIHRoaXMuY3B1c19yZXF1aXJlZCA9IGNwdXNfcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLm1lbV9yZXF1aXJlZCA9IG1lbV9yZXF1aXJlZDtcbiAgICAgICAgICAgIHRoaXMuZGlza19vdXRfY29uc3RfcmVxdWlyZWQgPSBkaXNrX291dF9jb25zdF9yZXF1aXJlZDtcbiAgICAgICAgICAgIHRoaXMuZGlza19vdXRfbXVsdF9yZXF1aXJlZCA9IGRpc2tfb3V0X211bHRfcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLmljb25fY29kZSA9IGljb25fY29kZTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZCA9IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmFyY2hpdmVkID0gYXJjaGl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHBhdXNlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlX2ludGVyZmFjZSA9IEpvYlR5cGVJbnRlcmZhY2UudHJhbnNmb3JtZXIoam9iX3R5cGVfaW50ZXJmYWNlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JUeXBlLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdKb2JUeXBlJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRJY29uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWNvbl9jb2RlID8gJzxpIGNsYXNzPVwiZmFcIj4mI3gnICsgdGhpcy5pY29uX2NvZGUgKyAnPC9pPicgOiAnPGkgY2xhc3M9XCJmYVwiPiYjeCcgKyBzY2FsZUNvbmZpZy5kZWZhdWx0SWNvbkNvZGUgKyAnPC9pPic7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbFRleHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pY29uX2NvZGUgPyAnJiN4JyArIHRoaXMuaWNvbl9jb2RlICsgJzsnIDogJyYjeCcgKyBzY2FsZUNvbmZpZy5kZWZhdWx0SWNvbkNvZGUgKyAnOyc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbFRpdGxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGl0bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIEpvYlR5cGUuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGUoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3N5c3RlbSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc19sb25nX3J1bm5pbmcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX29wZXJhdGlvbmFsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3BhdXNlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS51c2VzX2RvY2tlcixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kb2NrZXJfcHJpdmlsZWdlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kb2NrZXJfaW1hZ2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJpb3JpdHksXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudGltZW91dCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tYXhfdHJpZXMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3B1c19yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZW1fcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19vdXRfY29uc3RfcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlza19vdXRfbXVsdF9yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pY29uX2NvZGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hcmNoaXZlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wYXVzZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pbnRlcmZhY2VcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JUeXBlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iVHlwZS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JUeXBlLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYlR5cGUuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYlR5cGU7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iVHlwZURldGFpbHMnLCBmdW5jdGlvbiAoc2NhbGVDb25maWcsIEpvYlR5cGVJbnRlcmZhY2UsIEpvYlR5cGVFcnJvck1hcHBpbmcsIEpvYlR5cGVFcnJvciwgc2NhbGVTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBKb2JUeXBlRGV0YWlscyA9IGZ1bmN0aW9uIChpZCwgbmFtZSwgdmVyc2lvbiwgdGl0bGUsIGRlc2NyaXB0aW9uLCBjYXRlZ29yeSwgYXV0aG9yX25hbWUsIGF1dGhvcl91cmwsIGlzX3N5c3RlbSwgaXNfbG9uZ19ydW5uaW5nLCBpc19hY3RpdmUsIGlzX29wZXJhdGlvbmFsLCBpc19wYXVzZWQsIGljb25fY29kZSwgdXNlc19kb2NrZXIsIGRvY2tlcl9wcml2aWxlZ2VkLCBkb2NrZXJfaW1hZ2UsIHJldmlzaW9uX251bSwgcHJpb3JpdHksIHRpbWVvdXQsIG1heF9zY2hlZHVsZWQsIG1heF90cmllcywgY3B1c19yZXF1aXJlZCwgbWVtX3JlcXVpcmVkLCBkaXNrX291dF9jb25zdF9yZXF1aXJlZCwgZGlza19vdXRfbXVsdF9yZXF1aXJlZCwgY3JlYXRlZCwgYXJjaGl2ZWQsIHBhdXNlZCwgbGFzdF9tb2RpZmllZCwgam9iX3R5cGVfaW50ZXJmYWNlLCBlcnJvcl9tYXBwaW5nLCB0cmlnZ2VyX3J1bGUsIGVycm9ycywgam9iX2NvdW50c182aCwgam9iX2NvdW50c18xMmgsIGpvYl9jb3VudHNfMjRoKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yX25hbWUgPSBhdXRob3JfbmFtZTtcbiAgICAgICAgICAgIHRoaXMuYXV0aG9yX3VybCA9IGF1dGhvcl91cmw7XG4gICAgICAgICAgICB0aGlzLmlzX3N5c3RlbSA9IGlzX3N5c3RlbTtcbiAgICAgICAgICAgIHRoaXMuaXNfbG9uZ19ydW5uaW5nID0gaXNfbG9uZ19ydW5uaW5nO1xuICAgICAgICAgICAgdGhpcy5pc19hY3RpdmUgPSBpc19hY3RpdmU7XG4gICAgICAgICAgICB0aGlzLmlzX29wZXJhdGlvbmFsID0gaXNfb3BlcmF0aW9uYWw7XG4gICAgICAgICAgICB0aGlzLmlzX3BhdXNlZCA9IGlzX3BhdXNlZDtcbiAgICAgICAgICAgIHRoaXMuaWNvbl9jb2RlID0gaWNvbl9jb2RlO1xuICAgICAgICAgICAgdGhpcy51c2VzX2RvY2tlciA9IHVzZXNfZG9ja2VyO1xuICAgICAgICAgICAgdGhpcy5kb2NrZXJfcHJpdmlsZWdlZCA9IGRvY2tlcl9wcml2aWxlZ2VkO1xuICAgICAgICAgICAgdGhpcy5kb2NrZXJfaW1hZ2UgPSBkb2NrZXJfaW1hZ2U7XG4gICAgICAgICAgICB0aGlzLnJldmlzaW9uX251bSA9IHJldmlzaW9uX251bTtcbiAgICAgICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgICAgICB0aGlzLm1heF9zY2hlZHVsZWQgPSBtYXhfc2NoZWR1bGVkO1xuICAgICAgICAgICAgdGhpcy5tYXhfdHJpZXMgPSBtYXhfdHJpZXM7XG4gICAgICAgICAgICB0aGlzLmNwdXNfcmVxdWlyZWQgPSBjcHVzX3JlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5tZW1fcmVxdWlyZWQgPSBtZW1fcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLm1lbV9yZXF1aXJlZF9mb3JtYXR0ZWQgPSBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tTWliKG1lbV9yZXF1aXJlZCk7XG4gICAgICAgICAgICB0aGlzLmRpc2tfb3V0X2NvbnN0X3JlcXVpcmVkID0gZGlza19vdXRfY29uc3RfcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLmRpc2tfb3V0X2NvbnN0X3JlcXVpcmVkX2Zvcm1hdHRlZCA9IHNjYWxlU2VydmljZS5jYWxjdWxhdGVGaWxlU2l6ZUZyb21NaWIoZGlza19vdXRfY29uc3RfcmVxdWlyZWQpO1xuICAgICAgICAgICAgdGhpcy5kaXNrX291dF9tdWx0X3JlcXVpcmVkID0gZGlza19vdXRfbXVsdF9yZXF1aXJlZDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZCA9IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmFyY2hpdmVkID0gYXJjaGl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnBhdXNlZCA9IHBhdXNlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlX2ludGVyZmFjZSA9IGpvYl90eXBlX2ludGVyZmFjZTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JfbWFwcGluZyA9IEpvYlR5cGVFcnJvck1hcHBpbmcudHJhbnNmb3JtZXIoZXJyb3JfbWFwcGluZyk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJfcnVsZSA9IHRyaWdnZXJfcnVsZTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gSm9iVHlwZUVycm9yLnRyYW5zZm9ybWVyKGVycm9ycyk7XG4gICAgICAgICAgICB0aGlzLmpvYl9jb3VudHNfNmggPSBqb2JfY291bnRzXzZoO1xuICAgICAgICAgICAgdGhpcy5qb2JfY291bnRzXzEyaCA9IGpvYl9jb3VudHNfMTJoO1xuICAgICAgICAgICAgdGhpcy5qb2JfY291bnRzXzI0aCA9IGpvYl9jb3VudHNfMjRoO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYlR5cGVEZXRhaWxzLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIGdldEljb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pY29uX2NvZGUgPyAnPGkgY2xhc3M9XCJmYVwiPiYjeCcgKyB0aGlzLmljb25fY29kZSArICc8L2k+JyA6ICc8aSBjbGFzcz1cImZhXCI+JiN4JyArIHNjYWxlQ29uZmlnLmRlZmF1bHRJY29uQ29kZSArICc8L2k+JztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRQZXJmb3JtYW5jZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBmYWlsZWQ2QXJyID0gXy53aGVyZSh0aGlzLmpvYl9jb3VudHNfNmgsIHsgJ3N0YXR1cyc6ICdGQUlMRUQnIH0pLFxuICAgICAgICAgICAgICAgICAgICBmYWlsZWQxMkFyciA9IF8ud2hlcmUodGhpcy5qb2JfY291bnRzXzEyaCwgeyAnc3RhdHVzJzogJ0ZBSUxFRCcgfSksXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZDI0QXJyID0gXy53aGVyZSh0aGlzLmpvYl9jb3VudHNfMjRoLCB7ICdzdGF0dXMnOiAnRkFJTEVEJyB9KTtcblxuICAgICAgICAgICAgICAgIHZhciBjb21wbGV0ZWQ2ID0gXy5maW5kKHRoaXMuam9iX2NvdW50c182aCwgJ3N0YXR1cycsICdDT01QTEVURUQnKSB8fCB7IGNvdW50OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZDYgPSBfLnN1bShmYWlsZWQ2QXJyLCAnY291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgdG90YWw2ID0gZmFpbGVkNkFyci5sZW5ndGggPiAwID8gZmFpbGVkNiArIGNvbXBsZXRlZDYuY291bnQgOiBjb21wbGV0ZWQ2LmNvdW50LFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZTYgPSB0b3RhbDYgPT09IDAgPyAwIDogMTAwIC0gKChmYWlsZWQ2IC8gdG90YWw2KSAqIDEwMCkudG9GaXhlZCgyKSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkMTIgPSBfLmZpbmQodGhpcy5qb2JfY291bnRzXzEyaCwgJ3N0YXR1cycsICdDT01QTEVURUQnKSB8fCB7IGNvdW50OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZDEyID0gXy5zdW0oZmFpbGVkMTJBcnIsICdjb3VudCcpLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbDEyID0gZmFpbGVkMTJBcnIubGVuZ3RoID4gMCA/IGZhaWxlZDEyICsgY29tcGxldGVkMTIuY291bnQgOiBjb21wbGV0ZWQxMi5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc1JhdGUxMiA9IHRvdGFsMTIgPT09IDAgPyAwIDogMTAwIC0gKChmYWlsZWQxMiAvIHRvdGFsMTIpICogMTAwKS50b0ZpeGVkKDIpLFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQyNCA9IF8uZmluZCh0aGlzLmpvYl9jb3VudHNfMjRoLCAnc3RhdHVzJywgJ0NPTVBMRVRFRCcpIHx8IHsgY291bnQ6IDAgfSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkMjQgPSBfLnN1bShmYWlsZWQyNEFyciwgJ2NvdW50JyksXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsMjQgPSBmYWlsZWQyNEFyci5sZW5ndGggPiAwID8gZmFpbGVkMjQgKyBjb21wbGV0ZWQyNC5jb3VudCA6IGNvbXBsZXRlZDI0LmNvdW50LFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZTI0ID0gdG90YWwyNCA9PT0gMCA/IDAgOiAxMDAgLSAoKGZhaWxlZDI0IC8gdG90YWwyNCkgKiAxMDApLnRvRml4ZWQoMik7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBob3VyNjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmF0ZTogc3VjY2Vzc1JhdGU2LFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkOiBmYWlsZWQ2LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWQ2LmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IHRvdGFsNlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBob3VyMTI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdGU6IHN1Y2Nlc3NSYXRlMTIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWQ6IGZhaWxlZDEyLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWQxMi5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiB0b3RhbDEyXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGhvdXIyNDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmF0ZTogc3VjY2Vzc1JhdGUyNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZDogZmFpbGVkMjQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZDI0LmNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IHRvdGFsMjRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0RmFpbHVyZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmFpbGVkNiA9IF8ud2hlcmUodGhpcy5qb2JfY291bnRzXzZoLCB7ICdzdGF0dXMnOiAnRkFJTEVEJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkNlZhbHVlcyA9IF8udmFsdWVzKF8uZ3JvdXBCeShmYWlsZWQ2LCAnY2F0ZWdvcnknKSksXG4gICAgICAgICAgICAgICAgICAgIGZhaWxlZDEyID0gXy53aGVyZSh0aGlzLmpvYl9jb3VudHNfMTJoLCB7ICdzdGF0dXMnOiAnRkFJTEVEJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkMTJWYWx1ZXMgPSBfLnZhbHVlcyhfLmdyb3VwQnkoZmFpbGVkMTIsICdjYXRlZ29yeScpKSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkMjQgPSBfLndoZXJlKHRoaXMuam9iX2NvdW50c18yNGgsIHsgJ3N0YXR1cyc6ICdGQUlMRUQnIH0pLFxuICAgICAgICAgICAgICAgICAgICBmYWlsZWQyNFZhbHVlcyA9IF8udmFsdWVzKF8uZ3JvdXBCeShmYWlsZWQyNCwgJ2NhdGVnb3J5JykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdldEZhaWx1cmVDb3VudHMgPSBmdW5jdGlvbiAoY2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0dXJuQXJyID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjYXRlZ29yaWVzLCBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjYXRlZ29yeSwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkFyci5wdXNoKHsgc3RhdHVzOiB2YWwuY2F0ZWdvcnksIGNvdW50OiB2YWwuY291bnQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5BcnI7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGhvdXI2OiBnZXRGYWlsdXJlQ291bnRzKGZhaWxlZDZWYWx1ZXMpLFxuICAgICAgICAgICAgICAgICAgICBob3VyMTI6IGdldEZhaWx1cmVDb3VudHMoZmFpbGVkMTJWYWx1ZXMpLFxuICAgICAgICAgICAgICAgICAgICBob3VyMjQ6IGdldEZhaWx1cmVDb3VudHMoZmFpbGVkMjRWYWx1ZXMpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgSm9iVHlwZURldGFpbHMuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBjaGFuZ2UgcHJvcGVydHkgcmV0dXJuZWQgYnkgQVBJIGZyb20gXCJpbnRlcmZhY2VcIiB0byBcImpvYl90eXBlX2ludGVyZmFjZVwiIGJlY2F1c2UgXCJpbnRlcmZhY2VcIiBpcyBhIHJlc2VydmVkIHdvcmQgaW4gSlNcbiAgICAgICAgICAgICAgICB2YXIgam9iVHlwZUludGVyZmFjZSA9IGRhdGEuaW50ZXJmYWNlID8gZGF0YS5pbnRlcmZhY2UgOiBkYXRhLmpvYl90eXBlX2ludGVyZmFjZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVEZXRhaWxzKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jYXRlZ29yeSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hdXRob3JfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hdXRob3JfdXJsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3N5c3RlbSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc19sb25nX3J1bm5pbmcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX29wZXJhdGlvbmFsLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3BhdXNlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pY29uX2NvZGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudXNlc19kb2NrZXIsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZG9ja2VyX3ByaXZpbGVnZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZG9ja2VyX2ltYWdlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnJldmlzaW9uX251bSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wcmlvcml0eSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50aW1lb3V0LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm1heF9zY2hlZHVsZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWF4X3RyaWVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNwdXNfcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWVtX3JlcXVpcmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpc2tfb3V0X2NvbnN0X3JlcXVpcmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpc2tfb3V0X211bHRfcmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hcmNoaXZlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wYXVzZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgam9iVHlwZUludGVyZmFjZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lcnJvcl9tYXBwaW5nLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRyaWdnZXJfcnVsZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lcnJvcnMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX2NvdW50c182aCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfY291bnRzXzEyaCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfY291bnRzXzI0aFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVEZXRhaWxzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iVHlwZURldGFpbHMudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoSm9iVHlwZURldGFpbHMuYnVpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYlR5cGVEZXRhaWxzLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBKb2JUeXBlRGV0YWlscztcbiAgICB9KTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2JUeXBlRXJyb3InLCBmdW5jdGlvbiAobW9tZW50LCBzY2FsZUNvbmZpZykge1xuICAgICAgICB2YXIgSm9iVHlwZUVycm9yID0gZnVuY3Rpb24gKGlkLCBuYW1lLCB0aXRsZSwgZGVzY3JpcHRpb24sIGNhdGVnb3J5LCBjcmVhdGVkLCBsYXN0X21vZGlmaWVkKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IGNhdGVnb3J5O1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkID0gY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZF9mb3JtYXR0ZWQgPSBjcmVhdGVkID8gbW9tZW50LnV0YyhjcmVhdGVkKS50b0lTT1N0cmluZygpIDogY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWRfZm9ybWF0dGVkID0gbGFzdF9tb2RpZmllZCA/IG1vbWVudC51dGMobGFzdF9tb2RpZmllZCkudG9JU09TdHJpbmcoKSA6IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgSm9iVHlwZUVycm9yLnByb3RvdHlwZSA9IHtcblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JUeXBlRXJyb3IuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNhdGVnb3J5LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVFcnJvcigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIEpvYlR5cGVFcnJvci50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JUeXBlRXJyb3IuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iVHlwZUVycm9yLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBKb2JUeXBlRXJyb3I7XG4gICAgfSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBcbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdKb2JUeXBlRXJyb3JNYXBwaW5nJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgSm9iVHlwZUVycm9yTWFwcGluZyA9IGZ1bmN0aW9uICh2ZXJzaW9uLCBleGl0X2NvZGVzKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy5leGl0X2NvZGVzID0gZXhpdF9jb2RlcztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JUeXBlRXJyb3JNYXBwaW5nLnByb3RvdHlwZSA9IHtcblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JUeXBlRXJyb3JNYXBwaW5nLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JUeXBlRXJyb3JNYXBwaW5nKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZXhpdF9jb2Rlc1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVFcnJvck1hcHBpbmcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JUeXBlRXJyb3JNYXBwaW5nLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKEpvYlR5cGVFcnJvck1hcHBpbmcuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iVHlwZUVycm9yTWFwcGluZy5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gSm9iVHlwZUVycm9yTWFwcGluZztcbiAgICB9KVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ0pvYlR5cGVJbnB1dERhdGEnLCBmdW5jdGlvbiAoc2NhbGVDb25maWcpIHtcbiAgICAgICAgdmFyIEpvYlR5cGVJbnB1dERhdGEgPSBmdW5jdGlvbiAobWVkaWFfdHlwZXMsIHJlcXVpcmVkLCB0eXBlLCBuYW1lKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhX3R5cGVzID0gbWVkaWFfdHlwZXM7XG4gICAgICAgICAgICB0aGlzLnJlcXVpcmVkID0gcmVxdWlyZWQ7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JUeXBlSW5wdXREYXRhLnByb3RvdHlwZSA9IHtcblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JUeXBlSW5wdXREYXRhLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JUeXBlSW5wdXREYXRhKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm1lZGlhX3R5cGVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlcXVpcmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmFtZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVJbnB1dERhdGEoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JUeXBlSW5wdXREYXRhLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKEpvYlR5cGVJbnB1dERhdGEuYnVpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYlR5cGVJbnB1dERhdGEuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYlR5cGVJbnB1dERhdGE7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iVHlwZUludGVyZmFjZScsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgSm9iVHlwZUlucHV0RGF0YSwgSm9iVHlwZU91dHB1dERhdGEpIHtcbiAgICAgICAgdmFyIEpvYlR5cGVJbnRlcmZhY2UgPSBmdW5jdGlvbiAodmVyc2lvbiwgY29tbWFuZCwgY29tbWFuZF9hcmd1bWVudHMsIGlucHV0X2RhdGEsIG91dHB1dF9kYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kID0gY29tbWFuZDtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZF9hcmd1bWVudHMgPSBjb21tYW5kX2FyZ3VtZW50cztcbiAgICAgICAgICAgIHRoaXMuaW5wdXRfZGF0YSA9IEpvYlR5cGVJbnB1dERhdGEudHJhbnNmb3JtZXIoaW5wdXRfZGF0YSk7XG4gICAgICAgICAgICB0aGlzLm91dHB1dF9kYXRhID0gSm9iVHlwZU91dHB1dERhdGEudHJhbnNmb3JtZXIob3V0cHV0X2RhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYlR5cGVJbnRlcmZhY2UucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZ2V0SWNvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmljb25Db2RlID8gJzxpIGNsYXNzPVwiZmFcIj4mI3gnICsgdGhpcy5pY29uQ29kZSArICc8L2k+JyA6ICc8aSBjbGFzcz1cImZhXCI+JiN4JyArIHNjYWxlQ29uZmlnLmRlZmF1bHRJY29uQ29kZSArICc8L2k+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgSm9iVHlwZUludGVyZmFjZS5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSm9iVHlwZUludGVyZmFjZShcbiAgICAgICAgICAgICAgICAgICAgZGF0YS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbW1hbmQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY29tbWFuZF9hcmd1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaW5wdXRfZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5vdXRwdXRfZGF0YVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVJbnRlcmZhY2UoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JUeXBlSW50ZXJmYWNlLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKEpvYlR5cGVJbnRlcmZhY2UuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSm9iVHlwZUludGVyZmFjZS5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gSm9iVHlwZUludGVyZmFjZTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ0pvYlR5cGVPdXRwdXREYXRhJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgSm9iVHlwZU91dHB1dERhdGEgPSBmdW5jdGlvbiAobmFtZSwgdHlwZSwgcmVxdWlyZWQsIG1lZGlhX3R5cGUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5yZXF1aXJlZCA9IHJlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5tZWRpYV90eXBlID0gbWVkaWFfdHlwZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBKb2JUeXBlT3V0cHV0RGF0YS5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgSm9iVHlwZU91dHB1dERhdGEuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEpvYlR5cGVPdXRwdXREYXRhKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZWRpYV90eXBlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgSm9iVHlwZU91dHB1dERhdGEoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBKb2JUeXBlT3V0cHV0RGF0YS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JUeXBlT3V0cHV0RGF0YS5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBKb2JUeXBlT3V0cHV0RGF0YS5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gSm9iVHlwZU91dHB1dERhdGE7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnSm9iVHlwZVN0YXR1cycsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgSm9iVHlwZSwgSm9iRXhlY3V0aW9uKSB7XG4gICAgICAgIHZhciBKb2JUeXBlU3RhdHVzID0gZnVuY3Rpb24gKGpvYl90eXBlLCBqb2JfY291bnRzKSB7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlID0gSm9iVHlwZS50cmFuc2Zvcm1lcihqb2JfdHlwZSk7XG4gICAgICAgICAgICB0aGlzLmpvYl9jb3VudHMgPSBqb2JfY291bnRzO1xuICAgICAgICAgICAgdGhpcy5oYXNfcnVubmluZyA9IF8uZmluZChqb2JfY291bnRzLCAnc3RhdHVzJywgJ1JVTk5JTkcnKTtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSB0aGlzLmdldFBlcmZvcm1hbmNlKCkucmF0ZURlc2NyaXB0aW9uO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgICAgIEpvYlR5cGVTdGF0dXMucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0pvYlR5cGVTdGF0dXMnO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldFBlcmZvcm1hbmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZhaWxlZEFyciA9IF8uc29ydEJ5T3JkZXIoXy5maWx0ZXIodGhpcy5qb2JfY291bnRzLCB7IHN0YXR1czogJ0ZBSUxFRCcgfSksIFsnY291bnQnXSwgWydkZXNjJ10pLFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQgPSBfLmZpbmQodGhpcy5qb2JfY291bnRzLCAnc3RhdHVzJywgJ0NPTVBMRVRFRCcpIHx8IHsgY291bnQ6IDAgfSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkID0gXy5zdW0oZmFpbGVkQXJyLCAnY291bnQnKSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkQ2F0ZWdvcnkgPSBmYWlsZWRBcnIubGVuZ3RoID4gMCA/IGZhaWxlZEFyclswXS5jYXRlZ29yeSA6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbCA9IGZhaWxlZEFyci5sZW5ndGggPiAwID8gZmFpbGVkICsgY29tcGxldGVkLmNvdW50IDogY29tcGxldGVkLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZSA9IHRvdGFsID09PSAwID8gMCA6IDEwMCAtICgoZmFpbGVkIC8gdG90YWwpICogMTAwKS50b0ZpeGVkKDIpLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZURlc2NyaXB0aW9uID0gJ3N1Y2Nlc3MnO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3NSYXRlIDw9IDMwICYmIHRvdGFsID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZURlc2NyaXB0aW9uID0gJ2Vycm9yJztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN1Y2Nlc3NSYXRlID4gMzAgJiYgc3VjY2Vzc1JhdGUgPD0gNjAgJiYgdG90YWwgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NSYXRlRGVzY3JpcHRpb24gPSAnd2FybmluZyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0b3RhbCA9PT0gMCAmJiAhdGhpcy5oYXNfcnVubmluZykge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzUmF0ZURlc2NyaXB0aW9uID0gJ3pfaW5hY3RpdmUnOyAvLyBwcmVwZW5kIHdpdGggJ3pfJyBmb3Igb3JkZXJpbmcgcHVycG9zZXNcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByYXRlOiBzdWNjZXNzUmF0ZSxcbiAgICAgICAgICAgICAgICAgICAgcmF0ZURlc2NyaXB0aW9uOiBzdWNjZXNzUmF0ZURlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBmYWlsZWQ6IGZhaWxlZCxcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkQ2F0ZWdvcnk6IGZhaWxlZENhdGVnb3J5LFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZC5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IHRvdGFsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRSdW5uaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uZmluZCh0aGlzLmpvYl9jb3VudHMsICdzdGF0dXMnLCAnUlVOTklORycpIHx8IHsgY291bnQ6IDAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRGYWlsdXJlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBmYWlsZWQgPSBfLndoZXJlKHRoaXMuam9iX2NvdW50cywgeyAnc3RhdHVzJzogJ0ZBSUxFRCcgfSk7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2goZmFpbGVkLCBmdW5jdGlvbiAoZikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSBfLmZpbmQoc2NhbGVDb25maWcuZXJyb3JDYXRlZ29yaWVzLCB7IG5hbWU6IGYuY2F0ZWdvcnkgfSk7XG4gICAgICAgICAgICAgICAgICAgIGYub3JkZXIgPSBjYXRlZ29yeSA/IGNhdGVnb3J5Lm9yZGVyIDogJyc7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZmFpbGVkVmFsdWVzID0gXy52YWx1ZXMoXy5ncm91cEJ5KGZhaWxlZCwgJ29yZGVyJykpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGdldEZhaWx1cmVDb3VudHMgPSBmdW5jdGlvbiAoY2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0dXJuQXJyID0gW107XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjYXRlZ29yaWVzLCBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChjYXRlZ29yeSwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkFyci5wdXNoKHsgc3RhdHVzOiB2YWwuY2F0ZWdvcnksIGNvdW50OiB2YWwuY291bnQsIG9yZGVyOiB2YWwub3JkZXIgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfLnNvcnRCeU9yZGVyKHJldHVybkFyciwgWydvcmRlciddLCBbJ2Rlc2MnXSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRGYWlsdXJlQ291bnRzKGZhaWxlZFZhbHVlcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEZpbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gdGhpcy5nZXRQZXJmb3JtYW5jZSgpO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0dXMucmF0ZURlc2NyaXB0aW9uID09PSAnel9pbmFjdGl2ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjYWxlQ29uZmlnLmNvbG9ycy5jaGFydF9ncmF5X2Rhcms7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfZ3JlZW47XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEFjdGl2aXR5VG90YWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSdW5uaW5nKCkuY291bnQgPiAwID8gdGhpcy5nZXRSdW5uaW5nKCkuY291bnQgOiAnJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsRXJyb3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2UgPSB0aGlzLmdldFBlcmZvcm1hbmNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGYWlsZWQ6ICcgKyAocGVyZm9ybWFuY2UuZmFpbGVkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsVG90YWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2UgPSB0aGlzLmdldFBlcmZvcm1hbmNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLmNvbXBsZXRlZDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsUGF1c2VSZXN1bWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEZhaWx1cmVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8ubWFwKHRoaXMuZ2V0RmFpbHVyZXMoKSwgJ3N0YXR1cycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBKb2JUeXBlU3RhdHVzLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JUeXBlU3RhdHVzKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9jb3VudHNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBKb2JUeXBlU3RhdHVzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgSm9iVHlwZVN0YXR1cy50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChKb2JUeXBlU3RhdHVzLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEpvYlR5cGVTdGF0dXMuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIEpvYlR5cGVTdGF0dXM7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1Byb2R1Y3QnLCBmdW5jdGlvbiAoSm9iVHlwZSwgc2NhbGVTZXJ2aWNlLCBzY2FsZUNvbmZpZykge1xuICAgICAgICB2YXIgUHJvZHVjdCA9IGZ1bmN0aW9uIChpZCwgd29ya3NwYWNlLCBmaWxlX25hbWUsIG1lZGlhX3R5cGUsIGZpbGVfc2l6ZSwgZGF0YV90eXBlLCBpc19kZWxldGVkLCB1dWlkLCB1cmwsIGNyZWF0ZWQsIGRlbGV0ZWQsIGRhdGFfc3RhcnRlZCwgZGF0YV9lbmRlZCwgZ2VvbWV0cnksIGNlbnRlcl9wb2ludCwgbWV0YV9kYXRhLCBjb3VudHJpZXMsIGxhc3RfbW9kaWZpZWQsIGlzX29wZXJhdGlvbmFsLCBpc19wdWJsaXNoZWQsIHB1Ymxpc2hlZCwgdW5wdWJsaXNoZWQsIGpvYl90eXBlLCBqb2IsIGpvYl9leGUsIHVwZGF0ZSwgc291cmNlX2ZpbGVzKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLndvcmtzcGFjZSA9IHdvcmtzcGFjZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZV9uYW1lID0gZmlsZV9uYW1lO1xuICAgICAgICAgICAgdGhpcy5tZWRpYV90eXBlID0gbWVkaWFfdHlwZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZV9zaXplID0gZmlsZV9zaXplO1xuICAgICAgICAgICAgdGhpcy5maWxlX3NpemVfcmVhZGFibGUgPSB0aGlzLmdldFJlYWRhYmxlRmlsZVNpemUoKTtcbiAgICAgICAgICAgIHRoaXMuZGF0YV90eXBlID0gZGF0YV90eXBlO1xuICAgICAgICAgICAgdGhpcy5pc19kZWxldGVkID0gaXNfZGVsZXRlZDtcbiAgICAgICAgICAgIHRoaXMudXVpZCA9IHV1aWQ7XG4gICAgICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZCA9IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWRfZm9ybWF0dGVkID0gY3JlYXRlZCA/IG1vbWVudC51dGMoY3JlYXRlZCkudG9JU09TdHJpbmcoKSA6IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZWQgPSBkZWxldGVkO1xuICAgICAgICAgICAgdGhpcy5kYXRhX3N0YXJ0ZWQgPSBkYXRhX3N0YXJ0ZWQ7XG4gICAgICAgICAgICB0aGlzLmRhdGFfZW5kZWQgPSBkYXRhX2VuZGVkO1xuICAgICAgICAgICAgdGhpcy5nZW9tZXRyeSA9IGdlb21ldHJ5O1xuICAgICAgICAgICAgdGhpcy5jZW50ZXJfcG9pbnQgPSBjZW50ZXJfcG9pbnQ7XG4gICAgICAgICAgICB0aGlzLm1ldGFfZGF0YSA9IG1ldGFfZGF0YTtcbiAgICAgICAgICAgIHRoaXMuY291bnRyaWVzID0gY291bnRyaWVzO1xuICAgICAgICAgICAgdGhpcy5sYXN0X21vZGlmaWVkID0gbGFzdF9tb2RpZmllZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZF9mb3JtYXR0ZWQgPSBsYXN0X21vZGlmaWVkID8gbW9tZW50LnV0YyhsYXN0X21vZGlmaWVkKS50b0lTT1N0cmluZygpIDogbGFzdF9tb2RpZmllZDtcbiAgICAgICAgICAgIHRoaXMuaXNfb3BlcmF0aW9uYWwgPSBpc19vcGVyYXRpb25hbDtcbiAgICAgICAgICAgIHRoaXMuaXNfb3BlcmF0aW9uYWxfbGFiZWwgPSBpc19vcGVyYXRpb25hbCA/ICdPcGVyYXRpb25hbCcgOiAnUiZhbXA7RCc7XG4gICAgICAgICAgICB0aGlzLmlzX3B1Ymxpc2hlZCA9IGlzX3B1Ymxpc2hlZDtcbiAgICAgICAgICAgIHRoaXMucHVibGlzaGVkID0gcHVibGlzaGVkO1xuICAgICAgICAgICAgdGhpcy51bnB1Ymxpc2hlZCA9IHVucHVibGlzaGVkO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZSA9IEpvYlR5cGUudHJhbnNmb3JtZXIoam9iX3R5cGUpO1xuICAgICAgICAgICAgdGhpcy5qb2IgPSBqb2I7XG4gICAgICAgICAgICB0aGlzLmpvYl9leGUgPSBqb2JfZXhlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGUgPSB1cGRhdGU7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZV9maWxlcyA9IHNvdXJjZV9maWxlcztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBQcm9kdWN0LnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIGdldER1cmF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudC51dGModGhpcy5sYXN0X21vZGlmaWVkKS5kaWZmKG1vbWVudC51dGModGhpcy5jcmVhdGVkKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0UmVhZGFibGVGaWxlU2l6ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tQnl0ZXModGhpcy5maWxlX3NpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBQcm9kdWN0LmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9kdWN0KFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLndvcmtzcGFjZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5maWxlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWVkaWFfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5maWxlX3NpemUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGF0YV90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX2RlbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudXVpZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS51cmwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kZWxldGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRhdGFfc3RhcnRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kYXRhX2VuZGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmdlb21ldHJ5LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNlbnRlcl9wb2ludCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZXRhX2RhdGEsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY291bnRyaWVzLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmxhc3RfbW9kaWZpZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfb3BlcmF0aW9uYWwsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfcHVibGlzaGVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1Ymxpc2hlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS51bnB1Ymxpc2hlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2IsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX2V4ZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS51cGRhdGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc291cmNlX2ZpbGVzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvZHVjdCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFByb2R1Y3QudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoUHJvZHVjdC5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9kdWN0LmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBQcm9kdWN0O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUnVubmluZ0pvYicsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgc2NhbGVTZXJ2aWNlLCBKb2JUeXBlKSB7XG4gICAgICAgIHZhciBSdW5uaW5nSm9iID0gZnVuY3Rpb24gKGNvdW50LCBsb25nZXN0X3J1bm5pbmcsIGpvYl90eXBlKSB7XG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gY291bnQ7XG4gICAgICAgICAgICB0aGlzLmxvbmdlc3RfcnVubmluZyA9IGxvbmdlc3RfcnVubmluZztcbiAgICAgICAgICAgIHRoaXMuam9iX3R5cGUgPSBKb2JUeXBlLnRyYW5zZm9ybWVyKGpvYl90eXBlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBSdW5uaW5nSm9iLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIGdldER1cmF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjYWxlU2VydmljZS5jYWxjdWxhdGVEdXJhdGlvbih0aGlzLmxvbmdlc3RfcnVubmluZywgbW9tZW50LnV0YygpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEljb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IHRoaXMuam9iX3R5cGUuaWNvbl9jb2RlID8gJzxpIGNsYXNzPVwiZmFcIj4mI3gnICsgdGhpcy5qb2JfdHlwZS5pY29uX2NvZGUgKyAnPC9pPicgOiAnPGkgY2xhc3M9XCJmYVwiPiYjeCcgKyBzY2FsZUNvbmZpZy5kZWZhdWx0SWNvbkNvZGUgKyAnPC9pPic7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGljb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFJ1bm5pbmdKb2IuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJ1bm5pbmdKb2IoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY291bnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubG9uZ2VzdF9ydW5uaW5nLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUnVubmluZ0pvYigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJ1bm5pbmdKb2IudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoUnVubmluZ0pvYi5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBSdW5uaW5nSm9iLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBSdW5uaW5nSm9iO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1N5c3RlbUZhaWx1cmUnLCBmdW5jdGlvbiAoc2NhbGVDb25maWcsIHNjYWxlU2VydmljZSkge1xuICAgICAgICB2YXIgU3lzdGVtRmFpbHVyZSA9IGZ1bmN0aW9uIChjb3VudCwgam9iX3R5cGVfbmFtZSwgam9iX3R5cGVfdmVyc2lvbiwgZXJyb3JfbmFtZSwgZmlyc3RfZXJyb3IsIGxhc3RfZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDtcbiAgICAgICAgICAgIHRoaXMuam9iX3R5cGVfbmFtZSA9IGpvYl90eXBlX25hbWU7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlX3ZlcnNpb24gPSBqb2JfdHlwZV92ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy5lcnJvcl9uYW1lID0gZXJyb3JfbmFtZTtcbiAgICAgICAgICAgIHRoaXMuZmlyc3RfZXJyb3IgPSBmaXJzdF9lcnJvcjtcbiAgICAgICAgICAgIHRoaXMubGFzdF9lcnJvciA9IGxhc3RfZXJyb3I7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgU3lzdGVtRmFpbHVyZS5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICBnZXREdXJhdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRHVyYXRpb24odGhpcy5maXJzdF9lcnJvciwgdGhpcy5sYXN0X2Vycm9yKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRJY29uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ0pvYlR5cGUgPSBfLmZpbmQoc2NhbGVDb25maWcuam9iVHlwZXMsICd0aXRsZScsIHRoaXMuam9iX3R5cGVfbmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZ0pvYlR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpZ0pvYlR5cGUuaWNvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjYWxlQ29uZmlnLmRlZmF1bHRJY29uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBTeXN0ZW1GYWlsdXJlLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTeXN0ZW1GYWlsdXJlKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvdW50LFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX3R5cGVfdmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lcnJvcl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmZpcnN0X2Vycm9yLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmxhc3RfZXJyb3JcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTeXN0ZW1GYWlsdXJlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgU3lzdGVtRmFpbHVyZS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChTeXN0ZW1GYWlsdXJlLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFN5c3RlbUZhaWx1cmUuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFN5c3RlbUZhaWx1cmU7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdsb2FkQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBzY2FsZVNlcnZpY2UsIG5hdlNlcnZpY2UsIGxvYWRTZXJ2aWNlLCB1aUdyaWRDb25zdGFudHMsIHNjYWxlQ29uZmlnLCBzdWJuYXZTZXJ2aWNlLCBRdWV1ZVN0YXR1cywgZ3JpZEZhY3RvcnkpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAkc2NvcGUucXVldWVTdGF0dXNFcnJvciA9IG51bGw7XG4gICAgICAgICRzY29wZS5xdWV1ZVN0YXR1c0Vycm9yU3RhdHVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnRvdGFsUXVldWVkID0gMDtcbiAgICAgICAgJHNjb3BlLmdyaWRTdHlsZSA9ICcnO1xuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5sb2FkO1xuICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdsb2FkJyk7XG5cbiAgICAgICAgJHNjb3BlLmdldFBhZ2UgPSBmdW5jdGlvbiAocGFnZU51bWJlciwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGxvYWRTZXJ2aWNlLmdldFF1ZXVlU3RhdHVzKHBhZ2VOdW1iZXIgLSAxLCBwYWdlU2l6ZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGRhdGEuam9ic1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gbmV3RGF0YTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSAnVW5hYmxlIHRvIGxvYWQgcXVldWUgc3RhdHVzOiAnICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMgPSBncmlkRmFjdG9yeS5kZWZhdWx0R3JpZE9wdGlvbnMoKTtcbiAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5lbmFibGVTb3J0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuY29sdW1uRGVmcyA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICdqb2JfdHlwZS50aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0pvYiBUeXBlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+PHNwYW4gbmctYmluZC1odG1sPVwicm93LmVudGl0eS5nZXRJY29uKClcIj48L3NwYW4+IHt7IHJvdy5lbnRpdHkuam9iX3R5cGUudGl0bGUgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdqb2JfdHlwZS52ZXJzaW9uJywgZGlzcGxheU5hbWU6ICdWZXJzaW9uJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGZpZWxkOiAnaGlnaGVzdF9wcmlvcml0eScsIGVuYWJsZUZpbHRlcmluZzogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICdsb25nZXN0UXVldWVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRHVyYXRpb24gb2YgTG9uZ2VzdCBRdWV1ZWQgSm9iJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzIHRleHQtcmlnaHRcIj57eyByb3cuZW50aXR5LmdldER1cmF0aW9uKCkgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdjb3VudCcsIGVuYWJsZUZpbHRlcmluZzogZmFsc2UgfVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLm9uUmVnaXN0ZXJBcGkgPSBmdW5jdGlvbiAoZ3JpZEFwaSkge1xuICAgICAgICAgICAgICAgICAgICAvL3NldCBncmlkQXBpIG9uIHNjb3BlXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ncmlkQXBpID0gZ3JpZEFwaTtcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEFwaS5zZWxlY3Rpb24ub24ucm93U2VsZWN0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvam9icycpLnNlYXJjaCh7am9iX3R5cGVfaWQ6IHJvdy5lbnRpdHkuam9iX3R5cGUuaWQsIHN0YXR1czogJ1FVRVVFRCd9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkucGFnaW5hdGlvbi5vbi5wYWdpbmF0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRQYWdlKGN1cnJlbnRQYWdlLCBwYWdlU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgbG9hZFNlcnZpY2UuZ2V0UXVldWVTdGF0dXMoMCwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZSkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSByZXN1bHQucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLnRvdGFsSXRlbXMgPSByZXN1bHQucmVzdWx0cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b3RhbFF1ZXVlZCA9IF8uc3VtKHJlc3VsdC5yZXN1bHRzLCAnY291bnQnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3F1ZXVlIHN0YXR1cyB1cGRhdGVkJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXNUZXh0ICYmIHJlc3VsdC5zdGF0dXNUZXh0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnF1ZXVlU3RhdHVzRXJyb3JTdGF0dXMgPSByZXN1bHQuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVldWVTdGF0dXNFcnJvciA9ICdVbmFibGUgdG8gcmV0cmlldmUgcXVldWUgc3RhdHVzLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdsb2FkJyk7XG4gICAgICAgIH07XG4gICAgICAgIGluaXRpYWxpemUoKTtcblxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHNldCBjb250YWluZXIgaGVpZ2h0cyBlcXVhbCB0byBhdmFpbGFibGUgcGFnZSBoZWlnaHRcbiAgICAgICAgICAgIHZhciB2aWV3cG9ydCA9IHNjYWxlU2VydmljZS5nZXRWaWV3cG9ydFNpemUoKSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBzY2FsZUNvbmZpZy5oZWFkZXJPZmZzZXQsXG4gICAgICAgICAgICAgICAgZ3JpZE1heEhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCAtIG9mZnNldDtcblxuICAgICAgICAgICAgJHNjb3BlLmdyaWRTdHlsZSA9ICdoZWlnaHQ6ICcgKyBncmlkTWF4SGVpZ2h0ICsgJ3B4OyBtYXgtaGVpZ2h0OiAnICsgZ3JpZE1heEhlaWdodCArICdweDsgb3ZlcmZsb3cteTogYXV0bzsnO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2xvYWREZXB0aENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIG5hdlNlcnZpY2UsIHNjYWxlQ29uZmlnLCBzdWJuYXZTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS5zdWJuYXZMaW5rcyA9IHNjYWxlQ29uZmlnLnN1Ym5hdkxpbmtzLmxvYWQ7XG4gICAgICAgIHN1Ym5hdlNlcnZpY2Uuc2V0Q3VycmVudFBhdGgoJ2xvYWQvZGVwdGgnKTtcblxuICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbmF2U2VydmljZS51cGRhdGVMb2NhdGlvbignbG9hZCcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGluaXRpYWxpemUoKTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdxdWV1ZVJ1bm5pbmdDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sIHNjYWxlU2VydmljZSwgbmF2U2VydmljZSwgam9iU2VydmljZSwgZ3JpZEZhY3RvcnksIHVpR3JpZENvbnN0YW50cywgc2NhbGVDb25maWcsIHN1Ym5hdlNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAkc2NvcGUucnVubmluZ0pvYnNFcnJvciA9IG51bGw7XG4gICAgICAgICRzY29wZS5ydW5uaW5nSm9ic0Vycm9yU3RhdHVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnRvdGFsUnVubmluZyA9IDA7XG4gICAgICAgICRzY29wZS5ncmlkU3R5bGUgPSAnJztcbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3MubG9hZDtcbiAgICAgICAgc3VibmF2U2VydmljZS5zZXRDdXJyZW50UGF0aCgnbG9hZC9ydW5uaW5nJyk7XG5cbiAgICAgICAgJHNjb3BlLmdldFBhZ2UgPSBmdW5jdGlvbiAocGFnZU51bWJlciwgcGFnZVNpemUpe1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgam9iU2VydmljZS5nZXRSdW5uaW5nSm9ic09uY2UocGFnZU51bWJlciAtIDEsIHBhZ2VTaXplKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0RhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZTsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YS5wdXNoKGRhdGEucmVzdWx0c1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gbmV3RGF0YTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gJ1VuYWJsZSB0byBsb2FkIHF1ZXVlIHJ1bm5pbmcgc3RhdHVzOiAnICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCRzY29wZS5zdGF0dXMpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zID0gZ3JpZEZhY3RvcnkuZGVmYXVsdEdyaWRPcHRpb25zKCk7XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZW5hYmxlU29ydGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmNvbHVtbkRlZnMgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZDogJ3RpdGxlJyxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdKb2IgVHlwZScsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZUZpbHRlcmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj48c3BhbiBuZy1iaW5kLWh0bWw9XCJyb3cuZW50aXR5LmdldEljb24oKVwiPjwvc3Bhbj4ge3sgcm93LmVudGl0eS5qb2JfdHlwZS50aXRsZSB9fTwvZGl2PidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtmaWVsZDogJ2pvYl90eXBlLnZlcnNpb24nLCBkaXNwbGF5TmFtZTogJ1ZlcnNpb24nLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlfSxcbiAgICAgICAgICAgICAgICB7ZmllbGQ6ICdjb3VudCcsIGRpc3BsYXlOYW1lOiAnTnVtYmVyIG9mIEpvYnMnLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiAnbG9uZ2VzdFJ1bm5pbmcnLFxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0R1cmF0aW9uIG9mIExvbmdlc3QgUnVubmluZyBKb2InLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzIHRleHQtcmlnaHRcIj57eyByb3cuZW50aXR5LmdldER1cmF0aW9uKCkgfX08L2Rpdj4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gW107XG4gICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMub25SZWdpc3RlckFwaSA9IGZ1bmN0aW9uIChncmlkQXBpKSB7XG4gICAgICAgICAgICAgICAgLy8gc2V0IGdyaWRBcGkgb24gc2NvcGVcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaSA9IGdyaWRBcGk7XG4gICAgICAgICAgICAgICAgZ3JpZEFwaS5zZWxlY3Rpb24ub24ucm93U2VsZWN0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9qb2JzJykuc2VhcmNoKHtqb2JfdHlwZV9pZDogcm93LmVudGl0eS5qb2JfdHlwZS5pZCwgc3RhdHVzOiAnUlVOTklORyd9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkucGFnaW5hdGlvbi5vbi5wYWdpbmF0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFBhZ2UoY3VycmVudFBhZ2UsIHBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGpvYlNlcnZpY2UuZ2V0UnVubmluZ0pvYnMoMCwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZSkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLnRvdGFsSXRlbXMgPSBkYXRhLnJlc3VsdHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxSdW5uaW5nID0gXy5zdW0oZGF0YS5yZXN1bHRzLCAnY291bnQnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3J1bm5pbmcgam9icyB1cGRhdGVkJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzVGV4dCAmJiBkYXRhLnN0YXR1c1RleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucnVubmluZ0pvYnNFcnJvclN0YXR1cyA9IGRhdGEuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucnVubmluZ0pvYnNFcnJvciA9ICdVbmFibGUgdG8gcmV0cmlldmUgcnVubmluZyBqb2JzLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5hdlNlcnZpY2UudXBkYXRlTG9jYXRpb24oJ2xvYWQnKTtcbiAgICAgICAgfTtcbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHNjYWxlQ29uZmlnLmhlYWRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBncmlkTWF4SGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0IC0gb2Zmc2V0O1xuXG4gICAgICAgICAgICAkc2NvcGUuZ3JpZFN0eWxlID0gJ2hlaWdodDogJyArIGdyaWRNYXhIZWlnaHQgKyAncHg7IG1heC1oZWlnaHQ6ICcgKyBncmlkTWF4SGVpZ2h0ICsgJ3B4OyBvdmVyZmxvdy15OiBhdXRvOyc7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnam9iRXhlY3V0aW9uU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgJHEsICRyZXNvdXJjZSwgcG9sbGVyLCBzY2FsZUNvbmZpZywgSm9iRXhlY3V0aW9uLCBKb2JFeGVjdXRpb25Mb2cpIHtcblxuICAgICAgICB2YXIgZ2V0Sm9iRXhlY3V0aW9uc1BhcmFtcyA9IGZ1bmN0aW9uKCBwYWdlTnVtYmVyLCBwYWdlU2l6ZSwgZmlsdGVyICl7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2VOdW1iZXIsXG4gICAgICAgICAgICAgICAgcGFnZV9zaXplOiBwYWdlU2l6ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBqb2JUeXBlSWQgPSBmaWx0ZXIuam9iX3R5cGVfaWQgPyBmaWx0ZXIuam9iVHlwZUlkIDogJyc7XG4gICAgICAgICAgICB2YXIgam9iU3RhdHVzID0gZmlsdGVyLnN0YXR1cyA/IGZpbHRlci5qb2JTdGF0dXMgOiAnJztcblxuICAgICAgICAgICAgaWYgKGpvYlN0YXR1cyAmJiBqb2JTdGF0dXMgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLmpvYl9zdGF0dXMgPSBqb2JTdGF0dXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRKb2JFeGVjdXRpb25zOiBmdW5jdGlvbiAocGFnZU51bWJlciwgcGFnZVNpemUsIGZpbHRlcikge1xuICAgICAgICAgICAgICAgIHZhciBqb2JFeGVjdXRpb25zID0gW10sXG4gICAgICAgICAgICAgICAgICAgIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGdldEpvYkV4ZWN1dGlvbnNQYXJhbXMocGFnZU51bWJlciwgcGFnZVNpemUsIGZpbHRlcik7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi1leGVjdXRpb25zLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBqb2JFeGVjdXRpb25zLmV4ZWN1dGlvbnMgPSBKb2JFeGVjdXRpb24udHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgam9iRXhlY3V0aW9ucy5jb3VudCA9IGRhdGEuY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShqb2JFeGVjdXRpb25zKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Sm9iRXhlY3V0aW9uRGV0YWlsczogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi1leGVjdXRpb25zLycgKyBpZCArICcvJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoSm9iRXhlY3V0aW9uLnRyYW5zZm9ybWVyKGRhdGEpKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0TG9nT25jZTogZnVuY3Rpb24oZXhlY0lkKXtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLWV4ZWN1dGlvbnMvJyArIGV4ZWNJZCArICcvbG9ncy8nKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0TG9nOiBmdW5jdGlvbihleGVjSWQpe1xuICAgICAgICAgICAgICAgIHZhciB1cmwgPSB1cmwgfHwgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLWV4ZWN1dGlvbnMvJyArIGV4ZWNJZCArICcvbG9ncy8nO1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXcuIFNpbmNlIGEgcHJvbWlzZSBjYW4gb25seSBiZSByZXNvbHZlZCBvciByZWplY3RlZCBvbmNlIGJ1dCB3ZSB3YW50XG4gICAgICAgICAgICAgICAgLy8gdG8ga2VlcCB0cmFjayBvZiBhbGwgcmVxdWVzdHMsIHBvbGxlciBzZXJ2aWNlIHVzZXMgdGhlIG5vdGlmeUNhbGxiYWNrLiBCeSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgLy8gcG9sbGVyIG9ubHkgZ2V0cyBub3RpZmllZCBvZiBzdWNjZXNzIHJlc3BvbnNlcy5cbiAgICAgICAgICAgICAgICB2YXIgam9iRXhlY3V0aW9uTG9nUmVzb3VyY2UgPSAkcmVzb3VyY2UodXJsKTtcbiAgICAgICAgICAgICAgICB2YXIgam9iRXhlY3V0aW9uTG9nUG9sbGVyID0gcG9sbGVyLmdldChqb2JFeGVjdXRpb25Mb2dSZXNvdXJjZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXk6IHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMuam9iRXhlY3V0aW9uTG9nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGpvYkV4ZWN1dGlvbkxvZ1BvbGxlci5wcm9taXNlLnRoZW4obnVsbCwgbnVsbCwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuJHJlc29sdmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5leGVjdXRpb25fbG9nID0gSm9iRXhlY3V0aW9uTG9nLnRyYW5zZm9ybWVyKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuZXhlY3V0aW9uX2xvZy5zdGF0dXMgPT09ICdDT01QTEVURUQnIHx8IHJlc3VsdC5leGVjdXRpb25fbG9nLnN0YXR1cyA9PT0gJ0ZBSUxFRCcpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvYkV4ZWN1dGlvbkxvZ1BvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgam9iRXhlY3V0aW9uTG9nUG9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnam9iU2VydmljZScsIGZ1bmN0aW9uKCRodHRwLCAkcSwgJHJlc291cmNlLCBzY2FsZUNvbmZpZywgSm9iLCBKb2JEZXRhaWxzLCBSdW5uaW5nSm9iLCBwb2xsZXIsIHBvbGxlckZhY3RvcnkpIHtcblxuICAgICAgICB2YXIgZ2V0Sm9ic1BhcmFtcyA9IGZ1bmN0aW9uIChwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkLCBvcmRlciwgc3RhdHVzLCBqb2JfdHlwZV9pZCwgam9iX3R5cGVfbmFtZSwgam9iX3R5cGVfY2F0ZWdvcnksIHVybCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLFxuICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZV9zaXplLFxuICAgICAgICAgICAgICAgIHN0YXJ0ZWQ6IHN0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgZW5kZWQ6IGVuZGVkLFxuICAgICAgICAgICAgICAgIG9yZGVyOiBvcmRlcixcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICBqb2JfdHlwZV9pZDogam9iX3R5cGVfaWQsXG4gICAgICAgICAgICAgICAgam9iX3R5cGVfbmFtZTogam9iX3R5cGVfbmFtZSxcbiAgICAgICAgICAgICAgICBqb2JfdHlwZV9jYXRlZ29yeTogam9iX3R5cGVfY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldEpvYlVwZGF0ZURhdGEgPSBmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRKb2JzOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IGdldEpvYnNQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICBwYXJhbXMudXJsID0gcGFyYW1zLnVybCA/IHBhcmFtcy51cmwgOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2JzLyc7XG5cbiAgICAgICAgICAgICAgICB2YXIgam9ic1Jlc291cmNlID0gJHJlc291cmNlKHBhcmFtcy51cmwsIHBhcmFtcyksXG4gICAgICAgICAgICAgICAgICAgIGpvYnNQb2xsZXIgPSBwb2xsZXJGYWN0b3J5Lm5ld1BvbGxlcihqb2JzUmVzb3VyY2UsIHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMuam9icyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gam9ic1BvbGxlci5wcm9taXNlLnRoZW4obnVsbCwgbnVsbCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuJHJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBKb2IudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpvYnNQb2xsZXIuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEpvYnNPbmNlOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IGdldEpvYnNQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogcGFyYW1zLnVybCA/IHBhcmFtcy51cmwgOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2JzLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBKb2IudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEpvYkNvdW50c0J5U3RhdHVzOiBmdW5jdGlvbiAoaG91cikge1xuICAgICAgICAgICAgICAgIGhvdXIgPSBob3VyIHx8IDM7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuZ2V0Sm9iQ291bnRzQnlTdGF0dXMoaG91cikpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRKb2JEZXRhaWw6IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9icy8nICsgaWQgKyAnLycpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKEpvYkRldGFpbHMudHJhbnNmb3JtZXIoZGF0YSkpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRSdW5uaW5nSm9iczogZnVuY3Rpb24gKHBhZ2VOdW1iZXIsIHBhZ2VTaXplKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZU51bWJlcjogcGFnZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgcnVubmluZ0pvYnNSZXNvdXJjZSA9ICRyZXNvdXJjZShzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2ItdHlwZXMvcnVubmluZy8nLCBwYXJhbXMpLFxuICAgICAgICAgICAgICAgICAgICBydW5uaW5nSm9ic1BvbGxlciA9IHBvbGxlckZhY3RvcnkubmV3UG9sbGVyKHJ1bm5pbmdKb2JzUmVzb3VyY2UsIHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMucnVubmluZ0pvYnMpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmdKb2JzUG9sbGVyLnByb21pc2UudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cyA9IFJ1bm5pbmdKb2IudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdKb2JzUG9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRSdW5uaW5nSm9ic09uY2U6IGZ1bmN0aW9uIChwYWdlTnVtYmVyLCBwYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VOdW1iZXI6IHBhZ2VOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi10eXBlcy9ydW5uaW5nLycsIHBhcmFtcykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBSdW5uaW5nSm9iLnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXBkYXRlSm9iOiBmdW5jdGlvbiAoaWQsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gZGF0YSB8fCBnZXRKb2JVcGRhdGVEYXRhKCk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYnMvJyArIGlkICsgJy8nLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCdqb2JUeXBlU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgJHEsICRyZXNvdXJjZSwgcG9sbGVyLCBwb2xsZXJGYWN0b3J5LCBzY2FsZUNvbmZpZywgam9iU2VydmljZSwgSm9iVHlwZSwgSm9iVHlwZURldGFpbHMsIEpvYlR5cGVTdGF0dXMpIHtcbiAgICAgICAgLyp2YXIgdG90YWxKb2JUeXBlcyA9IDU7XG5cbiAgICAgICAgdmFyIGdldFRvdGFsSm9iVHlwZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdG90YWxKb2JUeXBlcztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgc2V0VG90YWxKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRvdGFsSm9iVHlwZXMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoMjAgLSAxICsgMSkpICsgMTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRUb3RhbEpvYlR5cGVzKCk7XG4gICAgICAgIH0sIDMxMDApOyovXG5cbiAgICAgICAgdmFyIGdldEpvYlR5cGVQYXJhbXMgPSBmdW5jdGlvbiAocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCwgbmFtZSwgY2F0ZWdvcnksIG9yZGVyKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsXG4gICAgICAgICAgICAgICAgcGFnZV9zaXplOiBwYWdlX3NpemUsXG4gICAgICAgICAgICAgICAgc3RhcnRlZDogc3RhcnRlZCxcbiAgICAgICAgICAgICAgICBlbmRlZDogZW5kZWQsXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgb3JkZXI6IG9yZGVyID8gb3JkZXIgOiBbJ25hbWUnLCAndmVyc2lvbiddXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlU3RhdHVzUGFyYW1zID0gZnVuY3Rpb24gKHBhZ2UsIHBhZ2Vfc2l6ZSwgc3RhcnRlZCwgZW5kZWQpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7fTtcblxuICAgICAgICAgICAgaWYgKHBhZ2UpIHsgcGFyYW1zLnBhZ2UgPSBwYWdlOyB9XG4gICAgICAgICAgICBpZiAocGFnZV9zaXplKSB7IHBhcmFtcy5wYWdlX3NpemUgPSBwYWdlX3NpemU7IH1cbiAgICAgICAgICAgIGlmIChzdGFydGVkKSB7IHBhcmFtcy5zdGFydGVkID0gc3RhcnRlZDsgfVxuICAgICAgICAgICAgaWYgKGVuZGVkKSB7IHBhcmFtcy5lbmRlZCA9IGVuZGVkOyB9XG5cbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEpvYlR5cGVzOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IGdldEpvYlR5cGVQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICAvLyB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIC8vICAgICBvcmRlcjogb3JkZXIgfHwgWyduYW1lJywndmVyc2lvbiddXG4gICAgICAgICAgICAgICAgLy8gfTtcblxuICAgICAgICAgICAgICAgIHZhciBqb2JUeXBlc1Jlc291cmNlID0gJHJlc291cmNlKHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi10eXBlcy8nLCBwYXJhbXMpLFxuICAgICAgICAgICAgICAgICAgICBqb2JUeXBlc1BvbGxlciA9IHBvbGxlckZhY3RvcnkubmV3UG9sbGVyKGpvYlR5cGVzUmVzb3VyY2UsIHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMuam9iVHlwZXMpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGpvYlR5cGVzUG9sbGVyLnByb21pc2UudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS4kcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qdmFyIHJldHVyblJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzb2x2ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgam9iX3R5cGVzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZ2V0VG90YWxKb2JUeXBlcygpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQuam9iX3R5cGVzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNfc3lzdGVtXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhdXNlZFwiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXNrXCI6IDY0LjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRvY2tlcl9pbWFnZVwiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmNoaXZlZFwiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VzX2RvY2tlclwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWNvbl9jb2RlXCI6IHNjYWxlQ29uZmlnLmpvYlR5cGVzW2kgLSAxXS5jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcIkluZ2VzdHMgYSBzb3VyY2UgZmlsZSBpbnRvIGEgd29ya3NwYWNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lbVwiOiA2NC4wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpc19hY3RpdmVcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3B1c1wiOiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhc3RfbW9kaWZpZWRcIjogXCIyMDE1LTAzLTExVDAwOjAwOjAwWlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfdHJpZXNcIjogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNfcGF1c2VkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHNjYWxlQ29uZmlnLmpvYlR5cGVzW2kgLSAxXS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZFwiOiBcIjIwMTUtMDMtMTFUMDA6MDA6MDBaXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpbWVvdXRcIjogMTgwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNfbG9uZ19ydW5uaW5nXCI6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXR1cm5SZXN1bHQ7Ki9cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzID0gSm9iVHlwZS50cmFuc2Zvcm1lcihkYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBqb2JUeXBlc1BvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEpvYlR5cGVzT25jZTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHBhcmFtcyB8fCBnZXRKb2JUeXBlUGFyYW1zKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBKb2JUeXBlLnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Sm9iVHlwZVN0YXR1czogZnVuY3Rpb24gKHBhZ2UsIHBhZ2Vfc2l6ZSwgc3RhcnRlZCwgZW5kZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gZ2V0Sm9iVHlwZVN0YXR1c1BhcmFtcyhwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkKTtcblxuICAgICAgICAgICAgICAgIHZhciBqb2JUeXBlU3RhdHVzUmVzb3VyY2UgPSAkcmVzb3VyY2Uoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzL3N0YXR1cy8nLCBwYXJhbXMpLFxuICAgICAgICAgICAgICAgICAgICBqb2JUeXBlU3RhdHVzUG9sbGVyID0gcG9sbGVyRmFjdG9yeS5uZXdQb2xsZXIoam9iVHlwZVN0YXR1c1Jlc291cmNlLCBzY2FsZUNvbmZpZy5wb2xsSW50ZXJ2YWxzLmpvYlR5cGVTdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGpvYlR5cGVTdGF0dXNQb2xsZXIucHJvbWlzZS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyp2YXIgcmV0dXJuZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzb2x2ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgam9iX3R5cGVfc3RhdHM6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBnZXRUb3RhbEpvYlR5cGVzKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybmRhdGEuam9iX3R5cGVfc3RhdHMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpY29uX2NvZGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm51bV9jb21wbGV0ZWRcIjogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDIwMDAwIC0gMTAwMDAgKyAxKSkgKyAxMDAwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibnVtX2NhbmNlbGVkXCI6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAyMCArIDEpKSArIDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJudW1fZXJyb3JfREFUQVwiOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoOTAwMCAtIDIwICsgMSkpICsgMjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm51bV9lcnJvcl9TWVNURU1cIjogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDkwMDAgLSAyMCArIDEpKSArIDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJudW1fZXJyb3JfQUxHT1JJVEhNXCI6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICg5MDAwIC0gMjAgKyAxKSkgKyAyMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHJldHVybmRhdGE7Ki9cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzID0gSm9iVHlwZVN0YXR1cy50cmFuc2Zvcm1lcihkYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgam9iVHlwZVN0YXR1c1BvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Sm9iVHlwZVN0YXR1c09uY2U6IGZ1bmN0aW9uIChwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBnZXRKb2JUeXBlU3RhdHVzUGFyYW1zKHBhZ2UsIHBhZ2Vfc2l6ZSwgc3RhcnRlZCwgZW5kZWQpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi10eXBlcy9zdGF0dXMvJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cyA9IEpvYlR5cGVTdGF0dXMudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRKb2JUeXBlRGV0YWlsczogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwLmdldChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2ItdHlwZXMvJyArIGlkICsgJy8nKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShKb2JUeXBlRGV0YWlscy50cmFuc2Zvcm1lcihkYXRhKSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVwZGF0ZUpvYlR5cGU6IGZ1bmN0aW9uIChkYXRhKXtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZEpvYlR5cGUgPSBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX21hcHBpbmdzOiBkYXRhLmVycm9yX21hcHBpbmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNfcGF1c2VkOiBkYXRhLmlzX3BhdXNlZFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWREYXRhID0gdXBkYXRlZEpvYlR5cGUoZGF0YSk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYi10eXBlcy8nICsgZGF0YS5pZCArICcvJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB1cGRhdGVkRGF0YVxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoSm9iVHlwZURldGFpbHMudHJhbnNmb3JtZXIocmVzdWx0KSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1F1ZXVlU3RhdHVzJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBzY2FsZVNlcnZpY2UsIEpvYlR5cGUpIHtcbiAgICAgICAgdmFyIFF1ZXVlU3RhdHVzID0gZnVuY3Rpb24gKGpvYl90eXBlLCBjb3VudCwgbG9uZ2VzdF9xdWV1ZWQsIGhpZ2hlc3RfcHJpb3JpdHkpIHtcbiAgICAgICAgICAgIHRoaXMuam9iX3R5cGUgPSBKb2JUeXBlLnRyYW5zZm9ybWVyKGpvYl90eXBlKTtcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDtcbiAgICAgICAgICAgIHRoaXMubG9uZ2VzdF9xdWV1ZWQgPSBsb25nZXN0X3F1ZXVlZDtcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdF9wcmlvcml0eSA9IGhpZ2hlc3RfcHJpb3JpdHk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICAgICAgUXVldWVTdGF0dXMucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZ2V0SWNvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmpvYl90eXBlLmljb25fY29kZSA/ICc8aSBjbGFzcz1cImZhXCI+JiN4JyArIHRoaXMuam9iX3R5cGUuaWNvbl9jb2RlICsgJzwvaT4nIDogJzxpIGNsYXNzPVwiZmFcIj4mI3gnICsgc2NhbGVDb25maWcuZGVmYXVsdEljb25Db2RlICsgJzwvaT4nO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldER1cmF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjYWxlU2VydmljZS5jYWxjdWxhdGVEdXJhdGlvbih0aGlzLmxvbmdlc3RfcXVldWVkLCBtb21lbnQudXRjKCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFF1ZXVlU3RhdHVzLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBRdWV1ZVN0YXR1cyhcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sb25nZXN0X3F1ZXVlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5oaWdoZXN0X3ByaW9yaXR5XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUXVldWVTdGF0dXMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBRdWV1ZVN0YXR1cy50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChRdWV1ZVN0YXR1cy5idWlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUXVldWVTdGF0dXMuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFF1ZXVlU3RhdHVzO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnbG9hZFNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCwgJHEsICRyZXNvdXJjZSwgc2NhbGVDb25maWcsIHBvbGxlciwgcG9sbGVyRmFjdG9yeSwgUXVldWVTdGF0dXMpIHtcbiAgICAgICAgdmFyIGdldEpvYkxvYWRQYXJhbXMgPSBmdW5jdGlvbiAocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCwgb3JkZXIsIHN0YXR1cywgam9iX3R5cGVfaWQsIGpvYl90eXBlX25hbWUsIGpvYl90eXBlX2NhdGVnb3J5LCB1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhcnRlZDogc3RhcnRlZCxcbiAgICAgICAgICAgICAgICBlbmRlZDogZW5kZWQsXG4gICAgICAgICAgICAgICAgam9iX3R5cGVfaWQ6IGpvYl90eXBlX2lkLFxuICAgICAgICAgICAgICAgIGpvYl90eXBlX25hbWU6IGpvYl90eXBlX25hbWUsXG4gICAgICAgICAgICAgICAgam9iX3R5cGVfY2F0ZWdvcnk6IGpvYl90eXBlX2NhdGVnb3J5LFxuICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogMTAwMCxcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0UmVxdWV1ZUpvYnNQYXJhbXMgPSBmdW5jdGlvbiAoc3RhcnRlZCwgZW5kZWQsIGpvYl9zdGF0dXMsIGpvYl90eXBlX2lkcywgam9iX3R5cGVfbmFtZXMsIGpvYl90eXBlX2NhdGVnb3JpZXMsIHByaW9yaXR5LCB1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhcnRlZDogc3RhcnRlZCxcbiAgICAgICAgICAgICAgICBlbmRlZDogZW5kZWQsXG4gICAgICAgICAgICAgICAgam9iX3N0YXR1czogam9iX3N0YXR1cyxcbiAgICAgICAgICAgICAgICBqb2JfaWRzOiBqb2JfaWRzLFxuICAgICAgICAgICAgICAgIGpvYl90eXBlX2lkczogam9iX3R5cGVfaWRzLFxuICAgICAgICAgICAgICAgIGpvYl90eXBlX25hbWVzOiBqb2JfdHlwZV9uYW1lcyxcbiAgICAgICAgICAgICAgICBqb2JfdHlwZV9jYXRlZ29yaWVzOiBqb2JfdHlwZV9jYXRlZ29yaWVzLFxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBwcmlvcml0eSxcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0UXVldWVTdGF0dXM6IGZ1bmN0aW9uIChwYWdlTnVtYmVyLCBwYWdlU2l6ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VfbnVtYmVyOiBwYWdlTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICBwYWdlX3NpemU6IHBhZ2VTaXplXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBxdWV1ZVN0YXR1c1Jlc291cmNlID0gJHJlc291cmNlKHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3F1ZXVlL3N0YXR1cy8nLCBwYXJhbXMpLFxuICAgICAgICAgICAgICAgICAgICBxdWV1ZVN0YXR1c1BvbGxlciA9IHBvbGxlckZhY3RvcnkubmV3UG9sbGVyKHF1ZXVlU3RhdHVzUmVzb3VyY2UsIHNjYWxlQ29uZmlnLnBvbGxJbnRlcnZhbHMucXVldWVTdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXVlU3RhdHVzUG9sbGVyLnByb21pc2UudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuJHJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucmVzdWx0cyA9IFF1ZXVlU3RhdHVzLnRyYW5zZm9ybWVyKHJlc3VsdC5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlU3RhdHVzUG9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldFF1ZXVlU3RhdHVzT25jZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICRodHRwLmdldChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdxdWV1ZS9zdGF0dXMvJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBRdWV1ZVN0YXR1cy50cmFuc2Zvcm1lcihkYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVxdWV1ZUpvYnM6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSBwYXJhbXMgfHwgZ2V0UmVxdWV1ZUpvYnNQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICBwYXJhbXMudXJsID0gcGFyYW1zLnVybCA/IHBhcmFtcy51cmwgOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdxdWV1ZS9yZXF1ZXVlLWpvYnMvJztcblxuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QocGFyYW1zLnVybCwgcGFyYW1zKS5zdWNjZXNzKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEpvYkxvYWQ6IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSBwYXJhbXMgfHwgZ2V0Sm9iTG9hZFBhcmFtcygpO1xuICAgICAgICAgICAgICAgIHBhcmFtcy51cmwgPSBwYXJhbXMudXJsID8gcGFyYW1zLnVybCA6IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2xvYWQvJztcblxuICAgICAgICAgICAgICAgIHZhciBqb2JMb2FkUmVzb3VyY2UgPSAkcmVzb3VyY2UocGFyYW1zLnVybCwgcGFyYW1zKSxcbiAgICAgICAgICAgICAgICAgICAgam9iTG9hZFBvbGxlciA9IHBvbGxlckZhY3RvcnkubmV3UG9sbGVyKGpvYkxvYWRSZXNvdXJjZSwgc2NhbGVDb25maWcucG9sbEludGVydmFscy5qb2JMb2FkKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBqb2JMb2FkUG9sbGVyLnByb21pc2UudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEuJHJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBqb2JMb2FkUG9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRKb2JMb2FkT25jZTogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHBhcmFtcyB8fCBnZXRKb2JMb2FkUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHBhcmFtcy51cmwgPyBwYXJhbXMudXJsIDogc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbG9hZC8nLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignbWV0cmljc0NvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIHNjYWxlQ29uZmlnLCBzY2FsZVNlcnZpY2UsIG5hdlNlcnZpY2UsIG1ldHJpY3NTZXJ2aWNlLCBtb21lbnQpIHtcbiAgICAgICAgdmFyIGNoYXJ0ID0gbnVsbCxcbiAgICAgICAgICAgIGNvbEFyciA9IFtdLFxuICAgICAgICAgICAgY29sTmFtZXMgPSB7fSxcbiAgICAgICAgICAgIHhBcnIgPSBbXSxcbiAgICAgICAgICAgIHJlbW92ZUlkcyA9IFtdLFxuICAgICAgICAgICAgeVVuaXRzID0gW10sXG4gICAgICAgICAgICBsb2NhdGlvblBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBjaGFydDogbnVsbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICRzY29wZS5fID0gXztcbiAgICAgICAgJHNjb3BlLm1vbWVudCA9IG1vbWVudDtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmdNZXRyaWNzID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5jaGFydEFyciA9IFtdO1xuICAgICAgICAkc2NvcGUuY2hhcnREYXRhID0gW107XG4gICAgICAgICRzY29wZS5jaGFydFN0eWxlID0gJyc7XG4gICAgICAgICRzY29wZS5zZWxlY3RlZERhdGFUeXBlID0ge307XG4gICAgICAgICRzY29wZS5pbnB1dFN0YXJ0RGF0ZSA9IG1vbWVudC51dGMoKS5zdWJ0cmFjdCgxLCAnTScpLnRvRGF0ZSgpO1xuICAgICAgICAkc2NvcGUuaW5wdXRFbmREYXRlID0gbW9tZW50LnV0YygpLnRvRGF0ZSgpO1xuICAgICAgICAkc2NvcGUub3BlbklucHV0U3RhcnQgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAkc2NvcGUuaW5wdXRTdGFydE9wZW5lZCA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5pbnB1dFN0YXJ0T3BlbmVkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5vcGVuSW5wdXRFbmQgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAkc2NvcGUuaW5wdXRFbmRPcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuaW5wdXRFbmRPcGVuZWQgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLmRhdGVNb2RlbE9wdGlvbnMgPSB7XG4gICAgICAgICAgICB0aW1lem9uZTogJyswMDAnXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5kYXRhVHlwZUZpbHRlclRleHQgPSAnJztcbiAgICAgICAgJHNjb3BlLmZpbHRlcnNBcHBsaWVkID0gW107XG4gICAgICAgICRzY29wZS5maWx0ZXJlZENob2ljZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmZpbHRlcmVkQ2hvaWNlc09wdGlvbnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkTWV0cmljcyA9IFtdO1xuICAgICAgICAkc2NvcGUuY29sdW1uR3JvdXBzT3B0aW9ucyA9IFtdO1xuICAgICAgICAkc2NvcGUuY29sdW1ucyA9IFtdO1xuICAgICAgICAkc2NvcGUuZ3JvdXBzID0gW107XG4gICAgICAgICRzY29wZS5jaGFydFRpdGxlID0gJyc7XG4gICAgICAgICRzY29wZS5jaGFydERpc3BsYXkgPSAnc3RhY2tlZCc7XG4gICAgICAgICRzY29wZS5zdGFja2VkQ2xhc3MgPSAnYnRuLXByaW1hcnknO1xuICAgICAgICAkc2NvcGUuZ3JvdXBlZENsYXNzID0gJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgJHNjb3BlLnN1YmNoYXJ0Q2xhc3MgPSAnYnRuLXByaW1hcnknO1xuICAgICAgICAkc2NvcGUuc3ViY2hhcnRFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5jaGFydFR5cGUgPSAnYmFyJztcbiAgICAgICAgJHNjb3BlLmNoYXJ0VHlwZURpc3BsYXkgPSAnQmFyJztcbiAgICAgICAgJHNjb3BlLmJhckNsYXNzID0gJ2J0bi1wcmltYXJ5JztcbiAgICAgICAgJHNjb3BlLmFyZWFDbGFzcyA9ICdidG4tZGVmYXVsdCc7XG4gICAgICAgICRzY29wZS5saW5lQ2xhc3MgPSAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAkc2NvcGUuc3BsaW5lQ2xhc3MgPSAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAkc2NvcGUuc2NhdHRlckNsYXNzID0gJ2J0bi1kZWZhdWx0JztcblxuICAgICAgICAvKlxuICAgICAgICAvLyBjaGVjayBmb3IgbG9jYXRpb25QYXJhbXMgaW4gcXVlcnkgc3RyaW5nLCBhbmQgdXBkYXRlIGFzIG5lY2Vzc2FyeVxuICAgICAgICBfLmZvckVhY2goXy5wYWlycyhsb2NhdGlvblBhcmFtcyksIGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gXy5hdCgkbG9jYXRpb24uc2VhcmNoKCksIHBhcmFtWzBdKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb25QYXJhbXNbcGFyYW1bMF1dID0gdmFsdWUubGVuZ3RoID4gMSA/IHZhbHVlIDogdmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChsb2NhdGlvblBhcmFtcy5jaGFydCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2hhcnRBcnIgPSBKU09OLnBhcnNlKGF0b2IobG9jYXRpb25QYXJhbXMuY2hhcnQpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0b2FzdHJbJ2Vycm9yJ10oJ1VuYWJsZSB0byBwYXJzZSBKU09OJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgKi9cblxuICAgICAgICBzZWxmLmdldFBsb3REYXRhUGFyYW1zID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogbnVsbCxcbiAgICAgICAgICAgICAgICBzdGFydGVkOiBvYmouc3RhcnRlZCxcbiAgICAgICAgICAgICAgICBlbmRlZDogb2JqLmVuZGVkLFxuICAgICAgICAgICAgICAgIGNob2ljZV9pZDogb2JqLmNob2ljZV9pZCxcbiAgICAgICAgICAgICAgICBjb2x1bW46IG9iai5jb2x1bW4sXG4gICAgICAgICAgICAgICAgZ3JvdXA6IG9iai5ncm91cCxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogb2JqLmRhdGFUeXBlLm5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5yZXNldFNlbGVjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuaW5wdXRTdGFydERhdGUgPSBtb21lbnQudXRjKCkuc3VidHJhY3QoMSwgJ00nKS50b0RhdGUoKTtcbiAgICAgICAgICAgICRzY29wZS5pbnB1dEVuZERhdGUgPSBtb21lbnQudXRjKCkudG9EYXRlKCk7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXRhVHlwZSA9IHt9O1xuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZURhdGFUeXBlU2VsZWN0aW9uKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi51cGRhdGVDaGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5jaGFydERhdGEgPSBbXTtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY2hhcnRBcnIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gbm90aGluZyB0byBzaG93IG9uIGNoYXJ0XG4gICAgICAgICAgICAgICAgY2hhcnQuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGNoYXJ0ID0gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGxJbml0ID0gXy5hZnRlcigkc2NvcGUuY2hhcnRBcnIubGVuZ3RoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgaW5pdENoYXJ0IGFmdGVyIHRoaXMgZnVuY3Rpb24gaGFzIGJlZW4gY2FsbGVkIGZvciBhbGwgZGF0YXNldHMgaW4gY2hhcnRBcnJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdNZXRyaWNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdENoYXJ0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLmNoYXJ0QXJyLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLmdldFBsb3REYXRhUGFyYW1zKG9iaik7XG4gICAgICAgICAgICAgICAgICAgIG1ldHJpY3NTZXJ2aWNlLmdldFBsb3REYXRhKHBhcmFtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvL21ldHJpY3NTZXJ2aWNlLmdldEdlbmVyYXRlZFBsb3REYXRhKHtxdWVyeTogb2JqLCBwYXJhbXM6IHBhcmFtc30pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jaGFydERhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IG9iaixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzOiBkYXRhLnJlc3VsdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbEluaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZ01ldHJpY3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0clsnZXJyb3InXShlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgbG9jYXRpb25QYXJhbXMuY2hhcnQgPSBidG9hKEpTT04uc3RyaW5naWZ5KCRzY29wZS5jaGFydEFycikpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2NoYXJ0JywgbG9jYXRpb25QYXJhbXMuY2hhcnQpLnJlcGxhY2UoKTtcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5hZGRUb0NoYXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmNoYXJ0QXJyID0gW107IC8vIGNvbW1lbnQgdGhpcyBvdXQgaWYgYWxsb3dpbmcgbXVsdGlwbGUgYWRkc1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdNZXRyaWNzID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZENob2ljZXMgPSBbXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZENvbHVtbnMgPSBbXTtcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGZpbHRlciBvYmplY3QgYXNzb2NpYXRlZCB3aXRoIHRoZSBjaG9zZW4gZmlsdGVyIElEc1xuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5maWx0ZXJzQXBwbGllZCwgZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRDaG9pY2VzLnB1c2goXy5maW5kKCRzY29wZS5maWx0ZXJlZENob2ljZXMsIHsgaWQ6IHBhcnNlSW50KGlkKSB9KSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoJHNjb3BlLnNlbGVjdGVkTWV0cmljcykpIHtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLnNlbGVjdGVkTWV0cmljcywgZnVuY3Rpb24gKG1ldHJpYykge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvbHVtbnMucHVzaChfLmZpbmQoJHNjb3BlLmNvbHVtbnMsIHsgbmFtZTogbWV0cmljIH0pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2x1bW5zLnB1c2goXy5maW5kKCRzY29wZS5jb2x1bW5zLCB7IG5hbWU6ICRzY29wZS5zZWxlY3RlZE1ldHJpY3MgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLmNoYXJ0QXJyLnB1c2goe1xuICAgICAgICAgICAgICAgIHN0YXJ0ZWQ6ICRzY29wZS5pbnB1dFN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGVuZGVkOiAkc2NvcGUuaW5wdXRFbmREYXRlLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgY2hvaWNlX2lkOiAkc2NvcGUuZmlsdGVyc0FwcGxpZWQsXG4gICAgICAgICAgICAgICAgY29sdW1uOiBfLnBsdWNrKHNlbGVjdGVkQ29sdW1ucywgJ25hbWUnKSxcbiAgICAgICAgICAgICAgICBncm91cDogbnVsbCxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJHNjb3BlLnNlbGVjdGVkRGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgZmlsdGVyc0FwcGxpZWQ6IGZpbHRlcmVkQ2hvaWNlcyxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE1ldHJpY3M6IHNlbGVjdGVkQ29sdW1uc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZUNoYXJ0KCk7XG4gICAgICAgICAgICAvL3NlbGYucmVzZXRTZWxlY3Rpb25zKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmRlbGV0ZUZyb21DaGFydCA9IGZ1bmN0aW9uIChvYmpUb0RlbGV0ZSkge1xuICAgICAgICAgICAgXy5yZW1vdmUoJHNjb3BlLmNoYXJ0QXJyLCBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaikgPT09IEpTT04uc3RyaW5naWZ5KG9ialRvRGVsZXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVDaGFydCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5nZXRGaWx0ZXJPcHRpb25zID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICByZXR1cm4gXy51bmlxKF8ucGx1Y2soJHNjb3BlLmZpbHRlcmVkQ2hvaWNlcywgcGFyYW0pKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2hhbmdlRGF0YVR5cGVTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyByZXNldCBvcHRpb25zXG4gICAgICAgICAgICAkc2NvcGUuZmlsdGVyc0FwcGxpZWQgPSBbXTtcbiAgICAgICAgICAgIC8vJHNjb3BlLmZpbHRlcmVkQ2hvaWNlcyA9IFtdO1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkRGF0YVR5cGVPcHRpb25zID0gW107XG4gICAgICAgICAgICAkc2NvcGUuZGF0YVR5cGVGaWx0ZXJUZXh0ID0gJyc7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRNZXRyaWNzID0gW107XG4gICAgICAgICAgICAvLyRzY29wZS5jb2x1bW5Hcm91cHMgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5jb2x1bW5zID0gW107XG5cbiAgICAgICAgICAgIGlmICghJHNjb3BlLnNlbGVjdGVkRGF0YVR5cGUubmFtZSB8fCAkc2NvcGUuc2VsZWN0ZWREYXRhVHlwZS5uYW1lID09PSAnJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhdGFUeXBlID0ge307XG4gICAgICAgICAgICAgICAgc2VsZi5nZXREYXRhVHlwZXMoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5nZXREYXRhVHlwZU9wdGlvbnMoJHNjb3BlLnNlbGVjdGVkRGF0YVR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8qJHNjb3BlLmNoYW5nZUZpbHRlclNlbGVjdGlvbiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhuYW1lICsgJzogJyArICRzY29wZS5maWx0ZXJzQXBwbGllZFtuYW1lXSk7XG4gICAgICAgICAgICAvLyByZW1vdmUgZmlsdGVyIGlmIHZhbHVlIGlzIG51bGwgb3IgZW1wdHlcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmZpbHRlcnNBcHBsaWVkW25hbWVdIHx8ICRzY29wZS5maWx0ZXJzQXBwbGllZFtuYW1lXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgJHNjb3BlLmZpbHRlcnNBcHBsaWVkW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdXBkYXRlIGZpbHRlcmVkIGNob2ljZXNcbiAgICAgICAgICAgIGFwcGx5RmlsdGVyc1RvQ2hvaWNlcygpO1xuICAgICAgICB9OyovXG5cbiAgICAgICAgJHNjb3BlLmFyZUZpbHRlcnNBcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5maWx0ZXJzQXBwbGllZC5sZW5ndGggPiAwO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qJHNjb3BlLnJlbW92ZUZpbHRlciA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAvLyBzZXQgdmFsdWUgPSBudWxsXG4gICAgICAgICAgICAkc2NvcGUuZmlsdGVyc0FwcGxpZWRbbmFtZV0gPSAnJztcbiAgICAgICAgICAgIC8vIHRyaWdnZXIgZmlsdGVyIHNlbGVjdGlvbiBjaGFuZ2VcbiAgICAgICAgICAgICRzY29wZS5jaGFuZ2VGaWx0ZXJTZWxlY3Rpb24obmFtZSk7XG4gICAgICAgIH07Ki9cblxuICAgICAgICAkc2NvcGUudXBkYXRlQ2hhcnREaXNwbGF5ID0gZnVuY3Rpb24gKGRpc3BsYXkpIHtcbiAgICAgICAgICAgICRzY29wZS5jaGFydERpc3BsYXkgPSBkaXNwbGF5O1xuICAgICAgICAgICAgJHNjb3BlLnN0YWNrZWRDbGFzcyA9IGRpc3BsYXkgPT09ICdzdGFja2VkJyA/ICdidG4tcHJpbWFyeScgOiAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAgICAgJHNjb3BlLmdyb3VwZWRDbGFzcyA9IGRpc3BsYXkgPT09ICdncm91cGVkJyA/ICdidG4tcHJpbWFyeScgOiAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAgICAgc2VsZi5pbml0Q2hhcnQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudXBkYXRlQ2hhcnRUeXBlID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgICAgICRzY29wZS5jaGFydFR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgJHNjb3BlLmNoYXJ0VHlwZURpc3BsYXkgPSBfLmNhcGl0YWxpemUodHlwZSk7XG4gICAgICAgICAgICAkc2NvcGUuYmFyQ2xhc3MgPSB0eXBlID09PSAnYmFyJyA/ICdidG4tcHJpbWFyeScgOiAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAgICAgJHNjb3BlLmFyZWFDbGFzcyA9IHR5cGUgPT09ICdhcmVhJyA/ICdidG4tcHJpbWFyeScgOiAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAgICAgJHNjb3BlLmxpbmVDbGFzcyA9IHR5cGUgPT09ICdsaW5lJyA/ICdidG4tcHJpbWFyeScgOiAnYnRuLWRlZmF1bHQnO1xuICAgICAgICAgICAgJHNjb3BlLnNwbGluZUNsYXNzID0gdHlwZSA9PT0gJ3NwbGluZScgPyAnYnRuLXByaW1hcnknIDogJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgICAgICRzY29wZS5zY2F0dGVyQ2xhc3MgPSB0eXBlID09PSAnc2NhdHRlcicgPyAnYnRuLXByaW1hcnknIDogJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgICAgIHNlbGYuaW5pdENoYXJ0KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnRvZ2dsZVN1YmNoYXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnN1YmNoYXJ0RW5hYmxlZCA9ICEkc2NvcGUuc3ViY2hhcnRFbmFibGVkO1xuICAgICAgICAgICAgaWYgKCRzY29wZS5zdWJjaGFydEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3ViY2hhcnRDbGFzcyA9ICdidG4tcHJpbWFyeSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5zdWJjaGFydENsYXNzID0gJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdtZXRyaWNzJyk7XG4gICAgICAgICAgICBzZWxmLmdldERhdGFUeXBlcygpO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY2hhcnRBcnIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlQ2hhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgICAgIH07XG5cbiAgICAgICAgLyp2YXIgYXBwbHlGaWx0ZXJzVG9DaG9pY2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNob2ljZXMgPSAkc2NvcGUuc2VsZWN0ZWREYXRhVHlwZU9wdGlvbnMgPyAkc2NvcGUuc2VsZWN0ZWREYXRhVHlwZU9wdGlvbnMuY2hvaWNlcyA6IFtdO1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkQ2hvaWNlcyA9IF8ud2hlcmUoY2hvaWNlcywkc2NvcGUuZmlsdGVyc0FwcGxpZWQpO1xuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkQ2hvaWNlcyA9IGZpbHRlcmVkQ2hvaWNlcztcbiAgICAgICAgfTsqL1xuXG4gICAgICAgIHNlbGYuZ2V0RGF0YVR5cGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbWV0cmljc1NlcnZpY2UuZ2V0RGF0YVR5cGVzKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmF2YWlsYWJsZURhdGFUeXBlcyA9IHJlc3VsdC5yZXN1bHRzO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIHRvYXN0clsnZXJyb3InXShlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmdldERhdGFUeXBlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICBtZXRyaWNzU2VydmljZS5nZXREYXRhVHlwZU1ldHJpY3MoaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhdGFUeXBlQXZhaWxhYmxlTWV0cmljcyA9IHJlc3VsdC5tZXRyaWNzO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5nZXREYXRhVHlwZU9wdGlvbnMgPSBmdW5jdGlvbiAoZGF0YVR5cGUpIHtcbiAgICAgICAgICAgIG1ldHJpY3NTZXJ2aWNlLmdldERhdGFUeXBlT3B0aW9ucyhkYXRhVHlwZS5uYW1lKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXRhVHlwZU9wdGlvbnMgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJlc3VsdC5maWx0ZXJzLCBmdW5jdGlvbiAoZmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhVHlwZUZpbHRlclRleHQgPSAkc2NvcGUuZGF0YVR5cGVGaWx0ZXJUZXh0Lmxlbmd0aCA9PT0gMCA/IF8uY2FwaXRhbGl6ZShmaWx0ZXIucGFyYW0pIDogJHNjb3BlLmRhdGFUeXBlRmlsdGVyVGV4dCArICcsICcgKyBfLmNhcGl0YWxpemUoZmlsdGVyLnBhcmFtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsdGVyZWRDaG9pY2VzID0gXy5zb3J0QnlPcmRlcihyZXN1bHQuY2hvaWNlcywgWyd0aXRsZScsJ3ZlcnNpb24nXSwgWydhc2MnLCdhc2MnXSk7XG4gICAgICAgICAgICAgICAgLy8gZm9ybWF0IGZpbHRlcmVkQ2hvaWNlcyBmb3IgdXNlIHdpdGggbXVsdGlzZWxlY3QgZGlyZWN0aXZlXG4gICAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkQ2hvaWNlc09wdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLmZpbHRlcmVkQ2hvaWNlcywgZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZENob2ljZXNPcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGNob2ljZS52ZXJzaW9uID8gY2hvaWNlLnRpdGxlICsgJyAnICsgY2hvaWNlLnZlcnNpb24gOiBjaG9pY2UudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogY2hvaWNlLnZlcnNpb24gPyBjaG9pY2UudGl0bGUgKyAnICcgKyBjaG9pY2UudmVyc2lvbiA6IGNob2ljZS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBjaG9pY2UuaWRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlcmVkQ2hvaWNlc09wdGlvbnMgPSBmaWx0ZXJlZENob2ljZXNPcHRpb25zO1xuICAgICAgICAgICAgICAgICRzY29wZS5jb2x1bW5zID0gXy5zb3J0QnlPcmRlcihyZXN1bHQuY29sdW1ucywgWyd0aXRsZSddLCBbJ2FzYyddKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JvdXBzID0gcmVzdWx0Lmdyb3VwcztcblxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhbiBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgZ3JvdXBlZCBjb2x1bW5zXG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3Vwc09wdGlvbnMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uR3JvdXBzID0gXy5wYWlycyhfLmdyb3VwQnkocmVzdWx0LmNvbHVtbnMsICdncm91cCcpKTtcbiAgICAgICAgICAgICAgICBfLmZvckVhY2goY29sdW1uR3JvdXBzLCBmdW5jdGlvbiAoZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBfLmZpbmQoJHNjb3BlLmdyb3VwcywgeyBuYW1lOiBncm91cFswXSB9KS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZ3JvdXBbMV0sIGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogY29sdW1uLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBjb2x1bW4udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNvbHVtbi5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uR3JvdXBzT3B0aW9ucy5wdXNoKG9wdGlvbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29sdW1uR3JvdXBzT3B0aW9ucy51bnNoaWZ0KHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdOb25lIFNlbGVjdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdOb25lIFNlbGVjdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbHVtbkdyb3Vwc09wdGlvbnMgPSBjb2x1bW5Hcm91cHNPcHRpb25zO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgdG9hc3RyWydlcnJvciddKGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNlbGYuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2lucHV0RW5kRGF0ZScsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWUpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHNldCB1cCBjaGFydFxuICAgICAgICBzZWxmLmluaXRDaGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIG1hcmsgYW55IGV4aXN0aW5nIGRhdGEgZm9yIHJlbW92YWxcbiAgICAgICAgICAgIC8vIGNvbXBhcmUgY3VyckNvbHMgKGNvbHVtbnMgY3VycmVudGx5IGluIHRoZSBjaGFydCkgd2l0aCBkaXNwbGF5Q29scyAoY29sdW1ucyB0byBkaXNwbGF5KVxuICAgICAgICAgICAgcmVtb3ZlSWRzID0gW107XG4gICAgICAgICAgICB2YXIgY3VyckNvbHMgPSBbXSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5Q29scyA9IFtdO1xuICAgICAgICAgICAgXy5mb3JFYWNoKGNvbEFyciwgZnVuY3Rpb24gKGNvbCwgaWR4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGlkeCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyckNvbHMucHVzaChjb2xbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5jaGFydERhdGEsIGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbHMgPSBkaXNwbGF5Q29scy5jb25jYXQoXy5wbHVjayhkLnF1ZXJ5LmZpbHRlcnNBcHBsaWVkLCAnbmFtZScpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBleGFjdCBkaWZmZXJlbmNlcyBiZXR3ZWVuIGN1cnJDb2xzIGFuZCBkaXNwbGF5Q29sc1xuICAgICAgICAgICAgLy8gaWYgbm9uZSBhcmUgZm91bmQsIHRoZW4gcmVtb3ZlSWRzIHN0YXlzIGVtcHR5XG4gICAgICAgICAgICBfLmZvckVhY2goY3VyckNvbHMsIGZ1bmN0aW9uIChjdXJyQ29sKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3BsYXlDb2wgPSBfLmZpbmQoZGlzcGxheUNvbHMsIGZ1bmN0aW9uIChkQ29sKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkQ29sID09PSBjdXJyQ29sO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmICghZGlzcGxheUNvbCkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVJZHMucHVzaChjdXJyQ29sKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gaW5pdCB3aXRoIG5ldyBkYXRhXG4gICAgICAgICAgICBjb2xBcnIgPSBbXTtcbiAgICAgICAgICAgIHhBcnIgPSBbXTtcbiAgICAgICAgICAgIGNvbE5hbWVzID0ge307XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSB4QXJyXG4gICAgICAgICAgICB2YXIgbnVtRGF5cyA9IG1vbWVudC51dGMoJHNjb3BlLmlucHV0RW5kRGF0ZSkuZW5kT2YoJ2QnKS5kaWZmKG1vbWVudC51dGMoJHNjb3BlLmlucHV0U3RhcnREYXRlLnRvSVNPU3RyaW5nKCkpLnN0YXJ0T2YoJ2QnKSwgJ2QnKSArIDE7IC8vIGFkZCAxIHRvIGluY2x1ZGUgc3RhcnRpbmcgZGF5IGluIGNvdW50XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURheXM7IGkrKykge1xuICAgICAgICAgICAgICAgIHhBcnIucHVzaChtb21lbnQudXRjKCRzY29wZS5pbnB1dFN0YXJ0RGF0ZS50b0lTT1N0cmluZygpKS5zdGFydE9mKCdkJykuYWRkKGksICdkJykudG9EYXRlKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpdGVyYXRlIG92ZXIgZGF0YXR5cGVzIGFuZCBhZGQgdmFsdWVzIHRvIGNvbEFyclxuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5jaGFydERhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlQXJyID0gW10sXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gZGF0YS5xdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlGaWx0ZXIgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRlcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgeVVuaXRzID0gXy5wbHVjayhxdWVyeS5zZWxlY3RlZE1ldHJpY3MsICd1bml0cycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5LmZpbHRlcnNBcHBsaWVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmlsdGVycyB3ZXJlIGFwcGxpZWQsIHNvIGJ1aWxkIGRhdGEgc291cmNlIGFjY29yZGluZ2x5XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLnJlc3VsdHMsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZXMgZm9yIGFsbCBmaWx0ZXJzIGFyZSByZXR1cm5lZCBpbiBvbmUgYXJyYXkgb2YgYXJyYXlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIGdyb3VwIHJlc3VsdHMgYnkgaWQgdG8gaXNvbGF0ZSBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwZWRSZXN1bHQgPSBfLmdyb3VwQnkocmVzdWx0LnZhbHVlcywgJ2lkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE9iaiA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJZHMgPSBfLnBsdWNrKHF1ZXJ5LmZpbHRlcnNBcHBsaWVkLCAnaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cnkgdG8gZ2V0IGVhY2ggZmlsdGVyIGlkIGZyb20gZ3JvdXBlZFJlc3VsdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIHVuZGVmaW5lZCwgYW4gZW1wdHkgYXJyYXkgd2lsbCBiZSByZXR1cm5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgYWxsb3dzIGEgemVyb2VkIGFycmF5IHRvIGFwcGVhciBpbiB0aGUgY2hhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2luY2Ugd2Ugd2FudCB0byBpbmNsdWRlIGFsbCBmaWx0ZXJzIHNlbGVjdGVkIGJ5IHRoZSB1c2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVnYXJkbGVzcyBvZiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJJZHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIG1vcmUgdGhhbiBvbmUgZmlsdGVyIGlzIHJlcXVlc3RlZCwgdGhlbiBhbiBpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZSBpcyBwcmVzZW50IHdpdGhpbiBkYXRhLnJlc3VsdHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGZpbHRlcklkcywgZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRPYmpbaWRdID0gXy5nZXQoZ3JvdXBlZFJlc3VsdCwgaWQsIFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiBvbmUgZmlsdGVyIGlzIHJlcXVlc3RlZCwgbm8gaWQgdmFsdWUgaXMgaW5jbHVkZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gZGF0YS5yZXN1bHRzLCBzbyBidWlsZCByZXN1bHRPYmogd2l0aCB0aGUgb3RoZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5mbyB3ZSBoYXZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE9ialtxdWVyeS5jaG9pY2VfaWRbMF1dID0gXy5wYWlycyhncm91cGVkUmVzdWx0KVswXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKF8ucGFpcnMocmVzdWx0T2JqKSwgZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVBcnIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZFswXSB3aWxsIGJlIGNob2ljZSBpZCwgZFsxXSB3aWxsIGJlIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBvbmx5IG9uZSBmaWx0ZXIgd2FzIHNlbGVjdGVkLCBkWzBdIHdpbGwgcmV0dXJuIGFzIHN0cmluZyAndW5kZWZpbmVkJyBzaW5jZSBubyBpZCBpcyBpbmNsdWRlZCBpbiB0aGlzIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlGaWx0ZXIgPSBkWzBdID09PSAndW5kZWZpbmVkJyA/IHF1ZXJ5LmZpbHRlcnNBcHBsaWVkWzBdIDogXy5maW5kKHF1ZXJ5LmZpbHRlcnNBcHBsaWVkLCB7aWQ6IHBhcnNlSW50KGRbMF0pfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0ZXMgPSBkWzFdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCByZXN1bHQgdmFsdWVzIHRvIHZhbHVlQXJyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh4QXJyLCBmdW5jdGlvbiAoeERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZU9iaiA9IF8uZmluZChxdWVyeURhdGVzLCBmdW5jdGlvbiAocURhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50LnV0YyhxRGF0ZS5kYXRlKS5pc1NhbWUoeERhdGUsICdkYXknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCAwIGlmIGRhdGEgZm9yIHhEYXRlIGlzIG5vdCBwcmVzZW50IGluIHF1ZXJ5RGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQXJyLnB1c2godmFsdWVPYmogPyB2YWx1ZU9iai52YWx1ZSA6IDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwcmVwZW5kIHZhbHVlQXJyIHdpdGggZmlsdGVyIHRpdGxlLCBhbmQgcHVzaCBvbnRvIGNvbEFyclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUFyci51bnNoaWZ0KHF1ZXJ5RmlsdGVyLm5hbWUgKyBxdWVyeUZpbHRlci5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbE5hbWVzW3F1ZXJ5RmlsdGVyLm5hbWUgKyBxdWVyeUZpbHRlci5pZF0gPSBxdWVyeUZpbHRlci52ZXJzaW9uID8gcXVlcnlGaWx0ZXIudGl0bGUgKyAnICcgKyBxdWVyeUZpbHRlci52ZXJzaW9uIDogcXVlcnlGaWx0ZXIudGl0bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbEFyci5wdXNoKHZhbHVlQXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm8gZmlsdGVycyB3ZXJlIGFwcGxpZWQsIHNvIHNob3cgYWdncmVnYXRlIHN0YXRpc3RpY3NcbiAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRhdGEucmVzdWx0cywgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHJlc3VsdCB2YWx1ZXMgdG8gdmFsdWVBcnJcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh4QXJyLCBmdW5jdGlvbiAoeERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVPYmogPSBfLmZpbmQocmVzdWx0LnZhbHVlcywgZnVuY3Rpb24gKHFEYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQudXRjKHFEYXRlLmRhdGUpLmlzU2FtZSh4RGF0ZSwgJ2RheScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1c2ggMCBpZiBkYXRhIGZvciB4RGF0ZSBpcyBub3QgcHJlc2VudCBpbiByZXN1bHQudmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVBcnIucHVzaCh2YWx1ZU9iaiA/IHZhbHVlT2JqLnZhbHVlIDogMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJlcGVuZCB2YWx1ZUFyciB3aXRoIGZpbHRlciB0aXRsZSwgYW5kIHB1c2ggb250byBjb2xBcnJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2x1bW5MYWJlbCA9IHJlc3VsdC5jb2x1bW4udGl0bGUgKyAnIGZvciBhbGwgJyArIHF1ZXJ5LmRhdGFUeXBlLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVBcnIudW5zaGlmdChjb2x1bW5MYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xOYW1lc1snYWdncmVnYXRlJ10gPSBjb2x1bW5MYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbEFyci5wdXNoKHZhbHVlQXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGluZm9ybSB0aGUgdXNlciBpZiB0aGUgbWV0cmljcyB0aGV5IHNlbGVjdGVkIGFyZSBlbXB0eVxuICAgICAgICAgICAgaWYgKF8uc3VtKF8uZmxhdHRlbihjb2xBcnIpKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRvYXN0clsnaW5mbyddKCdUaGVyZSBpcyBubyBkYXRhIHRvIGRpc3BsYXkuJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHByZXBlbmQgeEFyciB3aXRoIGFuICd4JyBsYWJlbCBhbmQgYWRkIHRvIGNvbEFyclxuICAgICAgICAgICAgeEFyci51bnNoaWZ0KCd4Jyk7XG4gICAgICAgICAgICBjb2xBcnIudW5zaGlmdCh4QXJyKTtcblxuICAgICAgICAgICAgdmFyIHR5cGVzID0ge30sXG4gICAgICAgICAgICAgICAgdHlwZSA9IHt9LFxuICAgICAgICAgICAgICAgIGdyb3VwcyA9IFtdO1xuXG4gICAgICAgICAgICBfLmZvckVhY2goY29sQXJyLCBmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChjb2xbMF0gIT09ICd4Jykge1xuICAgICAgICAgICAgICAgICAgICB0eXBlW2NvbFswXV0gPSAkc2NvcGUuY2hhcnRUeXBlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNoYXJ0RGlzcGxheSA9PT0gJ3N0YWNrZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cHMucHVzaChjb2xbMF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHR5cGVzLCB0eXBlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoY2hhcnQpIHtcbiAgICAgICAgICAgICAgICAvLyBjaGFydCBhbHJlYWR5IGV4aXN0cywgc28gdXBkYXRlIHZhbHVlc1xuICAgICAgICAgICAgICAgIGNoYXJ0Lmdyb3VwcyhbZ3JvdXBzXSk7XG4gICAgICAgICAgICAgICAgY2hhcnQuZGF0YS5uYW1lcyhjb2xOYW1lcyk7XG4gICAgICAgICAgICAgICAgY2hhcnQuYXhpcy5sYWJlbHMoe1xuICAgICAgICAgICAgICAgICAgICB5OiBfLmNhcGl0YWxpemUoeVVuaXRzWzBdKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNoYXJ0LmxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBjb2xBcnIsXG4gICAgICAgICAgICAgICAgICAgIHR5cGVzOiB0eXBlcyxcbiAgICAgICAgICAgICAgICAgICAgdW5sb2FkOiByZW1vdmVJZHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm8gY2hhcnQgeWV0LCBzbyBzZXQgaXQgdXBcbiAgICAgICAgICAgICAgICBjaGFydCA9IGMzLmdlbmVyYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgYmluZHRvOiAnI21ldHJpY3MnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiAneCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBjb2xBcnIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlczogdHlwZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cHM6IFtncm91cHNdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IGNvbE5hbWVzXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN1YmNoYXJ0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93OiAkc2NvcGUuc3ViY2hhcnRFbmFibGVkXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA3MDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm46IHNjYWxlQ29uZmlnLmNvbG9ycy5wYXR0ZXJuRDMyMFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBheGlzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGltZXNlcmllcycsXG4gICAgICAgICAgICAgICAgICAgICAgICB4OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGljazoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50LnV0YyhkKS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRGF0ZXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLWNlbnRlcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgeToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IF8uY2FwaXRhbGl6ZSh5VW5pdHNbMF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ291dGVyLW1pZGRsZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzZXQgY2hhcnQgaGVpZ2h0XG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHNjYWxlQ29uZmlnLmhlYWRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBjaGFydE1heEhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCAtIG9mZnNldDtcblxuICAgICAgICAgICAgJHNjb3BlLmNoYXJ0U3R5bGUgPSAnaGVpZ2h0OiAnICsgY2hhcnRNYXhIZWlnaHQgKyAncHg7IG1heC1oZWlnaHQ6ICcgKyBjaGFydE1heEhlaWdodCArICdweDsnO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLnNlcnZpY2UoJ21ldHJpY3NTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwLCAkcSwgJHJlc291cmNlLCBzY2FsZUNvbmZpZykge1xuICAgICAgICB2YXIgZ2V0UGxvdERhdGFQYXJhbXMgPSBmdW5jdGlvbiAocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCwgY2hvaWNlX2lkLCBjb2x1bW4sIGdyb3VwLCBkYXRhVHlwZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coY2hvaWNlX2lkKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcGFnZTogcGFnZSxcbiAgICAgICAgICAgICAgICBwYWdlX3NpemU6IHBhZ2Vfc2l6ZSxcbiAgICAgICAgICAgICAgICBzdGFydGVkOiBzdGFydGVkLFxuICAgICAgICAgICAgICAgIGVuZGVkOiBlbmRlZCxcbiAgICAgICAgICAgICAgICBjaG9pY2VfaWQ6IGNob2ljZV9pZCxcbiAgICAgICAgICAgICAgICBjb2x1bW46IGNvbHVtbixcbiAgICAgICAgICAgICAgICBncm91cDogZ3JvdXAsXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXREYXRhVHlwZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ21ldHJpY3MvJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldERhdGFUeXBlTWV0cmljczogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwLmdldChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdtZXRyaWNzLycgKyBpZCArICcvJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldERhdGFUeXBlT3B0aW9uczogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ21ldHJpY3MvJyArIG5hbWUgKyAnLyc7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHVybCkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldFBsb3REYXRhOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHBhcmFtcyB8fCBnZXRQbG90RGF0YVBhcmFtcygpLFxuICAgICAgICAgICAgICAgICAgICBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdtZXRyaWNzLycgKyBwYXJhbXMuZGF0YVR5cGUgKyAnL3Bsb3QtZGF0YS8nLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldEdlbmVyYXRlZFBsb3REYXRhOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJldHVybk9iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IDI4LFxuICAgICAgICAgICAgICAgICAgICBuZXh0OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91czogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0czogW11cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIG51bURheXMgPSBtb21lbnQudXRjKG9iai5wYXJhbXMuZW5kZWQpLmRpZmYobW9tZW50LnV0YyhvYmoucGFyYW1zLnN0YXJ0ZWQpLCAnZCcpICsgMTtcblxuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChvYmoucXVlcnkuc2VsZWN0ZWRNZXRyaWNzLCBmdW5jdGlvbiAobWV0cmljKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5SZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IG1ldHJpYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbl94OiBtb21lbnQudXRjKG9iai5wYXJhbXMuc3RhcnRlZCkuZm9ybWF0KCdZWVlZLU1NLUREJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhfeDogbW9tZW50LnV0YyhvYmoucGFyYW1zLmVuZGVkKS5mb3JtYXQoJ1lZWVktTU0tREQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbl95OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3k6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogW11cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURheXM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5xdWVyeS5maWx0ZXJzQXBwbGllZC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKG9iai5xdWVyeS5maWx0ZXJzQXBwbGllZCwgZnVuY3Rpb24gKGZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQudmFsdWVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogbW9tZW50LnV0YyhvYmoucGFyYW1zLnN0YXJ0ZWQpLmFkZChpLCAnZCcpLmZvcm1hdCgnWVlZWS1NTS1ERCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAwIC0gMSArIDEpKSArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZmlsdGVyLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQudmFsdWVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBtb21lbnQudXRjKG9iai5wYXJhbXMuc3RhcnRlZCkuYWRkKGksICdkJykuZm9ybWF0KCdZWVlZLU1NLUREJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoMTAwMCAtIDEgKyAxKSkgKyAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuT2JqLnJlc3VsdHMucHVzaChyZXR1cm5SZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZC5yZXNvbHZlKHJldHVybk9iaik7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignbmF2Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCAkd2luZG93LCBzY2FsZUNvbmZpZywgc2NhbGVTZXJ2aWNlLCBzdGF0ZVNlcnZpY2UsIG5hdlNlcnZpY2UpIHtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBzY2FsZUNvbmZpZy5jb2xvcnMubmF2X2JnO1xuXG4gICAgICAgICRzY29wZS52ZXJzaW9uID0gJyc7XG4gICAgICAgICRzY29wZS5hY3RpdmVQYWdlID0gJ292ZXJ2aWV3JztcbiAgICAgICAgJHNjb3BlLmRvY3NVcmwgPSBzY2FsZUNvbmZpZy51cmxzLmRvY3VtZW50YXRpb247XG5cbiAgICAgICAgJHNjb3BlLmdvdG8gPSBmdW5jdGlvbihsb2MpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJycpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgobG9jKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgbG9jYXRpb25VcGRhdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlUGFnZSA9IG5hdlNlcnZpY2UubG9jYXRpb247XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG5hdlNlcnZpY2UucmVnaXN0ZXJPYnNlcnZlcihsb2NhdGlvblVwZGF0ZWQpO1xuXG4gICAgICAgICAgICBzY2FsZVNlcnZpY2UuZ2V0VmVyc2lvbigpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudmVyc2lvbiA9IGRhdGEudmVyc2lvbjtcbiAgICAgICAgICAgICAgICBzdGF0ZVNlcnZpY2Uuc2V0VmVyc2lvbihkYXRhLnZlcnNpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGluaXRpYWxpemUoKTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBTZWU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI1NzY3OTgvYW5ndWxhcmpzLWhvdy10by13YXRjaC1zZXJ2aWNlLXZhcmlhYmxlcy8xNzU1ODg4NSMxNzU1ODg4NVxuICAgICAqIERvaW5nIHRoaW5ncyB0aGlzIHdheSBzbyB0aGF0IHNzTmF2YmFyQ29udHJvbGxlciBjYW4gZ2V0IG5vdGlmaWVkXG4gICAgICogd2hlbiB0aGUgbG9jYXRpb24gY2hhbmdlcy4gVGhlbiwgb3VyIGNvbnRyb2xsZXJzIGp1c3QgbmVlZCB0byBjYWxsIGludG9cbiAgICAgKiB0aGlzIHNlcnZpY2UgdG8gdXBkYXRlTG9jYXRpb24uXG4gICAgICpcbiAgICAgKiBUaGUgb25seSB0aGluZyBJIGRvbid0IGxpa2UgYWJvdXQgdGhpcyBpcyB0aGF0IHRoZSBpbmRpdmlkdWFsXG4gICAgICogY29udHJvbGxlcnMgaGF2ZSB0byBjYWxsIGluIGFuZCB0ZWxsIHRoZSBzc05hdmlnYXRpb25TZXJ2aWNlIHdoYXRcbiAgICAgKiBwYWdlIHRoZXkgYXJlIHNob3dpbmcuXG4gICAgICovXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnbmF2U2VydmljZScsIGZ1bmN0aW9uICgkbG9jYXRpb24pIHtcblxuICAgICAgICB0aGlzLmxvY2F0aW9uID0gJ292ZXJ2aWV3JzsgLy8gd2hlcmUgdGhlIGFwcCBzdGFydHNcblxuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gW107XG5cbiAgICAgICAgdGhpcy5yZWdpc3Rlck9ic2VydmVyID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICAgICAgIG9ic2VydmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLm5vdGlmeU9ic2VydmVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG9ic2VydmVycywgZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy51cGRhdGVMb2NhdGlvbiA9IGZ1bmN0aW9uKGxvY2F0aW9uSW4pIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbkluO1xuICAgICAgICAgICAgdGhpcy5ub3RpZnlPYnNlcnZlcnMoKTtcbiAgICAgICAgfTtcblxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnc3VibmF2U2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgc2NhbGVDb25maWcpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRQYXRoID0gJyc7XG5cbiAgICAgICAgdGhpcy5zZXRDdXJyZW50UGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgICAgICBjdXJyZW50UGF0aCA9IHBhdGg7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5nZXRDdXJyZW50UGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UGF0aDtcbiAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdub2RlRGV0YWlsc0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgJHJvdXRlUGFyYW1zLCAkdGltZW91dCwgbmF2U2VydmljZSwgbm9kZVNlcnZpY2UsIHNjYWxlU2VydmljZSkge1xuICAgICAgICAkc2NvcGUubm9kZUlkID0gJHJvdXRlUGFyYW1zLmlkO1xuICAgICAgICAkc2NvcGUuc2NhbGVTZXJ2aWNlID0gc2NhbGVTZXJ2aWNlO1xuXG4gICAgICAgIHZhciBnZXROb2RlRGV0YWlscyA9IGZ1bmN0aW9uIChub2RlSWQpIHtcbiAgICAgICAgICAgIG5vZGVTZXJ2aWNlLmdldE5vZGUobm9kZUlkKS50aGVuKCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ub2RlID0gZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdub2RlcycpO1xuXG4gICAgICAgICAgICBnZXROb2RlRGV0YWlscygkc2NvcGUubm9kZUlkKTtcbiAgICAgICAgICAgIF8uZGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG5cbiAgICAgICAgLyokc2NvcGUuJHdhdGNoKCdub2RlRGF0YScsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXdHcmlkKCk7XG4gICAgICAgIH0sIHRydWUpOyovXG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdub2Rlc0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgJHRpbWVvdXQsIG5hdlNlcnZpY2UsIG5vZGVTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS5ub2RlQ291bnRzID0gW107XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmhvdXJWYWx1ZSA9IDM7XG4gICAgICAgICRzY29wZS5ub2Rlc0Vycm9yID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLm5vZGVzRXJyb3JTdGF0dXMgPSBudWxsO1xuICAgICAgICAkc2NvcGUubm9kZVN0YXR1c0Vycm9yID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLm5vZGVTdGF0dXNFcnJvclN0YXR1cyA9IG51bGw7XG4gICAgICAgICRzY29wZS5ub2RlRGF0YSA9IHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBzdGF0dXM6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGVib3VuY2VUaW1lciA9IHt9O1xuXG4gICAgICAgIHZhciBkZWJvdW5jZUJyb2FkY2FzdCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBhcmdzKSB7XG4gICAgICAgICAgICBpZiAoZGVib3VuY2VUaW1lclttZXNzYWdlXSkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbChkZWJvdW5jZVRpbWVyW21lc3NhZ2VdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlYm91bmNlVGltZXJbbWVzc2FnZV0gPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QobWVzc2FnZSwgYXJncyk7XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZWRyYXdHcmlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGVib3VuY2VCcm9hZGNhc3QoJ3JlZHJhd0dyaWQnLCAkc2NvcGUubm9kZURhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXROb2RlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG5vZGVTZXJ2aWNlLmdldE5vZGVzKCkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXNFcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ub2RlRGF0YS5kYXRhID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVkcmF3R3JpZCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1c1RleHQgJiYgZGF0YS5zdGF0dXNUZXh0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzRXJyb3JTdGF0dXMgPSBkYXRhLnN0YXR1c1RleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzRXJyb3IgPSAnVW5hYmxlIHRvIHJldHJpZXZlIG5vZGVzLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldE5vZGVTdGF0dXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBub2RlU2VydmljZS5nZXROb2RlU3RhdHVzKG51bGwsIG51bGwsICdQVCcgKyAkc2NvcGUuaG91clZhbHVlICsgJ0gnLCBudWxsKS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuJHJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ub2RlU3RhdHVzRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZURhdGEuc3RhdHVzID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVkcmF3R3JpZCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1c1RleHQgJiYgZGF0YS5zdGF0dXNUZXh0ICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVTdGF0dXNFcnJvclN0YXR1cyA9IGRhdGEuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZVN0YXR1c0Vycm9yID0gJ1VuYWJsZSB0byByZXRyaWV2ZSBub2RlIHN0YXR1cy4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBnZXROb2RlcygpO1xuICAgICAgICAgICAgZ2V0Tm9kZVN0YXR1cygpO1xuICAgICAgICAgICAgXy5kZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbmF2U2VydmljZS51cGRhdGVMb2NhdGlvbignbm9kZXMnKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb250cm9sbGVyKCdhaXNOb2RlSGVhbHRoQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIG5vZGVTZXJ2aWNlKSB7XG4gICAgICAgICRzY29wZS5sb2FkaW5nTm9kZUhlYWx0aCA9IHRydWU7XG4gICAgICAgICRzY29wZS5ub2RlSGVhbHRoRXJyb3IgPSBudWxsO1xuICAgICAgICAkc2NvcGUubm9kZUhlYWx0aEVycm9yU3RhdHVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLm5vZGVIZWFsdGggPSB7fTtcbiAgICAgICAgJHNjb3BlLm5vZGVzT2ZmbGluZSA9IDA7XG4gICAgICAgICRzY29wZS5ub2Rlc1BhdXNlZEVycm9ycyA9IDA7XG4gICAgICAgICRzY29wZS5ub2Rlc1BhdXNlZCA9IDA7XG4gICAgICAgICRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWQgPSAwO1xuICAgICAgICAkc2NvcGUubm9kZXNPZmZsaW5lQW5kUGF1c2VkRXJyb3JzID0gMDtcbiAgICAgICAgJHNjb3BlLmhlYWx0aHlOb2RlcyA9IDA7XG4gICAgICAgICRzY29wZS50b3RhbE5vZGVzID0gMDtcblxuICAgICAgICB2YXIgZ2V0Tm9kZVN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nTm9kZUhlYWx0aCA9IHRydWU7XG4gICAgICAgICAgICBub2RlU2VydmljZS5nZXROb2RlU3RhdHVzKG51bGwsIG51bGwsICRzY29wZS5kdXJhdGlvbiwgbnVsbCkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWxOb2RlcyA9IGRhdGEucmVzdWx0cy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVzT2ZmbGluZSA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNQYXVzZWRFcnJvcnMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzUGF1c2VkID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc09mZmxpbmVBbmRQYXVzZWRFcnJvcnMgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzT2ZmbGluZUFuZFBhdXNlZCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChkYXRhLnJlc3VsdHMsIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW4uaXNfb25saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZSBpcyBvZmZsaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4ubm9kZS5pc19wYXVzZWRfZXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzT2ZmbGluZUFuZFBhdXNlZEVycm9ycy5wdXNoKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi5ub2RlLmlzX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc09mZmxpbmVBbmRQYXVzZWQucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2Rlc09mZmxpbmUucHVzaChuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vZGUgaXMgb25saW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4ubm9kZS5pc19wYXVzZWRfZXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzUGF1c2VkRXJyb3JzLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuLm5vZGUuaXNfcGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzUGF1c2VkLnB1c2gobik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXNPZmZsaW5lID0gbm9kZXNPZmZsaW5lLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVzUGF1c2VkRXJyb3JzID0gbm9kZXNQYXVzZWRFcnJvcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXNQYXVzZWQgPSBub2Rlc1BhdXNlZC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWRFcnJvcnMgPSBub2Rlc09mZmxpbmVBbmRQYXVzZWRFcnJvcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZXNPZmZsaW5lQW5kUGF1c2VkID0gbm9kZXNPZmZsaW5lQW5kUGF1c2VkLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgdGhlIGxlbmd0aCBvZiBub2RlcyBib3RoIG9mZmxpbmUgYW5kIHBhdXNlZCB0byBwcm9kdWNlIGFuIGFjY3VyYXRlIGhlYWx0aHkgY291bnRcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmhlYWx0aHlOb2RlcyA9ICRzY29wZS50b3RhbE5vZGVzIC0gJHNjb3BlLm5vZGVzT2ZmbGluZSAtICRzY29wZS5ub2Rlc1BhdXNlZEVycm9ycyAtICRzY29wZS5ub2Rlc1BhdXNlZCAtICRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWQgLSAkc2NvcGUubm9kZXNPZmZsaW5lQW5kUGF1c2VkRXJyb3JzO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBkb251dERhdGEgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBkZXRlcm1pbmUgcGVyY2VudGFnZSBvZiBoZWFsdGh5IG5vZGVzLCBhbmQgYnJlYWtkb3duIG9mIHdoeSBub2RlcyBhcmUgdW5oZWFsdGh5XG4gICAgICAgICAgICAgICAgICAgIHZhciBnYXVnZURhdGEgPSAkc2NvcGUudG90YWxOb2RlcyA+IDAgPyAoKCRzY29wZS5oZWFsdGh5Tm9kZXMgLyAkc2NvcGUudG90YWxOb2RlcykgKiAxMDApLnRvRml4ZWQoMikgOiAwLjAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubm9kZXNPZmZsaW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9udXREYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ09mZmxpbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubm9kZXNPZmZsaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubm9kZXNQYXVzZWRFcnJvcnMgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb251dERhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnSGlnaCBGYWlsdXJlIFJhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubm9kZXNQYXVzZWRFcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5ub2Rlc1BhdXNlZCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbnV0RGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdQYXVzZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiAkc2NvcGUubm9kZXNQYXVzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm5vZGVzT2ZmbGluZUFuZFBhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9udXREYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ09mZmxpbmUgYW5kIFBhdXNlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6ICRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWRFcnJvcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbnV0RGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdPZmZsaW5lIGFuZCBQYXVzZWQgZHVlIHRvIEVycm9ycycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6ICRzY29wZS5ub2Rlc09mZmxpbmVBbmRQYXVzZWRFcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm5vZGVIZWFsdGggPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYXVnZURhdGE6IGdhdWdlRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbnV0RGF0YTogZG9udXREYXRhXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzVGV4dCAmJiBkYXRhLnN0YXR1c1RleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubm9kZUhlYWx0aEVycm9yU3RhdHVzID0gZGF0YS5zdGF0dXNUZXh0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ub2RlSGVhbHRoRXJyb3IgPSAnVW5hYmxlIHRvIHJldHJpZXZlIG5vZGUgaGVhbHRoLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nTm9kZUhlYWx0aCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZ2V0Tm9kZVN0YXR1cygpO1xuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCd1cGRhdGVOb2RlSGVhbHRoJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZ2V0Tm9kZVN0YXR1cygpO1xuICAgICAgICB9KTtcbiAgICB9KS5kaXJlY3RpdmUoJ2Fpc05vZGVIZWFsdGgnLCBmdW5jdGlvbigpe1xuICAgICAgICAvKipcbiAgICAgICAgICogVXNhZ2U6IDxhaXMtbm9kZS1oZWFsdGggLz5cbiAgICAgICAgICoqL1xuICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICBjb250cm9sbGVyOiAnYWlzTm9kZUhlYWx0aENvbnRyb2xsZXInLFxuICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9ub2Rlcy9kaXJlY3RpdmVzL25vZGVIZWFsdGhUZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAnPScsXG4gICAgICAgICAgICAgICAgIHNob3dEZXNjcmlwdGlvbjogJz0nXG4gICAgICAgICAgICAgfVxuICAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdOb2RlJywgZnVuY3Rpb24gKE5vZGVSZXNvdXJjZXMsIHNjYWxlU2VydmljZSkge1xuICAgICAgICB2YXIgTm9kZSA9IGZ1bmN0aW9uIChpZCwgaG9zdG5hbWUsIHBvcnQsIHNsYXZlX2lkLCBpc19wYXVzZWQsIGlzX3BhdXNlZF9lcnJvcnMsIGlzX2FjdGl2ZSwgYXJjaGl2ZWQsIGNyZWF0ZWQsIGxhc3Rfb2ZmZXIsIGxhc3RfbW9kaWZpZWQsIGpvYl9leGVzX3J1bm5pbmcsIHJlc291cmNlcykge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IGhvc3RuYW1lO1xuICAgICAgICAgICAgdGhpcy5wb3J0ID0gcG9ydDtcbiAgICAgICAgICAgIHRoaXMuc2xhdmVfaWQgPSBzbGF2ZV9pZDtcbiAgICAgICAgICAgIHRoaXMuaXNfcGF1c2VkID0gaXNfcGF1c2VkO1xuICAgICAgICAgICAgdGhpcy5pc19wYXVzZWRfZXJyb3JzID0gaXNfcGF1c2VkX2Vycm9ycztcbiAgICAgICAgICAgIHRoaXMuaXNfYWN0aXZlID0gaXNfYWN0aXZlO1xuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZCA9IGFyY2hpdmVkO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkID0gY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9vZmZlciA9IGxhc3Rfb2ZmZXI7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWQgPSBsYXN0X21vZGlmaWVkO1xuICAgICAgICAgICAgdGhpcy5qb2JfZXhlc19ydW5uaW5nID0gam9iX2V4ZXNfcnVubmluZztcbiAgICAgICAgICAgIHRoaXMucmVzb3VyY2VzID0gTm9kZVJlc291cmNlcy50cmFuc2Zvcm1lcihyZXNvdXJjZXMpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcbiAgICAgICAgTm9kZS5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnTm9kZSc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0RHVyYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUR1cmF0aW9uKHRoaXMuY3JlYXRlZCwgdGhpcy5sYXN0X21vZGlmaWVkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsVGV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgb25seSB1c2VkIHJldmVhbCA9IHRydWUgb24gZ3JpZENoYXJ0IGRpcmVjdGl2ZVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhvc3RuYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldENlbGxUaXRsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhvc3RuYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBOb2RlLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOb2RlKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmhvc3RuYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnBvcnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc2xhdmVfaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfcGF1c2VkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX3BhdXNlZF9lcnJvcnMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmFyY2hpdmVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9vZmZlcixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5sYXN0X21vZGlmaWVkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9leGVzX3J1bm5pbmcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVzb3VyY2VzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgTm9kZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIE5vZGUudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoTm9kZS5idWlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTm9kZS5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gTm9kZTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdOb2RlUmVzb3VyY2VzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIE5vZGVSZXNvdXJjZXMgPSBmdW5jdGlvbiAodG90YWwsIHNjaGVkdWxlZCwgdXNlZCkge1xuICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZWQgPSBzY2hlZHVsZWQ7XG4gICAgICAgICAgICB0aGlzLnVzZWQgPSB1c2VkO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcbiAgICAgICAgTm9kZVJlc291cmNlcy5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICAvLyBnZXREdXJhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUR1cmF0aW9uKHRoaXMuY3JlYXRlZCwgdGhpcy5sYXN0X21vZGlmaWVkKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgTm9kZVJlc291cmNlcy5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTm9kZVJlc291cmNlcyhcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50b3RhbCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zY2hlZHVsZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudXNlZFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5vZGVSZXNvdXJjZXMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBOb2RlUmVzb3VyY2VzLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKE5vZGVSZXNvdXJjZXMuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTm9kZVJlc291cmNlcy5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gTm9kZVJlc291cmNlcztcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnTm9kZVN0YXR1cycsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgbm9kZVVwZGF0ZVNlcnZpY2UsIE5vZGUsIEpvYkV4ZWN1dGlvbikge1xuICAgICAgICB2YXIgTm9kZVN0YXR1cyA9IGZ1bmN0aW9uIChub2RlLCBpc19vbmxpbmUsIGpvYl9leGVfY291bnRzLCBqb2JfZXhlc19ydW5uaW5nKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUgPSBOb2RlLnRyYW5zZm9ybWVyKG5vZGUpO1xuICAgICAgICAgICAgdGhpcy5pc19vbmxpbmUgPSBpc19vbmxpbmU7XG4gICAgICAgICAgICB0aGlzLmpvYl9leGVfY291bnRzID0gam9iX2V4ZV9jb3VudHM7XG4gICAgICAgICAgICB0aGlzLmpvYl9leGVzX3J1bm5pbmcgPSBKb2JFeGVjdXRpb24udHJhbnNmb3JtZXIoam9iX2V4ZXNfcnVubmluZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuICAgICAgICBOb2RlU3RhdHVzLnByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdOb2RlU3RhdHVzJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDb21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVkID0gXy5maW5kKHRoaXMuam9iX2V4ZV9jb3VudHMsICdzdGF0dXMnLCAnQ09NUExFVEVEJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBsZXRlZCA/IGNvbXBsZXRlZC5jb3VudCA6IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0RmFpbGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZhaWxlZCA9IF8uZmluZCh0aGlzLmpvYl9leGVfY291bnRzLCAnc3RhdHVzJywgJ0ZBSUxFRCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsZWQgPyBmYWlsZWQuY291bnQgOiAwO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldENlbGxGaWxsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gJyc7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGUuaXNfcGF1c2VkX2Vycm9ycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfb3JhbmdlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubm9kZS5pc19wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X3llbGxvdztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gc2NhbGVDb25maWcuY29sb3JzLmNoYXJ0X2dyZWVuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBzY2FsZUNvbmZpZy5jb2xvcnMuY2hhcnRfcmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0UnVubmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGNvdW50OiAwIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEVycm9yOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICdGYWlsZWQ6ICcgKyB0aGlzLmdldEZhaWxlZCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldENlbGxUb3RhbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnQ29tcGxldGVkOiAnICsgdGhpcy5nZXRDb21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRDZWxsU3RhdHVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGUuaXNfcGF1c2VkX2Vycm9ycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdIaWdoIEZhaWx1cmUgUmF0ZSc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlLmlzX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdQYXVzZWQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdPbmxpbmUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdPZmZsaW5lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbEpvYnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9ICcnO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCh0aGlzLmpvYl9leGVzX3J1bm5pbmcsIGZ1bmN0aW9uIChqb2JFeGVjdXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGpvYkV4ZWN1dGlvbi5qb2Iuam9iX3R5cGUuaWNvbl9jb2RlID9cbiAgICAgICAgICAgICAgICAgICAgdGV4dCArICcgJyArICcmI3gnICsgam9iRXhlY3V0aW9uLmpvYi5qb2JfdHlwZS5pY29uX2NvZGUgKyAnOycgOlxuICAgICAgICAgICAgICAgICAgICB0ZXh0ICsgJyAnICsgJyYjeCcgKyBzY2FsZUNvbmZpZy5kZWZhdWx0SWNvbkNvZGUgKyAnOyc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Q2VsbFBhdXNlUmVzdW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubm9kZS5pc19wYXVzZWQgPyAnJiN4ZjA0YjsnIDogJyYjeGYwNGM7JztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwYXVzZVJlc3VtZUNlbGw6IGZ1bmN0aW9uIChwYXVzZV9yZWFzb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdG5hbWU6IHRoaXMubm9kZS5ob3N0bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcG9ydDogdGhpcy5ub2RlLnBvcnQsXG4gICAgICAgICAgICAgICAgICAgIHBhdXNlX3JlYXNvbjogcGF1c2VfcmVhc29uIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICBpc19wYXVzZWQ6ICF0aGlzLm5vZGUuaXNfcGF1c2VkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZVVwZGF0ZVNlcnZpY2UudXBkYXRlTm9kZSh0aGlzLm5vZGUuaWQsIHVwZGF0ZURhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZS50cmFuc2Zvcm1lcihyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIE5vZGVTdGF0dXMuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE5vZGVTdGF0dXMoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc19vbmxpbmUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX2V4ZV9jb3VudHMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX2V4ZXNfcnVubmluZ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IE5vZGVTdGF0dXMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBOb2RlU3RhdHVzLnRyYW5zZm9ybWVyID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAubWFwKE5vZGVTdGF0dXMuYnVpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0dXMuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIE5vZGVTdGF0dXM7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5zZXJ2aWNlKCdub2RlU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgJHEsICRyZXNvdXJjZSwgc2NhbGVDb25maWcsIE5vZGUsIE5vZGVTdGF0dXMsIHBvbGxlciwgcG9sbGVyRmFjdG9yeSkge1xuICAgICAgICAvKnZhciB0b3RhbE5vZGVzID0gNTtcblxuICAgICAgICB2YXIgZ2V0VG90YWxOb2RlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0b3RhbE5vZGVzO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBzZXRUb3RhbE5vZGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdG90YWxOb2RlcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgyMCAtIDEgKyAxKSkgKyAxO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNldFRvdGFsTm9kZXMoKTtcbiAgICAgICAgfSwgMzEwMCk7Ki9cblxuICAgICAgICB2YXIgZ2V0Tm9kZVN0YXR1c1BhcmFtcyA9IGZ1bmN0aW9uIChwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge307XG5cbiAgICAgICAgICAgIGlmKHBhZ2UpIHsgcGFyYW1zLnBhZ2UgPSBwYWdlOyB9XG4gICAgICAgICAgICBpZihwYWdlX3NpemUpIHsgcGFyYW1zLnBhZ2Vfc2l6ZSA9IHBhZ2Vfc2l6ZTsgfVxuICAgICAgICAgICAgaWYoc3RhcnRlZCkgeyBwYXJhbXMuc3RhcnRlZCA9IHN0YXJ0ZWQ7IH1cbiAgICAgICAgICAgIGlmKGVuZGVkKSB7IHBhcmFtcy5lbmRlZCA9IGVuZGVkOyB9XG5cbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldE5vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGVzUmVzb3VyY2UgPSAkcmVzb3VyY2Uoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbm9kZXMvJyksXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzUG9sbGVyID0gcG9sbGVyRmFjdG9yeS5uZXdQb2xsZXIobm9kZXNSZXNvdXJjZSwgc2NhbGVDb25maWcucG9sbEludGVydmFscy5ub2Rlcyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZXNQb2xsZXIucHJvbWlzZS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyp2YXIgcmV0dXJuUmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvbHZlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlczogW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBnZXRUb3RhbE5vZGVzKCk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJob3N0bmFtZVwiOiBcIm5vZGVcIiArIGkgKyBcIi5sb2NhbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBvcnRcIjogNTA1MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzbGF2ZV9pZFwiOiBcIjIwMTUwNjE2LTEwMzA1MC0xODAwNDU0NTM2LTUwNTAtNjE5My1TMlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvdGFsX2NwdXNcIjogMi4wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvdGFsX21lbVwiOiA2NzkzLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG90YWxfZGlza1wiOiA5NDYzOS4wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlzX3BhdXNlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkXCI6IFwiMjAxNS0wNi0xNVQxNzoxODo1Mi40MTRaXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFzdF9tb2RpZmllZFwiOiBcIjIwMTUtMDYtMTVUMTc6MTg6NTIuNDE0WlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQubm9kZXMucHVzaChuZXdEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJldHVyblJlc3VsdDsqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBOb2RlLnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1BvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Tm9kZXNPbmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwLmdldChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdub2Rlcy8nKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5EYXRhID0gTm9kZS50cmFuc2Zvcm1lcihkYXRhLm5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHJldHVybkRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXROb2RlOiBmdW5jdGlvbiAoc2xhdmVJZCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbm9kZXMvJyArIHNsYXZlSWQgKyAnLycpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldHVybkRhdGEgPSBOb2RlLnRyYW5zZm9ybWVyKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUocmV0dXJuRGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldE5vZGVTdGF0dXM6IGZ1bmN0aW9uIChwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGdldE5vZGVTdGF0dXNQYXJhbXMocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVN0YXR1c1Jlc291cmNlID0gJHJlc291cmNlKHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ25vZGVzL3N0YXR1cy8nLCBwYXJhbXMpLFxuICAgICAgICAgICAgICAgICAgICBub2RlU3RhdHVzUG9sbGVyID0gcG9sbGVyRmFjdG9yeS5uZXdQb2xsZXIobm9kZVN0YXR1c1Jlc291cmNlLCBzY2FsZUNvbmZpZy5wb2xsSW50ZXJ2YWxzLm5vZGVTdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGVTdGF0dXNQb2xsZXIucHJvbWlzZS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyp2YXIgcmV0dXJuUmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXNvbHZlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX3N0YXRzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdldFRvdGFsTm9kZXMoKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJob3N0bmFtZVwiOiBcIm5vZGVcIiArIGkgKyBcIi5sb2NhbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImpvYnNfY29tcGxldGVkXCI6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAyMCArIDEpKSArIDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN5c3RlbV9mYWlsdXJlc1wiOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoMjAgLSAwICsgMSkpICsgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5SZXN1bHQubm9kZV9zdGF0cy5wdXNoKG5ld0RhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmV0dXJuUmVzdWx0OyovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucmVzdWx0cyA9IE5vZGVTdGF0dXMudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVTdGF0dXNQb2xsZXIuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdldE5vZGVTdGF0dXNPbmNlOiBmdW5jdGlvbiAocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gZ2V0Tm9kZVN0YXR1c1BhcmFtcyhwYWdlLCBwYWdlX3NpemUsIHN0YXJ0ZWQsIGVuZGVkKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbm9kZXMvc3RhdHVzLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBOb2RlU3RhdHVzLnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0Tm9kZURhdGE6IGZ1bmN0aW9uIChzbGF2ZUlkLCBzaW5jZSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge30sXG4gICAgICAgICAgICAgICAgICAgIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgc2luY2UgPSBzaW5jZSB8fCAnUFQzSCc7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXROb2RlcygpLnRoZW4oZnVuY3Rpb24gKG5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZXMgPSBub2RlcztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0Tm9kZVN0YXR1cyhzaW5jZSkudGhlbihmdW5jdGlvbiAoc3RhdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHMgPSBzdGF0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuc2VydmljZSgnbm9kZVVwZGF0ZVNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsICRxLCBzY2FsZUNvbmZpZywgTm9kZSkge1xuICAgICAgICB2YXIgZ2V0Tm9kZVVwZGF0ZURhdGEgPSBmdW5jdGlvbiAoaG9zdG5hbWUsIHBvcnQsIHBhdXNlX3JlYXNvbiwgaXNfcGF1c2VkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGhvc3RuYW1lOiBob3N0bmFtZSxcbiAgICAgICAgICAgICAgICBwb3J0OiBwb3J0LFxuICAgICAgICAgICAgICAgIHBhdXNlX3JlYXNvbjogcGF1c2VfcmVhc29uLFxuICAgICAgICAgICAgICAgIGlzX3BhdXNlZDogaXNfcGF1c2VkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cGRhdGVOb2RlOiBmdW5jdGlvbiAoaWQsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gZGF0YSB8fCBnZXROb2RlVXBkYXRlRGF0YSgpO1xuICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdub2Rlcy8nICsgaWQgKyAnLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoTm9kZS50cmFuc2Zvcm1lcihyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcignb3ZDb250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCBuYXZTZXJ2aWNlLCBub2RlU2VydmljZSwgam9iU2VydmljZSwgam9iVHlwZVNlcnZpY2UsIHN0YXR1c1NlcnZpY2UsIGdhdWdlRmFjdG9yeSwgc2NhbGVDb25maWcsIHNjYWxlU2VydmljZSwgc2NoZWR1bGVyU2VydmljZSwgdXNlclNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAkc2NvcGUuam9iRXJyb3IgPSBudWxsO1xuICAgICAgICAkc2NvcGUuam9iRXJyb3JTdGF0dXMgPSBudWxsO1xuICAgICAgICAkc2NvcGUubG9hZGluZ0pvYnMgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuam9iVHlwZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmhvdXJWYWx1ZSA9IDM7XG4gICAgICAgICRzY29wZS5qb2JEYXRhID0ge1xuICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgIHN0YXR1czogbnVsbFxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuam9iRXJyb3JCcmVha2Rvd24gPSBbXTtcbiAgICAgICAgJHNjb3BlLnN0YXR1cyA9IG51bGw7XG4gICAgICAgICRzY29wZS5sb2FkaW5nU3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLnN0YXR1c0Vycm9yID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnN0YXR1c0Vycm9yU3RhdHVzID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLm1hc3RlclN0YXR1cyA9ICcnO1xuICAgICAgICAkc2NvcGUubWFzdGVyU3RhdHVzQ2xhc3MgPSAnYWxlcnQtc3VjY2Vzcyc7XG4gICAgICAgICRzY29wZS5zY2hlZHVsZXJTdGF0dXMgPSAnJztcbiAgICAgICAgJHNjb3BlLnNjaGVkdWxlclN0YXR1c0NsYXNzID0gJ2FsZXJ0LXN1Y2Nlc3MnO1xuICAgICAgICAkc2NvcGUubWVtQ2FsYyA9ICcnO1xuICAgICAgICAkc2NvcGUuZGlza0NhbGMgPSAnJztcbiAgICAgICAgJHNjb3BlLnNjaGVkdWxlcklzUGF1c2VkID0gZmFsc2U7XG4gICAgICAgICRzY29wZS51c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckNyZWRzKCk7XG4gICAgICAgICRzY29wZS5zY2hlZHVsZXJDb250YWluZXJDbGFzcyA9ICRzY29wZS51c2VyID8gJHNjb3BlLnVzZXIuaXNfYWRtaW4gPyAnY29sLXhzLTggY29sLWxnLTEwJyA6ICdjb2wteHMtMTInIDogJ2NvbC14cy0xMic7XG4gICAgICAgICRzY29wZS5zY2hlZHVsZXJCdG5DbGFzcyA9ICdmYS1wYXVzZSc7XG5cbiAgICAgICAgJHNjb3BlLnRvZ2dsZVNjaGVkdWxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5zY2hlZHVsZXJJc1BhdXNlZCA9ICEkc2NvcGUuc2NoZWR1bGVySXNQYXVzZWQ7XG4gICAgICAgICAgICB2YXIgc2NoZWR1bGVyRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBpc19wYXVzZWQ6ICRzY29wZS5zY2hlZHVsZXJJc1BhdXNlZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNjaGVkdWxlclNlcnZpY2UudXBkYXRlU2NoZWR1bGVyKHNjaGVkdWxlckRhdGEpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVyU3RhdHVzID0gZGF0YS5pc19wYXVzZWQgPyAnUGF1c2VkJyA6ICdSdW5uaW5nJztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVyU3RhdHVzQ2xhc3MgPSBkYXRhLmlzX3BhdXNlZCA/ICdhbGVydC13YXJuaW5nJyA6ICdhbGVydC1zdWNjZXNzJztcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVyQnRuQ2xhc3MgPSBkYXRhLmlzX3BhdXNlZCA/ICdmYS1wbGF5JyA6ICdmYS1wYXVzZSc7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgcmVkcmF3R3JpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdyZWRyYXdHcmlkJywgJHNjb3BlLmpvYkRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzKCkudGhlbihudWxsLCBudWxsLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iRGF0YS5kYXRhID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgICAgICAgICByZWRyYXdHcmlkKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzVGV4dCAmJiBkYXRhLnN0YXR1c1RleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuam9iRXJyb3JTdGF0dXMgPSBkYXRhLnN0YXR1c1RleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmpvYkVycm9yID0gJ1VuYWJsZSB0byByZXRyaWV2ZSBqb2IgdHlwZXMuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZ0pvYnMgPSBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldFN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjcHVHYXVnZSA9IGdhdWdlRmFjdG9yeS5jcmVhdGVHYXVnZSgnY3B1JywgJ0NQVScsIDAsIDEwMCwgMTgwKSxcbiAgICAgICAgICAgICAgICBtZW1HYXVnZSA9IGdhdWdlRmFjdG9yeS5jcmVhdGVHYXVnZSgnbWVtb3J5JywgJ01lbW9yeScsIDAsIDEwMCwgMTgwKSxcbiAgICAgICAgICAgICAgICBkaXNrR2F1Z2UgPSBnYXVnZUZhY3RvcnkuY3JlYXRlR2F1Z2UoJ2Rpc2snLCAnRGlzaycsIDAsIDEwMCwgMTgwKTtcblxuICAgICAgICAgICAgc3RhdHVzU2VydmljZS5nZXRTdGF0dXMoKS50aGVuKG51bGwsIG51bGwsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LiRyZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICBjcHVHYXVnZS5yZWRyYXcocmVzdWx0LmdldENwdVVzYWdlKCkpO1xuICAgICAgICAgICAgICAgICAgICBtZW1HYXVnZS5yZWRyYXcocmVzdWx0LmdldE1lbVVzYWdlKCkpO1xuICAgICAgICAgICAgICAgICAgICBkaXNrR2F1Z2UucmVkcmF3KHJlc3VsdC5nZXREaXNrVXNhZ2UoKSk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tYXN0ZXJTdGF0dXMgPSByZXN1bHQubWFzdGVyLmlzX29ubGluZSA/ICdPbmxpbmUnIDogJ09mZmxpbmUnO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWFzdGVyU3RhdHVzQ2xhc3MgPSByZXN1bHQubWFzdGVyLmlzX29ubGluZSA/ICdhbGVydC1zdWNjZXNzJyA6ICdhbGVydC1kYW5nZXInO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjaGVkdWxlci5pc19vbmxpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2hlZHVsZXJTdGF0dXMgPSByZXN1bHQuc2NoZWR1bGVyLmlzX3BhdXNlZCA/ICdQYXVzZWQnIDogJ1J1bm5pbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjaGVkdWxlclN0YXR1c0NsYXNzID0gcmVzdWx0LnNjaGVkdWxlci5pc19wYXVzZWQgPyAnYWxlcnQtd2FybmluZycgOiAnYWxlcnQtc3VjY2Vzcyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVySXNQYXVzZWQgPSByZXN1bHQuc2NoZWR1bGVyLmlzX3BhdXNlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2hlZHVsZXJCdG5DbGFzcyA9IHJlc3VsdC5zY2hlZHVsZXIuaXNfcGF1c2VkID8gJ2ZhLXBsYXknIDogJ2ZhLXBhdXNlJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2hlZHVsZXJTdGF0dXMgPSByZXN1bHQuc2NoZWR1bGVyLmlzX3BhdXNlZCA/ICdPZmZsaW5lOyBQYXVzZWQnIDogJ09mZmxpbmUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjaGVkdWxlclN0YXR1c0NsYXNzID0gJ2FsZXJ0LWRhbmdlcic7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NoZWR1bGVySXNQYXVzZWQgPSByZXN1bHQuc2NoZWR1bGVyLmlzX3BhdXNlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY2hlZHVsZXJCdG5DbGFzcyA9IHJlc3VsdC5zY2hlZHVsZXIuaXNfcGF1c2VkID8gJ2ZhLXBsYXknIDogJ2ZhLXBhdXNlJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnJlc291cmNlcy5zY2hlZHVsZWQubWVtICYmIHJlc3VsdC5yZXNvdXJjZXMudG90YWwubWVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVtQ2FsYyA9IHNjYWxlU2VydmljZS5jYWxjdWxhdGVGaWxlU2l6ZUZyb21NaWIocmVzdWx0LnJlc291cmNlcy5zY2hlZHVsZWQubWVtKSArICcgLyAnICsgc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUZpbGVTaXplRnJvbU1pYihyZXN1bHQucmVzb3VyY2VzLnRvdGFsLm1lbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5yZXNvdXJjZXMuc2NoZWR1bGVkLmRpc2sgJiYgcmVzdWx0LnJlc291cmNlcy50b3RhbC5kaXNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlza0NhbGMgPSBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tTWliKHJlc3VsdC5yZXNvdXJjZXMuc2NoZWR1bGVkLmRpc2spICsgJyAvICcgKyBzY2FsZVNlcnZpY2UuY2FsY3VsYXRlRmlsZVNpemVGcm9tTWliKHJlc3VsdC5yZXNvdXJjZXMudG90YWwuZGlzayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1c1RleHQgJiYgcmVzdWx0LnN0YXR1c1RleHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzRXJyb3JTdGF0dXMgPSByZXN1bHQuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RhdHVzRXJyb3IgPSAnVW5hYmxlIHRvIHJldHJpZXZlIGNsdXN0ZXIgc3RhdHVzLic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nU3RhdHVzID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLiRvbignam9iVHlwZVN0YXR1cycsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmpvYkRhdGEuc3RhdHVzID0gZGF0YTtcbiAgICAgICAgICAgIHJlZHJhd0dyaWQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBnZXRKb2JUeXBlcygpO1xuICAgICAgICAgICAgZ2V0U3RhdHVzKCk7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdvdmVydmlldycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGluaXRpYWxpemUoKTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLnNlcnZpY2UoJ3dvcmtzcGFjZXNTZXJ2aWNlJywgZnVuY3Rpb24oJGh0dHAsICRxLCAkcmVzb3VyY2UsIHNjYWxlQ29uZmlnKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFdvcmtzcGFjZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3dvcmtzcGFjZXMvJztcblxuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShkYXRhLnJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0vLyxcbiAgICAgICAgICAgIC8vZ2V0V29ya3NwYWNlRGV0YWlsczogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvL31cbiAgICAgICAgfTtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ3JlY2lwZURldGFpbHNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIG5hdlNlcnZpY2UsIHJlY2lwZVNlcnZpY2UsIHNjYWxlQ29uZmlnLCBzdWJuYXZTZXJ2aWNlLCB1c2VyU2VydmljZSkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAkc2NvcGUucmVjaXBlID0ge307XG4gICAgICAgICRzY29wZS5yZWNpcGVJZCA9ICRyb3V0ZVBhcmFtcy5pZDtcbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3MucmVjaXBlcztcbiAgICAgICAgc3VibmF2U2VydmljZS5zZXRDdXJyZW50UGF0aCgncmVjaXBlcycpO1xuICAgICAgICAkc2NvcGUubG9hZGluZ1JlY2lwZURldGFpbCA9IHRydWU7XG4gICAgICAgICRzY29wZS5hY3RpdmVUYWIgPSAnc3RhdHVzJztcbiAgICAgICAgJHNjb3BlLmxhc3RTdGF0dXNDaGFuZ2UgPSAnJztcblxuICAgICAgICBzZWxmLmdldFJlY2lwZURldGFpbCA9IGZ1bmN0aW9uIChyZWNpcGVJZCkge1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdSZWNpcGVEZXRhaWwgPSB0cnVlO1xuICAgICAgICAgICAgcmVjaXBlU2VydmljZS5nZXRSZWNpcGVEZXRhaWxzKHJlY2lwZUlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlY2lwZSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgcmVjaXBlU2VydmljZS5nZXRSZWNpcGVUeXBlRGV0YWlsKGRhdGEucmVjaXBlX3R5cGUuaWQpLnRoZW4oZnVuY3Rpb24ocmVjaXBlVHlwZSl7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlID0gcmVjaXBlVHlwZTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmdSZWNpcGVEZXRhaWwgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNlbGYuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG5hdlNlcnZpY2UudXBkYXRlTG9jYXRpb24oJ3JlY2lwZXMnKTtcbiAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IHVzZXJTZXJ2aWNlLmdldFVzZXJDcmVkcygpO1xuXG4gICAgICAgICAgICBzZWxmLmdldFJlY2lwZURldGFpbCgkc2NvcGUucmVjaXBlSWQpO1xuICAgICAgICB9O1xuXG5cblxuICAgICAgICAkc2NvcGUuc3dpdGNoVGFiID0gZnVuY3Rpb24gKHRhYikge1xuICAgICAgICAgICAgJCgnIycgKyAkc2NvcGUuYWN0aXZlVGFiKS5oaWRlKCk7XG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlVGFiID0gdGFiO1xuICAgICAgICAgICAgJCgnIycgKyAkc2NvcGUuYWN0aXZlVGFiKS5zaG93KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5pbml0aWFsaXplKCk7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcigncmVjaXBlRWRpdG9yQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsICR1aWJNb2RhbCwgbmF2U2VydmljZSwgcmVjaXBlU2VydmljZSwgUmVjaXBlVHlwZSwgc3VibmF2U2VydmljZSwgam9iVHlwZVNlcnZpY2UsIHNjYWxlQ29uZmlnKSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAkc2NvcGUucmVjaXBlcyA9IG51bGw7XG4gICAgICAgICRzY29wZS5yZWNpcGVUeXBlSWQgPSBwYXJzZUludCgkcm91dGVQYXJhbXMuaWQpO1xuXG4gICAgICAgICRzY29wZS5qb2JUeXBlVmFsdWVzID0gW107XG5cbiAgICAgICAgJHNjb3BlLnN1Ym5hdkxpbmtzID0gc2NhbGVDb25maWcuc3VibmF2TGlua3MucmVjaXBlcztcbiAgICAgICAgc3VibmF2U2VydmljZS5zZXRDdXJyZW50UGF0aCgncmVjaXBlcy9idWlsZGVyJyk7XG5cbiAgICAgICAgJHNjb3BlLml0ZW1zID0gWydpdGVtMScsICdpdGVtMicsICdpdGVtMyddO1xuICAgICAgICAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSBudWxsO1xuXG4gICAgICAgIHZhciBnZXRKb2JUeXBlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGpvYlR5cGVTZXJ2aWNlLmdldEpvYlR5cGVzT25jZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcyA9IGRhdGE7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLm9wZW5BZGRKb2IgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FkZEpvYkNvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICBzaXplOiAnc20nXG4gICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICRzY29wZS5hZGRKb2JUeXBlKCRzY29wZS5zZWxlY3RlZEl0ZW0pO1xuICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgfSk7XG4gICAgICAgICB9O1xuXG4gICAgICAgICAkc2NvcGUuYWRkSm9iVHlwZSA9IGZ1bmN0aW9uKHNlbGVjdGVkSm9iVHlwZSl7XG4gICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5hZGRKb2JUeXBlKHNlbGVjdGVkSm9iVHlwZSk7XG4gICAgICAgICAgICAgJHNjb3BlLnJlZHJhd0dyYXBoKCk7XG4gICAgICAgICB9O1xuXG4gICAgICAgICAkc2NvcGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEl0ZW0gPSBpdGVtO1xuICAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZ2V0Sm9iVHlwZXMoKTtcbiAgICAgICAgICAgIG5hdlNlcnZpY2UudXBkYXRlTG9jYXRpb24oJ3JlY2lwZXMnKTtcbiAgICAgICAgICAgIGlmKCRzY29wZS5yZWNpcGVUeXBlSWQpe1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZWNpcGVUeXBlRGV0YWlsKCRzY29wZS5yZWNpcGVUeXBlSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlVHlwZSA9IFJlY2lwZVR5cGUubmV3KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuZ2V0UmVjaXBlVHlwZURldGFpbCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmVjaXBlU2VydmljZS5nZXRSZWNpcGVUeXBlRGV0YWlsKGlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGUgPSBkYXRhO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVkcmF3R3JhcGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZHJhd0dyYXBoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnNhdmVSZWNpcGVUeXBlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucmVjaXBlVHlwZS5uYW1lKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5pdGlhbGl6ZSgpO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcigncmVjaXBlVHlwZXNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sICR1aWJNb2RhbCwgaG90a2V5cywgc2NhbGVTZXJ2aWNlLCBuYXZTZXJ2aWNlLCByZWNpcGVTZXJ2aWNlLCBzdWJuYXZTZXJ2aWNlLCBqb2JUeXBlU2VydmljZSwgc2NhbGVDb25maWcsIFJlY2lwZVR5cGUsIHVzZXJTZXJ2aWNlLCBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuY29udGFpbmVyU3R5bGUgPSAnJztcbiAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGVzID0gW107XG4gICAgICAgICRzY29wZS5yZWNpcGVUeXBlSWRzID0gW107XG4gICAgICAgICRzY29wZS5yZXF1ZXN0ZWRSZWNpcGVUeXBlSWQgPSBwYXJzZUludCgkcm91dGVQYXJhbXMuaWQpO1xuICAgICAgICAkc2NvcGUuYWN0aXZlUmVjaXBlVHlwZSA9IG51bGw7XG4gICAgICAgICRzY29wZS5wZXJjZW50YWdlID0gNzM7XG4gICAgICAgICRzY29wZS5kYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgJHNjb3BlLnJlY2lwZXMgPSBudWxsO1xuICAgICAgICAkc2NvcGUubW9kZSA9ICd2aWV3JzsgLy8gdmFsaWQgdmFsdWVzIGFyZSBhZGQsIHZpZXcsIGFuZCBlZGl0XG4gICAgICAgICRzY29wZS5hZGRCdG5UZXh0ID0gJ05ldyBSZWNpcGUnO1xuICAgICAgICAkc2NvcGUuYWRkQnRuQ2xhc3MgPSAnYnRuLXByaW1hcnknO1xuICAgICAgICAkc2NvcGUuYWRkQnRuSWNvbiA9ICdmYS1wbHVzLWNpcmNsZSc7XG4gICAgICAgICRzY29wZS5lZGl0QnRuVGV4dCA9ICdFZGl0JztcbiAgICAgICAgJHNjb3BlLmVkaXRCdG5DbGFzcyA9ICdidG4tc3VjY2Vzcyc7XG4gICAgICAgICRzY29wZS5lZGl0QnRuSWNvbiA9ICdmYS1lZGl0JztcbiAgICAgICAgJHNjb3BlLmpvYlR5cGVWYWx1ZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLmlzUmVjaXBlTW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgJHNjb3BlLnNhdmVCdG5DbGFzcyA9ICdidG4tZGVmYXVsdCc7XG4gICAgICAgICRzY29wZS5tYXN0ZXJDbGFzcyA9ICdjb2wteHMtMyc7XG4gICAgICAgICRzY29wZS5kZXRhaWxDbGFzcyA9ICdjb2wteHMtOSc7XG4gICAgICAgICRzY29wZS5taW5pbWl6ZU1hc3RlciA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUubWluaW1pemVCdG5DbGFzcyA9ICdmYSBmYS1jaGV2cm9uLWxlZnQnO1xuICAgICAgICAkc2NvcGUudXNlciA9IHVzZXJTZXJ2aWNlLmdldFVzZXJDcmVkcygpO1xuICAgICAgICAkc2NvcGUuc2NhbGVDb25maWcgPSBzY2FsZUNvbmZpZztcbiAgICAgICAgJHNjb3BlLmxvY2FsUmVjaXBlVHlwZXMgPSBbXTtcblxuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5yZWNpcGVzO1xuICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdyZWNpcGVzL3R5cGVzJyk7XG5cbiAgICAgICAgdmFyIGluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdyZWNpcGVzJyk7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSB1c2VyU2VydmljZS5nZXRVc2VyQ3JlZHMoKTtcbiAgICAgICAgICAgIGdldFJlY2lwZVR5cGVzKCk7XG4gICAgICAgICAgICAvL2dldEpvYlR5cGVzKCk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB2YXIgZ2V0UmVjaXBlVHlwZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWNpcGVTZXJ2aWNlLmdldFJlY2lwZVR5cGVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgaWYgKHNjYWxlQ29uZmlnLnN0YXRpYykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBvSnNvbiA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc0tleTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHNLZXkgPSBsb2NhbFN0b3JhZ2Uua2V5KGkpOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9Kc29uW3NLZXldID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc0tleSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXy5maWx0ZXIoXy5wYWlycyhvSnNvbiksIGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5jb250YWlucyhvWzBdLCAncmVjaXBlVHlwZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBKU09OLnBhcnNlKG9bMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2NhbFJlY2lwZVR5cGVzLnB1c2godHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGVzLnB1c2godHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlVHlwZUlkcyA9IF8ucGx1Y2soZGF0YSwgJ2lkJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXdSZWNpcGVUeXBlRGV0YWlsKCRzY29wZS5yZXF1ZXN0ZWRSZWNpcGVUeXBlSWQpO1xuICAgICAgICAgICAgICAgIGhvdGtleXMuYmluZFRvKCRzY29wZSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21ibzogJ2N0cmwrdXAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdQcmV2aW91cyBSZWNpcGUgVHlwZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYWN0aXZlUmVjaXBlVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gXy5pbmRleE9mKCRzY29wZS5yZWNpcGVUeXBlSWRzLCAkc2NvcGUuYWN0aXZlUmVjaXBlVHlwZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZFJlY2lwZVR5cGUoJHNjb3BlLnJlY2lwZVR5cGVJZHNbaWR4IC0gMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KS5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tYm86ICdjdHJsK2Rvd24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdOZXh0IFJlY2lwZSBUeXBlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVSZWNpcGVUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBfLmluZGV4T2YoJHNjb3BlLnJlY2lwZVR5cGVJZHMsICRzY29wZS5hY3RpdmVSZWNpcGVUeXBlLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA8ICgkc2NvcGUucmVjaXBlVHlwZUlkcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRSZWNpcGVUeXBlKCRzY29wZS5yZWNpcGVUeXBlSWRzW2lkeCArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmxvYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5jbGVhckxvY2FsUmVjaXBlVHlwZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLmxvY2FsUmVjaXBlVHlwZXMsIGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3JlY2lwZVR5cGUnICsgdHlwZS5pZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcmVjaXBlcy90eXBlcycpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5uZXdSZWNpcGVUeXBlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcmVjaXBlcy90eXBlcy8wJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnZpZXdSZWNpcGVUeXBlRGV0YWlsID0gZnVuY3Rpb24gKHJlY2lwZVR5cGVJZCkge1xuICAgICAgICAgICAgaWYgKHJlY2lwZVR5cGVJZCA+IDApIHtcbiAgICAgICAgICAgICAgICByZWNpcGVTZXJ2aWNlLmdldFJlY2lwZVR5cGVEZXRhaWwocmVjaXBlVHlwZUlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmVSZWNpcGVUeXBlID0gZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiggcmVjaXBlVHlwZUlkID09PSAwKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjdGl2ZVJlY2lwZVR5cGUgPSBuZXcgUmVjaXBlVHlwZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5sb2FkUmVjaXBlVHlwZSA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVSZWNpcGVUeXBlICYmICRzY29wZS5hY3RpdmVSZWNpcGVUeXBlLm1vZGlmaWVkKSB7XG4gICAgICAgICAgICAgICAgY29uZmlybUNoYW5nZVJlY2lwZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBPS1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3JlY2lwZXMvdHlwZXMvJyArIGlkKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENhbmNlbFxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcmVjaXBlcy90eXBlcy8nICsgaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBjb25maXJtQ2hhbmdlUmVjaXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb25maXJtRGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgICAgICAgICAgc2l6ZTogJ3NtJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBtb2RhbEluc3RhbmNlLnJlc3VsdDtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudG9nZ2xlTWFzdGVyID0gZnVuY3Rpb24gKG1pbmltaXplTWFzdGVyKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIG1pbmltaXplTWFzdGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5taW5pbWl6ZU1hc3RlciA9IG1pbmltaXplTWFzdGVyO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWluaW1pemVNYXN0ZXIgPSAhJHNjb3BlLm1pbmltaXplTWFzdGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLm1hc3RlckNsYXNzID0gJHNjb3BlLm1pbmltaXplTWFzdGVyID8gJ2NvbC14cy0xIG1pbmltaXplZCcgOiAnY29sLXhzLTMnO1xuICAgICAgICAgICAgJHNjb3BlLmRldGFpbENsYXNzID0gJHNjb3BlLm1pbmltaXplTWFzdGVyID8gJ2NvbC14cy0xMScgOiAnY29sLXhzLTknO1xuICAgICAgICAgICAgJHNjb3BlLm1pbmltaXplQnRuQ2xhc3MgPSAkc2NvcGUubWluaW1pemVNYXN0ZXIgPyAnZmEgZmEtY2hldnJvbi1yaWdodCcgOiAnZmEgZmEtY2hldnJvbi1sZWZ0JztcbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLiRvbigndG9nZ2xlRWRpdCcsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZU1hc3RlcihkYXRhID09PSAnZWRpdCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpbml0aWFsaXplKCk7XG5cbiAgICAgICAgJHJvb3RTY29wZS4kb24oJ3JlY2lwZU1vZGlmaWVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmlzUmVjaXBlTW9kaWZpZWQgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLnNhdmVCdG5DbGFzcyA9ICdidG4tc3VjY2Vzcyc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHRzIGVxdWFsIHRvIGF2YWlsYWJsZSBwYWdlIGhlaWdodFxuICAgICAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2NhbGVTZXJ2aWNlLmdldFZpZXdwb3J0U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHNjYWxlQ29uZmlnLmhlYWRlck9mZnNldCxcbiAgICAgICAgICAgICAgICBjb250YWluZXJNYXhIZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgLSBvZmZzZXQ7XG5cbiAgICAgICAgICAgICRzY29wZS5jb250YWluZXJTdHlsZSA9ICdoZWlnaHQ6ICcgKyBjb250YWluZXJNYXhIZWlnaHQgKyAncHg7IG1heC1oZWlnaHQ6ICcgKyBjb250YWluZXJNYXhIZWlnaHQgKyAncHg7JztcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuY29udHJvbGxlcigncmVjaXBlc0NvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24sIHNjYWxlU2VydmljZSwgbmF2U2VydmljZSwgZ3JpZEZhY3RvcnksIHVpR3JpZENvbnN0YW50cywgc2NhbGVDb25maWcsIHN1Ym5hdlNlcnZpY2UsIHJlY2lwZVNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgcmVjaXBlc1BhcmFtcyA9IHtcbiAgICAgICAgICAgIHBhZ2U6IG51bGwsIHBhZ2Vfc2l6ZTogbnVsbCwgc3RhcnRlZDogbnVsbCwgZW5kZWQ6IG51bGwsIG9yZGVyOiAkcm9vdFNjb3BlLnJlY2lwZXNDb250cm9sbGVyT3JkZXIgfHwgbnVsbCwgdHlwZV9pZDogbnVsbCwgdHlwZV9uYW1lOiBudWxsLCB1cmw6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBjaGVjayBmb3IgcmVjaXBlc1BhcmFtcyBpbiBxdWVyeSBzdHJpbmcsIGFuZCB1cGRhdGUgYXMgbmVjZXNzYXJ5XG4gICAgICAgIF8uZm9yRWFjaChfLnBhaXJzKHJlY2lwZXNQYXJhbXMpLCBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IF8uYXQoJGxvY2F0aW9uLnNlYXJjaCgpLCBwYXJhbVswXSk7XG4gICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJlY2lwZXNQYXJhbXNbcGFyYW1bMF1dID0gdmFsdWUubGVuZ3RoID4gMSA/IHZhbHVlIDogdmFsdWVbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBncmlkUGFnZU51bWJlciA9IHJlY2lwZXNQYXJhbXMucGFnZSB8fCAxLFxuICAgICAgICAgICAgZmlsdGVyZWRCeVJlY2lwZVR5cGUgPSByZWNpcGVzUGFyYW1zLnR5cGVfaWQgPyB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgICBmaWx0ZXJlZEJ5T3JkZXIgPSByZWNpcGVzUGFyYW1zLm9yZGVyID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIC8vIHRoaXMgZmlsZSB3aWxsIGJlIHNpbWlsYXIgdG8gam9ic0NvbnRyb2xsZXJcbiAgICAgICAgJHNjb3BlLnJlY2lwZXNEYXRhID0ge307XG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGVWYWx1ZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkUmVjaXBlVHlwZSA9IHJlY2lwZXNQYXJhbXMudHlwZV9pZCB8fCAwO1xuICAgICAgICAkc2NvcGUuc3VibmF2TGlua3MgPSBzY2FsZUNvbmZpZy5zdWJuYXZMaW5rcy5yZWNpcGVzO1xuICAgICAgICAkc2NvcGUuZ3JpZFN0eWxlID0gJyc7XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdGFydCA9IHJlY2lwZXNQYXJhbXMuc3RhcnRlZCA/IG1vbWVudC51dGMocmVjaXBlc1BhcmFtcy5zdGFydGVkKS50b0RhdGUoKSA6IG1vbWVudC51dGMoKS5zdWJ0cmFjdCgxLCAnd2Vla3MnKS5zdGFydE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdGFydFBvcHVwID0ge1xuICAgICAgICAgICAgb3BlbmVkOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUub3Blbkxhc3RNb2RpZmllZFN0YXJ0UG9wdXAgPSBmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RhcnRQb3B1cC5vcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUubGFzdE1vZGlmaWVkU3RvcCA9IHJlY2lwZXNQYXJhbXMuZW5kZWQgPyBtb21lbnQudXRjKHJlY2lwZXNQYXJhbXMuZW5kZWQpLnRvRGF0ZSgpIDogbW9tZW50LnV0YygpLmVuZE9mKCdkJykudG9EYXRlKCk7XG4gICAgICAgICRzY29wZS5sYXN0TW9kaWZpZWRTdG9wUG9wdXAgPSB7XG4gICAgICAgICAgICBvcGVuZWQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5vcGVuTGFzdE1vZGlmaWVkU3RvcFBvcHVwID0gZnVuY3Rpb24gKCRldmVudCkge1xuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgJHNjb3BlLmxhc3RNb2RpZmllZFN0b3BQb3B1cC5vcGVuZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUuZGF0ZU1vZGVsT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHRpbWV6b25lOiAnKzAwMCdcbiAgICAgICAgfTtcblxuICAgICAgICBzdWJuYXZTZXJ2aWNlLnNldEN1cnJlbnRQYXRoKCdyZWNpcGVzJyk7XG5cbiAgICAgICAgdmFyIGRlZmF1bHRDb2x1bW5EZWZzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAncmVjaXBlX3R5cGUnLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnUmVjaXBlIFR5cGUnLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5LnJlY2lwZV90eXBlLnRpdGxlIH19IHt7IHJvdy5lbnRpdHkucmVjaXBlX3R5cGUudmVyc2lvbiB9fTwvZGl2PicsXG4gICAgICAgICAgICAgICAgZmlsdGVySGVhZGVyVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1maWx0ZXItY29udGFpbmVyXCI+PHNlbGVjdCBjbGFzcz1cImZvcm0tY29udHJvbCBpbnB1dC1zbVwiIG5nLW1vZGVsPVwiZ3JpZC5hcHBTY29wZS5zZWxlY3RlZFJlY2lwZVR5cGVcIj48b3B0aW9uIG5nLXNlbGVjdGVkPVwie3sgZ3JpZC5hcHBTY29wZS5yZWNpcGVUeXBlVmFsdWVzWyRpbmRleF0uaWQgPT0gZ3JpZC5hcHBTY29wZS5zZWxlY3RlZFJlY2lwZVR5cGUgfX1cIiB2YWx1ZT1cInt7IGdyaWQuYXBwU2NvcGUucmVjaXBlVHlwZVZhbHVlc1skaW5kZXhdLmlkIH19XCIgbmctcmVwZWF0PVwicmVjaXBlVHlwZSBpbiBncmlkLmFwcFNjb3BlLnJlY2lwZVR5cGVWYWx1ZXMgdHJhY2sgYnkgJGluZGV4XCI+e3sgZ3JpZC5hcHBTY29wZS5yZWNpcGVUeXBlVmFsdWVzWyRpbmRleF0udGl0bGUgfX0ge3sgZ3JpZC5hcHBTY29wZS5yZWNpcGVUeXBlVmFsdWVzWyRpbmRleF0udmVyc2lvbiB9fTwvb3B0aW9uPjwvc2VsZWN0PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvL3sgZmllbGQ6ICdjcmVhdGVkJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSwgY2VsbEZpbHRlcjogJ2RhdGU6XFwneXl5eS1NTS1kZCBISDptbTpzc1xcJyd9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZpZWxkOiAnY3JlYXRlZCcsXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdDcmVhdGVkIChaKScsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBjZWxsVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwidWktZ3JpZC1jZWxsLWNvbnRlbnRzXCI+e3sgcm93LmVudGl0eS5jcmVhdGVkX2Zvcm1hdHRlZCB9fTwvZGl2PidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICdsYXN0X21vZGlmaWVkJyxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0xhc3QgTW9kaWZpZWQgKFopJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5Lmxhc3RfbW9kaWZpZWRfZm9ybWF0dGVkIH19PC9kaXY+J1xuICAgICAgICAgICAgICAgIC8vY2VsbEZpbHRlcjogJ2RhdGU6XFwneXl5eS1NTS1kZCBISDptbTpzc1xcJycsICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2R1cmF0aW9uJyxcbiAgICAgICAgICAgICAgICBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVuYWJsZVNvcnRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxMjAsXG4gICAgICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cInVpLWdyaWQtY2VsbC1jb250ZW50cyB0ZXh0LXJpZ2h0XCI+e3sgcm93LmVudGl0eS5nZXREdXJhdGlvbigpIH19PC9kaXY+J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbmFibGVTb3J0aW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aS1ncmlkLWNlbGwtY29udGVudHNcIj57eyByb3cuZW50aXR5LmNvbXBsZXRlZF9mb3JtYXR0ZWQgfX08L2Rpdj4nXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zID0gZ3JpZEZhY3RvcnkuZGVmYXVsdEdyaWRPcHRpb25zKCk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uQ3VycmVudFBhZ2UgPSBwYXJzZUludChyZWNpcGVzUGFyYW1zLnBhZ2UgfHwgMSk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemUgPSBwYXJzZUludChyZWNpcGVzUGFyYW1zLnBhZ2Vfc2l6ZSkgfHwgJHNjb3BlLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZTtcbiAgICAgICAgdmFyIGNvbERlZnMgPSAkcm9vdFNjb3BlLnJlY2lwZUNvbERlZnMgPyAkcm9vdFNjb3BlLnJlY2lwZUNvbERlZnMgOiBkZWZhdWx0Q29sdW1uRGVmcztcbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmNvbHVtbkRlZnMgPSBncmlkRmFjdG9yeS5hcHBseVNvcnRDb25maWcoY29sRGVmcywgcmVjaXBlc1BhcmFtcyk7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gW107XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5vblJlZ2lzdGVyQXBpID0gZnVuY3Rpb24gKGdyaWRBcGkpIHtcbiAgICAgICAgICAgIC8vc2V0IGdyaWRBcGkgb24gc2NvcGVcbiAgICAgICAgICAgICRzY29wZS5ncmlkQXBpID0gZ3JpZEFwaTtcbiAgICAgICAgICAgICRzY29wZS5ncmlkQXBpLnNlbGVjdGlvbi5vbi5yb3dTZWxlY3Rpb25DaGFuZ2VkKCRzY29wZSwgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9yZWNpcGVzL3JlY2lwZS8nICsgcm93LmVudGl0eS5pZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkucGFnaW5hdGlvbi5vbi5wYWdpbmF0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChjdXJyZW50UGFnZSwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICByZWNpcGVzUGFyYW1zLnBhZ2UgPSBjdXJyZW50UGFnZTtcbiAgICAgICAgICAgICAgICByZWNpcGVzUGFyYW1zLnBhZ2Vfc2l6ZSA9IHBhZ2VTaXplO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdncmlkQXBpJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkuY29yZS5vbi5zb3J0Q2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChncmlkLCBzb3J0Q29sdW1ucykge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUucmVjaXBlQ29sRGVmcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5ncmlkQXBpLmdyaWQuY29sdW1ucywgZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICBjb2wuY29sRGVmLnNvcnQgPSBjb2wuc29ydDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnJlY2lwZUNvbERlZnMgPSAkc2NvcGUuZ3JpZEFwaS5ncmlkLm9wdGlvbnMuY29sdW1uRGVmcztcbiAgICAgICAgICAgICAgICB2YXIgc29ydEFyciA9IFtdO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaChzb3J0Q29sdW1ucywgZnVuY3Rpb24gKGNvbCkge1xuICAgICAgICAgICAgICAgICAgICBzb3J0QXJyLnB1c2goY29sLnNvcnQuZGlyZWN0aW9uID09PSAnZGVzYycgPyAnLScgKyBjb2wuZmllbGQgOiBjb2wuZmllbGQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVJlY2lwZU9yZGVyKHNvcnRBcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmdldFBhZ2UgPSBmdW5jdGlvbiAoZmlsdGVyLCBwYWdlTnVtYmVyLCBwYWdlU2l6ZSwgdXJsKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICByZWNpcGVTZXJ2aWNlLmdldFJlY2lwZXMoZmlsdGVyLCBwYWdlTnVtYmVyLCBwYWdlU2l6ZSwgdXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0RhdGEgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZXN1bHRzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdEYXRhLnB1c2goZGF0YS5yZXN1bHRzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IG5ld0RhdGE7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLnRvdGFsSXRlbXMgPSBkYXRhLmNvdW50O1xuICAgICAgICAgICAgICAgICRzY29wZS5qb2JzRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgZ3JpZFBhZ2VOdW1iZXIgPSBwYWdlTnVtYmVyO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5maWx0ZXJSZXN1bHRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgXy5mb3JFYWNoKF8ucGFpcnMocmVjaXBlc1BhcmFtcyksIGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2gocGFyYW1bMF0sIHBhcmFtWzFdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgZ2V0UmVjaXBlcygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRSZWNpcGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmVjaXBlU2VydmljZS5nZXRSZWNpcGVzKHJlY2lwZXNQYXJhbXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlc0RhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy50b3RhbEl0ZW1zID0gZGF0YS5jb3VudDtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0UmVjaXBlVHlwZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWNpcGVTZXJ2aWNlLmdldFJlY2lwZVR5cGVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlVmFsdWVzID0gZGF0YTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlVHlwZVZhbHVlcy51bnNoaWZ0KHsgbmFtZTogJ1ZJRVcgQUxMJywgdGl0bGU6ICdWSUVXIEFMTCcsIHZlcnNpb246ICcnLCBpZDogMCB9KTtcbiAgICAgICAgICAgICAgICBnZXRSZWNpcGVzKCk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciB1cGRhdGVSZWNpcGVPcmRlciA9IGZ1bmN0aW9uIChzb3J0QXJyKSB7XG4gICAgICAgICAgICByZWNpcGVzUGFyYW1zLm9yZGVyID0gc29ydEFyci5sZW5ndGggPiAwID8gc29ydEFyciA6IG51bGw7XG4gICAgICAgICAgICBmaWx0ZXJlZEJ5T3JkZXIgPSBzb3J0QXJyLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICAkc2NvcGUuZmlsdGVyUmVzdWx0cygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciB1cGRhdGVSZWNpcGVUeXBlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT0gcmVjaXBlc1BhcmFtcy50eXBlX2lkKSB7XG4gICAgICAgICAgICAgICAgcmVjaXBlc1BhcmFtcy5wYWdlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlY2lwZXNQYXJhbXMudHlwZV9pZCA9IHZhbHVlID09IDAgPyBudWxsIDogdmFsdWU7XG4gICAgICAgICAgICByZWNpcGVzUGFyYW1zLnBhZ2Vfc2l6ZSA9ICRzY29wZS5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0ZWRSZWNpcGVUeXBlJyk7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdsYXN0TW9kaWZpZWRTdGFydCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIHJlY2lwZXNQYXJhbXMuc3RhcnRlZCA9IHZhbHVlLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbHRlclJlc3VsdHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnbGFzdE1vZGlmaWVkU3RvcCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUubG9hZGluZykge1xuICAgICAgICAgICAgICAgIHJlY2lwZXNQYXJhbXMuZW5kZWQgPSB2YWx1ZS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgICAgICRzY29wZS5maWx0ZXJSZXN1bHRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3NlbGVjdGVkUmVjaXBlVHlwZScsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkQnlSZWNpcGVUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVJlY2lwZVR5cGUodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRCeVJlY2lwZVR5cGUgPSB2YWx1ZSAhPSAwO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVJlY2lwZVR5cGUodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgJHJvb3RTY29wZS5yZWNpcGVDb2xEZWZzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIC8vIHJvb3QgY29sdW1uIGRlZnMgaGF2ZSBub3QgYmVlbiBhbHRlcmVkIGJ5IHVzZXIsIHNvIHNldCB1cCBkZWZhdWx0c1xuICAgICAgICAgICAgICAgIGlmICghcmVjaXBlc1BhcmFtcy5vcmRlcikge1xuICAgICAgICAgICAgICAgICAgICByZWNpcGVzUGFyYW1zLm9yZGVyID0gJy1sYXN0X21vZGlmaWVkJztcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnb3JkZXInLCByZWNpcGVzUGFyYW1zLm9yZGVyKS5yZXBsYWNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghcmVjaXBlc1BhcmFtcy5wYWdlX3NpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBlc1BhcmFtcy5wYWdlX3NpemUgPSAkc2NvcGUuZ3JpZE9wdGlvbnMucGFnaW5hdGlvblBhZ2VTaXplO1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdwYWdlX3NpemUnLCByZWNpcGVzUGFyYW1zLnBhZ2Vfc2l6ZSkucmVwbGFjZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXJlY2lwZXNQYXJhbXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICByZWNpcGVzUGFyYW1zLnN0YXJ0ZWQgPSBtb21lbnQudXRjKCRzY29wZS5sYXN0TW9kaWZpZWRTdGFydCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnc3RhcnRlZCcsIHJlY2lwZXNQYXJhbXMuc3RhcnRlZCkucmVwbGFjZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXJlY2lwZXNQYXJhbXMuZW5kZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVjaXBlc1BhcmFtcy5lbmRlZCA9IG1vbWVudC51dGMoJHNjb3BlLmxhc3RNb2RpZmllZFN0b3ApLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2VuZGVkJywgcmVjaXBlc1BhcmFtcy5lbmRlZCkucmVwbGFjZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdldFJlY2lwZVR5cGVzKCk7XG4gICAgICAgICAgICBuYXZTZXJ2aWNlLnVwZGF0ZUxvY2F0aW9uKCdyZWNpcGVzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgLy8gc2V0IGNvbnRhaW5lciBoZWlnaHQgZXF1YWwgdG8gYXZhaWxhYmxlIHBhZ2UgaGVpZ2h0XG4gICAgICAgICAgICB2YXIgdmlld3BvcnQgPSBzY2FsZVNlcnZpY2UuZ2V0Vmlld3BvcnRTaXplKCk7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gc2NhbGVDb25maWcuaGVhZGVyT2Zmc2V0ICsgc2NhbGVDb25maWcuZGF0ZUZpbHRlck9mZnNldDtcbiAgICAgICAgICAgIHZhciBncmlkTWF4SGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0IC0gb2Zmc2V0O1xuICAgICAgICAgICAgJHNjb3BlLmdyaWRTdHlsZSA9ICdoZWlnaHQ6ICcgKyBncmlkTWF4SGVpZ2h0ICsgJ3B4OyBtYXgtaGVpZ2h0OiAnICsgZ3JpZE1heEhlaWdodCArICdweDsnO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKCk7XG4iLCIvKipcbiAqIDxhaXMtc2NhbGUtcmVjaXBlLXZpZXdlciAvPlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmNvbnRyb2xsZXIoJ2Fpc1NjYWxlUmVjaXBlR3JhcGhWaWV3ZXJDb250cm9sbGVyJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCAkdWliTW9kYWwsIHNjYWxlQ29uZmlnLCBzY2FsZVNlcnZpY2UsIGpvYlR5cGVTZXJ2aWNlLCByZWNpcGVTZXJ2aWNlLCB3b3Jrc3BhY2VzU2VydmljZSwgUmVjaXBlVHlwZSwgUmVjaXBlVHlwZURldGFpbCwgSm9iVHlwZSwgbG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICRzY29wZS52ZXJ0aWNlcyA9IFtdO1xuICAgICAgICAkc2NvcGUuZWRnZXMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnNlbGVjdGVkSW5wdXRQcm92aWRlciA9IG51bGw7XG4gICAgICAgICRzY29wZS5tb2RlID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmRlcGVuZGVuY3lCdG5DbGFzcyA9ICdmYS1wbHVzJztcbiAgICAgICAgJHNjb3BlLmFkZEJ0blRleHQgPSAnTmV3IFJlY2lwZSc7XG4gICAgICAgICRzY29wZS5hZGRCdG5DbGFzcyA9ICdidG4tcHJpbWFyeSc7XG4gICAgICAgICRzY29wZS5hZGRCdG5JY29uID0gJ2ZhLXBsdXMtY2lyY2xlJztcbiAgICAgICAgJHNjb3BlLmVkaXRCdG5UZXh0ID0gJ0VkaXQnO1xuICAgICAgICAkc2NvcGUuZWRpdEJ0bkNsYXNzID0gJ2J0bi1zdWNjZXNzJztcbiAgICAgICAgJHNjb3BlLmVkaXRCdG5JY29uID0gJ2ZhLWVkaXQnO1xuICAgICAgICAkc2NvcGUuam9iVHlwZVZhbHVlcyA9IFtdO1xuICAgICAgICAkc2NvcGUuc2F2ZUJ0bkNsYXNzID0gJ2J0bi1kZWZhdWx0JztcbiAgICAgICAgJHNjb3BlLnNhdmluZ1JlY2lwZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUud2FybmluZ3MgPSBbXTtcbiAgICAgICAgJHNjb3BlLnJlYWRvbmx5ID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmRldGFpbE1heEhlaWdodCA9IDA7XG4gICAgICAgICRzY29wZS5yZWNpcGVUeXBlVHJpZ2dlciA9IHsgZGF0YVR5cGVzOiAnJyB9O1xuICAgICAgICAkc2NvcGUuZGV0YWlsQ29udGFpbmVyU3R5bGUgPSAnJztcbiAgICAgICAgJHNjb3BlLmNvbnRhaW5lckNsYXNzID0gJHNjb3BlLmhhc0NvbnRhaW5lciA/ICcnIDogJ2RldGFpbC1jb250YWluZXIgbm8tdGFicyc7XG4gICAgICAgICRzY29wZS5sYXN0U3RhdHVzQ2hhbmdlID0gJyc7XG4gICAgICAgICRzY29wZS5hdmFpbGFibGVXb3Jrc3BhY2VzID0gW107XG4gICAgICAgICRzY29wZS5yZWNpcGVJbnB1dFR5cGVzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdwcm9wZXJ0eScsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdQcm9wZXJ0eScsXG4gICAgICAgICAgICAgICAgZmllbGRzOiBbXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnZmlsZScsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdGaWxlJyxcbiAgICAgICAgICAgICAgICBmaWVsZHM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ21lZGlhX3R5cGVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnTWVkaWEgVHlwZXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdmaWxlcycsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdGaWxlcycsXG4gICAgICAgICAgICAgICAgZmllbGRzOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdtZWRpYV90eXBlcycsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ01lZGlhIFR5cGVzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBbXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgICAgICAkc2NvcGUuYXZhaWxhYmxlVHJpZ2dlclR5cGVzID0gc2NhbGVDb25maWcudHJpZ2dlclR5cGVzO1xuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRSZWNpcGVJbnB1dFR5cGUgPSB7fTtcbiAgICAgICAgJHNjb3BlLnJlY2lwZUlucHV0ID0ge1xuICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIHR5cGU6ICcnXG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5pc0lFID0gc2NhbGVTZXJ2aWNlLmlzSUUoKTtcblxuICAgICAgICB2YXIgc3RhcnRKb2IgPSBudWxsO1xuICAgICAgICB2YXIgem9vbVNjYWxlID0gMDtcblxuICAgICAgICAvLyBEYWdyZSB2YXJpYWJsZXNcbiAgICAgICAgdmFyIHN2ZyA9IG51bGw7XG4gICAgICAgIHZhciBpbm5lciA9IG51bGw7XG4gICAgICAgIHZhciBncmFwaCA9IG51bGw7XG4gICAgICAgIHZhciB6b29tID0gbnVsbDtcbiAgICAgICAgdmFyIHJlbmRlciA9IG51bGw7XG5cbiAgICAgICAgdmFyIGdldENsb3Nlc3ROb2RlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBkMy5zZWxlY3RBbGwoJy5ub2RlUmVjdCcpLmZpbHRlcihmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkID09PSBuYW1lO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldE90aGVyTm9kZXMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGQzLnNlbGVjdEFsbCgnLm5vZGVSZWN0JykuZmlsdGVyKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgIT09IG5hbWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgcmVzZXRFZGl0QnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRCdG5UZXh0ID0gJHNjb3BlLm1vZGUgPT09ICdlZGl0JyA/ICdDYW5jZWwgRWRpdCcgOiAnRWRpdCc7XG4gICAgICAgICAgICAkc2NvcGUuZWRpdEJ0bkNsYXNzID0gJHNjb3BlLm1vZGUgPT09ICdlZGl0JyA/ICdidG4td2FybmluZycgOiAnYnRuLXN1Y2Nlc3MnO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRCdG5JY29uID0gJHNjb3BlLm1vZGUgPT09ICdlZGl0JyA/ICdmYS1jbG9zZScgOiAnZmEtZWRpdCc7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHJlc2V0QWRkQnRuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLmFkZEJ0blRleHQgPSAkc2NvcGUubW9kZSA9PT0gJ2FkZCcgPyAnQ2FuY2VsJyA6ICdOZXcgUmVjaXBlJztcbiAgICAgICAgICAgICRzY29wZS5hZGRCdG5DbGFzcyA9ICRzY29wZS5tb2RlID09PSAnYWRkJyA/ICdidG4td2FybmluZycgOiAnYnRuLXByaW1hcnknO1xuICAgICAgICAgICAgJHNjb3BlLmFkZEJ0bkljb24gPSAkc2NvcGUubW9kZSA9PT0gJ2FkZCcgPyAnZmEtY2xvc2UnIDogJ2ZhLXBsdXMtY2lyY2xlJztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgdG9nZ2xlQWRkUmVjaXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLm1vZGUgPSAkc2NvcGUubW9kZSA9PT0gJ2FkZCcgPyAndmlldycgOiAnYWRkJztcbiAgICAgICAgICAgIHJlc2V0QWRkQnRuKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHRvZ2dsZUVkaXRSZWNpcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGUgPT09ICdlZGl0Jykge1xuICAgICAgICAgICAgICAgICRzY29wZS5tb2RlID0gJ3ZpZXcnO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWxvYWRSZWNpcGVUeXBlRGV0YWlsKCRzY29wZS5yZWNpcGVUeXBlLmlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGUgPSAnZWRpdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSAnJztcbiAgICAgICAgICAgIHJlc2V0RWRpdEJ0bigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBlbmFibGVTYXZlUmVjaXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGUubW9kaWZpZWQgPSB0cnVlO1xuICAgICAgICAgICAgLy8kc2NvcGUuc2F2ZUJ0bkNsYXNzID0gJ2J0bi1wcmltYXJ5JztcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGlzYWJsZVNhdmVSZWNpcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUucmVjaXBlVHlwZS5tb2RpZmllZCA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLnNhdmVCdG5DbGFzcyA9ICdidG4tZGVmYXVsdDsnXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGNvbmZpcm1DaGFuZ2VSZWNpcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbmZpcm1EaWFsb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICBzaXplOiAnc20nXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIG1vZGFsSW5zdGFuY2UucmVzdWx0O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXRSZWNpcGVUeXBlSm9iQ2xhc3NOYW1lID0gZnVuY3Rpb24gKGpvYikge1xuICAgICAgICAgICAgLy8gZGVmYXVsdCB0byAnbm9zdGF0dXMnXG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gJ25vc3RhdHVzJztcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGFzc29jaWF0ZWQgam9iIGluIHRoZSByZWNpcGUuam9ic1xuICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVjaXBlam9iID0gXy5maW5kKCRzY29wZS5yZWNpcGUuam9icyx7am9iX25hbWU6IGpvYi5uYW1lfSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlY2lwZWpvYikge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSByZWNpcGVqb2Iuam9iLnN0YXR1cy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjbGFzc05hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnJlbG9hZFJlY2lwZVR5cGVEZXRhaWwgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHZhciBnZXRSZWNpcGVEZXRhaWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmVjaXBlU2VydmljZS5nZXRSZWNpcGVUeXBlRGV0YWlsKGlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlID0gZGF0YTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGVUeXBlLm1vZGlmaWVkKSB7XG4gICAgICAgICAgICAgICAgY29uZmlybUNoYW5nZVJlY2lwZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBPS1xuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlU2F2ZVJlY2lwZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXNldEFkZEJ0bigpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGUgPT09ICdlZGl0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlRWRpdFJlY2lwZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGdldFJlY2lwZURldGFpbCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2FuY2VsXG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb2RlID09PSAnZWRpdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlRWRpdFJlY2lwZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXNldEFkZEJ0bigpO1xuICAgICAgICAgICAgICAgIGdldFJlY2lwZURldGFpbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZWRyYXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpbml0aWFsaXplKCk7XG4gICAgICAgICAgICAvLyRyb290U2NvcGUuJGJyb2FkY2FzdCgncmVjaXBlTW9kaWZpZWQnKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUubm9kZUNsaWNrID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSBzZWxlY3Rpb24gY2xhc3NcbiAgICAgICAgICAgIC8vJCgnZGl2JykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkLW5vZGUnKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLm5vZGVSZWN0JykuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZScsIGZhbHNlKTtcblxuICAgICAgICAgICAgLy8gZmluZCB0aGUgam9iIGluIHRoZSByZWNpcGUgZGVmaW5pdGlvblxuICAgICAgICAgICAgdmFyIGpvYiA9IF8uZmluZCgkc2NvcGUucmVjaXBlVHlwZS5kZWZpbml0aW9uLmpvYnMsIHsgbmFtZTogbmFtZSB9KTtcblxuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzdGFydCcpIHtcbiAgICAgICAgICAgICAgICBqb2IgPSBzdGFydEpvYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciAkbmFtZSA9ICQoJyMnICsgbmFtZSk7XG4gICAgICAgICAgICB2YXIgcG9zID0gJG5hbWUucG9zaXRpb24oKTtcblxuICAgICAgICAgICAgLy8gY2xpY2sgbm9kZSBkaWZmZXJlbnQgZnJvbSBzZWxlY3RlZEpvYlxuICAgICAgICAgICAgaWYgKCEkc2NvcGUuc2VsZWN0ZWRKb2IgfHwgam9iLm5hbWUgIT09ICRzY29wZS5zZWxlY3RlZEpvYi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5lZGl0TW9kZSA9PT0gJ2FkZERlcGVuZGVuY3knKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZERlcGVuZGVuY3kobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZHJhdygpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuZWRpdE1vZGUgPT09ICdhZGRJbnB1dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRTdHIgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpvYi5uYW1lID09PSAnc3RhcnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gJzx1bCBjbGFzcz1cImxpc3QtZ3JvdXBcIj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uaW5wdXRfZGF0YSwgZnVuY3Rpb24gKHJlY2lwZUlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPGxpIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtXCI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gY29udGVudFN0ciArICc8YSBvbmNsaWNrPVwibWFwSW5wdXRSZWNpcGVJbnB1dChcXCcnICsgcmVjaXBlSW5wdXQubmFtZSArICdcXCcpXCI+JyArIHJlY2lwZUlucHV0Lm5hbWUgKyAnPC9hPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY2lwZUlucHV0Lm1lZGlhX3R5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdHIgPSBjb250ZW50U3RyICsgJzxkaXYgY2xhc3M9XCJpbnB1dC1tZWRpYS10eXBlc1wiPicgKyByZWNpcGVJbnB1dC5tZWRpYV90eXBlcy5qb2luKCcsJykgKyAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPC9saT4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gY29udGVudFN0ciArICc8L3VsPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbmFtZS5wb3BvdmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6ICdib2R5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50U3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdTZWxlY3QgcHJvdmlkZXIvb3V0cHV0J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbmFtZS5wb3BvdmVyKCdzaG93Jyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoam9iLmpvYl90eXBlLmpvYl90eXBlX2ludGVyZmFjZS5vdXRwdXRfZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9ICc8dWwgY2xhc3M9XCJsaXN0LWdyb3VwXCI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goam9iLmpvYl90eXBlLmpvYl90eXBlX2ludGVyZmFjZS5vdXRwdXRfZGF0YSwgZnVuY3Rpb24gKGpvYk91dHB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gY29udGVudFN0ciArICc8bGkgY2xhc3M9XCJsaXN0LWdyb3VwLWl0ZW1cIj4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gY29udGVudFN0ciArICc8YSBvbmNsaWNrPVwibWFwSW5wdXQoXFwnJyArIGpvYi5uYW1lICsgJ1xcJywgXFwnJyArIGpvYk91dHB1dC5uYW1lICsgJ1xcJylcIj4nICsgam9iT3V0cHV0Lm5hbWUgKyAnPC9hPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqb2JPdXRwdXQubWVkaWFfdHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPGRpdiBjbGFzcz1cImlucHV0LW1lZGlhLXR5cGVzXCI+JyArIGpvYk91dHB1dC5tZWRpYV90eXBlICsgJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPC9saT4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdHIgPSBjb250ZW50U3RyICsgJzwvdWw+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbmFtZS5wb3BvdmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiAnYm9keScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnRTdHIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnU2VsZWN0IHByb3ZpZGVyL291dHB1dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbmFtZS5wb3BvdmVyKCdzaG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5lZGl0TW9kZSA9PT0gJ2FkZE91dHB1dCcpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3V0cHV0UmVjZWl2ZXIgPSBqb2I7XG4gICAgICAgICAgICAgICAgICAgIGlmIChqb2Iuam9iX3R5cGUuam9iX3R5cGVfaW50ZXJmYWNlLmlucHV0X2RhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9ICc8dWwgY2xhc3M9XCJsaXN0LWdyb3VwXCI+JztcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChqb2Iuam9iX3R5cGUuam9iX3R5cGVfaW50ZXJmYWNlLmlucHV0X2RhdGEsIGZ1bmN0aW9uIChqb2JJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdHIgPSBjb250ZW50U3RyICsgJzxsaSBjbGFzcz1cImxpc3QtZ3JvdXAtaXRlbVwiPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPGEgb25jbGljaz1cIm1hcE91dHB1dChcXCcnICsgam9iLm5hbWUgKyAnXFwnLCBcXCcnICsgam9iSW5wdXQubmFtZSArICdcXCcpXCI+JyArIGpvYklucHV0Lm5hbWUgKyAnPC9hPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpvYklucHV0Lm1lZGlhX3R5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRTdHIgPSBjb250ZW50U3RyICsgJzxkaXYgY2xhc3M9XCJpbnB1dC1tZWRpYS10eXBlc1wiPicgKyBqb2JJbnB1dC5tZWRpYV90eXBlcy5qb2luKCcsJykgKyAnPC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFN0ciA9IGNvbnRlbnRTdHIgKyAnPC9saT4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50U3RyID0gY29udGVudFN0ciArICc8L3VsPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbmFtZS5wb3BvdmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXI6ICdib2R5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50U3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdTZWxlY3QgcmVjZWl2ZXIvaW5wdXQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRuYW1lLnBvcG92ZXIoJ3Nob3cnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgc2VsZWN0ZWQgam9iXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYiA9IGpvYjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFJlY2lwZUpvYiA9IF8uZmluZCgkc2NvcGUucmVjaXBlLmpvYnMsIHsgam9iX25hbWU6IGpvYi5uYW1lIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IHRoZSBzZWxlY3RlZC1ub2RlIGNsYXNzXG4gICAgICAgICAgICAgICAgICAgIC8vJG5hbWUuYWRkQ2xhc3MoJ3NlbGVjdGVkLW5vZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q2xvc2VzdE5vZGUobmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZScsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgeyAvLyBjbGljayBzZWxlY3RlZCBub2RlXG4gICAgICAgICAgICAgICAgLy8kKCdkaXYnKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQtbm9kZScpO1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLm5vZGVSZWN0JykuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRKb2IgPSBudWxsO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFJlY2lwZUpvYiA9IG51bGw7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3V0cHV0UmVjZWl2ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZElucHV0UHJvdmlkZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICcnO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZXBlbmRlbmN5QnRuQ2xhc3MgPSAnZmEtcGx1cyc7XG5cbiAgICAgICAgICAgICAgICAvLyQoJy5yZWNpcGVOb2RlOm5vdChcIi5zZWxlY3RlZC1ub2RlXCIpJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkLW5vZGUtc2VsZWN0YWJsZScpO1xuICAgICAgICAgICAgICAgIGdldE90aGVyTm9kZXMobmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZS1zZWxlY3RhYmxlJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZEpvYikge1xuICAgICAgICAgICAgICAgIC8vJCgnIycgKyAkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSkuYWRkQ2xhc3MoJ3NlbGVjdGVkLW5vZGUnKTtcbiAgICAgICAgICAgICAgICBnZXRDbG9zZXN0Tm9kZSgkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZScsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUudG9nZ2xlRWRpdE1vZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGUgPT09ICdlZGl0Jykge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWxvYWRSZWNpcGVUeXBlRGV0YWlsKCRzY29wZS5yZWNpcGVUeXBlLmlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdG9nZ2xlRWRpdFJlY2lwZSgpO1xuICAgICAgICAgICAgICAgIHJlc2V0QWRkQnRuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3RvZ2dsZUVkaXQnLCAkc2NvcGUubW9kZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLm9wZW5BZGRKb2IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICR1aWJNb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb246ICRzY29wZS5hbmltYXRpb25zRW5hYmxlZCxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FkZEpvYkNvbnRlbnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICBzaXplOiAnc20nXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZEpvYlR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgam9iVHlwZVNlcnZpY2UuZ2V0Sm9iVHlwZURldGFpbHMoJHNjb3BlLnNlbGVjdGVkSm9iVHlwZS5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFkZEpvYlR5cGUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVTYXZlUmVjaXBlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLm9wZW5FZGl0VHJpZ2dlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogJHNjb3BlLmFuaW1hdGlvbnNFbmFibGVkLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZWRpdFRyaWdnZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgc2NvcGU6ICRzY29wZSxcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb2RlID09PSAnZWRpdCcgfHwgJHNjb3BlLm1vZGUgPT09ICdhZGQnKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlLnRyaWdnZXJfcnVsZS5jb25maWd1cmF0aW9uLmNvbmRpdGlvbi5kYXRhX3R5cGVzID0gJHNjb3BlLnJlY2lwZVR5cGVUcmlnZ2VyLmRhdGFUeXBlcyA/ICRzY29wZS5yZWNpcGVUeXBlVHJpZ2dlci5kYXRhVHlwZXMuc3BsaXQoJywnKSA6IFtdO1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVTYXZlUmVjaXBlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmRlbGV0ZVJlY2lwZUlucHV0ID0gZnVuY3Rpb24gKGlucHV0TmFtZSkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZWRSZWNpcGVJbnB1dCA9IF8ucmVtb3ZlKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uaW5wdXRfZGF0YSwgZnVuY3Rpb24gKHJlY2lwZUlucHV0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY2lwZUlucHV0Lm5hbWUgPT09IGlucHV0TmFtZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbW92ZWQgJyArIHJlbW92ZWRSZWNpcGVJbnB1dC5sZW5ndGggKyAnIHJlY2lwZSBpbnB1dHMuJyk7XG4gICAgICAgICAgICBlbmFibGVTYXZlUmVjaXBlKCk7XG4gICAgICAgICAgICAkc2NvcGUucmVkcmF3KCk7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUub3BlbkFkZElucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkdWliTW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uOiAkc2NvcGUuYW5pbWF0aW9uc0VuYWJsZWQsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhZGRJbnB1dC5odG1sJyxcbiAgICAgICAgICAgICAgICBzY29wZTogJHNjb3BlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGZpZWxkcyBhbmQgYWRkIGFzIG5lY2Vzc2FyeVxuICAgICAgICAgICAgICAgIGlmICggJHNjb3BlLnNlbGVjdGVkUmVjaXBlSW5wdXRUeXBlLmZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZEFyciA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLnNlbGVjdGVkUmVjaXBlSW5wdXRUeXBlLmZpZWxkcywgZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goZmllbGQudmFsdWUuc3BsaXQoJywnKSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRBcnIucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVJbnB1dFtmaWVsZC5uYW1lXSA9IGZpZWxkQXJyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhZGQgaW5wdXQgdG8gcmVjaXBlIHR5cGUgZGVmaW5pdGlvblxuICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uaW5wdXRfZGF0YS5wdXNoKCRzY29wZS5yZWNpcGVJbnB1dCk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uam9icywgZnVuY3Rpb24gKGpvYikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoam9iLnJlY2lwZV9pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBqb2IucmVjaXBlX2lucHV0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2JfaW5wdXQ6ICRzY29wZS5yZWNpcGVJbnB1dC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwZV9pbnB1dDogJHNjb3BlLnJlY2lwZUlucHV0Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZ2V0SW9NYXBwaW5ncygpO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgZm9ybSBmaWVsZHNcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlSW5wdXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJydcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFJlY2lwZUlucHV0VHlwZSA9IHt9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNoYW5nZUlucHV0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZFJlY2lwZUlucHV0VHlwZSA9IF8uZmluZCgkc2NvcGUucmVjaXBlSW5wdXRUeXBlcywgeyduYW1lJzogJHNjb3BlLnJlY2lwZUlucHV0LnR5cGV9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0V2FybmluZ3NIdG1sID0gZnVuY3Rpb24gKHdhcm5pbmdzKSB7XG4gICAgICAgICAgICB2YXIgd2FybmluZ3NIdG1sID0gJyc7XG4gICAgICAgICAgICBfLmZvckVhY2god2FybmluZ3MsIGZ1bmN0aW9uICh3YXJuaW5nKSB7XG4gICAgICAgICAgICAgICAgd2FybmluZ3NIdG1sICs9ICc8Yj4nICsgd2FybmluZy5pZCArICc6PC9iPiAnICsgd2FybmluZy5kZXRhaWxzICsgJzxiciAvPjxiciAvPic7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHdhcm5pbmdzSHRtbCArPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRlZmF1bHQgYnRuLXhzIGNsZWFyXCI+SGlkZTwvYnV0dG9uPic7XG4gICAgICAgICAgICByZXR1cm4gd2FybmluZ3NIdG1sO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS52YWxpZGF0ZVJlY2lwZVR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWNpcGVTZXJ2aWNlLnZhbGlkYXRlUmVjaXBlVHlwZSgkc2NvcGUucmVjaXBlVHlwZSkudGhlbihmdW5jdGlvbiAodmFsaWRhdGlvblJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uUmVzdWx0Lndhcm5pbmdzICYmIHZhbGlkYXRpb25SZXN1bHQud2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkaXNwbGF5IHRoZSB3YXJuaW5nc1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2FybmluZ3NIdG1sID0gZ2V0V2FybmluZ3NIdG1sKHZhbGlkYXRpb25SZXN1bHQud2FybmluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHJbXCJlcnJvclwiXSh3YXJuaW5nc0h0bWwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0cltcInN1Y2Nlc3NcIl0oJ1JlY2lwZSBpcyB2YWxpZC4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IuZGV0YWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0cltcImVycm9yXCJdKGVycm9yLmRldGFpbCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyW1wiZXJyb3JcIl0oZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuc2F2ZVJlY2lwZVR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2F2aW5nUmVjaXBlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlY2lwZVNlcnZpY2UudmFsaWRhdGVSZWNpcGVUeXBlKCRzY29wZS5yZWNpcGVUeXBlKS50aGVuKGZ1bmN0aW9uICh2YWxpZGF0aW9uUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRpb25SZXN1bHQud2FybmluZ3MgJiYgdmFsaWRhdGlvblJlc3VsdC53YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgdGhlIHdhcm5pbmdzXG4gICAgICAgICAgICAgICAgICAgIHZhciB3YXJuaW5nc0h0bWwgPSBnZXRXYXJuaW5nc0h0bWwodmFsaWRhdGlvblJlc3VsdC53YXJuaW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0cltcImVycm9yXCJdKHdhcm5pbmdzSHRtbCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zYXZpbmdSZWNpcGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWNpcGVTZXJ2aWNlLnNhdmVSZWNpcGVUeXBlKCRzY29wZS5yZWNpcGVUeXBlKS50aGVuKGZ1bmN0aW9uIChzYXZlUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2F2aW5nUmVjaXBlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVjaXBlVHlwZSA9IFJlY2lwZVR5cGVEZXRhaWwudHJhbnNmb3JtZXIoc2F2ZVJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NhbGVDb25maWcuc3RhdGljKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoJHNjb3BlLnJlY2lwZVR5cGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVjaXBlVHlwZScgKyAkc2NvcGUucmVjaXBlVHlwZS5pZCwgSlNPTi5zdHJpbmdpZnkoJHNjb3BlLnJlY2lwZVR5cGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcmVjaXBlcy90eXBlcy8nICsgJHNjb3BlLnJlY2lwZVR5cGUuaWQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IuZGV0YWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0clsnZXJyb3InXShlcnJvci5kZXRhaWwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0clsnZXJyb3InXShlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICRzY29wZS5zYXZpbmdSZWNpcGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkaXNhYmxlU2F2ZVJlY2lwZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5hZGRKb2JUeXBlID0gZnVuY3Rpb24gKHNlbGVjdGVkSm9iVHlwZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRKb2JUeXBlLm5hbWUpO1xuICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5hZGRKb2Ioc2VsZWN0ZWRKb2JUeXBlKTtcbiAgICAgICAgICAgIC8vJHNjb3BlLiRicm9hZGNhc3QoJ3JlZHJhd1JlY2lwZXMnKTtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUubWFwSW5wdXQgPSBmdW5jdGlvbiAocHJvdmlkZXJOYW1lLCBwcm92aWRlck91dHB1dCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ21hcCBzZWxlY3RlZCBqb2IgaW5wdXQgdG8gJyArIHByb3ZpZGVyTmFtZSArICcuJyArIHByb3ZpZGVyT3V0cHV0KTtcbiAgICAgICAgICAgIHZhciBkZXBlbmRlbmN5ID0gXy5maW5kKCRzY29wZS5zZWxlY3RlZEpvYi5kZXBlbmRlbmNpZXMsIHtuYW1lOiBwcm92aWRlck5hbWV9KTtcblxuICAgICAgICAgICAgaWYgKGRlcGVuZGVuY3kgJiYgZGVwZW5kZW5jeS5jb25uZWN0aW9ucyAmJiBkZXBlbmRlbmN5LmNvbm5lY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgY29ubiA9IF8uZmluZChkZXBlbmRlbmN5LmNvbm5lY3Rpb25zLCB7IG91dHB1dDogcHJvdmlkZXJPdXRwdXQsIGlucHV0OiAkc2NvcGUuc2VsZWN0ZWRKb2JJbnB1dC5uYW1lIH0pO1xuICAgICAgICAgICAgICAgIGlmICghY29ubikge1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRlbmN5LmNvbm5lY3Rpb25zLnB1c2goeyBvdXRwdXQ6IHByb3ZpZGVyT3V0cHV0LCBpbnB1dDogJHNjb3BlLnNlbGVjdGVkSm9iSW5wdXQubmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghZGVwZW5kZW5jeSkge1xuICAgICAgICAgICAgICAgIGRlcGVuZGVuY3kgPSB7bmFtZTogcHJvdmlkZXJOYW1lLCBjb25uZWN0aW9uczogW3sgb3V0cHV0OiBwcm92aWRlck91dHB1dCwgaW5wdXQ6ICRzY29wZS5zZWxlY3RlZEpvYklucHV0Lm5hbWUgfV19O1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYi5kZXBlbmRlbmNpZXMucHVzaChkZXBlbmRlbmN5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlcGVuZGVuY3kuY29ubmVjdGlvbnMgPSBbeyBvdXRwdXQ6IHByb3ZpZGVyT3V0cHV0LCBpbnB1dDogJHNjb3BlLnNlbGVjdGVkSm9iSW5wdXQubmFtZSB9XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYi5kZXBTdGFydCA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gJyc7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRKb2JJbnB1dCA9IG51bGw7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRJbnB1dFByb3ZpZGVyID0gbnVsbDtcbiAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUubWFwSW5wdXRSZWNpcGVJbnB1dCA9IGZ1bmN0aW9uIChyZWNpcGVJbnB1dCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ21hcCBzZWxlY3RlZCBqb2IgdG8gcmVjaXBlIGlucHV0ICcgKyByZWNpcGVJbnB1dCk7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdJbnB1dCA9IF8uZmluZCgkc2NvcGUuc2VsZWN0ZWRKb2IucmVjaXBlX2lucHV0cywgeyBqb2JfaW5wdXQ6ICRzY29wZS5zZWxlY3RlZEpvYklucHV0Lm5hbWUgfSk7XG4gICAgICAgICAgICBpZiAoIGV4aXN0aW5nSW5wdXQgJiYgZXhpc3RpbmdJbnB1dC5yZWNpcGVfbmFtZSAhPT0gcmVjaXBlSW5wdXQpIHtcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgaXRcbiAgICAgICAgICAgICAgICBleGlzdGluZ0lucHV0LnJlY2lwZV9pbnB1dCA9IHJlY2lwZUlucHV0O1xuICAgICAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVkcmF3KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCAhZXhpc3RpbmdJbnB1dCApIHtcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgaXRcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRKb2IucmVjaXBlX2lucHV0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgam9iX2lucHV0OiAkc2NvcGUuc2VsZWN0ZWRKb2JJbnB1dC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICByZWNpcGVfaW5wdXQ6IHJlY2lwZUlucHV0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZW5hYmxlU2F2ZVJlY2lwZSgpO1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICcnO1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iSW5wdXQgPSBudWxsO1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkSW5wdXRQcm92aWRlciA9IG51bGw7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLm1hcE91dHB1dCA9IGZ1bmN0aW9uIChyZWNlaXZlck5hbWUsIHJlY2VpdmVySW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBkZXBlbmRlbmN5ID0gXy5maW5kKCRzY29wZS5zZWxlY3RlZE91dHB1dFJlY2VpdmVyLmRlcGVuZGVuY2llcywge25hbWU6ICRzY29wZS5zZWxlY3RlZEpvYi5uYW1lfSk7XG5cbiAgICAgICAgICAgIGlmIChkZXBlbmRlbmN5ICYmIGRlcGVuZGVuY3kuY29ubmVjdGlvbnMgJiYgZGVwZW5kZW5jeS5jb25uZWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbm4gPSBfLmZpbmQoZGVwZW5kZW5jeS5jb25uZWN0aW9ucywgeyBvdXRwdXQ6ICRzY29wZS5zZWxlY3RlZEpvYk91dHB1dC5uYW1lLCBpbnB1dDogcmVjZWl2ZXJJbnB1dCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbm4pIHtcbiAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jeS5jb25uZWN0aW9ucy5wdXNoKHtvdXRwdXQ6ICRzY29wZS5zZWxlY3RlZEpvYk91dHB1dC5uYW1lLCBpbnB1dDogcmVjZWl2ZXJJbnB1dH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFkZXBlbmRlbmN5KSB7XG4gICAgICAgICAgICAgICAgZGVwZW5kZW5jeSA9IHtuYW1lOiAkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSwgY29ubmVjdGlvbnM6IFt7b3V0cHV0OiAkc2NvcGUuc2VsZWN0ZWRKb2JPdXRwdXQubmFtZSwgaW5wdXQ6IHJlY2VpdmVySW5wdXR9XX07XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3V0cHV0UmVjZWl2ZXIuZGVwZW5kZW5jaWVzLnB1c2goZGVwZW5kZW5jeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZXBlbmRlbmN5LmNvbm5lY3Rpb25zID0gW3tvdXRwdXQ6ICRzY29wZS5zZWxlY3RlZEpvYk91dHB1dC5uYW1lLCBpbnB1dDogcmVjZWl2ZXJJbnB1dH1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkT3V0cHV0UmVjZWl2ZXIuZGVwU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICcnO1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iT3V0cHV0ID0gbnVsbDtcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZE91dHB1dFJlY2VpdmVyID0gbnVsbDtcbiAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudG9nZ2xlQWRkRGVwZW5kZW5jeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICgkc2NvcGUuZWRpdE1vZGUgPT09ICdhZGREZXBlbmRlbmN5Jykge1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICcnO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZXBlbmRlbmN5QnRuQ2xhc3MgPSAnZmEtcGx1cyc7XG4gICAgICAgICAgICAgICAgZ2V0T3RoZXJOb2Rlcygkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZS1zZWxlY3RhYmxlJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIC8vJCgnLnJlY2lwZU5vZGU6bm90KFwiLnNlbGVjdGVkLW5vZGVcIiknKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQtbm9kZS1zZWxlY3RhYmxlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0b2dnbGUgYWRkRGVwZW5kZW5jeSBtb2RlJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gJ2FkZERlcGVuZGVuY3knO1xuICAgICAgICAgICAgICAgICRzY29wZS5kZXBlbmRlbmN5QnRuQ2xhc3MgPSAnZmEtcmVtb3ZlJztcbiAgICAgICAgICAgICAgICBnZXRPdGhlck5vZGVzKCRzY29wZS5zZWxlY3RlZEpvYi5uYW1lKS5jbGFzc2VkKCdzZWxlY3RlZC1ub2RlLXNlbGVjdGFibGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAvLyQoJy5yZWNpcGVOb2RlOm5vdChcIi5zZWxlY3RlZC1ub2RlXCIpJykuYWRkQ2xhc3MoJ3NlbGVjdGVkLW5vZGUtc2VsZWN0YWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS50b2dnbGVBZGRJbnB1dCA9IGZ1bmN0aW9uIChqb2JpbnB1dCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5lZGl0TW9kZSA9PT0gJ2FkZElucHV0Jykge1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICcnO1xuICAgICAgICAgICAgICAgIGdldE90aGVyTm9kZXMoJHNjb3BlLnNlbGVjdGVkSm9iLm5hbWUpLmNsYXNzZWQoJ3NlbGVjdGVkLW5vZGUtc2VsZWN0YWJsZScsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAvLyQoJy5yZWNpcGVOb2RlOm5vdChcIi5zZWxlY3RlZC1ub2RlXCIpJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkLW5vZGUtc2VsZWN0YWJsZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRKb2JJbnB1dCA9IGpvYmlucHV0O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0b2dnbGUgYWRkSW5wdXQgbW9kZScpO1xuICAgICAgICAgICAgICAgICRzY29wZS5lZGl0TW9kZSA9ICdhZGRJbnB1dCc7XG4gICAgICAgICAgICAgICAgZ2V0T3RoZXJOb2Rlcygkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZS1zZWxlY3RhYmxlJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgLy8kKCcucmVjaXBlTm9kZTpub3QoXCIuc2VsZWN0ZWQtbm9kZVwiKScpLmFkZENsYXNzKCdzZWxlY3RlZC1ub2RlLXNlbGVjdGFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudG9nZ2xlQWRkT3V0cHV0ID0gZnVuY3Rpb24gKGpvYm91dHB1dCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5lZGl0TW9kZSA9PT0gJ2FkZE91dHB1dCcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSAnJztcbiAgICAgICAgICAgICAgICBnZXRPdGhlck5vZGVzKCRzY29wZS5zZWxlY3RlZEpvYi5uYW1lKS5jbGFzc2VkKCdzZWxlY3RlZC1ub2RlLXNlbGVjdGFibGUnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgLy8kKCcucmVjaXBlTm9kZTpub3QoXCIuc2VsZWN0ZWQtbm9kZVwiKScpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZC1ub2RlLXNlbGVjdGFibGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iT3V0cHV0ID0gam9ib3V0cHV0O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0b2dnbGUgYWRkT3V0cHV0IG1vZGUnKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSAnYWRkT3V0cHV0JztcbiAgICAgICAgICAgICAgICBnZXRPdGhlck5vZGVzKCRzY29wZS5zZWxlY3RlZEpvYi5uYW1lKS5jbGFzc2VkKCdzZWxlY3RlZC1ub2RlLXNlbGVjdGFibGUnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAvLyQoJy5yZWNpcGVOb2RlOm5vdChcIi5zZWxlY3RlZC1ub2RlXCIpJykuYWRkQ2xhc3MoJ3NlbGVjdGVkLW5vZGUtc2VsZWN0YWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZW1vdmVEZXBlbmRlbmN5ID0gZnVuY3Rpb24gKGRlcE5hbWUpIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVkRGVwcyA9IF8ucmVtb3ZlKCRzY29wZS5zZWxlY3RlZEpvYi5kZXBlbmRlbmNpZXMsIGZ1bmN0aW9uIChkZXApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVwLm5hbWUgPT09IGRlcE5hbWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmVkICcgKyByZW1vdmVkRGVwcy5sZW5ndGggKyAnIGRlcGVuZGVuY2llcy4nKTtcbiAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUucmVtb3ZlSW5wdXRNYXBwaW5nID0gZnVuY3Rpb24gKGRlcE5hbWUsIGRlcE91dHB1dCkge1xuICAgICAgICAgICAgaWYgKCBkZXBOYW1lID09PSAncmVjaXBlJyApIHtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgaXQgZnJvbSBzZWxlY3RlZEpvYi5yZWNpcGVfaW5wdXRzXG4gICAgICAgICAgICAgICAgdmFyIGRlcCA9IF8ucmVtb3ZlKCRzY29wZS5zZWxlY3RlZEpvYi5yZWNpcGVfaW5wdXRzLCB7IHJlY2lwZV9pbnB1dDogZGVwT3V0cHV0IH0pO1xuICAgICAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVkcmF3KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBkZXAgPSBfLmZpbmQoJHNjb3BlLnNlbGVjdGVkSm9iLmRlcGVuZGVuY2llcywge25hbWU6IGRlcE5hbWV9KTtcbiAgICAgICAgICAgICAgICBpZiAoZGVwICYmIGRlcC5jb25uZWN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAvLyBpdCdzIGFuIGlucHV0IGZyb20gYW5vdGhlciBqb2JcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW92ZWRDb24gPSBfLnJlbW92ZShkZXAuY29ubmVjdGlvbnMsIGZ1bmN0aW9uIChjb25uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29ubi5vdXRwdXQgPT09IGRlcE91dHB1dDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmVkICcgKyByZW1vdmVkQ29uLmxlbmd0aCArICcgaW5wdXQgY29ubmVjdGlvbnMuJyk7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlZHJhdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5kZWxldGVSZWNpcGVKb2IgPSBmdW5jdGlvbiAoam9iTmFtZSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIGRlcGVuZGVudCBjb25uZWN0aW9uc1xuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uam9icywgZnVuY3Rpb24gKGpvYikge1xuICAgICAgICAgICAgICAgIF8ucmVtb3ZlKGpvYi5kZXBlbmRlbmNpZXMsIHtuYW1lOiBqb2JOYW1lfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBqb2IgZnJvbSBkZWZpbml0aW9uLmpvYnNcbiAgICAgICAgICAgIF8ucmVtb3ZlKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uam9icywgeyBuYW1lOiBqb2JOYW1lIH0pO1xuICAgICAgICAgICAgLy8gZW5hYmxlIHNhdmUgYW5kIHJlZHJhd1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkSm9iID0gbnVsbDtcbiAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICRzY29wZS5yZWRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUucmVtb3ZlT3V0cHV0TWFwcGluZyA9IGZ1bmN0aW9uIChqb2JOYW1lLCBkZXBPdXRwdXQpIHtcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgdG8gcmVtb3ZlIG91dHB1dCBtYXBwaW5nIGZyb20gdGhlIGpvYiB3aGVyZSB0aGUgZGVwZW5kZW5jeSBpcyBkZWZpbmVkXG4gICAgICAgICAgICB2YXIgcmVjZWl2ZXIgPSBfLmZpbmQoJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5qb2JzLHtuYW1lOiBqb2JOYW1lfSk7XG4gICAgICAgICAgICAvLyByZW1vdmUgaXQgZnJvbSByZWNlaXZlci5kZXBlbmRlbmNpZXNcbiAgICAgICAgICAgIHZhciBkZXAgPSBfLmZpbmQocmVjZWl2ZXIuZGVwZW5kZW5jaWVzLCB7bmFtZTogJHNjb3BlLnNlbGVjdGVkSm9iLm5hbWV9KTtcbiAgICAgICAgICAgIGlmIChkZXAgJiYgZGVwLmNvbm5lY3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW92ZWRDb24gPSBfLnJlbW92ZShkZXAuY29ubmVjdGlvbnMsIGZ1bmN0aW9uIChjb25uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25uLm91dHB1dCA9PT0gZGVwT3V0cHV0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmVkICcgKyByZW1vdmVkQ29uLmxlbmd0aCArICcgb3V0cHV0IGNvbm5lY3Rpb25zLicpO1xuICAgICAgICAgICAgICAgIGVuYWJsZVNhdmVSZWNpcGUoKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVkcmF3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnNlbGVjdEpvYlR5cGVUb0FkZCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRKb2JUeXBlID0gaXRlbTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuJG9uKCdyZWRyYXdSZWNpcGVzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnJlZHJhdygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgYWRkRGVwZW5kZW5jeSA9IGZ1bmN0aW9uIChqb2JOYW1lKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSArICctPicgKyBqb2JOYW1lKTtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLnNlbGVjdGVkSm9iLmRlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYi5kZXBlbmRlbmNpZXMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBleGlzdGluZ0RlcGVuZGVuY3kgPSBfLmZpbmQoJHNjb3BlLnNlbGVjdGVkSm9iLmRlcGVuZGVuY2llcywge25hbWU6IGpvYk5hbWV9KTtcblxuICAgICAgICAgICAgaWYgKCFleGlzdGluZ0RlcGVuZGVuY3kpIHsgJHNjb3BlLnNlbGVjdGVkSm9iLmRlcGVuZGVuY2llcy5wdXNoKHtuYW1lOiBqb2JOYW1lfSk7IH1cbiAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZEpvYi5kZXBTdGFydCA9IGZhbHNlO1xuICAgICAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gJyc7XG4gICAgICAgICAgICAkc2NvcGUuZGVwZW5kZW5jeUJ0bkNsYXNzID0gJ2ZhLXBsdXMnO1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGdldElvTWFwcGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbikge1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUucmVjaXBlVHlwZS5kZWZpbml0aW9uLmpvYnMsIGZ1bmN0aW9uIChqb2IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgdGhlIGN1cnJlbnQgam9iVHlwZVxuICAgICAgICAgICAgICAgICAgICAvKnZhciB0aGlzSm9iVHlwZSA9IF8uZmluZCgkc2NvcGUucmVjaXBlVHlwZS5qb2JfdHlwZXMse2lkOiBqb2Iuam9iX3R5cGVfaWR9KTtcbiAgICAgICAgICAgICAgICAgICAgam9iLmpvYl90eXBlID0gdGhpc0pvYlR5cGU7Ki9cblxuICAgICAgICAgICAgICAgICAgICAvLyBmaW5kIGRlcGVuZGVudHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpvYi5qb2JfdHlwZSAmJiBqb2Iuam9iX3R5cGUuam9iX3R5cGVfaW50ZXJmYWNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goam9iLmpvYl90eXBlLmpvYl90eXBlX2ludGVyZmFjZS5vdXRwdXRfZGF0YSwgZnVuY3Rpb24gKGpvYk91dHB1dCwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpvYk91dHB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVwcyA9IGdldERlcGVuZGVudHMoam9iLm5hbWUsam9iT3V0cHV0Lm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2JPdXRwdXQuZGVwZW5kZW50cyA9IGRlcHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgZGVwZW5kZW5jeSBtYXBwaW5nc1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGpvYi5qb2JfdHlwZS5qb2JfdHlwZV9pbnRlcmZhY2UuaW5wdXRfZGF0YSwgZnVuY3Rpb24gKGpvYklucHV0LCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoam9iSW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0TWFwcGluZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGpvYi5kZXBlbmRlbmNpZXMsIGZ1bmN0aW9uIChkZXBlbmRlbmN5LGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRlcGVuZGVuY3kuY29ubmVjdGlvbnMsIGZ1bmN0aW9uIChjb25uLGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uLmlucHV0ID09PSBqb2JJbnB1dC5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TWFwcGluZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkZXBlbmRlbmN5Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6IGNvbm4ub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGNvbm4uaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goam9iLnJlY2lwZV9pbnB1dHMsIGZ1bmN0aW9uIChyZWNpcGVJbnB1dCwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVjaXBlSW5wdXQuam9iX2lucHV0ID09PSBqb2JJbnB1dC5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRNYXBwaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ3JlY2lwZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogcmVjaXBlSW5wdXQucmVjaXBlX2lucHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dDogcmVjaXBlSW5wdXQuam9iX2lucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqb2JJbnB1dC5kZXBlbmRlbmNpZXMgPSBpbnB1dE1hcHBpbmdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBqb2JUeXBlU2VydmljZS5nZXRKb2JUeXBlc09uY2UoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmpvYlR5cGVWYWx1ZXMgPSBkYXRhLnJlc3VsdHM7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgd29ya3NwYWNlc1NlcnZpY2UuZ2V0V29ya3NwYWNlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYXZhaWxhYmxlV29ya3NwYWNlcyA9IGRhdGFcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKCdyZWNpcGVUeXBlJywgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5tb2RlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoISRzY29wZS5yZWNpcGVUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlID0gbmV3IFJlY2lwZVR5cGUoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mICRzY29wZS5yZWNpcGVUeXBlLmlkID09PSAndW5kZWZpbmVkJyB8fCAkc2NvcGUucmVjaXBlVHlwZS5pZCA9PT0gbnVsbCB8fCAkc2NvcGUucmVjaXBlVHlwZS5pZCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kZSA9ICdhZGQnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RlID0gJHNjb3BlLm1vZGUgfHwgJ3ZpZXcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5qb2JzLCBmdW5jdGlvbiAoam9iLCBpZHgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFqb2Iuam9iX3R5cGUuam9iX3R5cGVfaW50ZXJmYWNlICYmICRzY29wZS5yZWNpcGVUeXBlLmpvYl90eXBlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpvYlR5cGVEYXRhID0gXy5maW5kKCRzY29wZS5yZWNpcGVUeXBlLmpvYl90eXBlcywge25hbWU6IGpvYi5qb2JfdHlwZS5uYW1lLCB2ZXJzaW9uOiBqb2Iuam9iX3R5cGUudmVyc2lvbn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5qb2JzW2lkeF0uam9iX3R5cGUgPSBqb2JUeXBlRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzZXR1cCBzdHJpbmcgdG8gYmluZCBjb21tYSBkZWxpbWl0ZWQgbGlzdCBvZiB0cmlnZ2VyIHJ1bGUgY29uZmlndXJhdGlvbiBjb25kaXRpb24gZGF0YSB0eXBlc1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVjaXBlVHlwZS50cmlnZ2VyX3J1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGVUeXBlLnRyaWdnZXJfcnVsZS5jb25maWd1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJlY2lwZVR5cGUudHJpZ2dlcl9ydWxlLmNvbmZpZ3VyYXRpb24uY29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGVUeXBlLnRyaWdnZXJfcnVsZS5jb25maWd1cmF0aW9uLmNvbmRpdGlvbi5kYXRhX3R5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNpcGVUeXBlVHJpZ2dlci5kYXRhVHlwZXMgPSAkc2NvcGUucmVjaXBlVHlwZS50cmlnZ2VyX3J1bGUuY29uZmlndXJhdGlvbi5jb25kaXRpb24uZGF0YV90eXBlcy5qb2luKCcsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaW5pdEdyYXBoKCk7XG4gICAgICAgICAgICAgICAgZ2V0SW9NYXBwaW5ncygpO1xuICAgICAgICAgICAgICAgIGRyYXdHcmFwaCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS51c2VyKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlYWRvbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluaXRHcmFwaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vICoqKioqKlxuICAgICAgICAgICAgLy8gc2V0dXAgRDMgY29udGFpbmVyIGFuZCBHcmFwaFxuICAgICAgICAgICAgLy8gKioqKioqXG4gICAgICAgICAgICAvLyRzY29wZS5zZWxlY3RlZEpvYiA9IG51bGw7XG4gICAgICAgICAgICBmdW5jdGlvbiBjbGlja2VkKCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gZDMuZXZlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHggPSBkMy5ldmVudC54O1xuICAgICAgICAgICAgICAgIHZhciB5ID0gZDMuZXZlbnQueTtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBwYXJzZUludChzdmcuc3R5bGUoXCJ3aWR0aFwiKS5yZXBsYWNlKC9weC8sIFwiXCIpKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gcGFyc2VJbnQoc3ZnLnN0eWxlKFwiaGVpZ2h0XCIpLnJlcGxhY2UoL3B4LywgXCJcIikpO1xuXG4gICAgICAgICAgICAgICAgaW5uZXIuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIHdpZHRoIC8gMiArIFwiLFwiICsgaGVpZ2h0IC8gMiArIFwiKXNjYWxlKDIpdHJhbnNsYXRlKFwiICsgLXggKyBcIixcIiArIC15ICsgXCIpXCIpO1xuXG4gICAgICAgICAgICAgICAgLy9pbm5lci5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDUwcHgsIDUwcHgpc2NhbGUoMiwzKVwiKTtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdmcgPSBkMy5zZWxlY3QoXCJzdmdcIik7XG4gICAgICAgICAgICBpbm5lciA9IHN2Zy5zZWxlY3QoXCJnXCIpOyAvLy5vbihcImNsaWNrXCIsIGNsaWNrZWQpO1xuICAgICAgICAgICAgLy8gU2V0IHVwIHpvb20gc3VwcG9ydFxuICAgICAgICAgICAgem9vbSA9IGQzLmJlaGF2aW9yLnpvb20oKS5vbihcInpvb21cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHpvb21TY2FsZSA9IGQzLmV2ZW50LnNjYWxlO1xuICAgICAgICAgICAgICAgIGlubmVyLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBkMy5ldmVudC50cmFuc2xhdGUgKyBcIilcIiArXG4gICAgICAgICAgICAgICAgICAgIFwic2NhbGUoXCIgKyB6b29tU2NhbGUgKyBcIilcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN2Zy5jYWxsKHpvb20pO1xuXG4gICAgICAgICAgICByZW5kZXIgPSBuZXcgZGFncmVEMy5yZW5kZXIoKTtcblxuICAgICAgICAgICAgLy8gTGVmdC10by1yaWdodCBsYXlvdXRcbiAgICAgICAgICAgIGdyYXBoID0gbmV3IGRhZ3JlRDMuZ3JhcGhsaWIuR3JhcGgoKTtcbiAgICAgICAgICAgIGdyYXBoLnNldEdyYXBoKHtcbiAgICAgICAgICAgICAgICBub2Rlc2VwOiA3MCxcbiAgICAgICAgICAgICAgICByYW5rc2VwOiA1MCxcbiAgICAgICAgICAgICAgICByYW5rZGlyOiBcIlRCXCIsXG4gICAgICAgICAgICAgICAgbWFyZ2lueDogMjAsXG4gICAgICAgICAgICAgICAgbWFyZ2lueTogMjBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGRyYXdHcmFwaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGdsb2JhbHMgYmVjYXVzZSBkYWdyZSBuZWVkcyBhIHJlZmVyZW5jZSB0byBhbmd1bGFyIHNjb3BlXG4gICAgICAgICAgICB3aW5kb3cubm9kZUNsaWNrID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGUgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY2lwZXZpZXdlcicpKS5zY29wZSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLm5vZGVDbGljayhuYW1lKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHdpbmRvdy5tYXBJbnB1dCA9IGZ1bmN0aW9uIChqb2JOYW1lLCBqb2JPdXRwdXQpIHtcbiAgICAgICAgICAgICAgICAkKCcjJyArIGpvYk5hbWUpLnBvcG92ZXIoJ2Rlc3Ryb3knKTtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcGUgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY2lwZXZpZXdlcicpKS5zY29wZSgpO1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLm1hcElucHV0KGpvYk5hbWUsIGpvYk91dHB1dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB3aW5kb3cubWFwSW5wdXRSZWNpcGVJbnB1dCA9IGZ1bmN0aW9uIChyZWNpcGVJbnB1dE5hbWUpIHtcbiAgICAgICAgICAgICAgICAkKCcjc3RhcnQnKS5wb3BvdmVyKCdkZXN0cm95Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNpcGV2aWV3ZXInKSkuc2NvcGUoKTtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5tYXBJbnB1dFJlY2lwZUlucHV0KHJlY2lwZUlucHV0TmFtZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB3aW5kb3cubWFwT3V0cHV0ID0gZnVuY3Rpb24gKGpvYk5hbWUsIGpvYklucHV0KSB7XG4gICAgICAgICAgICAgICAgJCgnIycgKyBqb2JOYW1lKS5wb3BvdmVyKCdkZXN0cm95Jyk7XG4gICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNpcGV2aWV3ZXInKSkuc2NvcGUoKTtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5tYXBPdXRwdXQoam9iTmFtZSwgam9iSW5wdXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGUpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGFzdFN0YXR1c0NoYW5nZSA9ICRzY29wZS5yZWNpcGUubGFzdF9tb2RpZmllZCA/IG1vbWVudC5kdXJhdGlvbihtb21lbnQudXRjKCRzY29wZS5yZWNpcGUubGFzdF9tb2RpZmllZCkuZGlmZihtb21lbnQudXRjKCkpKS5odW1hbml6ZSh0cnVlKSA6ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgam9icyA9IFtdO1xuICAgICAgICAgICAgaWYgKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24pIHtcbiAgICAgICAgICAgICAgICBqb2JzID0gJHNjb3BlLnJlY2lwZVR5cGUuZGVmaW5pdGlvbi5qb2JzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoaWxkQ291bnRzID0gW107XG4gICAgICAgICAgICAvLyBjcmVhdGUgZ3JhcGggb2JqZWN0c1xuICAgICAgICAgICAgZm9yICh2YXIgaWR4IGluIGpvYnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgam9iID0gam9ic1tpZHhdO1xuXG4gICAgICAgICAgICAgICAgaWYgKGpvYi5kZXBlbmRlbmNpZXMgPT09IHVuZGVmaW5lZCB8fCBqb2IuZGVwZW5kZW5jaWVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgam9iLmRlcFN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IGdldFJlY2lwZVR5cGVKb2JDbGFzc05hbWUoam9iKTtcblxuICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxkaXYgY2xhc3M9XCJyZWNpcGVOb2RlXCI+JztcbiAgICAgICAgICAgICAgICAvL3ZhciBodG1sID0gXCI8ZGl2IG9uY2xpY2s9XFxcImNvbnNvbGUubG9nKCdcIiArIGpvYi5qb2JfdHlwZS5uYW1lICsgXCInKVxcXCI+XCI7XG4gICAgICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gJ25vc3RhdHVzJykge1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8c3BhbiBjbGFzcz1cInN0YXR1c1wiPjwvc3Bhbj4nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgIGh0bWwgKz0gXCI8c3BhbiBjbGFzcz1jb25zdW1lcnM+XCIrd29ya2VyLmNvbnN1bWVycytcIjwvc3Bhbj5cIjtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8c3BhbiBjbGFzcz1cIm5hbWVcIj4nO1xuICAgICAgICAgICAgICAgIGlmIChqb2Iuam9iX3R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhqb2Iuam9iVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgaWQ9XCInICsgam9iLm5hbWUgKyAnXCIgY2xhc3M9XCJcIiBvbmNsaWNrPVwibm9kZUNsaWNrKFxcJycgKyBqb2IubmFtZSArICdcXCcpXCI+PHNwYW4gY2xhc3M9XCJuYW1lXCI+JyArIGpvYi5qb2JfdHlwZS5nZXRJY29uKCkgKyAnICcgKyBqb2IubmFtZSArICc8L3NwYW4+PC9kaXY+JztcbiAgICAgICAgICAgICAgICAgICAgLy9pZiAoam9iVHlwZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGh0bWwgKz0gJzxkaXYgaWQ9XCInICsgam9iLm5hbWUgKyAnXCIgY2xhc3M9XCJyZWNpcGVOb2RlXCIgb25jbGljaz1cIm5vZGVDbGljayhcXCcnICsgam9iLm5hbWUgKyAnXFwnKVwiPjxzcGFuIGNsYXNzPVwibmFtZVwiPicgKyBqb2JUeXBlLmdldEljb24oKSArICcgJyArIGpvYlR5cGUudGl0bGUgKyAnPC9zcGFuPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIC8vfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgaHRtbCArPSAnPGRpdiBpZD1cIicgKyBqb2IubmFtZSArICdcIiBjbGFzcz1cInJlY2lwZU5vZGVcIiBvbmNsaWNrPVwibm9kZUNsaWNrKFxcJycgKyBqb2IubmFtZSArICdcXCcpXCI+PHNwYW4gY2xhc3M9XCJuYW1lXCI+JyArIGpvYlR5cGUuZ2V0SWNvbigpICsgJyAnICsgam9iLm5hbWUgKyAnPC9zcGFuPjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIC8vfVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvc3Bhbj4nO1xuICAgICAgICAgICAgICAgIC8vICAgaHRtbCArPSBcIjxzcGFuIGNsYXNzPXF1ZXVlPjxzcGFuIGNsYXNzPWNvdW50ZXI+XCIrd29ya2VyLmNvdW50K1wiPC9zcGFuPjwvc3Bhbj5cIjtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xuICAgICAgICAgICAgICAgIGdyYXBoLnNldE5vZGUoam9iLm5hbWUsIHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxUeXBlOiAnaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBodG1sLFxuICAgICAgICAgICAgICAgICAgICByeDogNSxcbiAgICAgICAgICAgICAgICAgICAgcnk6IDUsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBjbGFzc05hbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBzZXR1cCBlZGdlc1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGQgaW4gam9iLmRlcGVuZGVuY2llcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVwID0gam9iLmRlcGVuZGVuY2llc1tkXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVwLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXBoLnNldEVkZ2UoZGVwLm5hbWUsIGpvYi5uYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9sYWJlbFR5cGU6ICdodG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2xhYmVsOiBkZXAubmFtZSArICctLT4nICsgam9iLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIwXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkQ291bnRzW2RlcC5uYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkQ291bnRzW2RlcC5uYW1lXSArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZENvdW50c1tkZXAubmFtZV0gPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzZXQgc3RhcnQgbm9kZSBhbmQgZWRnZXNcbiAgICAgICAgICAgIGdyYXBoLnNldE5vZGUoJ3N0YXJ0Jywge1xuICAgICAgICAgICAgICAgIGxhYmVsVHlwZTogJ2h0bWwnLFxuICAgICAgICAgICAgICAgIGxhYmVsOiAnPGRpdiBpZD1cInN0YXJ0XCIgY2xhc3M9XCJyZWNpcGVOb2RlXCIgb25jbGljaz1cIm5vZGVDbGljayhcXCdzdGFydFxcJylcIj48c3BhbiBjbGFzcz1uYW1lPlN0YXJ0PC9zcGFuPjwvZGl2PicsXG4gICAgICAgICAgICAgICAgcng6IDUsXG4gICAgICAgICAgICAgICAgcnk6IDUsXG4gICAgICAgICAgICAgICAgcGFkZGluZzogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzdGFydEpvYiA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnc3RhcnQnLFxuICAgICAgICAgICAgICAgIGpvYl90eXBlOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnU3RhcnQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpbnB1dF9kYXRhOiAkc2NvcGUucmVjaXBlVHlwZS5pbnB1dF9kYXRhXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG5vRGVwcyA9IF8uZmlsdGVyKGpvYnMsICdkZXBTdGFydCcsIHRydWUpO1xuICAgICAgICAgICAgZm9yICh2YXIgbiBpbiBub0RlcHMpIHtcbiAgICAgICAgICAgICAgICBncmFwaC5zZXRFZGdlKCdzdGFydCcsIG5vRGVwc1tuXS5uYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAyMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzZXQgZW5kIG5vZGUgYW5kIGVkZ2VzXG4gICAgICAgICAgICBncmFwaC5zZXROb2RlKCdlbmQnLCB7XG4gICAgICAgICAgICAgICAgbGFiZWxUeXBlOiAnaHRtbCcsXG4gICAgICAgICAgICAgICAgbGFiZWw6ICc8ZGl2IGNsYXNzPVwicmVjaXBlTm9kZVwiPjxzcGFuIGNsYXNzPVwibmFtZVwiPkVuZDwvc3Bhbj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgIHJ4OiA1LFxuICAgICAgICAgICAgICAgIHJ5OiA1LFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIG5vQ2hpbGRyZW4gPV8uZmlsdGVyKGpvYnMsIGZ1bmN0aW9uIChqb2IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWNoaWxkQ291bnRzW2pvYi5uYW1lXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9yICh2YXIgbyBpbiBub0NoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgZ3JhcGguc2V0RWRnZShub0NoaWxkcmVuW29dLm5hbWUsICdlbmQnLCB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAyMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB3YWl0IGZvciBjdXJyZW50IGNhbGwgc3RhY2sgdG8gY2xlYXJcbiAgICAgICAgICAgIF8uZGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlubmVyLmNhbGwocmVuZGVyLCBncmFwaCk7XG4gICAgICAgICAgICAgICAgem9vbS5ldmVudChkMy5zZWxlY3QoXCJzdmdcIikpO1xuXG4gICAgICAgICAgICAgICAgJCgnLm5vZGUgcmVjdCcpLmF0dHIoJ2NsYXNzJywgJ25vZGVSZWN0Jyk7XG5cbiAgICAgICAgICAgICAgICAvLyBhZGQgc2VsZWN0ZWQgY2xhc3MgdG8gYXBwcm9wcmlhdGUgbm9kZVxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2VsZWN0ZWRKb2IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8kKCcjJyArICRzY29wZS5zZWxlY3RlZEpvYi5uYW1lKS5hZGRDbGFzcygnc2VsZWN0ZWQtbm9kZScpO1xuICAgICAgICAgICAgICAgICAgICBnZXRDbG9zZXN0Tm9kZSgkc2NvcGUuc2VsZWN0ZWRKb2IubmFtZSkuY2xhc3NlZCgnc2VsZWN0ZWQtbm9kZScsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBnZXREZXBlbmRlbnRzID0gZnVuY3Rpb24gKG5hbWUsb3V0cHV0TmFtZSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcblxuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5yZWNpcGVUeXBlLmRlZmluaXRpb24uam9icywgZnVuY3Rpb24gKGpvYiwga2V5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGpvYi5uYW1lICE9PSBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uZm9yRWFjaChqb2IuZGVwZW5kZW5jaWVzLCBmdW5jdGlvbiAoZGVwZW5kZW5jeSwga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwZW5kZW5jeS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKGRlcGVuZGVuY3kuY29ubmVjdGlvbnMsIGZ1bmN0aW9uIChjb25uLCBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm4ub3V0cHV0ID09PSBvdXRwdXROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGpvYi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogY29ubi5vdXRwdXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGNvbm4uaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xuXG4gICAgfSkuZGlyZWN0aXZlKCdhaXNTY2FsZVJlY2lwZUdyYXBoVmlld2VyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2FnZTogPGFpcy1zY2FsZS1yZWNpcGUtdmlld2VyIHJlY2lwZT1cInJlY2lwZVwiIC8+XG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fpc1NjYWxlUmVjaXBlR3JhcGhWaWV3ZXJDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9yZWNpcGVzL3BhcnRpYWxzL3JlY2lwZUdyYXBoVmlld2VyVGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICByZWNpcGVUeXBlOiAnPScsXG4gICAgICAgICAgICAgICAgcmVjaXBlOiAnPScsXG4gICAgICAgICAgICAgICAgaXNNb2RpZmllZDogJz1tb2RpZmllZCcsXG4gICAgICAgICAgICAgICAgYWxsb3dFZGl0OiAnPScsXG4gICAgICAgICAgICAgICAgaGFzQ29udGFpbmVyOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAvLyBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIGVsSGVpZ2h0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncmVjaXBlLXZpZXdlci10aXRsZScpWzBdLnNjcm9sbEhlaWdodDtcbiAgICAgICAgICAgICAgICAvLyAgICAgc2NvcGUuZGV0YWlsTWF4SGVpZ2h0ID0gc2NvcGUuJHBhcmVudC5kZXRhaWxNYXhIZWlnaHQgPyBzY29wZS4kcGFyZW50LmRldGFpbE1heEhlaWdodCAtIGVsSGVpZ2h0IDogNzAwO1xuICAgICAgICAgICAgICAgIC8vICAgICBzY29wZS5kZXRhaWxDb250YWluZXJTdHlsZSA9ICdoZWlnaHQ6IDYydmg7IG1heC1oZWlnaHQ6IDYydmg7IG92ZXJmbG93LXk6IGF1dG87JztcbiAgICAgICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBSZWNpcGVUeXBlLCBzY2FsZVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIFJlY2lwZSA9IGZ1bmN0aW9uIChpZCwgY3JlYXRlZCwgY29tcGxldGVkLCBsYXN0X21vZGlmaWVkLCByZWNpcGVfdHlwZSkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkID0gY3JlYXRlZDtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKGNyZWF0ZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Y19ub2xhYmVsKTtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVkID0gY29tcGxldGVkO1xuICAgICAgICAgICAgdGhpcy5jb21wbGV0ZWRfZm9ybWF0dGVkID0gY29tcGxldGVkID8gbW9tZW50LnV0Yyhjb21wbGV0ZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Y19ub2xhYmVsKSA6ICcnO1xuICAgICAgICAgICAgdGhpcy5sYXN0X21vZGlmaWVkID0gbGFzdF9tb2RpZmllZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZF9mb3JtYXR0ZWQgPSBtb21lbnQudXRjKGxhc3RfbW9kaWZpZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0Y19ub2xhYmVsKTtcbiAgICAgICAgICAgIHRoaXMubGFzdF9zdGF0dXNfY2hhbmdlID0gbGFzdF9tb2RpZmllZCA/IG1vbWVudC5kdXJhdGlvbihtb21lbnQudXRjKGxhc3RfbW9kaWZpZWQpLmRpZmYobW9tZW50LnV0YygpKSkuaHVtYW5pemUodHJ1ZSkgOiAnJztcbiAgICAgICAgICAgIHRoaXMucmVjaXBlX3R5cGUgPSBSZWNpcGVUeXBlLnRyYW5zZm9ybWVyKHJlY2lwZV90eXBlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBSZWNpcGUucHJvdG90eXBlID0ge1xuICAgICAgICAgICAgZ2V0RHVyYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NhbGVTZXJ2aWNlLmNhbGN1bGF0ZUR1cmF0aW9uKHRoaXMuY3JlYXRlZCwgdGhpcy5sYXN0X21vZGlmaWVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgUmVjaXBlLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWNpcGUoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZWNpcGVfdHlwZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJlY2lwZS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGUuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBSZWNpcGU7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlRGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIFJlY2lwZURhdGEgPSBmdW5jdGlvbiAoaW5wdXRfZGF0YSwgdmVyc2lvbiwgd29ya3NwYWNlX2lkKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0X2RhdGEgPSBpbnB1dF9kYXRhO1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIHRoaXMud29ya3NwYWNlX2lkID0gd29ya3NwYWNlX2lkO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBSZWNpcGVEYXRhLmJ1aWxkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWNpcGVEYXRhKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlucHV0X2RhdGEsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS53b3Jrc3BhY2VfaWRcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWNpcGVEYXRhKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgUmVjaXBlRGF0YS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGVEYXRhLmJ1aWxkKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFJlY2lwZURhdGEuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZURhdGE7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlRGV0YWlscycsIGZ1bmN0aW9uIChSZWNpcGVEYXRhLCBSZWNpcGVUeXBlRGVmaW5pdGlvbiwgUmVjaXBlVHlwZSwgUmVjaXBlVHlwZURldGFpbCwgUmVjaXBlSm9iQ29udGFpbmVyLCBzY2FsZUNvbmZpZykge1xuICAgICAgICB2YXIgUmVjaXBlRGV0YWlscyA9IGZ1bmN0aW9uIChpZCwgY3JlYXRlZCwgY29tcGxldGVkLCBsYXN0X21vZGlmaWVkLCBkYXRhLCByZWNpcGVfdHlwZSwgcmVjaXBlX3R5cGVfcmV2LCBqb2JzKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWQgPSBjcmVhdGVkO1xuICAgICAgICAgICAgdGhpcy5jb21wbGV0ZWQgPSBjb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlZF9mb3JtYXR0ZWQgPSB0aGlzLmNvbXBsZXRlZCA/IG1vbWVudC51dGModGhpcy5jb21wbGV0ZWQpLmZvcm1hdChzY2FsZUNvbmZpZy5kYXRlRm9ybWF0cy5kYXlfc2Vjb25kX3V0YykgOiB0aGlzLmNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdF9tb2RpZmllZCA9IGxhc3RfbW9kaWZpZWQ7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBSZWNpcGVEYXRhLnRyYW5zZm9ybWVyKGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5yZWNpcGVfdHlwZSA9IFJlY2lwZVR5cGUudHJhbnNmb3JtZXIocmVjaXBlX3R5cGUpO1xuICAgICAgICAgICAgdGhpcy5yZWNpcGVfdHlwZV9yZXYgPSBSZWNpcGVUeXBlRGV0YWlsLnRyYW5zZm9ybWVyKHJlY2lwZV90eXBlX3Jldik7XG4gICAgICAgICAgICB0aGlzLmpvYnMgPSBSZWNpcGVKb2JDb250YWluZXIudHJhbnNmb3JtZXIoam9icyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFJlY2lwZURldGFpbHMuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZURldGFpbHMoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlY2lwZV90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlY2lwZV90eXBlX3JldixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlRGV0YWlscygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJlY2lwZURldGFpbHMudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoUmVjaXBlRGV0YWlscy5idWlsZClcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBSZWNpcGVEZXRhaWxzLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBSZWNpcGVEZXRhaWxzO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlSm9iJywgZnVuY3Rpb24gKEpvYlR5cGUpIHtcbiAgICAgICAgdmFyIFJlY2lwZUpvYiA9IGZ1bmN0aW9uIChpZCwgc3RhdHVzLCBqb2JfdHlwZSkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlID0gSm9iVHlwZS50cmFuc2Zvcm1lcihqb2JfdHlwZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFJlY2lwZUpvYi5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlSm9iKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JfdHlwZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZUpvYigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJlY2lwZUpvYi50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGVKb2IuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlSm9iLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBSZWNpcGVKb2I7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlSm9iQ29udGFpbmVyJywgZnVuY3Rpb24gKFJlY2lwZUpvYikge1xuICAgICAgICB2YXIgUmVjaXBlSm9iQ29udGFpbmVyID0gZnVuY3Rpb24gKGpvYl9uYW1lLCBqb2IpIHtcbiAgICAgICAgICAgIHRoaXMuam9iX25hbWUgPSBqb2JfbmFtZTtcbiAgICAgICAgICAgIHRoaXMuam9iID0gUmVjaXBlSm9iLnRyYW5zZm9ybWVyKGpvYik7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFJlY2lwZUpvYkNvbnRhaW5lci5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlSm9iQ29udGFpbmVyKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl9uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZUpvYkNvbnRhaW5lcigpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJlY2lwZUpvYkNvbnRhaW5lci50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGVKb2JDb250YWluZXIuYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlSm9iQ29udGFpbmVyLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBSZWNpcGVKb2JDb250YWluZXI7XG4gICAgfSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NjYWxlQXBwJykuZmFjdG9yeSgnUmVjaXBlVHlwZScsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgUmVjaXBlVHlwZURlZmluaXRpb24pIHtcbiAgICAgICAgdmFyIFJlY2lwZVR5cGUgPSBmdW5jdGlvbiAoaWQsIG5hbWUsIHZlcnNpb24sIHRpdGxlLCBkZXNjcmlwdGlvbiwgaXNfYWN0aXZlLCBkZWZpbml0aW9uLCByZXZpc2lvbl9udW0sIGNyZWF0ZWQsICBsYXN0X21vZGlmaWVkLCBhcmNoaXZlZCwgdHJpZ2dlcl9ydWxlKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMuaXNfYWN0aXZlID0gaXNfYWN0aXZlO1xuICAgICAgICAgICAgdGhpcy5kZWZpbml0aW9uID0gZGVmaW5pdGlvbiA/IFJlY2lwZVR5cGVEZWZpbml0aW9uLnRyYW5zZm9ybWVyKGRlZmluaXRpb24pIDogbmV3IFJlY2lwZVR5cGVEZWZpbml0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnJldmlzaW9uX251bSA9IHJldmlzaW9uX251bTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZCA9IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWQgPSBsYXN0X21vZGlmaWVkO1xuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZCA9IGFyY2hpdmVkO1xuICAgICAgICAgICAgaWYgKHRyaWdnZXJfcnVsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcl9ydWxlID0gdHJpZ2dlcl9ydWxlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJfcnVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJycsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBpc19hY3RpdmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYV90eXBlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhX3R5cGVzOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2VfbmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfZGF0YV9uYW1lOiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubW9kaWZpZWQgPSBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGF0aWMgbWV0aG9kcywgYXNzaWduZWQgdG8gY2xhc3NcbiAgICAgICAgUmVjaXBlVHlwZS5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZShcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNfYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmV2aXNpb25fbnVtLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hcmNoaXZlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50cmlnZ2VyX3J1bGVcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWNpcGVUeXBlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgUmVjaXBlVHlwZS50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEubWFwKFJlY2lwZVR5cGUuYnVpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGUuYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGU7XG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdSZWNpcGVUeXBlRGVmaW5pdGlvbicsIGZ1bmN0aW9uIChzY2FsZUNvbmZpZywgUmVjaXBlVHlwZURlZmluaXRpb25Kb2IsIEpvYlR5cGVJbnB1dERhdGEpIHtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgUmVjaXBlVHlwZURlZmluaXRpb24gPSBmdW5jdGlvbiAoaW5wdXRfZGF0YSwgdmVyc2lvbiwgam9icykge1xuICAgICAgICAgICAgdGhpcy5pbnB1dF9kYXRhID0gaW5wdXRfZGF0YSA/IEpvYlR5cGVJbnB1dERhdGEudHJhbnNmb3JtZXIoaW5wdXRfZGF0YSkgOiBbXTtcbiAgICAgICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb24gfHwgJzEuMCc7XG4gICAgICAgICAgICB0aGlzLmpvYnMgPSBqb2JzID8gUmVjaXBlVHlwZURlZmluaXRpb25Kb2IudHJhbnNmb3JtZXIoam9icykgOiBbXTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZ2V0Sm9iTmFtZSA9IGZ1bmN0aW9uKGpvYnMsIGpvYk5hbWUpe1xuICAgICAgICAgICAgdmFyIHRoZU5hbWUgPSBqb2JOYW1lO1xuICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gXy5maW5kKGpvYnMsIHsgJ25hbWUnOiBqb2JOYW1lIH0pO1xuICAgICAgICAgICAgdmFyIGlkeCA9IDI7XG4gICAgICAgICAgICB3aGlsZShleGlzdGluZyl7XG4gICAgICAgICAgICAgICAgdGhlTmFtZSA9IGpvYk5hbWUgKyAnLScgKyBpZHg7XG4gICAgICAgICAgICAgICAgZXhpc3RpbmcgPSBfLmZpbmQoam9icywgeyAnbmFtZSc6IHRoZU5hbWUgfSk7XG4gICAgICAgICAgICAgICAgaWR4Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhlTmFtZTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgICAgICBSZWNpcGVUeXBlRGVmaW5pdGlvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgICAgICBhZGRKb2I6IGZ1bmN0aW9uIChqb2JUeXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGpuYW1lID0gZ2V0Sm9iTmFtZSh0aGlzLmpvYnMsIGpvYlR5cGUubmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coam5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBqb2IgPSB7XG4gICAgICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llczogW10sXG4gICAgICAgICAgICAgICAgICAgIHJlY2lwZV9pbnB1dHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBqbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgam9iX3R5cGVfaWQ6IGpvYlR5cGUuaWQsXG4gICAgICAgICAgICAgICAgICAgIGpvYl90eXBlOiBqb2JUeXBlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmpvYnMucHVzaChqb2IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBSZWNpcGVUeXBlRGVmaW5pdGlvbi5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZihkYXRhKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZVR5cGVEZWZpbml0aW9uKFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlucHV0X2RhdGEsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5qb2JzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZURlZmluaXRpb24oKTtcbiAgICAgICAgfTtcblxuICAgICAgICBSZWNpcGVUeXBlRGVmaW5pdGlvbi50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGVUeXBlRGVmaW5pdGlvbi5idWlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlVHlwZURlZmluaXRpb24uYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGVEZWZpbml0aW9uO1xuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1JlY2lwZVR5cGVEZWZpbml0aW9uSm9iJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBKb2JUeXBlRGV0YWlscykge1xuICAgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIFJlY2lwZVR5cGVEZWZpbml0aW9uSm9iID0gZnVuY3Rpb24gKHJlY2lwZV9pbnB1dHMsIG5hbWUsIGpvYl90eXBlLCBkZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgICAgIHRoaXMucmVjaXBlX2lucHV0cyA9IHJlY2lwZV9pbnB1dHM7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy5qb2JfdHlwZSA9IGpvYl90eXBlO1xuICAgICAgICAgICAgLy90aGlzLmpvYl90eXBlID0ge1xuICAgICAgICAgICAgLy8gICAgbmFtZTogam9iX3R5cGUubmFtZSxcbiAgICAgICAgICAgIC8vICAgIHZlcnNpb246IGpvYl90eXBlLnZlcnNpb25cbiAgICAgICAgICAgIC8vfTtcbiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzIHx8IFtdO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBSZWNpcGVUeXBlRGVmaW5pdGlvbkpvYi5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZURlZmluaXRpb25Kb2IoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucmVjaXBlX2lucHV0cyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmpvYl90eXBlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlcGVuZGVuY2llc1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZVR5cGVEZWZpbml0aW9uSm9iKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgUmVjaXBlVHlwZURlZmluaXRpb25Kb2IudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoUmVjaXBlVHlwZURlZmluaXRpb25Kb2IuYnVpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGVEZWZpbml0aW9uSm9iLmJ1aWxkKGRhdGEpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGVEZWZpbml0aW9uSm9iO1xuXG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5mYWN0b3J5KCdSZWNpcGVUeXBlRGV0YWlsJywgZnVuY3Rpb24gKHNjYWxlQ29uZmlnLCBSZWNpcGVUeXBlRGVmaW5pdGlvbiwgSm9iVHlwZURldGFpbHMpIHtcbiAgICAgICAgdmFyIFJlY2lwZVR5cGVEZXRhaWwgPSBmdW5jdGlvbiAoaWQsIG5hbWUsIHZlcnNpb24sIHRpdGxlLCBkZXNjcmlwdGlvbiwgaXNfYWN0aXZlLCBkZWZpbml0aW9uLCBjcmVhdGVkLCBsYXN0X21vZGlmaWVkLCBhcmNoaXZlZCwgdHJpZ2dlcl9ydWxlLCBqb2JfdHlwZXMpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy5pc19hY3RpdmUgPSBpc19hY3RpdmU7XG4gICAgICAgICAgICB0aGlzLmRlZmluaXRpb24gPSBSZWNpcGVUeXBlRGVmaW5pdGlvbi50cmFuc2Zvcm1lcihkZWZpbml0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlZCA9IGNyZWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RfbW9kaWZpZWQgPSBsYXN0X21vZGlmaWVkO1xuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZCA9IGFyY2hpdmVkO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyX3J1bGUgPSB0cmlnZ2VyX3J1bGU7XG4gICAgICAgICAgICB0aGlzLmpvYl90eXBlcyA9IEpvYlR5cGVEZXRhaWxzLnRyYW5zZm9ybWVyKGpvYl90eXBlcyk7XG4gICAgICAgICAgICB0aGlzLm1vZGlmaWVkID0gZmFsc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc3RhdGljIG1ldGhvZHMsIGFzc2lnbmVkIHRvIGNsYXNzXG4gICAgICAgIFJlY2lwZVR5cGVEZXRhaWwuYnVpbGQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlY2lwZVR5cGVEZXRhaWwoXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmlzX2FjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubGFzdF9tb2RpZmllZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5hcmNoaXZlZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50cmlnZ2VyX3J1bGUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuam9iX3R5cGVzXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZURldGFpbCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFJlY2lwZVR5cGVEZXRhaWwudHJhbnNmb3JtZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoUmVjaXBlVHlwZURldGFpbC5idWlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlVHlwZURldGFpbC5idWlsZChkYXRhKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gUmVjaXBlVHlwZURldGFpbDtcbiAgICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLmZhY3RvcnkoJ1JlY2lwZVR5cGVWYWxpZGF0aW9uJywgZnVuY3Rpb24gKFJlY2lwZVR5cGVEZWZpbml0aW9uKSB7XG5cbiAgICAgICAgdmFyIGdldFJlY2lwZVR5cGVWYWxpZGF0aW9uSm9icyA9IGZ1bmN0aW9uIChqb2JzKSB7XG4gICAgICAgICAgICB2YXIgam9ic091dCA9IFtdO1xuICAgICAgICAgICAgXy5mb3JFYWNoKGpvYnMsIGZ1bmN0aW9uKGpvYil7XG4gICAgICAgICAgICAgICBqb2JzT3V0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgIHJlY2lwZV9pbnB1dHM6IGpvYi5yZWNpcGVfaW5wdXRzLFxuICAgICAgICAgICAgICAgICAgIG5hbWU6IGpvYi5uYW1lLFxuICAgICAgICAgICAgICAgICAgIGpvYl90eXBlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGpvYi5qb2JfdHlwZS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiBqb2Iuam9iX3R5cGUudmVyc2lvblxuICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgZGVwZW5kZW5jaWVzOiBqb2IuZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gam9ic091dDtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHZhciBSZWNpcGVUeXBlVmFsaWRhdGlvbiA9IGZ1bmN0aW9uIChpZCwgbmFtZSwgdmVyc2lvbiwgdGl0bGUsIGRlc2NyaXB0aW9uLCBkZWZpbml0aW9uLCB0cmlnZ2VyX3J1bGUpIHtcbiAgICAgICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy5kZWZpbml0aW9uID0ge1xuICAgICAgICAgICAgICAgIGlucHV0X2RhdGE6IGRlZmluaXRpb24uaW5wdXRfZGF0YSxcbiAgICAgICAgICAgICAgICBqb2JzOiBnZXRSZWNpcGVUeXBlVmFsaWRhdGlvbkpvYnMoZGVmaW5pdGlvbi5qb2JzKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcl9ydWxlID0gdHJpZ2dlcl9ydWxlO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHN0YXRpYyBtZXRob2RzLCBhc3NpZ25lZCB0byBjbGFzc1xuICAgICAgICBSZWNpcGVUeXBlVmFsaWRhdGlvbi5idWlsZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZVZhbGlkYXRpb24oXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudHJpZ2dlcl9ydWxlXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVjaXBlVHlwZVZhbGlkYXRpb24oKTtcbiAgICAgICAgfTtcblxuICAgICAgICBSZWNpcGVUeXBlVmFsaWRhdGlvbi50cmFuc2Zvcm1lciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgLm1hcChSZWNpcGVUeXBlVmFsaWRhdGlvbi5idWlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUmVjaXBlVHlwZVZhbGlkYXRpb24uYnVpbGQoZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZVR5cGVWYWxpZGF0aW9uO1xuICAgIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGFuZ3VsYXIubW9kdWxlKCdzY2FsZUFwcCcpLnNlcnZpY2UoJ3JlY2lwZVNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsICRxLCAkdGltZW91dCwgc2NhbGVDb25maWcsIFJlY2lwZVR5cGUsIFJlY2lwZVR5cGVEZXRhaWwsIFJlY2lwZSwgUmVjaXBlRGV0YWlscywgUmVjaXBlVHlwZVZhbGlkYXRpb24pIHtcbiAgICAgICAgdmFyIGdldFJlY2lwZXNQYXJhbXMgPSBmdW5jdGlvbiAocGFnZSwgcGFnZV9zaXplLCBzdGFydGVkLCBlbmRlZCwgb3JkZXIsIGNvbXBsZXRlZCwgcmVjaXBlX3R5cGVfaWQsIHJlY2lwZV90eXBlX25hbWUsIHVybCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLFxuICAgICAgICAgICAgICAgIHBhZ2Vfc2l6ZTogcGFnZV9zaXplLFxuICAgICAgICAgICAgICAgIHN0YXJ0ZWQ6IHN0YXJ0ZWQsXG4gICAgICAgICAgICAgICAgZW5kZWQ6IGVuZGVkLFxuICAgICAgICAgICAgICAgIG9yZGVyOiBvcmRlcixcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZCxcbiAgICAgICAgICAgICAgICByZWNpcGVfdHlwZV9pZDogcmVjaXBlX3R5cGVfaWQsXG4gICAgICAgICAgICAgICAgcmVjaXBlX3R5cGVfbmFtZTogcmVjaXBlX3R5cGVfbmFtZSxcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0UmVjaXBlVHlwZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3JlY2lwZS10eXBlcy8nKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShSZWNpcGVUeXBlLnRyYW5zZm9ybWVyKGRhdGEucmVzdWx0cykpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGdldFJlY2lwZVR5cGVEZXRhaWw6IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgJGh0dHAuZ2V0KHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3JlY2lwZS10eXBlcy8nICsgaWQgKyAnLycpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5EYXRhID0gUmVjaXBlVHlwZURldGFpbC50cmFuc2Zvcm1lcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShyZXR1cm5EYXRhKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBnZXRSZWNpcGVzOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IGdldFJlY2lwZXNQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogcGFyYW1zLnVybCA/IHBhcmFtcy51cmwgOiBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGVzLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlc3VsdHMgPSBSZWNpcGUudHJhbnNmb3JtZXIoZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgZ2V0UmVjaXBlRGV0YWlsczogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwLmdldChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGVzLycgKyBpZCArICcvJykuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gUmVjaXBlRGV0YWlscy50cmFuc2Zvcm1lcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc2F2ZVJlY2lwZVR5cGU6IGZ1bmN0aW9uIChyZWNpcGVUeXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBjbGVhblJlY2lwZVR5cGUgPSBSZWNpcGVUeXBlVmFsaWRhdGlvbi50cmFuc2Zvcm1lcihyZWNpcGVUeXBlKTtcblxuICAgICAgICAgICAgICAgIGlmICghY2xlYW5SZWNpcGVUeXBlLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICRodHRwLnBvc3Qoc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAncmVjaXBlLXR5cGVzLycsIGNsZWFuUmVjaXBlVHlwZSkuc3VjY2VzcyhmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wYXRjaChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGUtdHlwZXMvJyArIGNsZWFuUmVjaXBlVHlwZS5pZCArICcvJywgY2xlYW5SZWNpcGVUeXBlKS5zdWNjZXNzKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwZVR5cGUgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUocmVjaXBlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHZhbGlkYXRlUmVjaXBlVHlwZTogZnVuY3Rpb24gKHJlY2lwZVR5cGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIGNsZWFuUmVjaXBlVHlwZSA9IFJlY2lwZVR5cGVWYWxpZGF0aW9uLnRyYW5zZm9ybWVyKHJlY2lwZVR5cGUpO1xuXG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdChzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGUtdHlwZXMvdmFsaWRhdGlvbi8nLCBjbGVhblJlY2lwZVR5cGUpLnN1Y2Nlc3MoZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICAgICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuIiwiLyoqXG4gKiBAYXV0aG9yIERpbWl0cnkgS3VkcmF5dnRzZXZcbiAqIEB2ZXJzaW9uIDIuMVxuICovXG5cbiB2YXIgdXBkYXRlV2luZG93ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgeCA9IHcuaW5uZXJXaWR0aCB8fCBlLmNsaWVudFdpZHRoIHx8IGcuY2xpZW50V2lkdGg7XG4gICAgLy8gIHkgPSB3LmlubmVySGVpZ2h0fHwgZS5jbGllbnRIZWlnaHR8fCBnLmNsaWVudEhlaWdodDtcbiAgICAgLy9cbiAgICAvLyAgc3ZnLmF0dHIoXCJ3aWR0aFwiLCB4KS5hdHRyKFwiaGVpZ2h0XCIsIHkpO1xuICAgIGNvbnNvbGUubG9nKCdyZXNpemUnKTtcbiB9O1xuXG4gd2luZG93Lm9ucmVzaXplID0gdXBkYXRlV2luZG93O1xuXG5kMy5nYW50dCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBGSVRfVElNRV9ET01BSU5fTU9ERSA9IFwiZml0XCI7XG4gICAgdmFyIEZJWEVEX1RJTUVfRE9NQUlOX01PREUgPSBcImZpeGVkXCI7XG5cbiAgICB2YXIgbWFyZ2luID0ge1xuXHRcdHRvcCA6IDIwLFxuXHRcdHJpZ2h0IDogMjAsXG5cdFx0Ym90dG9tIDogMjAsXG5cdFx0bGVmdCA6IDYwXG4gICAgfTtcbiAgICB2YXIgdGltZURvbWFpblN0YXJ0ID0gZDMudGltZS5kYXkub2Zmc2V0KG5ldyBEYXRlKCksLTMpO1xuICAgIHZhciB0aW1lRG9tYWluRW5kID0gZDMudGltZS5ob3VyLm9mZnNldChuZXcgRGF0ZSgpLCszKTtcbiAgICB2YXIgdGltZURvbWFpbk1vZGUgPSBGSVRfVElNRV9ET01BSU5fTU9ERTsvLyBmaXhlZCBvciBmaXRcbiAgICB2YXIgdGFza1R5cGVzID0gW107XG4gICAgdmFyIHRhc2tTdGF0dXMgPSBbXTtcbiAgICB2YXIgaGVpZ2h0ID0gZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbS01O1xuICAgIHZhciB3aWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGggLSBtYXJnaW4ucmlnaHQgLSBtYXJnaW4ubGVmdC01O1xuXHR2YXIgcmVuZGVyVG8gPSBcImJvZHlcIjtcblx0dmFyIGJlZ2luID0gJyc7XG5cdHZhciBlbmRlZCA9ICcnO1xuXG4gICAgdmFyIHRpY2tGb3JtYXQgPSBcIiVIOiVNOiVTXCI7XG5cbiAgICB2YXIga2V5RnVuY3Rpb24gPSBmdW5jdGlvbihkKSB7XG5cdFx0cmV0dXJuIGRbYmVnaW5dICsgZC50YXNrTmFtZSArIGRbZW5kZWRdO1xuICAgIH07XG5cbiAgICB2YXIgcmVjdFRyYW5zZm9ybSA9IGZ1bmN0aW9uKGQpIHtcblx0XHRyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyB4KGRbYmVnaW5dKSArIFwiLFwiICsgeShkLnRhc2tOYW1lKSArIFwiKVwiO1xuICAgIH07XG5cbiAgICB2YXIgeCA9IGQzLnRpbWUuc2NhbGUoKS5kb21haW4oWyB0aW1lRG9tYWluU3RhcnQsIHRpbWVEb21haW5FbmQgXSkucmFuZ2UoWyAwLCB3aWR0aCBdKS5jbGFtcCh0cnVlKTtcblxuICAgIHZhciB5ID0gZDMuc2NhbGUub3JkaW5hbCgpLmRvbWFpbih0YXNrVHlwZXMpLnJhbmdlUm91bmRCYW5kcyhbIDAsIGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tIF0sIC4xKTtcblxuICAgIHZhciB4QXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KFwiYm90dG9tXCIpLnRpY2tGb3JtYXQoZDMudGltZS5mb3JtYXQodGlja0Zvcm1hdCkpLnRpY2tTdWJkaXZpZGUodHJ1ZSlcblx0ICAgIC50aWNrU2l6ZSg4KS50aWNrUGFkZGluZyg4KTtcblxuICAgIHZhciB5QXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeSkub3JpZW50KFwibGVmdFwiKS50aWNrU2l6ZSgwKTtcblxuICAgIHZhciBpbml0VGltZURvbWFpbiA9IGZ1bmN0aW9uKHRhc2tzKSB7XG5cdGlmICh0aW1lRG9tYWluTW9kZSA9PT0gRklUX1RJTUVfRE9NQUlOX01PREUpIHtcblx0ICAgIGlmICh0YXNrcyA9PT0gdW5kZWZpbmVkIHx8IHRhc2tzLmxlbmd0aCA8IDEpIHtcblx0XHR0aW1lRG9tYWluU3RhcnQgPSBkMy50aW1lLmRheS5vZmZzZXQobmV3IERhdGUoKSwgLTMpO1xuXHRcdHRpbWVEb21haW5FbmQgPSBkMy50aW1lLmhvdXIub2Zmc2V0KG5ldyBEYXRlKCksICszKTtcblx0XHRyZXR1cm47XG5cdCAgICB9XG5cdCAgICB0YXNrcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRyZXR1cm4gYVtlbmRlZF0gLSBiW2VuZGVkXTtcblx0ICAgIH0pO1xuXHQgICAgdGltZURvbWFpbkVuZCA9IHRhc2tzW3Rhc2tzLmxlbmd0aCAtIDFdW2VuZGVkXTtcblx0ICAgIHRhc2tzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdHJldHVybiBhW2JlZ2luXSAtIGJbYmVnaW5dO1xuXHQgICAgfSk7XG5cdCAgICB0aW1lRG9tYWluU3RhcnQgPSB0YXNrc1swXVtiZWdpbl07XG5cdH1cbiAgICB9O1xuXG4gICAgdmFyIGluaXRBeGlzID0gZnVuY3Rpb24oKSB7XG5cdHggPSBkMy50aW1lLnNjYWxlKCkuZG9tYWluKFsgdGltZURvbWFpblN0YXJ0LCB0aW1lRG9tYWluRW5kIF0pLnJhbmdlKFsgMCwgd2lkdGggXSkuY2xhbXAodHJ1ZSk7XG5cdHkgPSBkMy5zY2FsZS5vcmRpbmFsKCkuZG9tYWluKHRhc2tUeXBlcykucmFuZ2VSb3VuZEJhbmRzKFsgMCwgaGVpZ2h0IC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b20gXSwgLjEpO1xuXHR4QXhpcyA9IGQzLnN2Zy5heGlzKCkuc2NhbGUoeCkub3JpZW50KFwiYm90dG9tXCIpLnRpY2tzKE1hdGguY2VpbCh3aWR0aC8xNTApKS50aWNrRm9ybWF0KGQzLnRpbWUuZm9ybWF0KHRpY2tGb3JtYXQpKS50aWNrU3ViZGl2aWRlKHRydWUpXG5cdFx0LnRpY2tTaXplKDgpLnRpY2tQYWRkaW5nKDgpO1xuXG5cdHlBeGlzID0gZDMuc3ZnLmF4aXMoKS5zY2FsZSh5KS5vcmllbnQoXCJsZWZ0XCIpLnRpY2tTaXplKDApO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnYW50dCh0YXNrcykge1xuXG5cdGluaXRUaW1lRG9tYWluKHRhc2tzKTtcblx0aW5pdEF4aXMoKTtcblxuXHR2YXIgc3ZnID0gZDMuc2VsZWN0KHJlbmRlclRvKVxuXHQuYXBwZW5kKFwic3ZnXCIpXG5cdC5hdHRyKFwiY2xhc3NcIiwgXCJjaGFydFwiKVxuXHQuYXR0cihcIndpZHRoXCIsIHdpZHRoICsgbWFyZ2luLmxlZnQgKyBtYXJnaW4ucmlnaHQpXG5cdC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tKVxuXHQuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiZ2FudHQtY2hhcnRcIilcblx0LmF0dHIoXCJ3aWR0aFwiLCB3aWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuXHQuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgKyBtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSlcblx0LmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoXCIgKyBtYXJnaW4ubGVmdCArIFwiLCBcIiArIG1hcmdpbi50b3AgKyBcIilcIik7XG5cbiAgICAgIHN2Zy5zZWxlY3RBbGwoXCIuY2hhcnRcIilcblx0IC5kYXRhKHRhc2tzLCBrZXlGdW5jdGlvbikuZW50ZXIoKVxuXHQgLmFwcGVuZChcInJlY3RcIilcblx0IC5hdHRyKFwicnhcIiwgNSlcbiAgICAgICAgIC5hdHRyKFwicnlcIiwgNSlcblx0IC5hdHRyKFwiY2xhc3NcIiwgZnVuY3Rpb24oZCl7XG5cdCAgICAgaWYodGFza1N0YXR1c1tkLnN0YXR1c10gPT0gbnVsbCl7IHJldHVybiBcImJhclwiO31cblx0ICAgICByZXR1cm4gdGFza1N0YXR1c1tkLnN0YXR1c107XG5cdCAgICAgfSlcblx0IC5hdHRyKFwieVwiLCAwKVxuXHQgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgcmVjdFRyYW5zZm9ybSlcblx0IC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkucmFuZ2VCYW5kKCk7IH0pXG5cdCAuYXR0cihcIndpZHRoXCIsIGZ1bmN0aW9uKGQpIHtcblx0ICAgICByZXR1cm4gKHgoZFtlbmRlZF0pIC0geChkW2JlZ2luXSkpO1xuXHQgICAgIH0pO1xuXG5cblx0IHN2Zy5hcHBlbmQoXCJnXCIpXG5cdCAuYXR0cihcImNsYXNzXCIsIFwieCBheGlzXCIpXG5cdCAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZSgwLCBcIiArIChoZWlnaHQgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbSkgKyBcIilcIilcblx0IC50cmFuc2l0aW9uKClcblx0IC5jYWxsKHhBeGlzKTtcblxuXHQgc3ZnLmFwcGVuZChcImdcIikuYXR0cihcImNsYXNzXCIsIFwieSBheGlzXCIpLnRyYW5zaXRpb24oKS5jYWxsKHlBeGlzKTtcblxuXHQgcmV0dXJuIGdhbnR0O1xuXG4gICAgfTtcblxuICAgIGdhbnR0LnJlZHJhdyA9IGZ1bmN0aW9uKHRhc2tzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZWRyYXcnKTtcblx0aW5pdFRpbWVEb21haW4odGFza3MpO1xuXHRpbml0QXhpcygpO1xuXG4gICAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3QoXCJzdmdcIik7XG5cbiAgICAgICAgdmFyIGdhbnR0Q2hhcnRHcm91cCA9IHN2Zy5zZWxlY3QoXCIuZ2FudHQtY2hhcnRcIik7XG4gICAgICAgIHZhciByZWN0ID0gZ2FudHRDaGFydEdyb3VwLnNlbGVjdEFsbChcInJlY3RcIikuZGF0YSh0YXNrcywga2V5RnVuY3Rpb24pO1xuXG4gICAgICAgIHJlY3QuZW50ZXIoKVxuICAgICAgICAgLmluc2VydChcInJlY3RcIixcIjpmaXJzdC1jaGlsZFwiKVxuICAgICAgICAgLmF0dHIoXCJyeFwiLCA1KVxuICAgICAgICAgLmF0dHIoXCJyeVwiLCA1KVxuXHQgLmF0dHIoXCJjbGFzc1wiLCBmdW5jdGlvbihkKXtcblx0ICAgICBpZih0YXNrU3RhdHVzW2Quc3RhdHVzXSA9PSBudWxsKXsgcmV0dXJuIFwiYmFyXCI7fVxuXHQgICAgIHJldHVybiB0YXNrU3RhdHVzW2Quc3RhdHVzXTtcblx0ICAgICB9KVxuXHQgLnRyYW5zaXRpb24oKVxuXHQgLmF0dHIoXCJ5XCIsIDApXG5cdCAuYXR0cihcInRyYW5zZm9ybVwiLCByZWN0VHJhbnNmb3JtKVxuXHQgLmF0dHIoXCJoZWlnaHRcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4geS5yYW5nZUJhbmQoKTsgfSlcblx0ICAuYXR0cihcIndpZHRoXCIsIGZ1bmN0aW9uKGQpIHtcblx0ICAgICByZXR1cm4gKHgoZFtlbmRlZF0pIC0geChkW2JlZ2luXSkpO1xuXHQgICAgIH0pO1xuXG4gICAgICAgIHJlY3QudHJhbnNpdGlvbigpXG4gICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgcmVjdFRyYW5zZm9ybSlcblx0IC5hdHRyKFwiaGVpZ2h0XCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIHkucmFuZ2VCYW5kKCk7IH0pXG5cdCAuYXR0cihcIndpZHRoXCIsIGZ1bmN0aW9uKGQpIHtcblx0ICAgICByZXR1cm4gKHgoZFtlbmRlZF0pIC0geChkW2JlZ2luXSkpO1xuXHQgICAgIH0pO1xuXG5cdHJlY3QuZXhpdCgpLnJlbW92ZSgpO1xuXG5cdHN2Zy5zZWxlY3QoXCIueFwiKS50cmFuc2l0aW9uKCkuY2FsbCh4QXhpcyk7XG5cdHN2Zy5zZWxlY3QoXCIueVwiKS50cmFuc2l0aW9uKCkuY2FsbCh5QXhpcyk7XG5cblx0cmV0dXJuIGdhbnR0O1xuICAgIH07XG5cbiAgICBnYW50dC5tYXJnaW4gPSBmdW5jdGlvbih2YWx1ZSkge1xuXHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpXG5cdCAgICByZXR1cm4gbWFyZ2luO1xuXHRtYXJnaW4gPSB2YWx1ZTtcblx0cmV0dXJuIGdhbnR0O1xuICAgIH07XG5cbiAgICBnYW50dC50aW1lRG9tYWluID0gZnVuY3Rpb24odmFsdWUpIHtcblx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKVxuXHQgICAgcmV0dXJuIFsgdGltZURvbWFpblN0YXJ0LCB0aW1lRG9tYWluRW5kIF07XG5cdHRpbWVEb21haW5TdGFydCA9ICt2YWx1ZVswXSwgdGltZURvbWFpbkVuZCA9ICt2YWx1ZVsxXTtcblx0cmV0dXJuIGdhbnR0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ31cbiAgICAgKiAgICAgICAgICAgICAgICB2YWxlIFRoZSB2YWx1ZSBjYW4gYmUgXCJmaXRcIiAtIHRoZSBkb21haW4gZml0cyB0aGUgZGF0YSBvclxuICAgICAqICAgICAgICAgICAgICAgIFwiZml4ZWRcIiAtIGZpeGVkIGRvbWFpbi5cbiAgICAgKi9cbiAgICBnYW50dC50aW1lRG9tYWluTW9kZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdGlmICghYXJndW1lbnRzLmxlbmd0aClcblx0ICAgIHJldHVybiB0aW1lRG9tYWluTW9kZTtcbiAgICAgICAgdGltZURvbWFpbk1vZGUgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGdhbnR0O1xuXG4gICAgfTtcblxuICAgIGdhbnR0LnRhc2tUeXBlcyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdGlmICghYXJndW1lbnRzLmxlbmd0aClcblx0ICAgIHJldHVybiB0YXNrVHlwZXM7XG5cdHRhc2tUeXBlcyA9IHZhbHVlO1xuXHRyZXR1cm4gZ2FudHQ7XG4gICAgfTtcblxuICAgIGdhbnR0LnRhc2tTdGF0dXMgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpXG5cdCAgICByZXR1cm4gdGFza1N0YXR1cztcblx0dGFza1N0YXR1cyA9IHZhbHVlO1xuXHRyZXR1cm4gZ2FudHQ7XG4gICAgfTtcblxuXHRnYW50dC5iZWdpbiA9IGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRpZighYXJndW1lbnRzLmxlbmd0aCl7XG5cdFx0XHRyZXR1cm4gYmVnaW47XG5cdFx0fVxuXHRcdGJlZ2luID0gdmFsdWU7XG5cdFx0cmV0dXJuIGdhbnR0O1xuXHR9O1xuXG5cdGdhbnR0LmVuZGVkID0gZnVuY3Rpb24odmFsdWUpe1xuXHRcdGlmKCFhcmd1bWVudHMubGVuZ3RoKXtcblx0XHRcdHJldHVybiBlbmRlZDtcblx0XHR9XG5cdFx0ZW5kZWQgPSB2YWx1ZTtcblx0XHRyZXR1cm4gZ2FudHQ7XG5cdH07XG5cbiAgICBnYW50dC53aWR0aCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdGlmICghYXJndW1lbnRzLmxlbmd0aClcblx0ICAgIHJldHVybiB3aWR0aDtcblx0d2lkdGggPSArdmFsdWU7XG5cdHJldHVybiBnYW50dDtcbiAgICB9O1xuXG4gICAgZ2FudHQuaGVpZ2h0ID0gZnVuY3Rpb24odmFsdWUpIHtcblx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKVxuXHQgICAgcmV0dXJuIGhlaWdodDtcblx0aGVpZ2h0ID0gK3ZhbHVlO1xuXHRyZXR1cm4gZ2FudHQ7XG4gICAgfTtcblxuICAgIGdhbnR0LnRpY2tGb3JtYXQgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpXG5cdCAgICByZXR1cm4gdGlja0Zvcm1hdDtcblx0dGlja0Zvcm1hdCA9IHZhbHVlO1xuXHRyZXR1cm4gZ2FudHQ7XG4gICAgfTtcblxuXHRnYW50dC5yZW5kZXJUbyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0aWYoIWFyZ3VtZW50cy5sZW5ndGgpe1xuXHRcdFx0cmV0dXJuIHJlbmRlclRvO1xuXHRcdH1cblx0XHRyZW5kZXJUbyA9IHZhbHVlO1xuXHRcdHJldHVybiBnYW50dDtcblx0fTtcblxuXG5cbiAgICByZXR1cm4gZ2FudHQ7XG59O1xuIiwiZnVuY3Rpb24gR2F1Z2UocGxhY2Vob2xkZXJOYW1lLCBjb25maWd1cmF0aW9uKVxue1xuICAgIHRoaXMucGxhY2Vob2xkZXJOYW1lID0gcGxhY2Vob2xkZXJOYW1lO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzOyAvLyBmb3IgaW50ZXJuYWwgZDMgZnVuY3Rpb25zXG5cbiAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGNvbmZpZ3VyYXRpb24pXG4gICAge1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ3VyYXRpb247XG5cbiAgICAgICAgdGhpcy5jb25maWcuc2l6ZSA9IHRoaXMuY29uZmlnLnNpemUgKiAwLjk7XG5cbiAgICAgICAgdGhpcy5jb25maWcucmFkdWlzID0gdGhpcy5jb25maWcuc2l6ZSAqIDAuOTcgLyAyO1xuICAgICAgICB0aGlzLmNvbmZpZy5jeCA9IHRoaXMuY29uZmlnLnNpemUgLyAyO1xuICAgICAgICB0aGlzLmNvbmZpZy5jeSA9IHRoaXMuY29uZmlnLnNpemUgLyAyO1xuXG4gICAgICAgIHRoaXMuY29uZmlnLm1pbiA9IHVuZGVmaW5lZCAhPSBjb25maWd1cmF0aW9uLm1pbiA/IGNvbmZpZ3VyYXRpb24ubWluIDogMDtcbiAgICAgICAgdGhpcy5jb25maWcubWF4ID0gdW5kZWZpbmVkICE9IGNvbmZpZ3VyYXRpb24ubWF4ID8gY29uZmlndXJhdGlvbi5tYXggOiAxMDA7XG4gICAgICAgIHRoaXMuY29uZmlnLnJhbmdlID0gdGhpcy5jb25maWcubWF4IC0gdGhpcy5jb25maWcubWluO1xuXG4gICAgICAgIHRoaXMuY29uZmlnLm1ham9yVGlja3MgPSBjb25maWd1cmF0aW9uLm1ham9yVGlja3MgfHwgNTtcbiAgICAgICAgdGhpcy5jb25maWcubWlub3JUaWNrcyA9IGNvbmZpZ3VyYXRpb24ubWlub3JUaWNrcyB8fCAyO1xuXG4gICAgICAgIHRoaXMuY29uZmlnLmdyZWVuQ29sb3IgXHQ9IGNvbmZpZ3VyYXRpb24uZ3JlZW5Db2xvciB8fCBcIiM4ZmNhMGVcIjtcbiAgICAgICAgdGhpcy5jb25maWcueWVsbG93Q29sb3IgPSBjb25maWd1cmF0aW9uLnllbGxvd0NvbG9yIHx8IFwiI2ZmYzMxN1wiO1xuICAgICAgICB0aGlzLmNvbmZpZy5yZWRDb2xvciBcdD0gY29uZmlndXJhdGlvbi5yZWRDb2xvciB8fCBcIiNmNTRkMzZcIjtcblxuICAgICAgICB0aGlzLmNvbmZpZy50cmFuc2l0aW9uRHVyYXRpb24gPSBjb25maWd1cmF0aW9uLnRyYW5zaXRpb25EdXJhdGlvbiB8fCA1MDA7XG4gICAgfTtcblxuICAgIHRoaXMucmVuZGVyID0gZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5ib2R5ID0gZDMuc2VsZWN0KFwiI1wiICsgdGhpcy5wbGFjZWhvbGRlck5hbWUpXG4gICAgICAgICAgICAuYXBwZW5kKFwic3ZnOnN2Z1wiKVxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImdhdWdlXCIpXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHRoaXMuY29uZmlnLnNpemUpXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLmNvbmZpZy5zaXplKTtcblxuICAgICAgICB0aGlzLmJvZHkuYXBwZW5kKFwic3ZnOmNpcmNsZVwiKVxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm91dGVyLWNpcmNsZVwiKVxuICAgICAgICAgICAgLmF0dHIoXCJjeFwiLCB0aGlzLmNvbmZpZy5jeClcbiAgICAgICAgICAgIC5hdHRyKFwiY3lcIiwgdGhpcy5jb25maWcuY3kpXG4gICAgICAgICAgICAuYXR0cihcInJcIiwgdGhpcy5jb25maWcucmFkdWlzICogMC45NSlcbiAgICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCIjY2NjXCIpO1xuICAgICAgICAgICAgLyouc3R5bGUoXCJzdHJva2VcIiwgXCIjMDAwXCIpXG4gICAgICAgICAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgXCIwLjVweFwiKTsqL1xuXG4gICAgICAgIHRoaXMuYm9keS5hcHBlbmQoXCJzdmc6Y2lyY2xlXCIpXG4gICAgICAgICAgICAuYXR0cihcImN4XCIsIHRoaXMuY29uZmlnLmN4KVxuICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCB0aGlzLmNvbmZpZy5jeSlcbiAgICAgICAgICAgIC5hdHRyKFwiclwiLCAwLjkgKiB0aGlzLmNvbmZpZy5yYWR1aXMpXG4gICAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiI2ZmZlwiKVxuICAgICAgICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiI2UwZTBlMFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMnB4XCIpO1xuXG4gICAgICAgIGZvciAodmFyIGdyZWVuSWR4IGluIHRoaXMuY29uZmlnLmdyZWVuWm9uZXMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuZHJhd0JhbmQodGhpcy5jb25maWcuZ3JlZW5ab25lc1tncmVlbklkeF0uZnJvbSwgdGhpcy5jb25maWcuZ3JlZW5ab25lc1tncmVlbklkeF0udG8sIHNlbGYuY29uZmlnLmdyZWVuQ29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgeWVsbG93SWR4IGluIHRoaXMuY29uZmlnLnllbGxvd1pvbmVzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRyYXdCYW5kKHRoaXMuY29uZmlnLnllbGxvd1pvbmVzW3llbGxvd0lkeF0uZnJvbSwgdGhpcy5jb25maWcueWVsbG93Wm9uZXNbeWVsbG93SWR4XS50bywgc2VsZi5jb25maWcueWVsbG93Q29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgcmVkSWR4IGluIHRoaXMuY29uZmlnLnJlZFpvbmVzKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmRyYXdCYW5kKHRoaXMuY29uZmlnLnJlZFpvbmVzW3JlZElkeF0uZnJvbSwgdGhpcy5jb25maWcucmVkWm9uZXNbcmVkSWR4XS50bywgc2VsZi5jb25maWcucmVkQ29sb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGZvbnRTaXplID0gMDtcblxuICAgICAgICBpZiAodW5kZWZpbmVkICE9IHRoaXMuY29uZmlnLmxhYmVsKVxuICAgICAgICB7XG4gICAgICAgICAgICBmb250U2l6ZSA9IE1hdGgucm91bmQodGhpcy5jb25maWcuc2l6ZSAvIDkpO1xuICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZChcInN2Zzp0ZXh0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIHRoaXMuY29uZmlnLmN4KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCB0aGlzLmNvbmZpZy5jeSAvIDIgKyBmb250U2l6ZSAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBmb250U2l6ZSAvIDIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgICAgICAgIC50ZXh0KHRoaXMuY29uZmlnLmxhYmVsKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSArIFwicHhcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwiIzMzM1wiKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCBcIjBweFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvbnRTaXplID0gTWF0aC5yb3VuZCh0aGlzLmNvbmZpZy5zaXplIC8gMTYpO1xuICAgICAgICB2YXIgbWFqb3JEZWx0YSA9IHRoaXMuY29uZmlnLnJhbmdlIC8gKHRoaXMuY29uZmlnLm1ham9yVGlja3MgLSAxKTtcbiAgICAgICAgZm9yICh2YXIgbWFqb3IgPSB0aGlzLmNvbmZpZy5taW47IG1ham9yIDw9IHRoaXMuY29uZmlnLm1heDsgbWFqb3IgKz0gbWFqb3JEZWx0YSlcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG1pbm9yRGVsdGEgPSBtYWpvckRlbHRhIC8gdGhpcy5jb25maWcubWlub3JUaWNrcyxcbiAgICAgICAgICAgICAgICBwb2ludDEgPSAwLFxuICAgICAgICAgICAgICAgIHBvaW50MiA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBtaW5vciA9IG1ham9yICsgbWlub3JEZWx0YTsgbWlub3IgPCBNYXRoLm1pbihtYWpvciArIG1ham9yRGVsdGEsIHRoaXMuY29uZmlnLm1heCk7IG1pbm9yICs9IG1pbm9yRGVsdGEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcG9pbnQxID0gdGhpcy52YWx1ZVRvUG9pbnQobWlub3IsIDAuNzUpO1xuICAgICAgICAgICAgICAgIHBvaW50MiA9IHRoaXMudmFsdWVUb1BvaW50KG1pbm9yLCAwLjg1KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYm9keS5hcHBlbmQoXCJzdmc6bGluZVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIngxXCIsIHBvaW50MS54KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInkxXCIsIHBvaW50MS55KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcIngyXCIsIHBvaW50Mi54KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInkyXCIsIHBvaW50Mi55KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJzdHJva2VcIiwgXCIjNjY2XCIpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCBcIjFweFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcG9pbnQxID0gdGhpcy52YWx1ZVRvUG9pbnQobWFqb3IsIDAuNyk7XG4gICAgICAgICAgICBwb2ludDIgPSB0aGlzLnZhbHVlVG9Qb2ludChtYWpvciwgMC44NSk7XG5cbiAgICAgICAgICAgIHRoaXMuYm9keS5hcHBlbmQoXCJzdmc6bGluZVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieDFcIiwgcG9pbnQxLngpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ5MVwiLCBwb2ludDEueSlcbiAgICAgICAgICAgICAgICAuYXR0cihcIngyXCIsIHBvaW50Mi54KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieTJcIiwgcG9pbnQyLnkpXG4gICAgICAgICAgICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwiIzMzM1wiKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCBcIjJweFwiKTtcblxuICAgICAgICAgICAgaWYgKG1ham9yID09IHRoaXMuY29uZmlnLm1pbiB8fCBtYWpvciA9PSB0aGlzLmNvbmZpZy5tYXgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ID0gdGhpcy52YWx1ZVRvUG9pbnQobWFqb3IsIDAuNjMpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LmFwcGVuZChcInN2Zzp0ZXh0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCBwb2ludC54KVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgcG9pbnQueSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBmb250U2l6ZSAvIDMpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgbWFqb3IgPT0gdGhpcy5jb25maWcubWluID8gXCJzdGFydFwiIDogXCJlbmRcIilcbiAgICAgICAgICAgICAgICAgICAgLnRleHQobWFqb3IpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSArIFwicHhcIilcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiMzMzNcIilcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMHB4XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBvaW50ZXJDb250YWluZXIgPSB0aGlzLmJvZHkuYXBwZW5kKFwic3ZnOmdcIikuYXR0cihcImNsYXNzXCIsIFwicG9pbnRlckNvbnRhaW5lclwiKTtcblxuICAgICAgICB2YXIgbWlkVmFsdWUgPSAodGhpcy5jb25maWcubWluICsgdGhpcy5jb25maWcubWF4KSAvIDI7XG5cbiAgICAgICAgdmFyIHBvaW50ZXJQYXRoID0gdGhpcy5idWlsZFBvaW50ZXJQYXRoKG1pZFZhbHVlKTtcblxuICAgICAgICB2YXIgcG9pbnRlckxpbmUgPSBkMy5zdmcubGluZSgpXG4gICAgICAgICAgICAueChmdW5jdGlvbihkKSB7IHJldHVybiBkLnggfSlcbiAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQueSB9KVxuICAgICAgICAgICAgLmludGVycG9sYXRlKFwiYmFzaXNcIik7XG5cbiAgICAgICAgcG9pbnRlckNvbnRhaW5lci5zZWxlY3RBbGwoXCJwYXRoXCIpXG4gICAgICAgICAgICAuZGF0YShbcG9pbnRlclBhdGhdKVxuICAgICAgICAgICAgLmVudGVyKClcbiAgICAgICAgICAgIC5hcHBlbmQoXCJzdmc6cGF0aFwiKVxuICAgICAgICAgICAgLmF0dHIoXCJkXCIsIHBvaW50ZXJMaW5lKVxuICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiM4ODhcIik7XG5cbiAgICAgICAgcG9pbnRlckNvbnRhaW5lci5hcHBlbmQoXCJzdmc6Y2lyY2xlXCIpXG4gICAgICAgICAgICAuYXR0cihcImN4XCIsIHRoaXMuY29uZmlnLmN4KVxuICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCB0aGlzLmNvbmZpZy5jeSlcbiAgICAgICAgICAgIC5hdHRyKFwiclwiLCAwLjEyICogdGhpcy5jb25maWcucmFkdWlzKVxuICAgICAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIiM4ODhcIik7XG5cbiAgICAgICAgZm9udFNpemUgPSBNYXRoLnJvdW5kKHRoaXMuY29uZmlnLnNpemUgLyAxMCk7XG4gICAgICAgIHBvaW50ZXJDb250YWluZXIuc2VsZWN0QWxsKFwidGV4dFwiKVxuICAgICAgICAgICAgLmRhdGEoW21pZFZhbHVlXSlcbiAgICAgICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgICAuYXBwZW5kKFwic3ZnOnRleHRcIilcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCB0aGlzLmNvbmZpZy5jeClcbiAgICAgICAgICAgIC5hdHRyKFwieVwiLCB0aGlzLmNvbmZpZy5zaXplIC0gdGhpcy5jb25maWcuY3kgLyA0IC0gZm9udFNpemUpXG4gICAgICAgICAgICAuYXR0cihcImR5XCIsIGZvbnRTaXplIC8gMilcbiAgICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSArIFwicHhcIilcbiAgICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCIjMDAwXCIpXG4gICAgICAgICAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgXCIwcHhcIik7XG5cbiAgICAgICAgdGhpcy5yZWRyYXcodGhpcy5jb25maWcubWluLCAwKTtcbiAgICB9O1xuXG4gICAgdGhpcy5idWlsZFBvaW50ZXJQYXRoID0gZnVuY3Rpb24odmFsdWUpXG4gICAge1xuICAgICAgICB2YXIgZGVsdGEgPSB0aGlzLmNvbmZpZy5yYW5nZSAvIDEzO1xuXG4gICAgICAgIHZhciBoZWFkID0gdmFsdWVUb1BvaW50KHZhbHVlLCAwLjg1KTtcbiAgICAgICAgdmFyIGhlYWQxID0gdmFsdWVUb1BvaW50KHZhbHVlIC0gZGVsdGEsIDAuMTIpO1xuICAgICAgICB2YXIgaGVhZDIgPSB2YWx1ZVRvUG9pbnQodmFsdWUgKyBkZWx0YSwgMC4xMik7XG5cbiAgICAgICAgdmFyIHRhaWxWYWx1ZSA9IHZhbHVlIC0gKHRoaXMuY29uZmlnLnJhbmdlICogKDEvKDI3MC8zNjApKSAvIDIpO1xuICAgICAgICB2YXIgdGFpbCA9IHZhbHVlVG9Qb2ludCh0YWlsVmFsdWUsIDAuMjgpO1xuICAgICAgICB2YXIgdGFpbDEgPSB2YWx1ZVRvUG9pbnQodGFpbFZhbHVlIC0gZGVsdGEsIDAuMTIpO1xuICAgICAgICB2YXIgdGFpbDIgPSB2YWx1ZVRvUG9pbnQodGFpbFZhbHVlICsgZGVsdGEsIDAuMTIpO1xuXG4gICAgICAgIHJldHVybiBbaGVhZCwgaGVhZDEsIHRhaWwyLCB0YWlsLCB0YWlsMSwgaGVhZDIsIGhlYWRdO1xuXG4gICAgICAgIGZ1bmN0aW9uIHZhbHVlVG9Qb2ludCh2YWx1ZSwgZmFjdG9yKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9pbnQgPSBzZWxmLnZhbHVlVG9Qb2ludCh2YWx1ZSwgZmFjdG9yKTtcbiAgICAgICAgICAgIHBvaW50LnggLT0gc2VsZi5jb25maWcuY3g7XG4gICAgICAgICAgICBwb2ludC55IC09IHNlbGYuY29uZmlnLmN5O1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZHJhd0JhbmQgPSBmdW5jdGlvbihzdGFydCwgZW5kLCBjb2xvcilcbiAgICB7XG4gICAgICAgIGlmICgwID49IGVuZCAtIHN0YXJ0KSByZXR1cm47XG5cbiAgICAgICAgdGhpcy5ib2R5LmFwcGVuZChcInN2ZzpwYXRoXCIpXG4gICAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIGNvbG9yKVxuICAgICAgICAgICAgLmF0dHIoXCJkXCIsIGQzLnN2Zy5hcmMoKVxuICAgICAgICAgICAgICAgIC5zdGFydEFuZ2xlKHRoaXMudmFsdWVUb1JhZGlhbnMoc3RhcnQpKVxuICAgICAgICAgICAgICAgIC5lbmRBbmdsZSh0aGlzLnZhbHVlVG9SYWRpYW5zKGVuZCkpXG4gICAgICAgICAgICAgICAgLmlubmVyUmFkaXVzKDAuNjUgKiB0aGlzLmNvbmZpZy5yYWR1aXMpXG4gICAgICAgICAgICAgICAgLm91dGVyUmFkaXVzKDAuODUgKiB0aGlzLmNvbmZpZy5yYWR1aXMpKVxuICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZnVuY3Rpb24oKSB7IHJldHVybiBcInRyYW5zbGF0ZShcIiArIHNlbGYuY29uZmlnLmN4ICsgXCIsIFwiICsgc2VsZi5jb25maWcuY3kgKyBcIikgcm90YXRlKDI3MClcIiB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5yZWRyYXcgPSBmdW5jdGlvbih2YWx1ZSwgdHJhbnNpdGlvbkR1cmF0aW9uKVxuICAgIHtcbiAgICAgICAgdmFyIHBvaW50ZXJDb250YWluZXIgPSB0aGlzLmJvZHkuc2VsZWN0KFwiLnBvaW50ZXJDb250YWluZXJcIik7XG5cbiAgICAgICAgcG9pbnRlckNvbnRhaW5lci5zZWxlY3RBbGwoXCJ0ZXh0XCIpLnRleHQoTWF0aC5yb3VuZCh2YWx1ZSkpO1xuXG4gICAgICAgIHZhciBwb2ludGVyID0gcG9pbnRlckNvbnRhaW5lci5zZWxlY3RBbGwoXCJwYXRoXCIpO1xuICAgICAgICBwb2ludGVyLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLmR1cmF0aW9uKHVuZGVmaW5lZCAhPSB0cmFuc2l0aW9uRHVyYXRpb24gPyB0cmFuc2l0aW9uRHVyYXRpb24gOiB0aGlzLmNvbmZpZy50cmFuc2l0aW9uRHVyYXRpb24pXG4gICAgICAgICAgICAvLy5kZWxheSgwKVxuICAgICAgICAgICAgLy8uZWFzZShcImxpbmVhclwiKVxuICAgICAgICAgICAgLy8uYXR0cihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbihkKVxuICAgICAgICAgICAgLmF0dHJUd2VlbihcInRyYW5zZm9ybVwiLCBmdW5jdGlvbigpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ZXJWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+IHNlbGYuY29uZmlnLm1heCkgcG9pbnRlclZhbHVlID0gc2VsZi5jb25maWcubWF4ICsgMC4wMipzZWxmLmNvbmZpZy5yYW5nZTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IHNlbGYuY29uZmlnLm1pbikgcG9pbnRlclZhbHVlID0gc2VsZi5jb25maWcubWluIC0gMC4wMipzZWxmLmNvbmZpZy5yYW5nZTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0Um90YXRpb24gPSAoc2VsZi52YWx1ZVRvRGVncmVlcyhwb2ludGVyVmFsdWUpIC0gOTApO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Um90YXRpb24gPSBzZWxmLl9jdXJyZW50Um90YXRpb24gfHwgdGFyZ2V0Um90YXRpb247XG4gICAgICAgICAgICAgICAgc2VsZi5fY3VycmVudFJvdGF0aW9uID0gdGFyZ2V0Um90YXRpb247XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oc3RlcClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3RhdGlvbiA9IGN1cnJlbnRSb3RhdGlvbiArICh0YXJnZXRSb3RhdGlvbi1jdXJyZW50Um90YXRpb24pKnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInRyYW5zbGF0ZShcIiArIHNlbGYuY29uZmlnLmN4ICsgXCIsIFwiICsgc2VsZi5jb25maWcuY3kgKyBcIikgcm90YXRlKFwiICsgcm90YXRpb24gKyBcIilcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB2YXIgb3V0ZXJDaXJjbGUgPSB0aGlzLmJvZHkuc2VsZWN0KFwiLm91dGVyLWNpcmNsZVwiKVxuICAgICAgICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLmR1cmF0aW9uKDc1MClcbiAgICAgICAgICAgIC5zdHlsZShcImZpbGxcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBpID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpID4gMCAmJiBpIDwgNzUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLmdyZWVuQ29sb3I7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID49IDc1ICYmIGkgPCA5MCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5jb25maWcueWVsbG93Q29sb3I7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLnJlZENvbG9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0aGlzLnZhbHVlVG9EZWdyZWVzID0gZnVuY3Rpb24odmFsdWUpXG4gICAge1xuICAgICAgICAvLyB0aGFua3MgQGNsb3NlYWxlcnRcbiAgICAgICAgLy9yZXR1cm4gdmFsdWUgLyB0aGlzLmNvbmZpZy5yYW5nZSAqIDI3MCAtIDQ1O1xuICAgICAgICByZXR1cm4gdmFsdWUgLyB0aGlzLmNvbmZpZy5yYW5nZSAqIDI3MCAtICh0aGlzLmNvbmZpZy5taW4gLyB0aGlzLmNvbmZpZy5yYW5nZSAqIDI3MCArIDQ1KTtcbiAgICB9O1xuXG4gICAgdGhpcy52YWx1ZVRvUmFkaWFucyA9IGZ1bmN0aW9uKHZhbHVlKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVUb0RlZ3JlZXModmFsdWUpICogTWF0aC5QSSAvIDE4MDtcbiAgICB9O1xuXG4gICAgdGhpcy52YWx1ZVRvUG9pbnQgPSBmdW5jdGlvbih2YWx1ZSwgZmFjdG9yKVxuICAgIHtcbiAgICAgICAgcmV0dXJuIHsgXHR4OiB0aGlzLmNvbmZpZy5jeCAtIHRoaXMuY29uZmlnLnJhZHVpcyAqIGZhY3RvciAqIE1hdGguY29zKHRoaXMudmFsdWVUb1JhZGlhbnModmFsdWUpKSxcbiAgICAgICAgICAgIHk6IHRoaXMuY29uZmlnLmN5IC0gdGhpcy5jb25maWcucmFkdWlzICogZmFjdG9yICogTWF0aC5zaW4odGhpcy52YWx1ZVRvUmFkaWFucyh2YWx1ZSkpIFx0XHR9O1xuICAgIH07XG5cbiAgICAvLyBpbml0aWFsaXphdGlvblxuICAgIHRoaXMuY29uZmlndXJlKGNvbmZpZ3VyYXRpb24pO1xufSIsIi8qISBcbiAqIGFuZ3VsYXItaG90a2V5cyB2MS41LjBcbiAqIGh0dHBzOi8vY2hpZWZmYW5jeXBhbnRzLmdpdGh1Yi5pby9hbmd1bGFyLWhvdGtleXNcbiAqIENvcHlyaWdodCAoYykgMjAxNSBXZXMgQ3J1dmVyXG4gKiBMaWNlbnNlOiBNSVRcbiAqL1xuIWZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7YW5ndWxhci5tb2R1bGUoXCJjZnAuaG90a2V5c1wiLFtdKS5wcm92aWRlcihcImhvdGtleXNcIixbXCIkaW5qZWN0b3JcIixmdW5jdGlvbihhKXt0aGlzLmluY2x1ZGVDaGVhdFNoZWV0PSEwLHRoaXMudXNlTmdSb3V0ZT1hLmhhcyhcIm5nVmlld0RpcmVjdGl2ZVwiKSx0aGlzLnRlbXBsYXRlVGl0bGU9XCJLZXlib2FyZCBTaG9ydGN1dHM6XCIsdGhpcy50ZW1wbGF0ZUhlYWRlcj1udWxsLHRoaXMudGVtcGxhdGVGb290ZXI9bnVsbCx0aGlzLnRlbXBsYXRlPSc8ZGl2IGNsYXNzPVwiY2ZwLWhvdGtleXMtY29udGFpbmVyIGZhZGVcIiBuZy1jbGFzcz1cIntpbjogaGVscFZpc2libGV9XCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjxkaXYgY2xhc3M9XCJjZnAtaG90a2V5c1wiPjxoNCBjbGFzcz1cImNmcC1ob3RrZXlzLXRpdGxlXCIgbmctaWY9XCIhaGVhZGVyXCI+e3sgdGl0bGUgfX08L2g0PjxkaXYgbmctYmluZC1odG1sPVwiaGVhZGVyXCIgbmctaWY9XCJoZWFkZXJcIj48L2Rpdj48dGFibGU+PHRib2R5Pjx0ciBuZy1yZXBlYXQ9XCJob3RrZXkgaW4gaG90a2V5cyB8IGZpbHRlcjp7IGRlc2NyaXB0aW9uOiBcXCchJCR1bmRlZmluZWQkJFxcJyB9XCI+PHRkIGNsYXNzPVwiY2ZwLWhvdGtleXMta2V5c1wiPjxzcGFuIG5nLXJlcGVhdD1cImtleSBpbiBob3RrZXkuZm9ybWF0KCkgdHJhY2sgYnkgJGluZGV4XCIgY2xhc3M9XCJjZnAtaG90a2V5cy1rZXlcIj57eyBrZXkgfX08L3NwYW4+PC90ZD48dGQgY2xhc3M9XCJjZnAtaG90a2V5cy10ZXh0XCI+e3sgaG90a2V5LmRlc2NyaXB0aW9uIH19PC90ZD48L3RyPjwvdGJvZHk+PC90YWJsZT48ZGl2IG5nLWJpbmQtaHRtbD1cImZvb3RlclwiIG5nLWlmPVwiZm9vdGVyXCI+PC9kaXY+PGRpdiBjbGFzcz1cImNmcC1ob3RrZXlzLWNsb3NlXCIgbmctY2xpY2s9XCJ0b2dnbGVDaGVhdFNoZWV0KClcIj7DlzwvZGl2PjwvZGl2PjwvZGl2PicsdGhpcy5jaGVhdFNoZWV0SG90a2V5PVwiP1wiLHRoaXMuY2hlYXRTaGVldERlc2NyaXB0aW9uPVwiU2hvdyAvIGhpZGUgdGhpcyBoZWxwIG1lbnVcIix0aGlzLiRnZXQ9W1wiJHJvb3RFbGVtZW50XCIsXCIkcm9vdFNjb3BlXCIsXCIkY29tcGlsZVwiLFwiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYSxiLGMsZCxlKXtmdW5jdGlvbiBmKGEpe3ZhciBiPXtjb21tYW5kOlwi4oyYXCIsc2hpZnQ6XCLih6dcIixsZWZ0Olwi4oaQXCIscmlnaHQ6XCLihpJcIix1cDpcIuKGkVwiLGRvd246XCLihpNcIixcInJldHVyblwiOlwi4oapXCIsYmFja3NwYWNlOlwi4oyrXCJ9O2E9YS5zcGxpdChcIitcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspXCJtb2RcIj09PWFbY10mJihkLm5hdmlnYXRvciYmZC5uYXZpZ2F0b3IucGxhdGZvcm0uaW5kZXhPZihcIk1hY1wiKT49MD9hW2NdPVwiY29tbWFuZFwiOmFbY109XCJjdHJsXCIpLGFbY109YlthW2NdXXx8YVtjXTtyZXR1cm4gYS5qb2luKFwiICsgXCIpfWZ1bmN0aW9uIGcoYSxiLGMsZCxlLGYpe3RoaXMuY29tYm89YSBpbnN0YW5jZW9mIEFycmF5P2E6W2FdLHRoaXMuZGVzY3JpcHRpb249Yix0aGlzLmNhbGxiYWNrPWMsdGhpcy5hY3Rpb249ZCx0aGlzLmFsbG93SW49ZSx0aGlzLnBlcnNpc3RlbnQ9Zix0aGlzLl9mb3JtYXRlZD1udWxsfWZ1bmN0aW9uIGgoKXtmb3IodmFyIGE9by5ob3RrZXlzLmxlbmd0aDthLS07KXt2YXIgYj1vLmhvdGtleXNbYV07YiYmIWIucGVyc2lzdGVudCYmayhiKX19ZnVuY3Rpb24gaSgpe28uaGVscFZpc2libGU9IW8uaGVscFZpc2libGUsby5oZWxwVmlzaWJsZT8odD1sKFwiZXNjXCIpLGsoXCJlc2NcIiksaihcImVzY1wiLHQuZGVzY3JpcHRpb24saSxudWxsLFtcIklOUFVUXCIsXCJTRUxFQ1RcIixcIlRFWFRBUkVBXCJdKSk6KGsoXCJlc2NcIiksdCE9PSExJiZqKHQpKX1mdW5jdGlvbiBqKGEsYixjLGQsZSxmKXt2YXIgaCxpPVtcIklOUFVUXCIsXCJTRUxFQ1RcIixcIlRFWFRBUkVBXCJdLGo9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpO2lmKFwiW29iamVjdCBPYmplY3RdXCI9PT1qJiYoYj1hLmRlc2NyaXB0aW9uLGM9YS5jYWxsYmFjayxkPWEuYWN0aW9uLGY9YS5wZXJzaXN0ZW50LGU9YS5hbGxvd0luLGE9YS5jb21ibyksYiBpbnN0YW5jZW9mIEZ1bmN0aW9uPyhkPWMsYz1iLGI9XCIkJHVuZGVmaW5lZCQkXCIpOmFuZ3VsYXIuaXNVbmRlZmluZWQoYikmJihiPVwiJCR1bmRlZmluZWQkJFwiKSx2b2lkIDA9PT1mJiYoZj0hMCksXCJmdW5jdGlvblwiPT10eXBlb2YgYyl7aD1jLGUgaW5zdGFuY2VvZiBBcnJheXx8KGU9W10pO2Zvcih2YXIgayxsPTA7bDxlLmxlbmd0aDtsKyspZVtsXT1lW2xdLnRvVXBwZXJDYXNlKCksaz1pLmluZGV4T2YoZVtsXSksLTEhPT1rJiZpLnNwbGljZShrLDEpO2M9ZnVuY3Rpb24oYSl7dmFyIGI9ITAsYz1hLnRhcmdldHx8YS5zcmNFbGVtZW50LGQ9Yy5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpO2lmKChcIiBcIitjLmNsYXNzTmFtZStcIiBcIikuaW5kZXhPZihcIiBtb3VzZXRyYXAgXCIpPi0xKWI9ITA7ZWxzZSBmb3IodmFyIGU9MDtlPGkubGVuZ3RoO2UrKylpZihpW2VdPT09ZCl7Yj0hMTticmVha31iJiZuKGguYXBwbHkodGhpcyxhcmd1bWVudHMpKX19XCJzdHJpbmdcIj09dHlwZW9mIGQ/TW91c2V0cmFwLmJpbmQoYSxuKGMpLGQpOk1vdXNldHJhcC5iaW5kKGEsbihjKSk7dmFyIG09bmV3IGcoYSxiLGMsZCxlLGYpO3JldHVybiBvLmhvdGtleXMucHVzaChtKSxtfWZ1bmN0aW9uIGsoYSl7dmFyIGI9YSBpbnN0YW5jZW9mIGc/YS5jb21ibzphO2lmKE1vdXNldHJhcC51bmJpbmQoYiksYW5ndWxhci5pc0FycmF5KGIpKXtmb3IodmFyIGM9ITAsZD1iLmxlbmd0aDtkLS07KWM9ayhiW2RdKSYmYztyZXR1cm4gY312YXIgZT1vLmhvdGtleXMuaW5kZXhPZihsKGIpKTtyZXR1cm4gZT4tMT8oby5ob3RrZXlzW2VdLmNvbWJvLmxlbmd0aD4xP28uaG90a2V5c1tlXS5jb21iby5zcGxpY2Uoby5ob3RrZXlzW2VdLmNvbWJvLmluZGV4T2YoYiksMSk6by5ob3RrZXlzLnNwbGljZShlLDEpLCEwKTohMX1mdW5jdGlvbiBsKGEpe2lmKCFhKXJldHVybiBvLmhvdGtleXM7Zm9yKHZhciBiLGM9MDtjPG8uaG90a2V5cy5sZW5ndGg7YysrKWlmKGI9by5ob3RrZXlzW2NdLGIuY29tYm8uaW5kZXhPZihhKT4tMSlyZXR1cm4gYjtyZXR1cm4hMX1mdW5jdGlvbiBtKGEpe3JldHVybiBhLiRpZCBpbiBwfHwocFthLiRpZF09W10sYS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Zm9yKHZhciBiPXBbYS4kaWRdLmxlbmd0aDtiLS07KWsocFthLiRpZF0ucG9wKCkpfSkpLHthZGQ6ZnVuY3Rpb24oYil7dmFyIGM7cmV0dXJuIGM9YXJndW1lbnRzLmxlbmd0aD4xP2ouYXBwbHkodGhpcyxhcmd1bWVudHMpOmooYikscFthLiRpZF0ucHVzaChjKSx0aGlzfX19ZnVuY3Rpb24gbihhKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXtpZihhIGluc3RhbmNlb2YgQXJyYXkpe3ZhciBlPWFbMF0sZj1hWzFdO2E9ZnVuY3Rpb24oYSl7Zi5zY29wZS4kZXZhbChlKX19Yi4kYXBwbHkoZnVuY3Rpb24oKXthKGMsbChkKSl9KX19TW91c2V0cmFwLnByb3RvdHlwZS5zdG9wQ2FsbGJhY2s9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oXCIgXCIrYi5jbGFzc05hbWUrXCIgXCIpLmluZGV4T2YoXCIgbW91c2V0cmFwIFwiKT4tMT8hMTpiLmNvbnRlbnRFZGl0YWJsZSYmXCJ0cnVlXCI9PWIuY29udGVudEVkaXRhYmxlfSxnLnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24oKXtpZihudWxsPT09dGhpcy5fZm9ybWF0ZWQpe2Zvcih2YXIgYT10aGlzLmNvbWJvWzBdLGI9YS5zcGxpdCgvW1xcc10vKSxjPTA7YzxiLmxlbmd0aDtjKyspYltjXT1mKGJbY10pO3RoaXMuX2Zvcm1hdGVkPWJ9cmV0dXJuIHRoaXMuX2Zvcm1hdGVkfTt2YXIgbz1iLiRuZXcoKTtvLmhvdGtleXM9W10sby5oZWxwVmlzaWJsZT0hMSxvLnRpdGxlPXRoaXMudGVtcGxhdGVUaXRsZSxvLmhlYWRlcj10aGlzLnRlbXBsYXRlSGVhZGVyLG8uZm9vdGVyPXRoaXMudGVtcGxhdGVGb290ZXIsby50b2dnbGVDaGVhdFNoZWV0PWk7dmFyIHA9W107aWYodGhpcy51c2VOZ1JvdXRlJiZiLiRvbihcIiRyb3V0ZUNoYW5nZVN1Y2Nlc3NcIixmdW5jdGlvbihhLGIpe2goKSxiJiZiLmhvdGtleXMmJmFuZ3VsYXIuZm9yRWFjaChiLmhvdGtleXMsZnVuY3Rpb24oYSl7dmFyIGM9YVsyXTsoXCJzdHJpbmdcIj09dHlwZW9mIGN8fGMgaW5zdGFuY2VvZiBTdHJpbmcpJiYoYVsyXT1bYyxiXSksYVs1XT0hMSxqLmFwcGx5KHRoaXMsYSl9KX0pLHRoaXMuaW5jbHVkZUNoZWF0U2hlZXQpe3ZhciBxPWVbMF0scj1hWzBdLHM9YW5ndWxhci5lbGVtZW50KHRoaXMudGVtcGxhdGUpO2oodGhpcy5jaGVhdFNoZWV0SG90a2V5LHRoaXMuY2hlYXRTaGVldERlc2NyaXB0aW9uLGkpLChyPT09cXx8cj09PXEuZG9jdW1lbnRFbGVtZW50KSYmKHI9cS5ib2R5KSxhbmd1bGFyLmVsZW1lbnQocikuYXBwZW5kKGMocykobykpfXZhciB0PSExLHU9e2FkZDpqLGRlbDprLGdldDpsLGJpbmRUbzptLHRlbXBsYXRlOnRoaXMudGVtcGxhdGUsdG9nZ2xlQ2hlYXRTaGVldDppLGluY2x1ZGVDaGVhdFNoZWV0OnRoaXMuaW5jbHVkZUNoZWF0U2hlZXQsY2hlYXRTaGVldEhvdGtleTp0aGlzLmNoZWF0U2hlZXRIb3RrZXksY2hlYXRTaGVldERlc2NyaXB0aW9uOnRoaXMuY2hlYXRTaGVldERlc2NyaXB0aW9uLHVzZU5nUm91dGU6dGhpcy51c2VOZ1JvdXRlLHB1cmdlSG90a2V5czpoLHRlbXBsYXRlVGl0bGU6dGhpcy50ZW1wbGF0ZVRpdGxlfTtyZXR1cm4gdX1dfV0pLmRpcmVjdGl2ZShcImhvdGtleVwiLFtcImhvdGtleXNcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsbGluazpmdW5jdGlvbihiLGMsZCl7dmFyIGUsZjthbmd1bGFyLmZvckVhY2goYi4kZXZhbChkLmhvdGtleSksZnVuY3Rpb24oYixjKXtmPVwic3RyaW5nXCI9PXR5cGVvZiBkLmhvdGtleUFsbG93SW4/ZC5ob3RrZXlBbGxvd0luLnNwbGl0KC9bXFxzLF0rLyk6W10sZT1jLGEuYWRkKHtjb21ibzpjLGRlc2NyaXB0aW9uOmQuaG90a2V5RGVzY3JpcHRpb24sY2FsbGJhY2s6YixhY3Rpb246ZC5ob3RrZXlBY3Rpb24sYWxsb3dJbjpmfSl9KSxjLmJpbmQoXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YS5kZWwoZSl9KX19fV0pLnJ1bihbXCJob3RrZXlzXCIsZnVuY3Rpb24oYSl7fV0pfSgpLGZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGEsYixjKXtyZXR1cm4gYS5hZGRFdmVudExpc3RlbmVyP3ZvaWQgYS5hZGRFdmVudExpc3RlbmVyKGIsYywhMSk6dm9pZCBhLmF0dGFjaEV2ZW50KFwib25cIitiLGMpfWZ1bmN0aW9uIGUoYSl7aWYoXCJrZXlwcmVzc1wiPT1hLnR5cGUpe3ZhciBiPVN0cmluZy5mcm9tQ2hhckNvZGUoYS53aGljaCk7cmV0dXJuIGEuc2hpZnRLZXl8fChiPWIudG9Mb3dlckNhc2UoKSksYn1yZXR1cm4gclthLndoaWNoXT9yW2Eud2hpY2hdOnNbYS53aGljaF0/c1thLndoaWNoXTpTdHJpbmcuZnJvbUNoYXJDb2RlKGEud2hpY2gpLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gZihhLGIpe3JldHVybiBhLnNvcnQoKS5qb2luKFwiLFwiKT09PWIuc29ydCgpLmpvaW4oXCIsXCIpfWZ1bmN0aW9uIGcoYSl7dmFyIGI9W107cmV0dXJuIGEuc2hpZnRLZXkmJmIucHVzaChcInNoaWZ0XCIpLGEuYWx0S2V5JiZiLnB1c2goXCJhbHRcIiksYS5jdHJsS2V5JiZiLnB1c2goXCJjdHJsXCIpLGEubWV0YUtleSYmYi5wdXNoKFwibWV0YVwiKSxifWZ1bmN0aW9uIGgoYSl7cmV0dXJuIGEucHJldmVudERlZmF1bHQ/dm9pZCBhLnByZXZlbnREZWZhdWx0KCk6dm9pZChhLnJldHVyblZhbHVlPSExKX1mdW5jdGlvbiBpKGEpe3JldHVybiBhLnN0b3BQcm9wYWdhdGlvbj92b2lkIGEuc3RvcFByb3BhZ2F0aW9uKCk6dm9pZChhLmNhbmNlbEJ1YmJsZT0hMCl9ZnVuY3Rpb24gaihhKXtyZXR1cm5cInNoaWZ0XCI9PWF8fFwiY3RybFwiPT1hfHxcImFsdFwiPT1hfHxcIm1ldGFcIj09YX1mdW5jdGlvbiBrKCl7aWYoIXEpe3E9e307Zm9yKHZhciBhIGluIHIpYT45NSYmMTEyPmF8fHIuaGFzT3duUHJvcGVydHkoYSkmJihxW3JbYV1dPWEpfXJldHVybiBxfWZ1bmN0aW9uIGwoYSxiLGMpe3JldHVybiBjfHwoYz1rKClbYV0/XCJrZXlkb3duXCI6XCJrZXlwcmVzc1wiKSxcImtleXByZXNzXCI9PWMmJmIubGVuZ3RoJiYoYz1cImtleWRvd25cIiksY31mdW5jdGlvbiBtKGEpe3JldHVyblwiK1wiPT09YT9bXCIrXCJdOihhPWEucmVwbGFjZSgvXFwrezJ9L2csXCIrcGx1c1wiKSxhLnNwbGl0KFwiK1wiKSl9ZnVuY3Rpb24gbihhLGIpe3ZhciBjLGQsZSxmPVtdO2ZvcihjPW0oYSksZT0wO2U8Yy5sZW5ndGg7KytlKWQ9Y1tlXSx1W2RdJiYoZD11W2RdKSxiJiZcImtleXByZXNzXCIhPWImJnRbZF0mJihkPXRbZF0sZi5wdXNoKFwic2hpZnRcIikpLGooZCkmJmYucHVzaChkKTtyZXR1cm4gYj1sKGQsZixiKSx7a2V5OmQsbW9kaWZpZXJzOmYsYWN0aW9uOmJ9fWZ1bmN0aW9uIG8oYSxjKXtyZXR1cm4gYT09PWI/ITE6YT09PWM/ITA6byhhLnBhcmVudE5vZGUsYyl9ZnVuY3Rpb24gcChhKXtmdW5jdGlvbiBjKGEpe2E9YXx8e307dmFyIGIsYz0hMTtmb3IoYiBpbiB1KWFbYl0/Yz0hMDp1W2JdPTA7Y3x8KHg9ITEpfWZ1bmN0aW9uIGsoYSxiLGMsZCxlLGcpe3ZhciBoLGksaz1bXSxsPWMudHlwZTtpZighcy5fY2FsbGJhY2tzW2FdKXJldHVybltdO2ZvcihcImtleXVwXCI9PWwmJmooYSkmJihiPVthXSksaD0wO2g8cy5fY2FsbGJhY2tzW2FdLmxlbmd0aDsrK2gpaWYoaT1zLl9jYWxsYmFja3NbYV1baF0sKGR8fCFpLnNlcXx8dVtpLnNlcV09PWkubGV2ZWwpJiZsPT1pLmFjdGlvbiYmKFwia2V5cHJlc3NcIj09bCYmIWMubWV0YUtleSYmIWMuY3RybEtleXx8ZihiLGkubW9kaWZpZXJzKSkpe3ZhciBtPSFkJiZpLmNvbWJvPT1lLG49ZCYmaS5zZXE9PWQmJmkubGV2ZWw9PWc7KG18fG4pJiZzLl9jYWxsYmFja3NbYV0uc3BsaWNlKGgsMSksay5wdXNoKGkpfXJldHVybiBrfWZ1bmN0aW9uIGwoYSxiLGMsZCl7cy5zdG9wQ2FsbGJhY2soYixiLnRhcmdldHx8Yi5zcmNFbGVtZW50LGMsZCl8fGEoYixjKT09PSExJiYoaChiKSxpKGIpKX1mdW5jdGlvbiBtKGEpe1wibnVtYmVyXCIhPXR5cGVvZiBhLndoaWNoJiYoYS53aGljaD1hLmtleUNvZGUpO3ZhciBiPWUoYSk7aWYoYilyZXR1cm5cImtleXVwXCI9PWEudHlwZSYmdj09PWI/dm9pZCh2PSExKTp2b2lkIHMuaGFuZGxlS2V5KGIsZyhhKSxhKX1mdW5jdGlvbiBvKCl7Y2xlYXJUaW1lb3V0KHQpLHQ9c2V0VGltZW91dChjLDFlMyl9ZnVuY3Rpb24gcShhLGIsZCxmKXtmdW5jdGlvbiBnKGIpe3JldHVybiBmdW5jdGlvbigpe3g9YiwrK3VbYV0sbygpfX1mdW5jdGlvbiBoKGIpe2woZCxiLGEpLFwia2V5dXBcIiE9PWYmJih2PWUoYikpLHNldFRpbWVvdXQoYywxMCl9dVthXT0wO2Zvcih2YXIgaT0wO2k8Yi5sZW5ndGg7KytpKXt2YXIgaj1pKzE9PT1iLmxlbmd0aCxrPWo/aDpnKGZ8fG4oYltpKzFdKS5hY3Rpb24pO3IoYltpXSxrLGYsYSxpKX19ZnVuY3Rpb24gcihhLGIsYyxkLGUpe3MuX2RpcmVjdE1hcFthK1wiOlwiK2NdPWIsYT1hLnJlcGxhY2UoL1xccysvZyxcIiBcIik7dmFyIGYsZz1hLnNwbGl0KFwiIFwiKTtyZXR1cm4gZy5sZW5ndGg+MT92b2lkIHEoYSxnLGIsYyk6KGY9bihhLGMpLHMuX2NhbGxiYWNrc1tmLmtleV09cy5fY2FsbGJhY2tzW2Yua2V5XXx8W10sayhmLmtleSxmLm1vZGlmaWVycyx7dHlwZTpmLmFjdGlvbn0sZCxhLGUpLHZvaWQgcy5fY2FsbGJhY2tzW2Yua2V5XVtkP1widW5zaGlmdFwiOlwicHVzaFwiXSh7Y2FsbGJhY2s6Yixtb2RpZmllcnM6Zi5tb2RpZmllcnMsYWN0aW9uOmYuYWN0aW9uLHNlcTpkLGxldmVsOmUsY29tYm86YX0pKX12YXIgcz10aGlzO2lmKGE9YXx8YiwhKHMgaW5zdGFuY2VvZiBwKSlyZXR1cm4gbmV3IHAoYSk7cy50YXJnZXQ9YSxzLl9jYWxsYmFja3M9e30scy5fZGlyZWN0TWFwPXt9O3ZhciB0LHU9e30sdj0hMSx3PSExLHg9ITE7cy5faGFuZGxlS2V5PWZ1bmN0aW9uKGEsYixkKXt2YXIgZSxmPWsoYSxiLGQpLGc9e30saD0wLGk9ITE7Zm9yKGU9MDtlPGYubGVuZ3RoOysrZSlmW2VdLnNlcSYmKGg9TWF0aC5tYXgoaCxmW2VdLmxldmVsKSk7Zm9yKGU9MDtlPGYubGVuZ3RoOysrZSlpZihmW2VdLnNlcSl7aWYoZltlXS5sZXZlbCE9aCljb250aW51ZTtpPSEwLGdbZltlXS5zZXFdPTEsbChmW2VdLmNhbGxiYWNrLGQsZltlXS5jb21ibyxmW2VdLnNlcSl9ZWxzZSBpfHxsKGZbZV0uY2FsbGJhY2ssZCxmW2VdLmNvbWJvKTt2YXIgbT1cImtleXByZXNzXCI9PWQudHlwZSYmdztkLnR5cGUhPXh8fGooYSl8fG18fGMoZyksdz1pJiZcImtleWRvd25cIj09ZC50eXBlfSxzLl9iaW5kTXVsdGlwbGU9ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGg7KytkKXIoYVtkXSxiLGMpfSxkKGEsXCJrZXlwcmVzc1wiLG0pLGQoYSxcImtleWRvd25cIixtKSxkKGEsXCJrZXl1cFwiLG0pfWZvcih2YXIgcSxyPXs4OlwiYmFja3NwYWNlXCIsOTpcInRhYlwiLDEzOlwiZW50ZXJcIiwxNjpcInNoaWZ0XCIsMTc6XCJjdHJsXCIsMTg6XCJhbHRcIiwyMDpcImNhcHNsb2NrXCIsMjc6XCJlc2NcIiwzMjpcInNwYWNlXCIsMzM6XCJwYWdldXBcIiwzNDpcInBhZ2Vkb3duXCIsMzU6XCJlbmRcIiwzNjpcImhvbWVcIiwzNzpcImxlZnRcIiwzODpcInVwXCIsMzk6XCJyaWdodFwiLDQwOlwiZG93blwiLDQ1OlwiaW5zXCIsNDY6XCJkZWxcIiw5MTpcIm1ldGFcIiw5MzpcIm1ldGFcIiwyMjQ6XCJtZXRhXCJ9LHM9ezEwNjpcIipcIiwxMDc6XCIrXCIsMTA5OlwiLVwiLDExMDpcIi5cIiwxMTE6XCIvXCIsMTg2OlwiO1wiLDE4NzpcIj1cIiwxODg6XCIsXCIsMTg5OlwiLVwiLDE5MDpcIi5cIiwxOTE6XCIvXCIsMTkyOlwiYFwiLDIxOTpcIltcIiwyMjA6XCJcXFxcXCIsMjIxOlwiXVwiLDIyMjpcIidcIn0sdD17XCJ+XCI6XCJgXCIsXCIhXCI6XCIxXCIsXCJAXCI6XCIyXCIsXCIjXCI6XCIzXCIsJDpcIjRcIixcIiVcIjpcIjVcIixcIl5cIjpcIjZcIixcIiZcIjpcIjdcIixcIipcIjpcIjhcIixcIihcIjpcIjlcIixcIilcIjpcIjBcIixfOlwiLVwiLFwiK1wiOlwiPVwiLFwiOlwiOlwiO1wiLCdcIic6XCInXCIsXCI8XCI6XCIsXCIsXCI+XCI6XCIuXCIsXCI/XCI6XCIvXCIsXCJ8XCI6XCJcXFxcXCJ9LHU9e29wdGlvbjpcImFsdFwiLGNvbW1hbmQ6XCJtZXRhXCIsXCJyZXR1cm5cIjpcImVudGVyXCIsZXNjYXBlOlwiZXNjXCIscGx1czpcIitcIixtb2Q6L01hY3xpUG9kfGlQaG9uZXxpUGFkLy50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk/XCJtZXRhXCI6XCJjdHJsXCJ9LHY9MTsyMD52OysrdilyWzExMSt2XT1cImZcIit2O2Zvcih2PTA7OT49djsrK3Ypclt2Kzk2XT12O3AucHJvdG90eXBlLmJpbmQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7cmV0dXJuIGE9YSBpbnN0YW5jZW9mIEFycmF5P2E6W2FdLGQuX2JpbmRNdWx0aXBsZS5jYWxsKGQsYSxiLGMpLGR9LHAucHJvdG90eXBlLnVuYmluZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7cmV0dXJuIGMuYmluZC5jYWxsKGMsYSxmdW5jdGlvbigpe30sYil9LHAucHJvdG90eXBlLnRyaWdnZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3JldHVybiBjLl9kaXJlY3RNYXBbYStcIjpcIitiXSYmYy5fZGlyZWN0TWFwW2ErXCI6XCIrYl0oe30sYSksY30scC5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiBhLl9jYWxsYmFja3M9e30sYS5fZGlyZWN0TWFwPXt9LGF9LHAucHJvdG90eXBlLnN0b3BDYWxsYmFjaz1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7cmV0dXJuKFwiIFwiK2IuY2xhc3NOYW1lK1wiIFwiKS5pbmRleE9mKFwiIG1vdXNldHJhcCBcIik+LTE/ITE6byhiLGMudGFyZ2V0KT8hMTpcIklOUFVUXCI9PWIudGFnTmFtZXx8XCJTRUxFQ1RcIj09Yi50YWdOYW1lfHxcIlRFWFRBUkVBXCI9PWIudGFnTmFtZXx8Yi5pc0NvbnRlbnRFZGl0YWJsZX0scC5wcm90b3R5cGUuaGFuZGxlS2V5PWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gYS5faGFuZGxlS2V5LmFwcGx5KGEsYXJndW1lbnRzKX0scC5pbml0PWZ1bmN0aW9uKCl7dmFyIGE9cChiKTtmb3IodmFyIGMgaW4gYSlcIl9cIiE9PWMuY2hhckF0KDApJiYocFtjXT1mdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYVtiXS5hcHBseShhLGFyZ3VtZW50cyl9fShjKSl9LHAuaW5pdCgpLGEuTW91c2V0cmFwPXAsXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHMmJihtb2R1bGUuZXhwb3J0cz1wKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShmdW5jdGlvbigpe3JldHVybiBwfSl9KHdpbmRvdyxkb2N1bWVudCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnc2NhbGVBcHAnKS5jb25maWcoZnVuY3Rpb24gKCRwcm92aWRlKSB7XG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJGh0dHBCYWNrZW5kJywgYW5ndWxhci5tb2NrLmUyZS4kaHR0cEJhY2tlbmREZWNvcmF0b3IpO1xuICAgIH0pLnJ1bihmdW5jdGlvbiAoJGh0dHBCYWNrZW5kLCBzY2FsZUNvbmZpZywgWE1MSHR0cFJlcXVlc3QpIHtcblxuICAgICAgICB2YXIgZ2V0U3luYyA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICByZXF1ZXN0Lm9wZW4oJ0dFVCcsIHVybCwgZmFsc2UpO1xuICAgICAgICAgICAgcmVxdWVzdC5zZW5kKG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuIFtyZXF1ZXN0LnN0YXR1cywgcmVxdWVzdC5yZXNwb25zZSwge31dO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEluZ2VzdHMgU3RhdHVzXG4gICAgICAgIHZhciBpbmdlc3RzU3RhdHVzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2luZ2VzdHMvc3RhdHVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKGluZ2VzdHNTdGF0dXNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3RyaWtlcyA9IEpTT04ucGFyc2UoZ2V0U3luYygndGVzdC9kYXRhL2luZ2VzdFN0cmlrZXMuanNvbicpWzFdKSxcbiAgICAgICAgICAgICAgICBzdGFydERhdGUgPSBtb21lbnQudXRjKCkuc3VidHJhY3QoMSwgJ3cnKS5zdGFydE9mKCdkJykudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBlbmREYXRlID0gbW9tZW50LnV0YygpLmFkZCgxLCAnZCcpLnN0YXJ0T2YoJ2QnKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIG51bUhvdXJzID0gbW9tZW50LnV0YyhlbmREYXRlKS5kaWZmKG1vbWVudC51dGMoc3RhcnREYXRlKSwgJ2gnKSxcbiAgICAgICAgICAgICAgICB0aGlzVGltZSA9ICcnLFxuICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdLFxuICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBbXTtcblxuICAgICAgICAgICAgXy5mb3JFYWNoKHN0cmlrZXMucmVzdWx0cywgZnVuY3Rpb24gKHN0cmlrZSkge1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1Ib3VyczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNUaW1lID0gbW9tZW50LnV0YyhzdGFydERhdGUpLmFkZChpLCAnaCcpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRoaXNUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXM6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICg1MDAgLSA1ICsgMSkpICsgNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICg1MDAwMDAwMDAgLSA1MDAwMDAwICsgMSkpICsgNTAwMDAwMFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBzdHJpa2U6IHN0cmlrZSxcbiAgICAgICAgICAgICAgICAgICAgbW9zdF9yZWNlbnQ6IG1vbWVudC51dGMoKS5zdGFydE9mKCdoJykudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZXM6IDIsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IDEyMzQ1Njc4OSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiB2YWx1ZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBjb3VudDogMixcbiAgICAgICAgICAgICAgICBuZXh0OiBudWxsLFxuICAgICAgICAgICAgICAgIHByZXZpb3VzOiBudWxsLFxuICAgICAgICAgICAgICAgIHJlc3VsdHM6IHJlc3VsdHNcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBbMjAwLCBkYXRhLCB7fV07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEluZ2VzdHNcbiAgICAgICAgdmFyIGluZ2VzdHNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvaW5nZXN0cy5qc29uJztcbiAgICAgICAgdmFyIGluZ2VzdHNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnaW5nZXN0cy8nLCAnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVChpbmdlc3RzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoaW5nZXN0c092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSm9iIGxvYWRcbiAgICAgICAgdmFyIGpvYkxvYWRSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbG9hZC8nLCAnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVChqb2JMb2FkUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG51bUhvdXJzID0gbW9tZW50LnV0YygpLmVuZE9mKCdkJykuZGlmZihtb21lbnQudXRjKCkuc3VidHJhY3QoNywgJ2QnKS5zdGFydE9mKCdkJyksICdoJyk7XG4gICAgICAgICAgICB2YXIgc3RhcnRUaW1lID0gbW9tZW50LnV0YygpLnN1YnRyYWN0KDcsICdkJykuc3RhcnRPZignZCcpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgY291bnQ6IG51bUhvdXJzLFxuICAgICAgICAgICAgICAgIG5leHQ6IG51bGwsXG4gICAgICAgICAgICAgICAgcHJldmlvdXM6IG51bGwsXG4gICAgICAgICAgICAgICAgcmVzdWx0czogW11cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5yZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0aW1lOiBtb21lbnQudXRjKHN0YXJ0VGltZSkuYWRkKGksICdoJykudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ19jb3VudDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDEwMCAtIDIwICsgMSkpICsgMjAsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlZF9jb3VudDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDEwMCAtIDIwICsgMSkpICsgMjAsXG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfY291bnQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAgLSAyMCArIDEpKSArIDIwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBbMjAwLCBkYXRhLCB7fV07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEpvYiBkZXRhaWxzXG4gICAgICAgIHZhciBqb2JEZXRhaWxzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL2pvYkRldGFpbHMuanNvbic7XG4gICAgICAgIHZhciBqb2JEZXRhaWxzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ2pvYnMvLiovJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQoam9iRGV0YWlsc1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uIChtZXRob2QsIHVybCkge1xuICAgICAgICAgICAgLy9yZXR1cm4gZ2V0U3luYyhqb2JEZXRhaWxzT3ZlcnJpZGVVcmwpO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBqb2JUeXBlLmlkIGZyb20gdGhlIHVybFxuICAgICAgICAgICAgdXJsID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB2YXIgaWQgPSB1cmwuc3Vic3RyaW5nKHVybC5zdWJzdHJpbmcoMCx1cmwubGFzdEluZGV4T2YoJy8nKSkubGFzdEluZGV4T2YoJy8nKSsxLHVybC5sZW5ndGgtMSk7XG4gICAgICAgICAgICBqb2JEZXRhaWxzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL2pvYi1kZXRhaWxzL2pvYkRldGFpbHMnICsgaWQgKyAnLmpzb24nO1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoam9iRGV0YWlsc092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSm9ic1xuICAgICAgICB2YXIgam9ic092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9qb2JzLmpzb24nO1xuICAgICAgICB2YXIgam9ic1JlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2JzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKGpvYnNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYyhqb2JzT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBKb2IgdHlwZSBzdGF0dXNcbiAgICAgICAgdmFyIGpvYlR5cGVTdGF0dXNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvam9iVHlwZVN0YXR1cy5qc29uJztcbiAgICAgICAgdmFyIGpvYlR5cGVTdGF0dXNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzL3N0YXR1cy8nLCAnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVChqb2JUeXBlU3RhdHVzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoam9iVHlwZVN0YXR1c092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUnVubmluZyBqb2IgdHlwZXNcbiAgICAgICAgdmFyIHJ1bm5pbmdKb2JzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL3J1bm5pbmdKb2JzLmpzb24nO1xuICAgICAgICB2YXIgcnVubmluZ0pvYnNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzL3J1bm5pbmcvJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQocnVubmluZ0pvYnNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYyhydW5uaW5nSm9ic092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSm9iIFR5cGUgRGV0YWlsc1xuICAgICAgICB2YXIgam9iVHlwZURldGFpbHNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvam9iLXR5cGVzL2pvYlR5cGUxLmpzb24nO1xuICAgICAgICB2YXIgam9iVHlwZURldGFpbHNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzLy4qLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKGpvYlR5cGVEZXRhaWxzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKG1ldGhvZCwgdXJsKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGpvYlR5cGUuaWQgZnJvbSB0aGUgdXJsXG4gICAgICAgICAgICB1cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHZhciBpZCA9IHVybC5zdWJzdHJpbmcodXJsLnN1YnN0cmluZygwLHVybC5sYXN0SW5kZXhPZignLycpKS5sYXN0SW5kZXhPZignLycpKzEsdXJsLmxlbmd0aC0xKTtcbiAgICAgICAgICAgIGpvYlR5cGVEZXRhaWxzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL2pvYi10eXBlcy9qb2JUeXBlJyArIGlkICsgJy5qc29uJztcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKGpvYlR5cGVEZXRhaWxzT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBKb2IgdHlwZXNcbiAgICAgICAgdmFyIGpvYlR5cGVzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL2pvYlR5cGVzLmpzb24nO1xuICAgICAgICB2YXIgam9iVHlwZXNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnam9iLXR5cGVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKGpvYlR5cGVzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoam9iVHlwZXNPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gSm9iIGV4ZWN1dGlvbiBsb2dzXG4gICAgICAgIHZhciBqb2JFeGVjdXRpb25Mb2dzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL2pvYkV4ZWN1dGlvbkxvZy5qc29uJztcbiAgICAgICAgdmFyIGpvYkV4ZWN1dGlvbkxvZ1JlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdqb2ItZXhlY3V0aW9ucy8uKi9sb2dzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKGpvYkV4ZWN1dGlvbkxvZ1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKGpvYkV4ZWN1dGlvbkxvZ3NPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgLy8gTWV0cmljcyBQbG90IERhdGEgRGV0YWlsXG4gICAgICAgIC8vdmFyIG1ldHJpY3NQbG90RGF0YU92ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9tZXRyaWNzSm9iVHlwZXNQbG90RGF0YS5qc29uJztcbiAgICAgICAgdmFyIG1ldHJpY3NQbG90RGF0YVJlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdtZXRyaWNzLy4qLy4qLycsJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQobWV0cmljc1Bsb3REYXRhUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKG1ldGhvZCwgdXJsKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0ge30sXG4gICAgICAgICAgICAgICAgcmFuZG9tID0gMDtcblxuICAgICAgICAgICAgdXJsLnNwbGl0KCc/JylbMV0uc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IGl0ZW0uc3BsaXQoJz0nKSxcbiAgICAgICAgICAgICAgICAgICAgayA9IHNbMF0sXG4gICAgICAgICAgICAgICAgICAgIHYgPSBzWzFdICYmIGRlY29kZVVSSUNvbXBvbmVudChzWzFdKTtcbiAgICAgICAgICAgICAgICAoayBpbiBvYmopID8gb2JqW2tdLnB1c2godikgOiBvYmpba10gPSBbdl1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgcmV0dXJuT2JqID0ge1xuICAgICAgICAgICAgICAgIGNvdW50OiAyOCxcbiAgICAgICAgICAgICAgICBuZXh0OiBudWxsLFxuICAgICAgICAgICAgICAgIHByZXZpb3VzOiBudWxsLFxuICAgICAgICAgICAgICAgIHJlc3VsdHM6IFtdXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgbnVtRGF5cyA9IG1vbWVudC51dGMob2JqLmVuZGVkWzBdKS5kaWZmKG1vbWVudC51dGMob2JqLnN0YXJ0ZWRbMF0pLCAnZCcpICsgMTtcblxuICAgICAgICAgICAgXy5mb3JFYWNoKG9iai5jb2x1bW4sIGZ1bmN0aW9uIChtZXRyaWMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF4UmFuZG9tID0gbWV0cmljID09PSAndG90YWxfY291bnQnID8gMTAwMCA6IDIwMDtcbiAgICAgICAgICAgICAgICB2YXIgbWluUmFuZG9tID0gbWV0cmljID09PSAndG90YWxfY291bnQnID8gODAwIDogMTA7XG4gICAgICAgICAgICAgICAgdmFyIHJldHVyblJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiB7IHRpdGxlOiBfLnN0YXJ0Q2FzZShtZXRyaWMpIH0sXG4gICAgICAgICAgICAgICAgICAgIG1pbl94OiBtb21lbnQudXRjKG9iai5zdGFydGVkWzBdKS5mb3JtYXQoJ1lZWVktTU0tREQnKSxcbiAgICAgICAgICAgICAgICAgICAgbWF4X3g6IG1vbWVudC51dGMob2JqLmVuZGVkWzBdKS5mb3JtYXQoJ1lZWVktTU0tREQnKSxcbiAgICAgICAgICAgICAgICAgICAgbWluX3k6IDEsXG4gICAgICAgICAgICAgICAgICAgIG1heF95OiAxMDAwLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRGF5czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouY2hvaWNlX2lkICYmIG9iai5jaG9pY2VfaWQubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXy5mb3JFYWNoKG9iai5jaG9pY2VfaWQsIGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICg1IC0gMSArIDEpKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmRvbSA8PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXhSYW5kb20gLSBtaW5SYW5kb20gKyAxKSkgKyBtaW5SYW5kb207XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblJlc3VsdC52YWx1ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBtb21lbnQudXRjKG9iai5zdGFydGVkWzBdKS5hZGQoaSwgJ2QnKS5mb3JtYXQoJ1lZWVktTU0tREQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYXJzZUludChpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoNSAtIDEgKyAxKSkgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmRvbSA8PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuUmVzdWx0LnZhbHVlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogbW9tZW50LnV0YyhvYmouc3RhcnRlZFswXSkuYWRkKGksICdkJykuZm9ybWF0KCdZWVlZLU1NLUREJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4UmFuZG9tIC0gbWluUmFuZG9tICsgMSkpICsgbWluUmFuZG9tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuT2JqLnJlc3VsdHMucHVzaChyZXR1cm5SZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBbMjAwLCByZXR1cm5PYmosIHt9XTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTWV0cmljcyBEZXRhaWxcbiAgICAgICAgdmFyIG1ldHJpY3NEZXRhaWxSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbWV0cmljcy8uKi8nLCdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKG1ldHJpY3NEZXRhaWxSZWdleCkucmVzcG9uZChmdW5jdGlvbiAobWV0aG9kLCB1cmwpIHtcbiAgICAgICAgICAgIHZhciB1cmxBcnIgPSB1cmwuc3BsaXQoJy8nKSxcbiAgICAgICAgICAgICAgICBkZXRhaWxUeXBlID0gdXJsQXJyW3VybEFyci5sZW5ndGggLSAyXTtcblxuICAgICAgICAgICAgaWYgKGRldGFpbFR5cGUgPT09ICdqb2ItdHlwZXMnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoJ3Rlc3QvZGF0YS9tZXRyaWNzSm9iVHlwZXMuanNvbicpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkZXRhaWxUeXBlID09PSAnZXJyb3ItdHlwZXMnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMoJ3Rlc3QvZGF0YS9tZXRyaWNzRXJyb3JUeXBlcy5qc29uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYygndGVzdC9kYXRhL21ldHJpY3NJbmdlc3QuanNvbicpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBNZXRyaWNzXG4gICAgICAgIHZhciBtZXRyaWNzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL21ldHJpY3MuanNvbic7XG4gICAgICAgIHZhciBtZXRyaWNzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ21ldHJpY3MvJywnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVChtZXRyaWNzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMobWV0cmljc092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTm9kZSBzdGF0dXNcbiAgICAgICAgdmFyIG5vZGVTdGF0dXNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvbm9kZVN0YXR1cy5qc29uJztcbiAgICAgICAgdmFyIG5vZGVTdGF0dXNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbm9kZXMvc3RhdHVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKG5vZGVTdGF0dXNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYyhub2RlU3RhdHVzT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBOb2RlIGRldGFpbHNcbiAgICAgICAgdmFyIG5vZGVPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvbm9kZS5qc29uJztcbiAgICAgICAgdmFyIG5vZGVSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnbm9kZXMvLiovJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQobm9kZVJlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKG5vZGVPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE5vZGVzXG4gICAgICAgIHZhciBub2Rlc092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9ub2Rlcy5qc29uJztcbiAgICAgICAgdmFyIG5vZGVzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ25vZGVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKG5vZGVzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMobm9kZXNPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFF1ZXVlIFN0YXR1cyBzZXJ2aWNlXG4gICAgICAgIHZhciBxdWV1ZVN0YXR1c092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9xdWV1ZVN0YXR1cy5qc29uJztcbiAgICAgICAgdmFyIHF1ZXVlU3RhdHVzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3F1ZXVlL3N0YXR1cy8nLCAnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVChxdWV1ZVN0YXR1c1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKHF1ZXVlU3RhdHVzT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlY2lwZSBEZXRhaWxzXG4gICAgICAgIHZhciByZWNpcGVEZXRhaWxzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL3JlY2lwZURldGFpbHMuanNvbic7XG4gICAgICAgIHZhciByZWNpcGVEZXRhaWxzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3JlY2lwZXMvLiovJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQocmVjaXBlRGV0YWlsc1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uIChtZXRob2QsIHVybCkge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSByZWNpcGVEZXRhaWwuaWQgZnJvbSB0aGUgdXJsXG4gICAgICAgICAgICB1cmwgPSB1cmwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHZhciBpZCA9IHVybC5zdWJzdHJpbmcodXJsLnN1YnN0cmluZygwLHVybC5sYXN0SW5kZXhPZignLycpKS5sYXN0SW5kZXhPZignLycpKzEsdXJsLmxlbmd0aC0xKTtcbiAgICAgICAgICAgIHJlY2lwZURldGFpbHNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvcmVjaXBlLWRldGFpbHMvcmVjaXBlRGV0YWlsJyArIGlkICsgJy5qc29uJztcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKHJlY2lwZURldGFpbHNPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlY2lwZXMgc2VydmljZVxuICAgICAgICB2YXIgcmVjaXBlc092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9yZWNpcGVzLmpzb24nO1xuICAgICAgICB2YXIgcmVjaXBlc1JlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKHJlY2lwZXNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYyhyZWNpcGVzT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZWNpcGUgdHlwZSB2YWxpZGF0aW9uIHNlcnZpY2VcbiAgICAgICAgdmFyIHJlY2lwZVR5cGVWYWxpZGF0aW9uT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL3JlY2lwZVR5cGVWYWxpZGF0aW9uU3VjY2Vzcy5qc29uJztcbiAgICAgICAgdmFyIHJlY2lwZVR5cGVWYWxpZGF0aW9uUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3JlY2lwZS10eXBlcy92YWxpZGF0aW9uLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuUE9TVChyZWNpcGVUeXBlVmFsaWRhdGlvblJlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKHJlY2lwZVR5cGVWYWxpZGF0aW9uT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZWNpcGUgVHlwZSBEZXRhaWxzXG4gICAgICAgIHZhciByZWNpcGVUeXBlRGV0YWlsc092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9yZWNpcGUtdHlwZXMvcmVjaXBlVHlwZTEuanNvbic7XG4gICAgICAgIHZhciByZWNpcGVUeXBlRGV0YWlsc1JlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICdyZWNpcGUtdHlwZXMvLiovJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQocmVjaXBlVHlwZURldGFpbHNSZWdleCkucmVzcG9uZChmdW5jdGlvbiAobWV0aG9kLCB1cmwpIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgcmVjaXBlVHlwZS5pZCBmcm9tIHRoZSB1cmxcbiAgICAgICAgICAgIHVybCA9IHVybC50b1N0cmluZygpO1xuICAgICAgICAgICAgdmFyIGlkID0gdXJsLnN1YnN0cmluZyh1cmwuc3Vic3RyaW5nKDAsdXJsLmxhc3RJbmRleE9mKCcvJykpLmxhc3RJbmRleE9mKCcvJykrMSx1cmwubGVuZ3RoLTEpO1xuICAgICAgICAgICAgcmVjaXBlVHlwZURldGFpbHNPdmVycmlkZVVybCA9ICd0ZXN0L2RhdGEvcmVjaXBlLXR5cGVzL3JlY2lwZVR5cGUnICsgaWQgKyAnLmpzb24nO1xuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gZ2V0U3luYyhyZWNpcGVUeXBlRGV0YWlsc092ZXJyaWRlVXJsKTtcbiAgICAgICAgICAgIGlmIChyZXR1cm5WYWx1ZVswXSAhPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjaXBlVHlwZScgKyBpZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyMDAsIEpTT04ucGFyc2UocmV0dXJuVmFsdWUpLCB7fV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUmVjaXBlIFR5cGVzIHNlcnZpY2VcbiAgICAgICAgdmFyIHJlY2lwZVR5cGVzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL3JlY2lwZVR5cGVzLmpzb24nO1xuICAgICAgICB2YXIgcmVjaXBlVHlwZXNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAncmVjaXBlLXR5cGVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKHJlY2lwZVR5cGVzUmVnZXgpLnJlc3BvbmQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFN5bmMocmVjaXBlVHlwZXNPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNhdmUgUmVjaXBlIFR5cGVcbiAgICAgICAgdmFyIHJlY2lwZVR5cGVTYXZlUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3JlY2lwZS10eXBlcy8nLCAnaScpO1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlblBPU1QocmVjaXBlVHlwZVNhdmVSZWdleCkucmVzcG9uZChmdW5jdGlvbiAobWV0aG9kLCB1cmwsIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciByZWNpcGVKb2JUeXBlcyA9IFtdLFxuICAgICAgICAgICAgICAgIHJlY2lwZUpvYlR5cGVzRGV0YWlscyA9IFtdLFxuICAgICAgICAgICAgICAgIGpvYlR5cGVEYXRhID0gZ2V0U3luYygndGVzdC9kYXRhL2pvYlR5cGVzLmpzb24nKSxcbiAgICAgICAgICAgICAgICBqb2JUeXBlcyA9IEpTT04ucGFyc2Uoam9iVHlwZURhdGFbMV0pLnJlc3VsdHMsXG4gICAgICAgICAgICAgICAgcmVjaXBlVHlwZSA9IEpTT04ucGFyc2UoZGF0YSksXG4gICAgICAgICAgICAgICAgdW5pcXVlUmVjaXBlVHlwZUpvYnMgPSBfLnVuaXEocmVjaXBlVHlwZS5kZWZpbml0aW9uLmpvYnMsICdqb2JfdHlwZScpO1xuICAgICAgICAgICAgXy5mb3JFYWNoKHVuaXF1ZVJlY2lwZVR5cGVKb2JzLCBmdW5jdGlvbiAoam9iKSB7XG4gICAgICAgICAgICAgICAgcmVjaXBlSm9iVHlwZXMucHVzaChfLmZpbmQoam9iVHlwZXMsIGZ1bmN0aW9uIChqb2JUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBqb2JUeXBlLm5hbWUgPT09IGpvYi5qb2JfdHlwZS5uYW1lICYmIGpvYlR5cGUudmVyc2lvbiA9PT0gam9iLmpvYl90eXBlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfLmZvckVhY2gocmVjaXBlSm9iVHlwZXMsIGZ1bmN0aW9uIChqb2JUeXBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGp0ID0gZ2V0U3luYygndGVzdC9kYXRhL2pvYi10eXBlcy9qb2JUeXBlJyArIGpvYlR5cGUuaWQgKyAnLmpzb24nKTtcbiAgICAgICAgICAgICAgICByZWNpcGVKb2JUeXBlc0RldGFpbHMucHVzaChKU09OLnBhcnNlKGp0WzFdKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciByZXR1cm5SZWNpcGUgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAwMCAtIDUgKyAxKSkgKyA1LFxuICAgICAgICAgICAgICAgIG5hbWU6IHJlY2lwZVR5cGUubmFtZSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiByZWNpcGVUeXBlLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgdGl0bGU6IHJlY2lwZVR5cGUudGl0bGUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlY2lwZVR5cGUuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRlZmluaXRpb246IHJlY2lwZVR5cGUuZGVmaW5pdGlvbixcbiAgICAgICAgICAgICAgICByZXZpc2lvbl9udW06IDEsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIGxhc3RfbW9kaWZpZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBhcmNoaXZlZDogbnVsbCxcbiAgICAgICAgICAgICAgICB0cmlnZ2VyX3J1bGU6IHJlY2lwZVR5cGUudHJpZ2dlcl9ydWxlLFxuICAgICAgICAgICAgICAgIGpvYl90eXBlczogcmVjaXBlSm9iVHlwZXNEZXRhaWxzXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIFsyMDAsIEpTT04uc3RyaW5naWZ5KHJldHVyblJlY2lwZSksIHt9XTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3RhdHVzIHNlcnZpY2VcbiAgICAgICAgdmFyIHN0YXR1c092ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS9zdGF0dXMuanNvbic7XG4gICAgICAgIHZhciBzdGF0dXNSZWdleCA9IG5ldyBSZWdFeHAoJ14nICsgc2NhbGVDb25maWcudXJscy5hcGlQcmVmaXggKyAnc3RhdHVzLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKHN0YXR1c1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKHN0YXR1c092ZXJyaWRlVXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVmVyc2lvblxuICAgICAgICB2YXIgdmVyc2lvbk92ZXJyaWRlVXJsID0gJ3Rlc3QvZGF0YS92ZXJzaW9uLmpzb24nO1xuICAgICAgICB2YXIgdmVyc2lvblJlZ2V4ID0gbmV3IFJlZ0V4cCgnXicgKyBzY2FsZUNvbmZpZy51cmxzLmFwaVByZWZpeCArICd2My92ZXJzaW9uLycsICdpJyk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuR0VUKHZlcnNpb25SZWdleCkucmVzcG9uZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0U3luYyh2ZXJzaW9uT3ZlcnJpZGVVcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXb3Jrc3BhY2VzXG4gICAgICAgIHZhciB3b3Jrc3BhY2VzT3ZlcnJpZGVVcmwgPSAndGVzdC9kYXRhL3dvcmtzcGFjZXMuanNvbic7XG4gICAgICAgIHZhciB3b3Jrc3BhY2VzUmVnZXggPSBuZXcgUmVnRXhwKCdeJyArIHNjYWxlQ29uZmlnLnVybHMuYXBpUHJlZml4ICsgJ3dvcmtzcGFjZXMvJywgJ2knKTtcbiAgICAgICAgJGh0dHBCYWNrZW5kLndoZW5HRVQod29ya3NwYWNlc1JlZ2V4KS5yZXNwb25kKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRTeW5jKHdvcmtzcGFjZXNPdmVycmlkZVVybCk7XG4gICAgICAgIH0pO1xuXG5cblxuXG5cbiAgICAgICAgLy8gRm9yIGV2ZXJ5dGhpbmcgZWxzZSwgZG9uJ3QgbW9ja1xuICAgICAgICAkaHR0cEJhY2tlbmQud2hlbkdFVCgvXlxcdysuKi8pLnBhc3NUaHJvdWdoKCk7XG4gICAgICAgICRodHRwQmFja2VuZC53aGVuUE9TVCgvXlxcdysuKi8pLnBhc3NUaHJvdWdoKCk7XG4gICAgfSk7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
