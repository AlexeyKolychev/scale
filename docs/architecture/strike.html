

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Strike &mdash; Scale 3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Scale 3.0 documentation" href="../index.html" />
    <link rel="up" title="Architecture" href="index.html" />
    <link rel="next" title="Triggers" href="triggers.html" />
    <link rel="prev" title="Import/Export" href="port.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="triggers.html" title="Triggers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="port.html" title="Import/Export"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Scale 3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Architecture</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="strike">
<span id="architecture-strike"></span><h1>Strike<a class="headerlink" href="#strike" title="Permalink to this headline">¶</a></h1>
<p>Strike is the name of Scale&#8217;s directory watching capability. A Strike process monitors a given directory on a Network
File System (NFS) for new files and ingests those files into a Scale workspace if they meet certain criteria. When a new
Strike process is created, a new job is created and executed to run the new process. A Strike process contains
configuration specifying the details of the NFS directory to monitor and how to ingest and store the files that appear
in the directory.</p>
<p><strong>Example Strike configuration:</strong></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;mount&quot;</span><span class="o">:</span> <span class="s2">&quot;host:/my/path&quot;</span><span class="p">,</span>
   <span class="s2">&quot;transfer_suffix&quot;</span><span class="o">:</span> <span class="s2">&quot;_tmp&quot;</span><span class="p">,</span>
   <span class="s2">&quot;files_to_ingest&quot;</span><span class="o">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;filename_regex&quot;</span><span class="o">:</span> <span class="s2">&quot;.*h5&quot;</span><span class="p">,</span>
           <span class="s2">&quot;data_types&quot;</span><span class="o">:</span> <span class="p">[],</span>
           <span class="s2">&quot;workspace_path&quot;</span><span class="o">:</span> <span class="s2">&quot;/wrksp/path&quot;</span><span class="p">,</span>
           <span class="s2">&quot;workspace_name&quot;</span><span class="o">:</span> <span class="s2">&quot;rs&quot;</span>
       <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <em>mount</em> field specifies the NFS host and path that should be mounted in order to access the directory to be
monitored. The <em>transfer_suffix</em> field defines a suffix that is used on the file names to indicate that they are still
transferring and have not yet finished being copied into the monitored directory. The <em>files_to_ingest</em> value is a list
detailing the different files to ingest and how to ingest them. The <em>filename_regex</em> field defines a regular expression
to check against the names of newly copied files. If the expression matches a newly copied file name in the directory,
that file is ingested according to the other fields in the JSON object. The <em>data_types</em> field is list of strings. Any
file that matches the corresponding regular expression will have the data type strings &#8220;tagged&#8221; with the file. The data
type tags are used to categorize files and control which jobs and recipes they go to. The <em>workspace_path</em> specifies a
relative path within the workspace where each file will be stored. Three additional and dynamically named directories,
for the current year, month, and day, will be appended to the <em>workspace_path</em> value automatically by the Scale system
when a file is ingested (i.e. workspace_path/YYYY/MM/DD). The <em>workspace_name</em> field is the system name of the unique
workspace that should ingest the file. To see all of the options for a Strike process&#8217;s configuration, please refer to
the Strike Configuration Specification below.</p>
<div class="section" id="strike-configuration-specification-version-1-0">
<span id="architecture-strike-spec"></span><h2>Strike Configuration Specification Version 1.0<a class="headerlink" href="#strike-configuration-specification-version-1-0" title="Permalink to this headline">¶</a></h2>
<p>A valid Strike configuration is a JSON document with the following structure:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;mount&quot;</span><span class="o">:</span> <span class="nx">STRING</span><span class="p">,</span>
   <span class="s2">&quot;transfer_suffix&quot;</span><span class="o">:</span> <span class="nx">STRING</span><span class="p">,</span>
   <span class="s2">&quot;files_to_ingest&quot;</span><span class="o">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;filename_regex&quot;</span><span class="o">:</span> <span class="nx">STRING</span><span class="p">,</span>
           <span class="s2">&quot;data_types&quot;</span><span class="o">:</span> <span class="p">[</span>
              <span class="nx">STRING</span><span class="p">,</span>
              <span class="nx">STRING</span>
           <span class="p">],</span>
           <span class="s2">&quot;workspace_path&quot;</span><span class="o">:</span> <span class="nx">STRING</span><span class="p">,</span>
           <span class="s2">&quot;workspace_name&quot;</span><span class="o">:</span> <span class="nx">STRING</span>
       <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>version</strong>: JSON string</p>
<blockquote>
<div>The <em>version</em> is an optional string value that defines the version of the configuration used. This allows updates to
be made to the specification while maintaining backwards compatibility by allowing Scale to recognize an older
version and convert it to the current version. The default value for <em>version</em> if it is not included is the latest
version, which is currently 1.0. It is recommended, though not required, that you include the <em>version</em> so that
future changes to the specification will still accept your Strike configuration.</div></blockquote>
<p><strong>mount</strong>: JSON string</p>
<blockquote>
<div>The <em>mount</em> field is a required string that specifies the NFS host and path that should be mounted in order to
access the monitored directory (format is <em>host:/file/path</em>).</div></blockquote>
<p><strong>transfer_suffix</strong>: JSON string</p>
<blockquote>
<div>The <em>transfer_suffix</em> field is a required string that defines a suffix that is used on the file names (by the
system or process that is transferring files into the directory) to indicate that the files are still transferring
and have not yet finished being copied into the monitored directory.</div></blockquote>
<p><strong>files_to_ingest</strong>: JSON array</p>
<blockquote>
<div><p>The <em>files_to_ingest</em> field is a list of JSON objects that define the rules for which files to ingest and how to
ingest them. The array must contain at least one item. Each JSON object has the following fields:</p>
<p><strong>filename_regex</strong>: JSON string</p>
<blockquote>
<div>The <em>filename_regex</em> field is a required string that defines a regular expression to check against the names of
newly copied files. When a new file is copied in the monitored directory, each expression is checked against the
file name in order of the <em>files_to_ingest</em> array. If an expression matches a newly copied file name in the
directory, that file is ingested according to the other fields in the JSON object and all subsequent
rules/expressions in the list are ignored.</div></blockquote>
<p><strong>data_types</strong>: JSON array</p>
<blockquote>
<div>The <em>data_types</em> field is an optional list of strings. Any file that matches the corresponding file name regular
expression will have these data type strings &#8220;tagged&#8221; with the file. If not provided, <em>data_types</em> defaults to
an empty array.</div></blockquote>
<p><strong>workspace_path</strong>: JSON string</p>
<blockquote>
<div>The <em>workspace_path</em> field is a required string that specifies a relative path within the workspace where each
file will be stored. Three additional and dynamically named directories, for the current year, month, and day,
will be appended to the <em>workspace_path</em> value automatically by the Scale system when a file is ingested
(i.e. workspace_path/YYYY/MM/DD).</div></blockquote>
<p><strong>workspace_name</strong>: JSON string</p>
<blockquote>
<div>The <em>workspace_name</em> field is required and contains the unique system name of the workspace that should store
each file that matches the corresponding file name regular expression.</div></blockquote>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Strike</a><ul>
<li><a class="reference internal" href="#strike-configuration-specification-version-1-0">Strike Configuration Specification Version 1.0</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="port.html"
                        title="previous chapter">Import/Export</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="triggers.html"
                        title="next chapter">Triggers</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/architecture/strike.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="triggers.html" title="Triggers"
             >next</a> |</li>
        <li class="right" >
          <a href="port.html" title="Import/Export"
             >previous</a> |</li>
        <li><a href="../index.html">Scale 3.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Architecture</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, NGA.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>